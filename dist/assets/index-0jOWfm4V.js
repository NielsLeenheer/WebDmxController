var mc=Object.defineProperty;var Aa=n=>{throw TypeError(n)};var yc=(n,e,t)=>e in n?mc(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var $e=(n,e,t)=>yc(n,typeof e!="symbol"?e+"":e,t),Ls=(n,e,t)=>e.has(n)||Aa("Cannot "+t);var p=(n,e,t)=>(Ls(n,e,"read from private field"),t?t.call(n):e.get(n)),U=(n,e,t)=>e.has(n)?Aa("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),F=(n,e,t,r)=>(Ls(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t),Fe=(n,e,t)=>(Ls(n,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();const mo=!1;var oa=Array.isArray,wc=Array.prototype.indexOf,la=Array.from,bc=Object.defineProperty,hr=Object.getOwnPropertyDescriptor,yo=Object.getOwnPropertyDescriptors,Sc=Object.prototype,Dc=Array.prototype,ca=Object.getPrototypeOf,Oa=Object.isExtensible;function Cc(n){return n()}function $s(n){for(var e=0;e<n.length;e++)n[e]()}function wo(){var n,e,t=new Promise((r,i)=>{n=r,e=i});return{promise:t,resolve:n,reject:e}}function bo(n,e){if(Array.isArray(n))return n;if(!(Symbol.iterator in n))return Array.from(n);const t=[];for(const r of n)if(t.push(r),t.length===e)break;return t}const vt=2,is=4,ss=8,wn=16,bn=32,ar=64,as=128,at=1024,It=2048,an=4096,Tt=8192,_n=16384,ua=32768,rr=65536,Ra=1<<17,So=1<<18,Nr=1<<19,Do=1<<20,Ft=256,Ui=512,$i=32768,Hs=1<<21,da=1<<22,Tn=1<<23,mn=Symbol("$state"),Ec=Symbol("legacy props"),Ic=Symbol(""),vr=new class extends Error{constructor(){super(...arguments);$e(this,"name","StaleReactionError");$e(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function Co(n){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function xc(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function kc(n){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Mc(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Pc(n){throw new Error("https://svelte.dev/e/effect_orphan")}function Tc(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Lc(n){throw new Error("https://svelte.dev/e/props_invalid_value")}function Ac(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Oc(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Rc(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Nc(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const os=1,ls=2,Eo=4,Fc=8,Bc=16,Vc=1,Gc=2,Io=4,jc=8,Kc=16,Uc=1,$c=2,it=Symbol(),Hc="http://www.w3.org/1999/xhtml",zc="@attach";function qc(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function Wc(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}let Yc=!1;function xo(n){return n===this.v}function Xc(n,e){return n!=n?e==e:n!==e||n!==null&&typeof n=="object"||typeof n=="function"}function ko(n){return!Xc(n,this.v)}let Fr=!1,Jc=!1;function Zc(){Fr=!0}let je=null;function kr(n){je=n}function yt(n,e=!1,t){je={p:je,i:!1,c:null,e:null,s:n,x:null,l:Fr&&!e?{s:null,u:null,$:[]}:null}}function wt(n){var e=je,t=e.e;if(t!==null){e.e=null;for(var r of t)Wo(r)}return n!==void 0&&(e.x=n),e.i=!0,je=e.p,n??{}}function pi(){return!Fr||je!==null&&je.l===null}let Hn=[];function Mo(){var n=Hn;Hn=[],$s(n)}function yn(n){if(Hn.length===0&&!Xr){var e=Hn;queueMicrotask(()=>{e===Hn&&Mo()})}Hn.push(n)}function Qc(){for(;Hn.length>0;)Mo()}function Po(n){var e=fe;if(e===null)return he.f|=Tn,n;if(e.f&ua)Mr(n,e);else{if(!(e.f&as))throw n;e.b.error(n)}}function Mr(n,e){for(;e!==null;){if(e.f&as)try{e.b.error(n);return}catch(t){n=t}e=e.parent}throw n}const Ii=new Set;let Ae=null,Yr=null,st=null,en=[],cs=null,zs=!1,Xr=!1;var _r,mr,zn,qn,ni,yr,wr,ft,qs,$n,To,Lo;const Ji=class Ji{constructor(){U(this,ft);$e(this,"committed",!1);$e(this,"current",new Map);$e(this,"previous",new Map);U(this,_r,new Set);U(this,mr,new Set);U(this,zn,0);U(this,qn,0);U(this,ni,null);U(this,yr,[]);U(this,wr,[]);$e(this,"skipped_effects",new Set);$e(this,"is_fork",!1)}process(e){var r;en=[],Yr=null,this.apply();var t={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const i of e)Fe(this,ft,qs).call(this,i,t);this.is_fork||Fe(this,ft,To).call(this),p(this,qn)>0||this.is_fork?(Fe(this,ft,$n).call(this,t.effects),Fe(this,ft,$n).call(this,t.render_effects),Fe(this,ft,$n).call(this,t.block_effects)):(Yr=this,Ae=null,Na(t.render_effects),Na(t.effects),Yr=null,(r=p(this,ni))==null||r.resolve()),st=null}capture(e,t){this.previous.has(e)||this.previous.set(e,t),e.f&Tn||(this.current.set(e,e.v),st==null||st.set(e,e.v))}activate(){Ae=this,this.apply()}deactivate(){Ae=null,st=null}flush(){if(this.activate(),en.length>0){if(Ao(),Ae!==null&&Ae!==this)return}else p(this,zn)===0&&this.process([]);this.deactivate()}discard(){for(const e of p(this,mr))e(this);p(this,mr).clear()}increment(e){F(this,zn,p(this,zn)+1),e&&F(this,qn,p(this,qn)+1)}decrement(e){F(this,zn,p(this,zn)-1),e&&F(this,qn,p(this,qn)-1),this.revive()}revive(){for(const e of p(this,yr))ot(e,It),ir(e);for(const e of p(this,wr))ot(e,an),ir(e);F(this,yr,[]),F(this,wr,[]),this.flush()}oncommit(e){p(this,_r).add(e)}ondiscard(e){p(this,mr).add(e)}settled(){return(p(this,ni)??F(this,ni,wo())).promise}static ensure(){if(Ae===null){const e=Ae=new Ji;Ii.add(Ae),Xr||Ji.enqueue(()=>{Ae===e&&e.flush()})}return Ae}static enqueue(e){yn(e)}apply(){}};_r=new WeakMap,mr=new WeakMap,zn=new WeakMap,qn=new WeakMap,ni=new WeakMap,yr=new WeakMap,wr=new WeakMap,ft=new WeakSet,qs=function(e,t){var d;e.f^=at;for(var r=e.first;r!==null;){var i=r.f,s=(i&(bn|ar))!==0,a=s&&(i&at)!==0,l=a||(i&Tt)!==0||this.skipped_effects.has(r);if(r.f&as&&((d=r.b)!=null&&d.is_pending())&&(t={parent:t,effect:r,effects:[],render_effects:[],block_effects:[]}),!l&&r.fn!==null){s?r.f^=at:i&is?t.effects.push(r):Vr(r)&&(r.f&wn&&t.block_effects.push(r),Tr(r));var c=r.first;if(c!==null){r=c;continue}}var u=r.parent;for(r=r.next;r===null&&u!==null;)u===t.effect&&(Fe(this,ft,$n).call(this,t.effects),Fe(this,ft,$n).call(this,t.render_effects),Fe(this,ft,$n).call(this,t.block_effects),t=t.parent),r=u.next,u=u.parent}},$n=function(e){for(const t of e)(t.f&It?p(this,yr):p(this,wr)).push(t),ot(t,at)},To=function(){if(p(this,qn)===0){for(const e of p(this,_r))e();p(this,_r).clear()}p(this,zn)===0&&Fe(this,ft,Lo).call(this)},Lo=function(){var i;if(Ii.size>1){this.previous.clear();var e=st,t=!0,r={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const s of Ii){if(s===this){t=!1;continue}const a=[];for(const[c,u]of this.current){if(s.current.has(c))if(t&&u!==s.current.get(c))s.current.set(c,u);else continue;a.push(c)}if(a.length===0)continue;const l=[...s.current.keys()].filter(c=>!this.current.has(c));if(l.length>0){const c=new Set,u=new Map;for(const d of a)Oo(d,l,c,u);if(en.length>0){Ae=s,s.apply();for(const d of en)Fe(i=s,ft,qs).call(i,d,r);en=[],s.deactivate()}}}Ae=null,st=e}this.committed=!0,Ii.delete(this)};let pn=Ji;function eu(n){var e=Xr;Xr=!0;try{for(var t;;){if(Qc(),en.length===0&&(Ae==null||Ae.flush(),en.length===0))return cs=null,t;Ao()}}finally{Xr=e}}function Ao(){var n=gr;zs=!0;try{var e=0;for(Ga(!0);en.length>0;){var t=pn.ensure();if(e++>1e3){var r,i;tu()}t.process(en),Ln.clear()}}finally{zs=!1,Ga(n),cs=null}}function tu(){try{Tc()}catch(n){Mr(n,cs)}}let Kt=null;function Na(n){var e=n.length;if(e!==0){for(var t=0;t<e;){var r=n[t++];if(!(r.f&(_n|Tt))&&Vr(r)&&(Kt=new Set,Tr(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null&&r.ac===null?Zo(r):r.fn=null),(Kt==null?void 0:Kt.size)>0)){Ln.clear();for(const i of Kt){if(i.f&(_n|Tt))continue;const s=[i];let a=i.parent;for(;a!==null;)Kt.has(a)&&(Kt.delete(a),s.push(a)),a=a.parent;for(let l=s.length-1;l>=0;l--){const c=s[l];c.f&(_n|Tt)||Tr(c)}}Kt.clear()}}Kt=null}}function Oo(n,e,t,r){if(!t.has(n)&&(t.add(n),n.reactions!==null))for(const i of n.reactions){const s=i.f;s&vt?Oo(i,e,t,r):s&(da|wn)&&!(s&It)&&Ro(i,e,r)&&(ot(i,It),ir(i))}}function Ro(n,e,t){const r=t.get(n);if(r!==void 0)return r;if(n.deps!==null)for(const i of n.deps){if(e.includes(i))return!0;if(i.f&vt&&Ro(i,e,t))return t.set(i,!0),!0}return t.set(n,!1),!1}function ir(n){for(var e=cs=n;e.parent!==null;){e=e.parent;var t=e.f;if(zs&&e===fe&&t&wn&&!(t&So))return;if(t&(ar|bn)){if(!(t&at))return;e.f^=at}}en.push(e)}function nu(n){let e=0,t=An(0),r;return()=>{gu()&&(o(t),or(()=>(e===0&&(r=ln(()=>n(()=>Jr(t)))),e+=1,()=>{yn(()=>{e-=1,e===0&&(r==null||r(),r=void 0,Jr(t))})})))}}var ru=rr|Nr|as;function iu(n,e,t){new su(n,e,t)}var At,Ot,aa,Yt,Wn,Xt,Rt,St,Jt,dn,En,Yn,In,Xn,xn,Zi,nt,au,ou,Ws,Gi,ji,Ys;class su{constructor(e,t,r){U(this,nt);$e(this,"parent");U(this,At,!1);U(this,Ot);U(this,aa,null);U(this,Yt);U(this,Wn);U(this,Xt);U(this,Rt,null);U(this,St,null);U(this,Jt,null);U(this,dn,null);U(this,En,null);U(this,Yn,0);U(this,In,0);U(this,Xn,!1);U(this,xn,null);U(this,Zi,nu(()=>(F(this,xn,An(p(this,Yn))),()=>{F(this,xn,null)})));F(this,Ot,e),F(this,Yt,t),F(this,Wn,r),this.parent=fe.b,F(this,At,!!p(this,Yt).pending),F(this,Xt,Br(()=>{fe.b=this;{var i=Fe(this,nt,Ws).call(this);try{F(this,Rt,Mt(()=>r(i)))}catch(s){this.error(s)}p(this,In)>0?Fe(this,nt,ji).call(this):F(this,At,!1)}return()=>{var s;(s=p(this,En))==null||s.remove()}},ru))}is_pending(){return p(this,At)||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!p(this,Yt).pending}update_pending_count(e){Fe(this,nt,Ys).call(this,e),F(this,Yn,p(this,Yn)+e),p(this,xn)&&Pr(p(this,xn),p(this,Yn))}get_effect_pending(){return p(this,Zi).call(this),o(p(this,xn))}error(e){var t=p(this,Yt).onerror;let r=p(this,Yt).failed;if(p(this,Xn)||!t&&!r)throw e;p(this,Rt)&&(tt(p(this,Rt)),F(this,Rt,null)),p(this,St)&&(tt(p(this,St)),F(this,St,null)),p(this,Jt)&&(tt(p(this,Jt)),F(this,Jt,null));var i=!1,s=!1;const a=()=>{if(i){Wc();return}i=!0,s&&Nc(),pn.ensure(),F(this,Yn,0),p(this,Jt)!==null&&pr(p(this,Jt),()=>{F(this,Jt,null)}),F(this,At,this.has_pending_snippet()),F(this,Rt,Fe(this,nt,Gi).call(this,()=>(F(this,Xn,!1),Mt(()=>p(this,Wn).call(this,p(this,Ot)))))),p(this,In)>0?Fe(this,nt,ji).call(this):F(this,At,!1)};var l=he;try{Ct(null),s=!0,t==null||t(e,a),s=!1}catch(c){Mr(c,p(this,Xt)&&p(this,Xt).parent)}finally{Ct(l)}r&&yn(()=>{F(this,Jt,Fe(this,nt,Gi).call(this,()=>{pn.ensure(),F(this,Xn,!0);try{return Mt(()=>{r(p(this,Ot),()=>e,()=>a)})}catch(c){return Mr(c,p(this,Xt).parent),null}finally{F(this,Xn,!1)}}))})}}At=new WeakMap,Ot=new WeakMap,aa=new WeakMap,Yt=new WeakMap,Wn=new WeakMap,Xt=new WeakMap,Rt=new WeakMap,St=new WeakMap,Jt=new WeakMap,dn=new WeakMap,En=new WeakMap,Yn=new WeakMap,In=new WeakMap,Xn=new WeakMap,xn=new WeakMap,Zi=new WeakMap,nt=new WeakSet,au=function(){try{F(this,Rt,Mt(()=>p(this,Wn).call(this,p(this,Ot))))}catch(e){this.error(e)}F(this,At,!1)},ou=function(){const e=p(this,Yt).pending;e&&(F(this,St,Mt(()=>e(p(this,Ot)))),pn.enqueue(()=>{var t=Fe(this,nt,Ws).call(this);F(this,Rt,Fe(this,nt,Gi).call(this,()=>(pn.ensure(),Mt(()=>p(this,Wn).call(this,t))))),p(this,In)>0?Fe(this,nt,ji).call(this):(pr(p(this,St),()=>{F(this,St,null)}),F(this,At,!1))}))},Ws=function(){var e=p(this,Ot);return p(this,At)&&(F(this,En,On()),p(this,Ot).before(p(this,En)),e=p(this,En)),e},Gi=function(e){var t=fe,r=he,i=je;Vt(p(this,Xt)),Ct(p(this,Xt)),kr(p(this,Xt).ctx);try{return e()}catch(s){return Po(s),null}finally{Vt(t),Ct(r),kr(i)}},ji=function(){const e=p(this,Yt).pending;p(this,Rt)!==null&&(F(this,dn,document.createDocumentFragment()),p(this,dn).append(p(this,En)),tl(p(this,Rt),p(this,dn))),p(this,St)===null&&F(this,St,Mt(()=>e(p(this,Ot))))},Ys=function(e){var t;if(!this.has_pending_snippet()){this.parent&&Fe(t=this.parent,nt,Ys).call(t,e);return}F(this,In,p(this,In)+e),p(this,In)===0&&(F(this,At,!1),p(this,St)&&pr(p(this,St),()=>{F(this,St,null)}),p(this,dn)&&(p(this,Ot).before(p(this,dn)),F(this,dn,null)))};function No(n,e,t,r){const i=pi()?gi:fa;if(t.length===0&&n.length===0){r(e.map(i));return}var s=Ae,a=fe,l=lu();function c(){Promise.all(t.map(u=>cu(u))).then(u=>{l();try{r([...e.map(i),...u])}catch(d){a.f&_n||Mr(d,a)}s==null||s.deactivate(),Hi()}).catch(u=>{Mr(u,a)})}n.length>0?Promise.all(n).then(()=>{l();try{return c()}finally{s==null||s.deactivate(),Hi()}}):c()}function lu(){var n=fe,e=he,t=je,r=Ae;return function(s=!0){Vt(n),Ct(e),kr(t),s&&(r==null||r.activate())}}function Hi(){Vt(null),Ct(null),kr(null)}function gi(n){var e=vt|It,t=he!==null&&he.f&vt?he:null;return fe===null||t!==null&&t.f&Ft?e|=Ft:fe.f|=Nr,{ctx:je,deps:null,effects:null,equals:xo,f:e,fn:n,reactions:null,rv:0,v:it,wv:0,parent:t??fe,ac:null}}function cu(n,e){let t=fe;t===null&&xc();var r=t.b,i=void 0,s=An(it),a=!he,l=new Map;return bu(()=>{var _;var c=wo();i=c.promise;try{Promise.resolve(n()).then(c.resolve,c.reject).then(()=>{u===Ae&&u.committed&&u.deactivate(),Hi()})}catch(m){c.reject(m),Hi()}var u=Ae;if(a){var d=!r.is_pending();r.update_pending_count(1),u.increment(d),(_=l.get(u))==null||_.reject(vr),l.delete(u),l.set(u,c)}const f=(m,h=void 0)=>{if(u.activate(),h)h!==vr&&(s.f|=Tn,Pr(s,h));else{s.f&Tn&&(s.f^=Tn),Pr(s,m);for(const[g,v]of l){if(l.delete(g),g===u)break;v.reject(vr)}}a&&(r.update_pending_count(-1),u.decrement(d))};c.promise.then(f,m=>f(null,m||"unknown"))}),fs(()=>{for(const c of l.values())c.reject(vr)}),new Promise(c=>{function u(d){function f(){d===i?c(s):u(i)}d.then(f,f)}u(i)})}function Be(n){const e=gi(n);return nl(e),e}function fa(n){const e=gi(n);return e.equals=ko,e}function Fo(n){var e=n.effects;if(e!==null){n.effects=null;for(var t=0;t<e.length;t+=1)tt(e[t])}}function uu(n){for(var e=n.parent;e!==null;){if(!(e.f&vt))return e;e=e.parent}return null}function va(n){var e,t=fe;Vt(uu(n));try{n.f&=~$i,Fo(n),e=al(n)}finally{Vt(t)}return e}function Bo(n){var e=va(n);if(n.equals(e)||(n.v=e,n.wv=il()),!lr)if(st!==null)st.set(n,n.v);else{var t=(Pn||n.f&Ft)&&n.deps!==null?an:at;ot(n,t)}}let Xs=new Set;const Ln=new Map;let Vo=!1;function An(n,e){var t={f:0,v:n,reactions:null,equals:xo,rv:0,wv:0};return t}function V(n,e){const t=An(n);return nl(t),t}function Go(n,e=!1,t=!0){var i;const r=An(n);return e||(r.equals=ko),Fr&&t&&je!==null&&je.l!==null&&((i=je.l).s??(i.s=[])).push(r),r}function S(n,e,t=!1){he!==null&&(!Ht||he.f&Ra)&&pi()&&he.f&(vt|wn|da|Ra)&&!(mt!=null&&mt.includes(n))&&Rc();let r=t?be(e):e;return Pr(n,r)}function Pr(n,e){if(!n.equals(e)){var t=n.v;lr?Ln.set(n,e):Ln.set(n,t),n.v=e;var r=pn.ensure();r.capture(n,t),n.f&vt&&(n.f&It&&va(n),ot(n,n.f&Ft?an:at)),n.wv=il(),jo(n,It),pi()&&fe!==null&&fe.f&at&&!(fe.f&(bn|ar))&&(Lt===null?Du([n]):Lt.push(n)),!r.is_fork&&Xs.size>0&&!Vo&&du()}return e}function du(){Vo=!1;const n=Array.from(Xs);for(const e of n)e.f&at&&ot(e,an),Vr(e)&&Tr(e);Xs.clear()}function Pt(n,e=1){var t=o(n),r=e===1?t++:t--;return S(n,t),r}function Jr(n){S(n,n.v+1)}function jo(n,e){var t=n.reactions;if(t!==null)for(var r=pi(),i=t.length,s=0;s<i;s++){var a=t[s],l=a.f;if(!(!r&&a===fe)){var c=(l&It)===0;c&&ot(a,e),l&vt?l&$i||(a.f|=$i,jo(a,an)):c&&(l&wn&&Kt!==null&&Kt.add(a),ir(a))}}}function be(n){if(typeof n!="object"||n===null||mn in n)return n;const e=ca(n);if(e!==Sc&&e!==Dc)return n;var t=new Map,r=oa(n),i=V(0),s=nr,a=l=>{if(nr===s)return l();var c=he,u=nr;Ct(null),Ka(s);var d=l();return Ct(c),Ka(u),d};return r&&t.set("length",V(n.length)),new Proxy(n,{defineProperty(l,c,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&Ac();var d=t.get(c);return d===void 0?d=a(()=>{var f=V(u.value);return t.set(c,f),f}):S(d,u.value,!0),!0},deleteProperty(l,c){var u=t.get(c);if(u===void 0){if(c in l){const d=a(()=>V(it));t.set(c,d),Jr(i)}}else S(u,it),Jr(i);return!0},get(l,c,u){var m;if(c===mn)return n;var d=t.get(c),f=c in l;if(d===void 0&&(!f||(m=hr(l,c))!=null&&m.writable)&&(d=a(()=>{var h=be(f?l[c]:it),g=V(h);return g}),t.set(c,d)),d!==void 0){var _=o(d);return _===it?void 0:_}return Reflect.get(l,c,u)},getOwnPropertyDescriptor(l,c){var u=Reflect.getOwnPropertyDescriptor(l,c);if(u&&"value"in u){var d=t.get(c);d&&(u.value=o(d))}else if(u===void 0){var f=t.get(c),_=f==null?void 0:f.v;if(f!==void 0&&_!==it)return{enumerable:!0,configurable:!0,value:_,writable:!0}}return u},has(l,c){var _;if(c===mn)return!0;var u=t.get(c),d=u!==void 0&&u.v!==it||Reflect.has(l,c);if(u!==void 0||fe!==null&&(!d||(_=hr(l,c))!=null&&_.writable)){u===void 0&&(u=a(()=>{var m=d?be(l[c]):it,h=V(m);return h}),t.set(c,u));var f=o(u);if(f===it)return!1}return d},set(l,c,u,d){var k;var f=t.get(c),_=c in l;if(r&&c==="length")for(var m=u;m<f.v;m+=1){var h=t.get(m+"");h!==void 0?S(h,it):m in l&&(h=a(()=>V(it)),t.set(m+"",h))}if(f===void 0)(!_||(k=hr(l,c))!=null&&k.writable)&&(f=a(()=>V(void 0)),S(f,be(u)),t.set(c,f));else{_=f.v!==it;var g=a(()=>be(u));S(f,g)}var v=Reflect.getOwnPropertyDescriptor(l,c);if(v!=null&&v.set&&v.set.call(d,u),!_){if(r&&typeof c=="string"){var D=t.get("length"),T=Number(c);Number.isInteger(T)&&T>=D.v&&S(D,T+1)}Jr(i)}return!0},ownKeys(l){o(i);var c=Reflect.ownKeys(l).filter(f=>{var _=t.get(f);return _===void 0||_.v!==it});for(var[u,d]of t)d.v!==it&&!(u in l)&&c.push(u);return c},setPrototypeOf(){Oc()}})}function Fa(n){try{if(n!==null&&typeof n=="object"&&mn in n)return n[mn]}catch{}return n}function Ko(n,e){return Object.is(Fa(n),Fa(e))}var Ba,Uo,$o,Ho;function fu(){if(Ba===void 0){Ba=window,Uo=/Firefox/.test(navigator.userAgent);var n=Element.prototype,e=Node.prototype,t=Text.prototype;$o=hr(e,"firstChild").get,Ho=hr(e,"nextSibling").get,Oa(n)&&(n.__click=void 0,n.__className=void 0,n.__attributes=null,n.__style=void 0,n.__e=void 0),Oa(t)&&(t.__t=void 0)}}function On(n=""){return document.createTextNode(n)}function tn(n){return $o.call(n)}function _i(n){return Ho.call(n)}function y(n,e){return tn(n)}function et(n,e=!1){{var t=tn(n);return t instanceof Comment&&t.data===""?_i(t):t}}function w(n,e=1,t=!1){let r=n;for(;e--;)r=_i(r);return r}function vu(n){n.textContent=""}function zo(){return!1}function ha(n,e){if(e){const t=document.body;n.autofocus=!0,yn(()=>{document.activeElement===t&&n.focus()})}}let Va=!1;function hu(){Va||(Va=!0,document.addEventListener("reset",n=>{Promise.resolve().then(()=>{var e;if(!n.defaultPrevented)for(const t of n.target.elements)(e=t.__on_r)==null||e.call(t)})},{capture:!0}))}function us(n){var e=he,t=fe;Ct(null),Vt(null);try{return n()}finally{Ct(e),Vt(t)}}function ds(n,e,t,r=t){n.addEventListener(e,()=>us(t));const i=n.__on_r;i?n.__on_r=()=>{i(),r(!0)}:n.__on_r=()=>r(!0),hu()}function qo(n){fe===null&&he===null&&Pc(),he!==null&&he.f&Ft&&fe===null&&Mc(),lr&&kc()}function pu(n,e){var t=e.last;t===null?e.last=e.first=n:(t.next=n,n.prev=t,e.last=n)}function on(n,e,t,r=!0){var i=fe;i!==null&&i.f&Tt&&(n|=Tt);var s={ctx:je,deps:null,nodes_start:null,nodes_end:null,f:n|It,first:null,fn:e,last:null,next:null,parent:i,b:i&&i.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(t)try{Tr(s),s.f|=ua}catch(c){throw tt(s),c}else e!==null&&ir(s);if(r){var a=s;if(t&&a.deps===null&&a.teardown===null&&a.nodes_start===null&&a.first===a.last&&!(a.f&Nr)&&(a=a.first,n&wn&&n&rr&&a!==null&&(a.f|=rr)),a!==null&&(a.parent=i,i!==null&&pu(a,i),he!==null&&he.f&vt&&!(n&ar))){var l=he;(l.effects??(l.effects=[])).push(a)}}return s}function gu(){return he!==null&&!Ht}function fs(n){const e=on(ss,null,!1);return ot(e,at),e.teardown=n,e}function nn(n){qo();var e=fe.f,t=!he&&(e&bn)!==0&&(e&ua)===0;if(t){var r=je;(r.e??(r.e=[])).push(n)}else return Wo(n)}function Wo(n){return on(is|Do,n,!1)}function _u(n){return qo(),on(ss|Do,n,!0)}function mu(n){pn.ensure();const e=on(ar|Nr,n,!0);return(t={})=>new Promise(r=>{t.outro?pr(e,()=>{tt(e),r(void 0)}):(tt(e),r(void 0))})}function mi(n){return on(is,n,!1)}function yu(n,e){var t=je,r={effect:null,ran:!1,deps:n};t.l.$.push(r),r.effect=or(()=>{n(),!r.ran&&(r.ran=!0,ln(e))})}function wu(){var n=je;or(()=>{for(var e of n.l.$){e.deps();var t=e.effect;t.f&at&&ot(t,an),Vr(t)&&Tr(t),e.ran=!1}})}function bu(n){return on(da|Nr,n,!0)}function or(n,e=0){return on(ss|e,n,!0)}function ie(n,e=[],t=[],r=[],i=!1){No(r,e,t,s=>{on(i?is:ss,()=>n(...s.map(o)),!0)})}function Br(n,e=0){var t=on(wn|e,n,!0);return t}function Mt(n,e=!0){return on(bn|Nr,n,!0,e)}function Yo(n){var e=n.teardown;if(e!==null){const t=lr,r=he;ja(!0),Ct(null);try{e.call(null)}finally{ja(t),Ct(r)}}}function Xo(n,e=!1){var t=n.first;for(n.first=n.last=null;t!==null;){const i=t.ac;i!==null&&us(()=>{i.abort(vr)});var r=t.next;t.f&ar?t.parent=null:tt(t,e),t=r}}function Su(n){for(var e=n.first;e!==null;){var t=e.next;e.f&bn||tt(e),e=t}}function tt(n,e=!0){var t=!1;(e||n.f&So)&&n.nodes_start!==null&&n.nodes_end!==null&&(Jo(n.nodes_start,n.nodes_end),t=!0),Xo(n,e&&!t),zi(n,0),ot(n,_n);var r=n.transitions;if(r!==null)for(const s of r)s.stop();Yo(n);var i=n.parent;i!==null&&i.first!==null&&Zo(n),n.next=n.prev=n.teardown=n.ctx=n.deps=n.fn=n.nodes_start=n.nodes_end=n.ac=null}function Jo(n,e){for(;n!==null;){var t=n===e?null:_i(n);n.remove(),n=t}}function Zo(n){var e=n.parent,t=n.prev,r=n.next;t!==null&&(t.next=r),r!==null&&(r.prev=t),e!==null&&(e.first===n&&(e.first=r),e.last===n&&(e.last=t))}function pr(n,e,t=!0){var r=[];pa(n,r,!0),Qo(r,()=>{t&&tt(n),e&&e()})}function Qo(n,e){var t=n.length;if(t>0){var r=()=>--t||e();for(var i of n)i.out(r)}else e()}function pa(n,e,t){if(!(n.f&Tt)){if(n.f^=Tt,n.transitions!==null)for(const a of n.transitions)(a.is_global||t)&&e.push(a);for(var r=n.first;r!==null;){var i=r.next,s=(r.f&rr)!==0||(r.f&bn)!==0&&(n.f&wn)!==0;pa(r,e,s?t:!1),r=i}}}function ga(n){el(n,!0)}function el(n,e){if(n.f&Tt){n.f^=Tt,n.f&at||(ot(n,It),ir(n));for(var t=n.first;t!==null;){var r=t.next,i=(t.f&rr)!==0||(t.f&bn)!==0;el(t,i?e:!1),t=r}if(n.transitions!==null)for(const s of n.transitions)(s.is_global||e)&&s.in()}}function tl(n,e){for(var t=n.nodes_start,r=n.nodes_end;t!==null;){var i=t===r?null:_i(t);e.append(t),t=i}}let gr=!1;function Ga(n){gr=n}let lr=!1;function ja(n){lr=n}let he=null,Ht=!1;function Ct(n){he=n}let fe=null;function Vt(n){fe=n}let mt=null;function nl(n){he!==null&&(mt===null?mt=[n]:mt.push(n))}let gt=null,xt=0,Lt=null;function Du(n){Lt=n}let rl=1,ei=0,nr=ei;function Ka(n){nr=n}let Pn=!1;function il(){return++rl}function Vr(n){var f;var e=n.f;if(e&It)return!0;if(e&an){var t=n.deps,r=(e&Ft)!==0;if(e&vt&&(n.f&=~$i),t!==null){var i,s,a=(e&Ui)!==0,l=r&&fe!==null&&!Pn,c=t.length;if((a||l)&&(fe===null||!(fe.f&_n))){var u=n,d=u.parent;for(i=0;i<c;i++)s=t[i],(a||!((f=s==null?void 0:s.reactions)!=null&&f.includes(u)))&&(s.reactions??(s.reactions=[])).push(u);a&&(u.f^=Ui),l&&d!==null&&!(d.f&Ft)&&(u.f^=Ft)}for(i=0;i<c;i++)if(s=t[i],Vr(s)&&Bo(s),s.wv>n.wv)return!0}(!r||fe!==null&&!Pn)&&ot(n,at)}return!1}function sl(n,e,t=!0){var r=n.reactions;if(r!==null&&!(mt!=null&&mt.includes(n)))for(var i=0;i<r.length;i++){var s=r[i];s.f&vt?sl(s,e,!1):e===s&&(t?ot(s,It):s.f&at&&ot(s,an),ir(s))}}function al(n){var g;var e=gt,t=xt,r=Lt,i=he,s=Pn,a=mt,l=je,c=Ht,u=nr,d=n.f;gt=null,xt=0,Lt=null,Pn=(d&Ft)!==0&&(Ht||!gr||he===null),he=d&(bn|ar)?null:n,mt=null,kr(n.ctx),Ht=!1,nr=++ei,n.ac!==null&&(us(()=>{n.ac.abort(vr)}),n.ac=null);try{n.f|=Hs;var f=n.fn,_=f(),m=n.deps;if(gt!==null){var h;if(zi(n,xt),m!==null&&xt>0)for(m.length=xt+gt.length,h=0;h<gt.length;h++)m[xt+h]=gt[h];else n.deps=m=gt;if(!Pn||d&vt&&n.reactions!==null)for(h=xt;h<m.length;h++)((g=m[h]).reactions??(g.reactions=[])).push(n)}else m!==null&&xt<m.length&&(zi(n,xt),m.length=xt);if(pi()&&Lt!==null&&!Ht&&m!==null&&!(n.f&(vt|an|It)))for(h=0;h<Lt.length;h++)sl(Lt[h],n);return i!==null&&i!==n&&(ei++,Lt!==null&&(r===null?r=Lt:r.push(...Lt))),n.f&Tn&&(n.f^=Tn),_}catch(v){return Po(v)}finally{n.f^=Hs,gt=e,xt=t,Lt=r,he=i,Pn=s,mt=a,kr(l),Ht=c,nr=u}}function Cu(n,e){let t=e.reactions;if(t!==null){var r=wc.call(t,n);if(r!==-1){var i=t.length-1;i===0?t=e.reactions=null:(t[r]=t[i],t.pop())}}t===null&&e.f&vt&&(gt===null||!gt.includes(e))&&(ot(e,an),e.f&(Ft|Ui)||(e.f^=Ui),Fo(e),zi(e,0))}function zi(n,e){var t=n.deps;if(t!==null)for(var r=e;r<t.length;r++)Cu(n,t[r])}function Tr(n){var e=n.f;if(!(e&_n)){ot(n,at);var t=fe,r=gr;fe=n,gr=!0;try{e&wn?Su(n):Xo(n),Yo(n);var i=al(n);n.teardown=typeof i=="function"?i:null,n.wv=rl;var s;mo&&Jc&&n.f&It&&n.deps}finally{gr=r,fe=t}}}async function Eu(){await Promise.resolve(),eu()}function o(n){var e=n.f,t=(e&vt)!==0;if(he!==null&&!Ht){var r=fe!==null&&(fe.f&_n)!==0;if(!r&&!(mt!=null&&mt.includes(n))){var i=he.deps;if(he.f&Hs)n.rv<ei&&(n.rv=ei,gt===null&&i!==null&&i[xt]===n?xt++:gt===null?gt=[n]:(!Pn||!gt.includes(n))&&gt.push(n));else{(he.deps??(he.deps=[])).push(n);var s=n.reactions;s===null?n.reactions=[he]:s.includes(he)||s.push(he)}}}else if(t&&n.deps===null&&n.effects===null){var a=n,l=a.parent;l!==null&&!(l.f&Ft)&&(a.f^=Ft)}if(lr){if(Ln.has(n))return Ln.get(n);if(t){a=n;var c=a.v;return(!(a.f&at)&&a.reactions!==null||ol(a))&&(c=va(a)),Ln.set(a,c),c}}else if(t){if(a=n,st!=null&&st.has(a))return st.get(a);Vr(a)&&Bo(a)}if(st!=null&&st.has(n))return st.get(n);if(n.f&Tn)throw n.v;return n.v}function ol(n){if(n.v===it)return!0;if(n.deps===null)return!1;for(const e of n.deps)if(Ln.has(e)||e.f&vt&&ol(e))return!0;return!1}function ln(n){var e=Ht;try{return Ht=!0,n()}finally{Ht=e}}const Iu=-7169;function ot(n,e){n.f=n.f&Iu|e}function ll(n){if(!(typeof n!="object"||!n||n instanceof EventTarget)){if(mn in n)Js(n);else if(!Array.isArray(n))for(let e in n){const t=n[e];typeof t=="object"&&t&&mn in t&&Js(t)}}}function Js(n,e=new Set){if(typeof n=="object"&&n!==null&&!(n instanceof EventTarget)&&!e.has(n)){e.add(n),n instanceof Date&&n.getTime();for(let r in n)try{Js(n[r],e)}catch{}const t=ca(n);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const r=yo(t);for(let i in r){const s=r[i].get;if(s)try{s.call(n)}catch{}}}}}function xu(n){return n.endsWith("capture")&&n!=="gotpointercapture"&&n!=="lostpointercapture"}const ku=["beforeinput","click","change","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"];function Mu(n){return ku.includes(n)}const Pu={formnovalidate:"formNoValidate",ismap:"isMap",nomodule:"noModule",playsinline:"playsInline",readonly:"readOnly",defaultvalue:"defaultValue",defaultchecked:"defaultChecked",srcobject:"srcObject",novalidate:"noValidate",allowfullscreen:"allowFullscreen",disablepictureinpicture:"disablePictureInPicture",disableremoteplayback:"disableRemotePlayback"};function Tu(n){return n=n.toLowerCase(),Pu[n]??n}const Lu=["touchstart","touchmove"];function Au(n){return Lu.includes(n)}const cl=new Set,Zs=new Set;function ul(n,e,t,r={}){function i(s){if(r.capture||Wr.call(e,s),!s.cancelBubble)return us(()=>t==null?void 0:t.call(this,s))}return n.startsWith("pointer")||n.startsWith("touch")||n==="wheel"?yn(()=>{e.addEventListener(n,i,r)}):e.addEventListener(n,i,r),i}function _a(n,e,t,r,i){var s={capture:r,passive:i},a=ul(n,e,t,s);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&fs(()=>{e.removeEventListener(n,a,s)})}function bt(n){for(var e=0;e<n.length;e++)cl.add(n[e]);for(var t of Zs)t(n)}let Ua=null;function Wr(n){var v;var e=this,t=e.ownerDocument,r=n.type,i=((v=n.composedPath)==null?void 0:v.call(n))||[],s=i[0]||n.target;Ua=n;var a=0,l=Ua===n&&n.__root;if(l){var c=i.indexOf(l);if(c!==-1&&(e===document||e===window)){n.__root=e;return}var u=i.indexOf(e);if(u===-1)return;c<=u&&(a=c)}if(s=i[a]||n.target,s!==e){bc(n,"currentTarget",{configurable:!0,get(){return s||t}});var d=he,f=fe;Ct(null),Vt(null);try{for(var _,m=[];s!==null;){var h=s.assignedSlot||s.parentNode||s.host||null;try{var g=s["__"+r];g!=null&&(!s.disabled||n.target===s)&&g.call(s,n)}catch(D){_?m.push(D):_=D}if(n.cancelBubble||h===e||h===null)break;s=h}if(_){for(let D of m)queueMicrotask(()=>{throw D});throw _}}finally{n.__root=e,delete n.currentTarget,Ct(d),Vt(f)}}}function ma(n){var e=document.createElement("template");return e.innerHTML=n.replaceAll("<!>","<!---->"),e.content}function Lr(n,e){var t=fe;t.nodes_start===null&&(t.nodes_start=n,t.nodes_end=e)}function B(n,e){var t=(e&Uc)!==0,r=(e&$c)!==0,i,s=!n.startsWith("<!>");return()=>{i===void 0&&(i=ma(s?n:"<!>"+n),t||(i=tn(i)));var a=r||Uo?document.importNode(i,!0):i.cloneNode(!0);if(t){var l=tn(a),c=a.lastChild;Lr(l,c)}else Lr(a,a);return a}}function Ou(n,e,t="svg"){var r=!n.startsWith("<!>"),i=`<${t}>${r?n:"<!>"+n}</${t}>`,s;return()=>{if(!s){var a=ma(i),l=tn(a);s=tn(l)}var c=s.cloneNode(!0);return Lr(c,c),c}}function dl(n,e){return Ou(n,e,"svg")}function Dt(n=""){{var e=On(n+"");return Lr(e,e),e}}function sr(){var n=document.createDocumentFragment(),e=document.createComment(""),t=On();return n.append(e,t),Lr(e,t),n}function P(n,e){n!==null&&n.before(e)}function te(n,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(n.__t??(n.__t=n.nodeValue))&&(n.__t=t,n.nodeValue=t+"")}function Ru(n,e){return Nu(n,e)}const dr=new Map;function Nu(n,{target:e,anchor:t,props:r={},events:i,context:s,intro:a=!0}){fu();var l=new Set,c=f=>{for(var _=0;_<f.length;_++){var m=f[_];if(!l.has(m)){l.add(m);var h=Au(m);e.addEventListener(m,Wr,{passive:h});var g=dr.get(m);g===void 0?(document.addEventListener(m,Wr,{passive:h}),dr.set(m,1)):dr.set(m,g+1)}}};c(la(cl)),Zs.add(c);var u=void 0,d=mu(()=>{var f=t??e.appendChild(On());return iu(f,{pending:()=>{}},_=>{if(s){yt({});var m=je;m.c=s}i&&(r.$$events=i),u=n(_,r)||{},s&&wt()}),()=>{var h;for(var _ of l){e.removeEventListener(_,Wr);var m=dr.get(_);--m===0?(document.removeEventListener(_,Wr),dr.delete(_)):dr.set(_,m)}Zs.delete(c),f!==t&&((h=f.parentNode)==null||h.removeChild(f))}});return Fu.set(u,d),u}let Fu=new WeakMap;var Ut,Zt,kt,ri,ii,Qi;class fl{constructor(e,t=!0){$e(this,"anchor");U(this,Ut,new Map);U(this,Zt,new Map);U(this,kt,new Map);U(this,ri,!0);U(this,ii,()=>{var e=Ae;if(p(this,Ut).has(e)){var t=p(this,Ut).get(e),r=p(this,Zt).get(t);if(r)ga(r);else{var i=p(this,kt).get(t);i&&(p(this,Zt).set(t,i.effect),p(this,kt).delete(t),i.fragment.lastChild.remove(),this.anchor.before(i.fragment),r=i.effect)}for(const[s,a]of p(this,Ut)){if(p(this,Ut).delete(s),s===e)break;const l=p(this,kt).get(a);l&&(tt(l.effect),p(this,kt).delete(a))}for(const[s,a]of p(this,Zt)){if(s===t)continue;const l=()=>{if(Array.from(p(this,Ut).values()).includes(s)){var u=document.createDocumentFragment();tl(a,u),u.append(On()),p(this,kt).set(s,{effect:a,fragment:u})}else tt(a);p(this,Zt).delete(s)};p(this,ri)||!r?pr(a,l,!1):l()}}});U(this,Qi,e=>{p(this,Ut).delete(e);const t=Array.from(p(this,Ut).values());for(const[r,i]of p(this,kt))t.includes(r)||(tt(i.effect),p(this,kt).delete(r))});this.anchor=e,F(this,ri,t)}ensure(e,t){var r=Ae,i=zo();if(t&&!p(this,Zt).has(e)&&!p(this,kt).has(e))if(i){var s=document.createDocumentFragment(),a=On();s.append(a),p(this,kt).set(e,{effect:Mt(()=>t(a)),fragment:s})}else p(this,Zt).set(e,Mt(()=>t(this.anchor)));if(p(this,Ut).set(r,e),i){for(const[l,c]of p(this,Zt))l===e?r.skipped_effects.delete(c):r.skipped_effects.add(c);for(const[l,c]of p(this,kt))l===e?r.skipped_effects.delete(c.effect):r.skipped_effects.add(c.effect);r.oncommit(p(this,ii)),r.ondiscard(p(this,Qi))}else p(this,ii).call(this)}}Ut=new WeakMap,Zt=new WeakMap,kt=new WeakMap,ri=new WeakMap,ii=new WeakMap,Qi=new WeakMap;function Pe(n,e,t=!1){var r=new fl(n),i=t?rr:0;function s(a,l){r.ensure(a,l)}Br(()=>{var a=!1;e((l,c=!0)=>{a=!0,s(c,l)}),a||s(!1,null)},i)}function We(n,e){return e}function Bu(n,e,t){for(var r=n.items,i=[],s=e.length,a=0;a<s;a++)pa(e[a].e,i,!0);var l=s>0&&i.length===0&&t!==null;if(l){var c=t.parentNode;vu(c),c.append(t),r.clear(),Wt(n,e[0].prev,e[s-1].next)}Qo(i,()=>{for(var u=0;u<s;u++){var d=e[u];l||(r.delete(d.k),Wt(n,d.prev,d.next)),tt(d.e,!l)}})}function Ge(n,e,t,r,i,s=null){var a=n,l={flags:e,items:new Map,first:null},c=(e&Eo)!==0;if(c){var u=n;a=u.appendChild(On())}var d=null,f=!1,_=new Map,m=fa(()=>{var D=t();return oa(D)?D:D==null?[]:la(D)}),h,g;function v(){Vu(g,h,l,_,a,i,e,r,t),s!==null&&(h.length===0?d?ga(d):d=Mt(()=>s(a)):d!==null&&pr(d,()=>{d=null}))}Br(()=>{g??(g=fe),h=o(m);var D=h.length;if(!(f&&D===0)){f=D===0;var T,k,A,O;if(zo()){var R=new Set,K=Ae;for(k=0;k<D;k+=1){A=h[k],O=r(A,k);var W=l.items.get(O)??_.get(O);W?e&(os|ls)&&vl(W,A,k,e):(T=hl(null,l,null,null,A,O,k,i,e,t,!0),_.set(O,T)),R.add(O)}for(const[Ce,Se]of l.items)R.has(Ce)||K.skipped_effects.add(Se.e);K.oncommit(v)}else v();o(m)}})}function Vu(n,e,t,r,i,s,a,l,c){var E,I,q,x;var u=(a&Fc)!==0,d=(a&(os|ls))!==0,f=e.length,_=t.items,m=t.first,h=m,g,v=null,D,T=[],k=[],A,O,R,K;if(u)for(K=0;K<f;K+=1)A=e[K],O=l(A,K),R=_.get(O),R!==void 0&&((E=R.a)==null||E.measure(),(D??(D=new Set)).add(R));for(K=0;K<f;K+=1){if(A=e[K],O=l(A,K),R=_.get(O),R===void 0){var W=r.get(O);if(W!==void 0){r.delete(O),_.set(O,W);var Ce=v?v.next:h;Wt(t,v,W),Wt(t,W,Ce),As(W,Ce,i),v=W}else{var Se=h?h.e.nodes_start:i;v=hl(Se,t,v,v===null?t.first:v.next,A,O,K,s,a,c)}_.set(O,v),T=[],k=[],h=v.next;continue}if(d&&vl(R,A,K,a),R.e.f&Tt&&(ga(R.e),u&&((I=R.a)==null||I.unfix(),(D??(D=new Set)).delete(R))),R!==h){if(g!==void 0&&g.has(R)){if(T.length<k.length){var se=k[0],Q;v=se.prev;var ne=T[0],ve=T[T.length-1];for(Q=0;Q<T.length;Q+=1)As(T[Q],se,i);for(Q=0;Q<k.length;Q+=1)g.delete(k[Q]);Wt(t,ne.prev,ve.next),Wt(t,v,ne),Wt(t,ve,se),h=se,v=ve,K-=1,T=[],k=[]}else g.delete(R),As(R,h,i),Wt(t,R.prev,R.next),Wt(t,R,v===null?t.first:v.next),Wt(t,v,R),v=R;continue}for(T=[],k=[];h!==null&&h.k!==O;)h.e.f&Tt||(g??(g=new Set)).add(h),k.push(h),h=h.next;if(h===null)continue;R=h}T.push(R),v=R,h=R.next}if(h!==null||g!==void 0){for(var ae=g===void 0?[]:la(g);h!==null;)h.e.f&Tt||ae.push(h),h=h.next;var we=ae.length;if(we>0){var Ee=a&Eo&&f===0?i:null;if(u){for(K=0;K<we;K+=1)(q=ae[K].a)==null||q.measure();for(K=0;K<we;K+=1)(x=ae[K].a)==null||x.fix()}Bu(t,ae,Ee)}}u&&yn(()=>{var b;if(D!==void 0)for(R of D)(b=R.a)==null||b.apply()}),n.first=t.first&&t.first.e,n.last=v&&v.e;for(var Ie of r.values())tt(Ie.e);r.clear()}function vl(n,e,t,r){r&os&&Pr(n.v,e),r&ls?Pr(n.i,t):n.i=t}function hl(n,e,t,r,i,s,a,l,c,u,d){var f=(c&os)!==0,_=(c&Bc)===0,m=f?_?Go(i,!1,!1):An(i):i,h=c&ls?An(a):a,g={i:h,v:m,k:s,a:null,e:null,prev:t,next:r};try{if(n===null){var v=document.createDocumentFragment();v.append(n=On())}return g.e=Mt(()=>l(n,m,h,u),Yc),g.e.prev=t&&t.e,g.e.next=r&&r.e,t===null?d||(e.first=g):(t.next=g,t.e.next=g.e),r!==null&&(r.prev=g,r.e.prev=g.e),g}finally{}}function As(n,e,t){for(var r=n.next?n.next.e.nodes_start:t,i=e?e.e.nodes_start:t,s=n.e.nodes_start;s!==null&&s!==r;){var a=_i(s);i.before(s),s=a}}function Wt(n,e,t){e===null?n.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function pl(n,e,t=!1,r=!1,i=!1){var s=n,a="";ie(()=>{var l=fe;if(a!==(a=e()??"")&&(l.nodes_start!==null&&(Jo(l.nodes_start,l.nodes_end),l.nodes_start=l.nodes_end=null),a!=="")){var c=a+"";t?c=`<svg>${c}</svg>`:r&&(c=`<math>${c}</math>`);var u=ma(c);if((t||r)&&(u=tn(u)),Lr(tn(u),u.lastChild),t||r)for(;tn(u);)s.before(tn(u));else s.before(u)}})}function gl(n,e,...t){var r=new fl(n);Br(()=>{const i=e()??null;r.ensure(i,i&&(s=>i(s,...t)))},rr)}function Gu(n,e){var t=void 0,r;Br(()=>{t!==(t=e())&&(r&&(tt(r),r=null),t&&(r=Mt(()=>{mi(()=>t(n))})))})}function _l(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var i=n.length;for(e=0;e<i;e++)n[e]&&(t=_l(n[e]))&&(r&&(r+=" "),r+=t)}else for(t in n)n[t]&&(r&&(r+=" "),r+=t);return r}function ju(){for(var n,e,t=0,r="",i=arguments.length;t<i;t++)(n=arguments[t])&&(e=_l(n))&&(r&&(r+=" "),r+=e);return r}function Ku(n){return typeof n=="object"?ju(n):n??""}const $a=[...` 	
\r\fÂ \v\uFEFF`];function Uu(n,e,t){var r=n==null?"":""+n;if(e&&(r=r?r+" "+e:e),t){for(var i in t)if(t[i])r=r?r+" "+i:i;else if(r.length)for(var s=i.length,a=0;(a=r.indexOf(i,a))>=0;){var l=a+s;(a===0||$a.includes(r[a-1]))&&(l===r.length||$a.includes(r[l]))?r=(a===0?"":r.substring(0,a))+r.substring(l+1):a=l}}return r===""?null:r}function Ha(n,e=!1){var t=e?" !important;":";",r="";for(var i in n){var s=n[i];s!=null&&s!==""&&(r+=" "+i+": "+s+t)}return r}function Os(n){return n[0]!=="-"||n[1]!=="-"?n.toLowerCase():n}function $u(n,e){if(e){var t="",r,i;if(Array.isArray(e)?(r=e[0],i=e[1]):r=e,n){n=String(n).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var s=!1,a=0,l=!1,c=[];r&&c.push(...Object.keys(r).map(Os)),i&&c.push(...Object.keys(i).map(Os));var u=0,d=-1;const g=n.length;for(var f=0;f<g;f++){var _=n[f];if(l?_==="/"&&n[f-1]==="*"&&(l=!1):s?s===_&&(s=!1):_==="/"&&n[f+1]==="*"?l=!0:_==='"'||_==="'"?s=_:_==="("?a++:_===")"&&a--,!l&&s===!1&&a===0){if(_===":"&&d===-1)d=f;else if(_===";"||f===g-1){if(d!==-1){var m=Os(n.substring(u,d).trim());if(!c.includes(m)){_!==";"&&f++;var h=n.substring(u,f).trim();t+=" "+h+";"}}u=f+1,d=-1}}}}return r&&(t+=Ha(r)),i&&(t+=Ha(i,!0)),t=t.trim(),t===""?null:t}return n==null?null:String(n)}function Ze(n,e,t,r,i,s){var a=n.__className;if(a!==t||a===void 0){var l=Uu(t,r,s);l==null?n.removeAttribute("class"):e?n.className=l:n.setAttribute("class",l),n.__className=t}else if(s&&i!==s)for(var c in s){var u=!!s[c];(i==null||u!==!!i[c])&&n.classList.toggle(c,u)}return s}function Rs(n,e={},t,r){for(var i in t){var s=t[i];e[i]!==s&&(t[i]==null?n.style.removeProperty(i):n.style.setProperty(i,s,r))}}function Je(n,e,t,r){var i=n.__style;if(i!==e){var s=$u(e,r);s==null?n.removeAttribute("style"):n.style.cssText=s,n.__style=e}else r&&(Array.isArray(r)?(Rs(n,t==null?void 0:t[0],r[0]),Rs(n,t==null?void 0:t[1],r[1],"important")):Rs(n,t,r));return r}function qi(n,e,t=!1){if(n.multiple){if(e==null)return;if(!oa(e))return qc();for(var r of n.options)r.selected=e.includes(Zr(r));return}for(r of n.options){var i=Zr(r);if(Ko(i,e)){r.selected=!0;return}}(!t||e!==void 0)&&(n.selectedIndex=-1)}function ml(n){var e=new MutationObserver(()=>{qi(n,n.__value)});e.observe(n,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),fs(()=>{e.disconnect()})}function hn(n,e,t=e){var r=new WeakSet,i=!0;ds(n,"change",s=>{var a=s?"[selected]":":checked",l;if(n.multiple)l=[].map.call(n.querySelectorAll(a),Zr);else{var c=n.querySelector(a)??n.querySelector("option:not([disabled])");l=c&&Zr(c)}t(l),Ae!==null&&r.add(Ae)}),mi(()=>{var s=e();if(n===document.activeElement){var a=Yr??Ae;if(r.has(a))return}if(qi(n,s,i),i&&s===void 0){var l=n.querySelector(":checked");l!==null&&(s=Zr(l),t(s))}n.__value=s,i=!1}),ml(n)}function Zr(n){return"__value"in n?n.__value:n.value}const Ur=Symbol("class"),$r=Symbol("style"),yl=Symbol("is custom element"),wl=Symbol("is html");function fr(n,e){var t=ya(n);t.value===(t.value=e??void 0)||n.value===e&&(e!==0||n.nodeName!=="PROGRESS")||(n.value=e??"")}function Hu(n,e){e?n.hasAttribute("selected")||n.setAttribute("selected",""):n.removeAttribute("selected")}function Bt(n,e,t,r){var i=ya(n);i[e]!==(i[e]=t)&&(e==="loading"&&(n[Ic]=t),t==null?n.removeAttribute(e):typeof t!="string"&&bl(n).includes(e)?n[e]=t:n.setAttribute(e,t))}function zu(n,e,t,r,i=!1,s=!1){var a=ya(n),l=a[yl],c=!a[wl],u=e||{},d=n.tagName==="OPTION";for(var f in e)f in t||(t[f]=null);t.class?t.class=Ku(t.class):t[Ur]&&(t.class=null),t[$r]&&(t.style??(t.style=null));var _=bl(n);for(const A in t){let O=t[A];if(d&&A==="value"&&O==null){n.value=n.__value="",u[A]=O;continue}if(A==="class"){var m=n.namespaceURI==="http://www.w3.org/1999/xhtml";Ze(n,m,O,r,e==null?void 0:e[Ur],t[Ur]),u[A]=O,u[Ur]=t[Ur];continue}if(A==="style"){Je(n,O,e==null?void 0:e[$r],t[$r]),u[A]=O,u[$r]=t[$r];continue}var h=u[A];if(!(O===h&&!(O===void 0&&n.hasAttribute(A)))){u[A]=O;var g=A[0]+A[1];if(g!=="$$")if(g==="on"){const R={},K="$$"+A;let W=A.slice(2);var v=Mu(W);if(xu(W)&&(W=W.slice(0,-7),R.capture=!0),!v&&h){if(O!=null)continue;n.removeEventListener(W,u[K],R),u[K]=null}if(O!=null)if(v)n[`__${W}`]=O,bt([W]);else{let Ce=function(Se){u[A].call(this,Se)};var k=Ce;u[K]=ul(W,n,Ce,R)}else v&&(n[`__${W}`]=void 0)}else if(A==="style")Bt(n,A,O);else if(A==="autofocus")ha(n,!!O);else if(!l&&(A==="__value"||A==="value"&&O!=null))n.value=n.__value=O;else if(A==="selected"&&d)Hu(n,O);else{var D=A;c||(D=Tu(D));var T=D==="defaultValue"||D==="defaultChecked";if(O==null&&!l&&!T)if(a[A]=null,D==="value"||D==="checked"){let R=n;const K=e===void 0;if(D==="value"){let W=R.defaultValue;R.removeAttribute(D),R.defaultValue=W,R.value=R.__value=K?W:null}else{let W=R.defaultChecked;R.removeAttribute(D),R.defaultChecked=W,R.checked=K?W:!1}}else n.removeAttribute(A);else T||_.includes(D)&&(l||typeof O!="string")?(n[D]=O,D in a&&(a[D]=it)):typeof O!="function"&&Bt(n,D,O)}}}return u}function qu(n,e,t=[],r=[],i=[],s,a=!1,l=!1){No(i,t,r,c=>{var u=void 0,d={},f=n.nodeName==="SELECT",_=!1;if(Br(()=>{var h=e(...c.map(o)),g=zu(n,u,h,s,a,l);_&&f&&"value"in h&&qi(n,h.value);for(let D of Object.getOwnPropertySymbols(d))h[D]||tt(d[D]);for(let D of Object.getOwnPropertySymbols(h)){var v=h[D];D.description===zc&&(!u||v!==u[D])&&(d[D]&&tt(d[D]),d[D]=Mt(()=>Gu(n,()=>v))),g[D]=v}u=g}),f){var m=n;mi(()=>{qi(m,u.value,!0),ml(m)})}_=!0})}function ya(n){return n.__attributes??(n.__attributes={[yl]:n.nodeName.includes("-"),[wl]:n.namespaceURI===Hc})}var za=new Map;function bl(n){var e=n.getAttribute("is")||n.nodeName,t=za.get(e);if(t)return t;za.set(e,t=[]);for(var r,i=n,s=Element.prototype;s!==i;){r=yo(i);for(var a in r)r[a].set&&t.push(a);i=ca(i)}return t}function Ar(n,e,t=e){var r=new WeakSet;ds(n,"input",async i=>{var s=i?n.defaultValue:n.value;if(s=Fs(n)?Bs(s):s,t(s),Ae!==null&&r.add(Ae),await Eu(),s!==(s=e())){var a=n.selectionStart,l=n.selectionEnd,c=n.value.length;if(n.value=s??"",l!==null){var u=n.value.length;a===l&&l===c&&u>c?(n.selectionStart=u,n.selectionEnd=u):(n.selectionStart=a,n.selectionEnd=Math.min(l,u))}}}),ln(e)==null&&n.value&&(t(Fs(n)?Bs(n.value):n.value),Ae!==null&&r.add(Ae)),or(()=>{var i=e();if(n===document.activeElement){var s=Yr??Ae;if(r.has(s))return}Fs(n)&&i===Bs(n.value)||n.type==="date"&&!i&&!n.value||i!==n.value&&(n.value=i??"")})}const Ns=new Set;function Un(n,e,t,r,i=r){var s=t.getAttribute("type")==="checkbox",a=n;if(e!==null)for(var l of e)a=a[l]??(a[l]=[]);a.push(t),ds(t,"change",()=>{var c=t.__value;s&&(c=Wu(a,c,t.checked)),i(c)},()=>i(s?[]:null)),or(()=>{var c=r();s?(c=c||[],t.checked=c.includes(t.__value)):t.checked=Ko(t.__value,c)}),fs(()=>{var c=a.indexOf(t);c!==-1&&a.splice(c,1)}),Ns.has(a)||(Ns.add(a),yn(()=>{a.sort((c,u)=>c.compareDocumentPosition(u)===4?-1:1),Ns.delete(a)})),yn(()=>{})}function Sl(n,e,t=e){ds(n,"change",r=>{var i=r?n.defaultChecked:n.checked;t(i)}),ln(e)==null&&t(n.checked),or(()=>{var r=e();n.checked=!!r})}function Wu(n,e,t){for(var r=new Set,i=0;i<n.length;i+=1)n[i].checked&&r.add(n[i].__value);return t||r.delete(e),Array.from(r)}function Fs(n){var e=n.type;return e==="number"||e==="range"}function Bs(n){return n===""?null:+n}var kn,br,si,es,Dl;const ts=class ts{constructor(e){U(this,es);U(this,kn,new WeakMap);U(this,br);U(this,si);F(this,si,e)}observe(e,t){var r=p(this,kn).get(e)||new Set;return r.add(t),p(this,kn).set(e,r),Fe(this,es,Dl).call(this).observe(e,p(this,si)),()=>{var i=p(this,kn).get(e);i.delete(t),i.size===0&&(p(this,kn).delete(e),p(this,br).unobserve(e))}}};kn=new WeakMap,br=new WeakMap,si=new WeakMap,es=new WeakSet,Dl=function(){return p(this,br)??F(this,br,new ResizeObserver(e=>{for(var t of e){ts.entries.set(t.target,t);for(var r of p(this,kn).get(t.target)||[])r(t)}}))},$e(ts,"entries",new WeakMap);let Qs=ts;var Yu=new Qs({box:"border-box"});function Xu(n,e,t){var r=Yu.observe(n,()=>t(n[e]));mi(()=>(ln(()=>t(n[e])),r))}function qa(n,e){return n===e||(n==null?void 0:n[mn])===e}function rn(n={},e,t,r){return mi(()=>{var i,s;return or(()=>{i=s,s=[],ln(()=>{n!==t(...s)&&(e(n,...s),i&&qa(t(...i),n)&&e(null,...i))})}),()=>{yn(()=>{s&&qa(t(...s),n)&&e(null,...s)})}}),n}function Ju(n=!1){const e=je,t=e.l.u;if(!t)return;let r=()=>ll(e.s);if(n){let i=0,s={};const a=gi(()=>{let l=!1;const c=e.s;for(const u in c)c[u]!==s[u]&&(s[u]=c[u],l=!0);return l&&i++,i});r=()=>o(a)}t.b.length&&_u(()=>{Wa(e,r),$s(t.b)}),nn(()=>{const i=ln(()=>t.m.map(Cc));return()=>{for(const s of i)typeof s=="function"&&s()}}),t.a.length&&nn(()=>{Wa(e,r),$s(t.a)})}function Wa(n,e){if(n.l.s)for(const t of n.l.s)o(t);e()}let xi=!1;function Zu(n){var e=xi;try{return xi=!1,[n(),xi]}finally{xi=e}}const Qu={get(n,e){if(!n.exclude.includes(e))return o(n.version),e in n.special?n.special[e]():n.props[e]},set(n,e,t){if(!(e in n.special)){var r=fe;try{Vt(n.parent_effect),n.special[e]=de({get[e](){return n.props[e]}},e,Io)}finally{Vt(r)}}return n.special[e](t),Pt(n.version),!0},getOwnPropertyDescriptor(n,e){if(!n.exclude.includes(e)&&e in n.props)return{enumerable:!0,configurable:!0,value:n.props[e]}},deleteProperty(n,e){return n.exclude.includes(e)||(n.exclude.push(e),Pt(n.version)),!0},has(n,e){return n.exclude.includes(e)?!1:e in n.props},ownKeys(n){return Reflect.ownKeys(n.props).filter(e=>!n.exclude.includes(e))}};function Ya(n,e){return new Proxy({props:n,exclude:e,special:{},version:An(0),parent_effect:fe},Qu)}function de(n,e,t,r){var k;var i=!Fr||(t&Gc)!==0,s=(t&jc)!==0,a=(t&Kc)!==0,l=r,c=!0,u=()=>(c&&(c=!1,l=a?ln(r):r),l),d;if(s){var f=mn in n||Ec in n;d=((k=hr(n,e))==null?void 0:k.set)??(f&&e in n?A=>n[e]=A:void 0)}var _,m=!1;s?[_,m]=Zu(()=>n[e]):_=n[e],_===void 0&&r!==void 0&&(_=u(),d&&(i&&Lc(),d(_)));var h;if(i?h=()=>{var A=n[e];return A===void 0?u():(c=!0,A)}:h=()=>{var A=n[e];return A!==void 0&&(l=void 0),A===void 0?l:A},i&&!(t&Io))return h;if(d){var g=n.$$legacy;return function(A,O){return arguments.length>0?((!i||!O||g||m)&&d(O?h():A),A):h()}}var v=!1,D=(t&Vc?gi:fa)(()=>(v=!1,h()));s&&o(D);var T=fe;return function(A,O){if(arguments.length>0){const R=O?o(D):i&&s?be(A):A;return S(D,R),v=!0,l!==void 0&&(l=R),A}return lr&&v||T.f&_n?D.v:o(D)}}function Gr(n){je===null&&Co(),Fr&&je.l!==null?ed(je).m.push(n):nn(()=>{const e=ln(n);if(typeof e=="function")return e})}function vs(n){je===null&&Co(),Gr(()=>()=>ln(n))}function ed(n){var e=n.l;return e.u??(e.u={a:[],b:[],m:[]})}const td="5";var _o;typeof window<"u"&&((_o=window.__svelte??(window.__svelte={})).v??(_o.v=new Set)).add(td);const nd=0,rd=126,id=231,sd=6;class ad{constructor(){this.universe=new Uint8Array(512).fill(0),this.device=null,this.interval=null,this.updateRate=1e3/60,this.connected=!1}async connect(){if(!("usb"in navigator))throw new Error("WebUSB is not supported in this browser");try{return this.device=await navigator.usb.requestDevice({filters:[{vendorId:1027}]}),await this.device.open(),await this.device.claimInterface(0),await this.device.controlTransferOut({requestType:"class",recipient:"interface",request:34,value:1,index:0}),this.connected=!0,this.interval=setInterval(()=>{this.sendUniverse()},this.updateRate),!0}catch(e){throw console.error("Failed to connect:",e),e}}disconnect(){this.interval&&(clearInterval(this.interval),this.interval=null),this.device&&(this.device.close(),this.device=null),this.connected=!1}setChannel(e,t){e>=0&&e<512&&(this.universe[e]=Math.max(0,Math.min(255,t)))}getChannel(e){return this.universe[e]||0}setChannels(e,t){t.forEach((r,i)=>{this.setChannel(e+i,r)})}getUniverse(){return this.universe}clearUniverse(){this.universe.fill(0)}sendUniverse(){if(!this.device||!this.connected)return;const e=Uint8Array.from([nd,...this.universe]),t=Uint8Array.from([rd,sd,e.length&255,e.length>>8&255,...e,id]);this.device.transferOut(2,t).catch(r=>{console.error("Failed to send DMX data:",r)})}}const Qe={RGB:{name:"RGB Light",channels:3,controls:[{name:"Red",type:"slider",color:"#b83838"},{name:"Green",type:"slider",color:"#4a964a"},{name:"Blue",type:"slider",color:"#365fb4"}]},RGBA:{name:"RGBA Light",channels:4,controls:[{name:"Red",type:"slider",color:"#b83838"},{name:"Green",type:"slider",color:"#4a964a"},{name:"Blue",type:"slider",color:"#365fb4"},{name:"Amber",type:"slider",color:"#a68522"}]},RGBW:{name:"RGBW Light",channels:4,controls:[{name:"Red",type:"slider",color:"#b83838"},{name:"Green",type:"slider",color:"#4a964a"},{name:"Blue",type:"slider",color:"#365fb4"},{name:"White",type:"slider",color:"#808080"}]},DIMMER:{name:"Dimmer",channels:1,controls:[{name:"Intensity",type:"slider",color:"#888888"}]},SMOKE:{name:"Smoke Machine",channels:1,controls:[{name:"Output",type:"slider",color:"#666666"}]},MOVING_HEAD:{name:"Moving Head (Basic)",channels:7,controls:[{name:"Pan/Tilt",type:"xypad",panIndex:0,tiltIndex:1},{name:"Dimmer",type:"slider",color:"#888888"},{name:"Red",type:"slider",color:"#b83838"},{name:"Green",type:"slider",color:"#4a964a"},{name:"Blue",type:"slider",color:"#365fb4"},{name:"White",type:"slider",color:"#808080"}]},FLAMETHROWER:{name:"Flamethrower",channels:2,controls:[{name:"Safety",type:"toggle",offValue:0,onValue:125},{name:"Fuel",type:"slider",color:"#ff5722"}]}};class Hr{constructor(e,t,r,i="",s=null,a=null){this.id=e,this.type=t,this.startChannel=r,this.name=i||`${Qe[t].name} ${e}`,this.defaultValues=new Array(Qe[t].channels).fill(0),this.linkedTo=s,this.cssId=a||this.generateCssId(this.name)}generateCssId(e){return e.toLowerCase().replace(/[^a-z0-9]/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,"")}updateCssId(){this.cssId=this.generateCssId(this.name)}setValue(e,t){this.defaultValues[e]=Math.max(0,Math.min(255,t))}getValue(e){return this.defaultValues[e]}getChannelValues(){return this.defaultValues}isLinked(){return this.linkedTo!==null}}function gn(n,e){if(!e||e.length===0)return"#000000";switch(n){case"RGB":{const[t,r,i]=e;return`rgb(${t}, ${r}, ${i})`}case"RGBA":{const[t,r,i,s]=e,a=255,l=191,c=0,u=Math.min(255,t+a*s/255),d=Math.min(255,r+l*s/255),f=Math.min(255,i+c*s/255);return`rgb(${Math.round(u)}, ${Math.round(d)}, ${Math.round(f)})`}case"RGBW":{const[t,r,i,s]=e,a=Math.min(255,t+s),l=Math.min(255,r+s),c=Math.min(255,i+s);return`rgb(${Math.round(a)}, ${Math.round(l)}, ${Math.round(c)})`}case"MOVING_HEAD":{const t=e[2]||0,r=e[3]||0,i=e[4]||0,s=e[5]||0,a=e[6]||0;let l=Math.min(255,r+a),c=Math.min(255,i+a),u=Math.min(255,s+a);return l=Math.round(l*t/255),c=Math.round(c*t/255),u=Math.round(u*t/255),`rgb(${l}, ${c}, ${u})`}case"DIMMER":{const t=e[0]||0;return`rgb(${t}, ${t}, ${t})`}case"SMOKE":{const t=e[0]||0,r=Math.round(t*.7);return`rgb(${Math.round(t*.5)}, ${Math.round(t*.5)}, ${r})`}default:return"#000000"}}class od{constructor(e=0,t="RGB",r=[0,0,0]){this.time=e,this.deviceType=t,this.values=[...r]}getProperties(){const e=gn(this.deviceType,this.values);if(this.deviceType==="MOVING_HEAD"){const t=this.values[0]||0,r=this.values[1]||0,i=t/255*100-50,s=r/255*100-50;return{color:e,transform:`translate(${i}%, ${s}%)`}}return{color:e}}toCSS(){const e=this.getProperties(),t=Object.entries(e).map(([i,s])=>`${i}: ${s}`).join("; ");return`${Math.round(this.time*100)}% { ${t}; }`}}class hs{constructor(e="animation",t="RGB",r=[]){this.name=e,this.deviceType=t,this.keyframes=r}addKeyframe(e,t){const r=new od(e,this.deviceType,t);return this.keyframes=[...this.keyframes,r].sort((i,s)=>i.time-s.time),r}removeKeyframe(e){const t=this.keyframes.indexOf(e);t!==-1&&this.keyframes.splice(t,1)}toCSS(){if(this.keyframes.length===0)return"";const e=this.keyframes.map(t=>t.toCSS()).join(`
  `);return`@keyframes ${this.name} {
  ${e}
}`}getKeyframeColor(e){return gn(this.deviceType,e.values)}getGradientSegments(e=1e3){if(this.keyframes.length===0)return[{left:0,width:e,gradient:"#000000"}];const t=[],r=[...this.keyframes].sort((s,a)=>s.time-a.time);if(r[0].time>0){const s=this.getKeyframeColor(r[0]);t.push({left:0,width:r[0].time*e,gradient:`linear-gradient(to right, #000000, ${s})`})}for(let s=0;s<r.length-1;s++){const a=r[s],l=r[s+1],c=this.getKeyframeColor(a),u=this.getKeyframeColor(l);t.push({left:a.time*e,width:(l.time-a.time)*e,gradient:`linear-gradient(to right, ${c}, ${u})`})}const i=r[r.length-1];if(i.time<1){const s=this.getKeyframeColor(i);t.push({left:i.time*e,width:(1-i.time)*e,gradient:`linear-gradient(to right, ${s}, #000000)`})}return t}toJSON(){return{name:this.name,deviceType:this.deviceType,keyframes:this.keyframes.map(e=>({time:e.time,deviceType:e.deviceType,values:e.values}))}}static fromJSON(e){const t=e.deviceType||"RGB",r=new hs(e.name,t);for(const i of e.keyframes)if(i.values)r.addKeyframe(i.time,i.values);else if(i.properties){const s=new Array(r.deviceType==="RGB"?3:4).fill(0);r.addKeyframe(i.time,s)}return r}}class ld{constructor(){this.animations=new Map,this.listeners=new Map,this.load()}on(e,t){this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e).add(t)}off(e,t){this.listeners.has(e)&&this.listeners.get(e).delete(t)}_emit(e,t){if(!this.listeners.has(e))return;const r=this.listeners.get(e);for(const i of r)i(t)}add(e){this.animations.set(e.name,e),this.save(),this._emit("changed",{type:"add",animation:e})}remove(e){const t=this.animations.get(e);this.animations.delete(e),this.save(),this._emit("changed",{type:"remove",animation:t,name:e})}get(e){return this.animations.get(e)}getAll(){return Array.from(this.animations.values())}has(e){return this.animations.has(e)}rename(e,t){const r=this.animations.get(e);return r?(r.name=t,this.animations.delete(e),this.animations.set(t,r),this.save(),!0):!1}toCSS(){return this.getAll().map(e=>e.toCSS()).filter(e=>e).join(`

`)}save(){const e=this.getAll().map(t=>t.toJSON());localStorage.setItem("dmx-animations",JSON.stringify(e))}load(){const e=localStorage.getItem("dmx-animations");if(e)try{const t=JSON.parse(e);for(const r of t){const i=hs.fromJSON(r);this.animations.set(i.name,i)}}catch(t){console.error("Failed to load animations:",t)}}clear(){this.animations.clear(),this.save()}}class yi{constructor(e={}){this.id=e.id||`mapping-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,this.name=e.name||"Untitled Mapping",this.mode=e.mode||"trigger",this.inputDeviceId=e.inputDeviceId||null,this.inputControlId=e.inputControlId||null,this.color=e.color||this._generateRandomColor(),this.triggerType=e.triggerType||"pressed",this.animationName=e.animationName||null,this.duration=e.duration||1e3,this.easing=e.easing||"linear",this.iterations=e.iterations||1,this.targetDeviceIds=e.targetDeviceIds||[],this.propertyName=e.propertyName||"--value",this.propertyType=e.propertyType||"percentage",this.range=e.range||[0,100],this.cssClassName=e.cssClassName||this._generateClassName()}_generateRandomColor(){const e=Math.floor(Math.random()*360),t=70+Math.floor(Math.random()*30),r=50+Math.floor(Math.random()*20);return`hsl(${e}, ${t}%, ${r}%)`}_generateClassName(){if(!this.inputDeviceId||!this.inputControlId)return`mapping-${this.id}`;const e=this.inputControlId.replace(/[^a-zA-Z0-9]/g,"_").toLowerCase(),t=this.triggerType==="pressed"?"down":this.triggerType==="not-pressed"?"up":"always";return`${e}_${t}`}updateClassName(){this.cssClassName=this._generateClassName()}toCSS(e=[]){return this.mode==="trigger"?this._generateTriggerCSS(e):""}_generateTriggerCSS(e=[]){if(!this.animationName)return"";const t=this.targetDeviceIds.map(s=>{const a=e.find(l=>l.id===s);return a?`#${a.cssId}`:null}).filter(s=>s!==null).join(", ");if(!t)return"";const r=this.iterations==="infinite"?"infinite":this.iterations,i=(this.duration/1e3).toFixed(3);return`.${this.cssClassName} ${t} {
  animation: ${this.animationName} ${i}s ${this.easing} ${r};
}`}getPropertyName(){return this.propertyName.startsWith("--")?this.propertyName:`--${this.propertyName}`}mapValue(e){const[t,r]=this.range,i=t+(r-t)*e;switch(this.propertyType){case"percentage":return`${i.toFixed(1)}%`;case"degrees":return`${i.toFixed(1)}deg`;case"number":return i.toFixed(2);default:return i.toString()}}toJSON(){return{id:this.id,name:this.name,mode:this.mode,inputDeviceId:this.inputDeviceId,inputControlId:this.inputControlId,color:this.color,triggerType:this.triggerType,animationName:this.animationName,duration:this.duration,easing:this.easing,iterations:this.iterations,targetDeviceIds:this.targetDeviceIds,propertyName:this.propertyName,propertyType:this.propertyType,range:this.range,cssClassName:this.cssClassName}}static fromJSON(e){return new yi(e)}}class Cl{constructor(){this.mappings=new Map,this.listeners=new Map,this.load()}on(e,t){this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e).add(t)}off(e,t){this.listeners.has(e)&&this.listeners.get(e).delete(t)}_emit(e,t){if(!this.listeners.has(e))return;const r=this.listeners.get(e);for(const i of r)i(t)}add(e){return this.mappings.set(e.id,e),this.save(),this._emit("changed",{type:"add",mapping:e}),e}remove(e){const t=this.mappings.get(e);this.mappings.delete(e),this.save(),this._emit("changed",{type:"remove",mapping:t,id:e})}get(e){return this.mappings.get(e)}getAll(){return Array.from(this.mappings.values())}getByInput(e,t){return this.getAll().filter(r=>r.inputDeviceId===e&&r.inputControlId===t)}getTriggerMappings(){return this.getAll().filter(e=>e.mode==="trigger")}getDirectMappings(){return this.getAll().filter(e=>e.mode==="direct")}toCSS(e=[]){return this.getTriggerMappings().map(t=>t.toCSS(e)).filter(t=>t).join(`

`)}save(){const e=this.getAll().map(t=>t.toJSON());localStorage.setItem("dmx-mappings",JSON.stringify(e))}load(){const e=localStorage.getItem("dmx-mappings");if(e)try{const t=JSON.parse(e);for(const r of t){const i=yi.fromJSON(r);this.mappings.set(i.id,i)}}catch(t){console.error("Failed to load mappings:",t)}}clear(){this.mappings.clear(),this.save()}}class El{constructor(){this.activeClasses=new Set,this.notPressedClasses=new Set,this.alwaysClasses=new Set,this.container=null}setContainer(e){this.container=e;for(const t of this.notPressedClasses)e.classList.add(t);for(const t of this.alwaysClasses)e.classList.add(t)}register(e){e.mode==="trigger"&&(e.triggerType==="not-pressed"?(this.notPressedClasses.add(e.cssClassName),this.container&&this.container.classList.add(e.cssClassName)):e.triggerType==="always"&&(this.alwaysClasses.add(e.cssClassName),this.container&&this.container.classList.add(e.cssClassName)))}unregister(e){e.mode==="trigger"&&(this.notPressedClasses.delete(e.cssClassName),this.alwaysClasses.delete(e.cssClassName),this.container&&this.container.classList.remove(e.cssClassName))}trigger(e){if(!this.container||e.mode!=="trigger")return;const t=e.cssClassName;e.triggerType==="pressed"?(this.container.classList.add(t),this.activeClasses.add(t)):e.triggerType==="not-pressed"&&this.container.classList.remove(t)}release(e){if(!this.container||e.mode!=="trigger")return;const t=e.cssClassName;e.triggerType==="pressed"?(this.container.classList.remove(t),this.activeClasses.delete(t)):e.triggerType==="not-pressed"&&this.container.classList.add(t)}addRawClass(e){this.container&&this.container.classList.add(e)}removeRawClass(e){this.container&&this.container.classList.remove(e)}clearAll(){if(this.container){for(const e of this.activeClasses)this.container.classList.remove(e);this.activeClasses.clear()}}}class cd{constructor(e,t){this.animationLibrary=e,this.mappingLibrary=t}generate(e=[]){const t=[];if(t.push("/* DMX Controller - Generated CSS */"),t.push("/* This stylesheet is auto-generated from your animations and input mappings */"),t.push(`/* You can edit this CSS and the changes will be reflected in the interface */
`),t.push("/* === CSS Custom Property Definitions === */"),t.push(`/* Define custom properties with specific syntax for type safety */
`),t.push("@property --safety {"),t.push('  syntax: "none | probably";'),t.push("  inherits: false;"),t.push("  initial-value: none;"),t.push(`}
`),t.push("@property --fuel {"),t.push('  syntax: "<percentage>";'),t.push("  inherits: false;"),t.push("  initial-value: 0%;"),t.push(`}
`),t.push("@property --smoke-output {"),t.push('  syntax: "<number>";'),t.push("  inherits: false;"),t.push("  initial-value: 0;"),t.push(`}
`),e.length>0){t.push("/* === Default Device Values === */"),t.push("/* These selectors set the default state for each device */");for(const a of e){const l=this._generateDeviceDefaults(a);l&&t.push(l)}t.push("")}const r=this.animationLibrary.toCSS();r&&(t.push("/* === Animations === */"),t.push(r),t.push(""));const i=this.mappingLibrary.toCSS(e);i&&(t.push("/* === Triggers === */"),t.push(i),t.push(""));const s=this.mappingLibrary.getDirectMappings();if(s.length>0){t.push("/* === Custom Properties (Direct Control) === */"),t.push("/* These properties are updated live via JavaScript */"),t.push(":root {");for(const a of s){const l=a.getPropertyName(),c=a.mapValue(0);t.push(`  ${l}: ${c}; /* ${a.name} */`)}t.push(`}
`)}return t.push("/* === Custom Styles === */"),t.push("/* Add your custom CSS below to override device defaults and apply animations */"),t.push(""),t.join(`
`)}_generateDeviceDefaults(e){if(!Qe[e.type]||e.isLinked&&e.isLinked())return null;const r=[],i=e.defaultValues||[];switch(e.type){case"RGB":const[s,a,l]=i;r.push(`  color: rgb(${s||0}, ${a||0}, ${l||0});`);break;case"RGBA":const[c,u,d,f]=i;r.push(`  color: rgb(${c||0}, ${u||0}, ${d||0});`),r.push(`  /* Amber channel: ${f||0} */`);break;case"RGBW":const[_,m,h,g]=i;r.push(`  color: rgb(${_||0}, ${m||0}, ${h||0});`),r.push(`  /* White channel: ${g||0} */`);break;case"DIMMER":const v=i[0]||0;r.push(`  opacity: ${(v/255).toFixed(2)};`);break;case"SMOKE":const D=i[0]||0;r.push(`  --smoke-output: ${D};`);break;case"MOVING_HEAD":const[T,k,A,O,R,K,W]=i,Ce=T!==void 0?Math.round(T/255*100-50):0,Se=k!==void 0?Math.round(k/255*100-50):0;r.push(`  translate: ${Ce}% ${Se}%;`),r.push(`  opacity: ${A!==void 0?(A/255).toFixed(2):"1"};`),r.push(`  color: rgb(${O||0}, ${R||0}, ${K||0});`),W!==void 0&&r.push(`  /* White channel: ${W} */`);break;case"FLAMETHROWER":const[se,Q]=i,ne=se>=125?"probably":"none",ve=Math.round(Q/255*100);r.push(`  --safety: ${ne};`),r.push(`  --fuel: ${ve}%;`);break;default:return null}return r.length===0?null:`#${e.cssId} {
${r.join(`
`)}
}`}}class ud{constructor(){this.deviceElements=new Map,this.container=null,this.previousValues=new Map}initialize(e){this.container=e}updateDevices(e){if(this.container){for(const[t,r]of this.deviceElements)e.find(i=>i.id===t)||(r.remove(),this.deviceElements.delete(t));for(const t of e){let r=this.deviceElements.get(t.id);const i=t.cssId;r?r.id!==i&&(r.id=i):(r=document.createElement("div"),r.id=i,r.className="dmx-device",r.dataset.deviceType=t.type,this.container.appendChild(r),this.deviceElements.set(t.id,r)),r.dataset.deviceName=t.name,r.dataset.deviceType=t.type}}}sampleDevice(e){var a;const t=this.deviceElements.get(e.id);if(!t)return console.warn(`[CSSSampler] No element found for device ${e.id}`),null;t.offsetHeight;const r=window.getComputedStyle(t),i={};switch(this.previousValues.has(e.id)||console.log(`[CSSSampler] Sampling device ${e.id} (${e.name}):`,{elementId:t.id,className:t.className,parentClass:(a=t.parentElement)==null?void 0:a.className,computedColor:r.color,computedOpacity:r.opacity}),this._sampleCount||(this._sampleCount=0),this._sampleCount++,this._sampleCount%60===0&&console.log(`[CSSSampler DEBUG] Device ${e.id} computed color:`,r.color,"opacity:",r.opacity),e.type){case"RGB":Object.assign(i,this._sampleRGB(r));break;case"RGBA":Object.assign(i,this._sampleRGBA(r));break;case"RGBW":Object.assign(i,this._sampleRGBW(r));break;case"DIMMER":Object.assign(i,this._sampleDimmer(r));break;case"SMOKE":Object.assign(i,this._sampleSmoke(r));break;case"MOVING_HEAD":Object.assign(i,this._sampleMovingHead(r));break;case"FLAMETHROWER":Object.assign(i,this._sampleFlamethrower(r));break}const s=this.previousValues.get(e.id);if(s){let l=!1;const c={};for(const[u,d]of Object.entries(i))s[u]!==d&&(l=!0,c[u]={from:s[u],to:d});l&&console.log(`[CSSSampler] Device ${e.id} (${e.name}) values changed:`,{color:r.color,opacity:r.opacity,changes:c})}else console.log(`[CSSSampler] Initial sample for device ${e.id} (${e.name}):`,{color:r.color,opacity:r.opacity,channels:i});return this.previousValues.set(e.id,{...i}),i}sampleAll(e){const t=new Map;for(const r of e){const i=this.sampleDevice(r);i&&t.set(r.id,i)}return t}_sampleRGB(e){const t=this._parseComputedColor(e.color);return{Red:t.r,Green:t.g,Blue:t.b}}_sampleRGBA(e){const t=this._parseComputedColor(e.color);return{Red:t.r,Green:t.g,Blue:t.b,Amber:t.a*255}}_sampleRGBW(e){const t=this._parseComputedColor(e.color),r=Math.min(t.r,t.g,t.b);return{Red:t.r,Green:t.g,Blue:t.b,White:r}}_sampleDimmer(e){const t=parseFloat(e.opacity)||1;return{Intensity:Math.round(t*255)}}_sampleSmoke(e){const t=e.getPropertyValue("--smoke-output")||"0",r=parseFloat(t);return{Output:Math.round(Math.max(0,Math.min(255,r)))}}_sampleMovingHead(e){const t=this._parseComputedColor(e.color),r=parseFloat(e.opacity)||1,i=this._parseTranslate(e.translate);return{Pan:i.x,Tilt:i.y,Dimmer:Math.round(r*255),Red:t.r,Green:t.g,Blue:t.b,White:Math.min(t.r,t.g,t.b)}}_sampleFlamethrower(e){const t=e.getPropertyValue("--safety")||"none",r=e.getPropertyValue("--fuel")||"0%",i=t.trim()==="probably"?125:0,s=r.match(/(\d+(?:\.\d+)?)/),a=s?parseFloat(s[1]):0,l=Math.round(Math.max(0,Math.min(100,a))*255/100);return{Safety:i,Fuel:l}}_parseComputedColor(e){const t=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([\d.]+))?\)/);return t?{r:parseInt(t[1]),g:parseInt(t[2]),b:parseInt(t[3]),a:t[4]?parseFloat(t[4]):1}:{r:0,g:0,b:0,a:1}}_parseTranslate(e){if(!e||e==="none")return{x:127,y:127};const t=e.match(/translate\(([^,)]+)(?:,?\s+([^)]+))?\)/);if(t){const r=this._parsePercentage(t[1]),i=t[2]?this._parsePercentage(t[2]):r;return{x:Math.round(r*255/100),y:Math.round(i*255/100)}}return{x:127,y:127}}_parsePercentage(e){const t=parseFloat(e);return e.includes("%")?Math.max(0,Math.min(100,t)):Math.max(0,Math.min(100,t/255*100))}getElement(e){return this.deviceElements.get(e)}clear(){for(const e of this.deviceElements.values())e.remove();this.deviceElements.clear()}}class Il{constructor(){this.properties=new Map,this.styleElement=null}initialize(){this.styleElement=document.createElement("style"),this.styleElement.id="dmx-custom-properties",document.head.appendChild(this.styleElement),this._updateStyle()}setProperty(e,t){e.startsWith("--")||(e=`--${e}`),this.properties.set(e,t),this._updateStyle()}getProperty(e){return e.startsWith("--")||(e=`--${e}`),this.properties.get(e)}_updateStyle(){if(!this.styleElement)return;const e=Array.from(this.properties.entries()).map(([t,r])=>`  ${t}: ${r};`).join(`
`);this.styleElement.textContent=`:root {
${e}
}`}clear(){this.properties.clear(),this._updateStyle()}destroy(){this.styleElement&&(this.styleElement.remove(),this.styleElement=null),this.properties.clear()}}function dd(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}),t}var ea={},Vs={},ta=function(n,e){return ta=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},ta(n,e)};function xl(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");ta(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Wi=function(){return Wi=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Wi.apply(this,arguments)};function kl(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function Ml(n,e,t,r){var i=arguments.length,s=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,r);else for(var l=n.length-1;l>=0;l--)(a=n[l])&&(s=(i<3?a(s):i>3?a(e,t,s):a(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}function Pl(n,e){return function(t,r){e(t,r,n)}}function Tl(n,e,t,r,i,s){function a(D){if(D!==void 0&&typeof D!="function")throw new TypeError("Function expected");return D}for(var l=r.kind,c=l==="getter"?"get":l==="setter"?"set":"value",u=!e&&n?r.static?n:n.prototype:null,d=e||(u?Object.getOwnPropertyDescriptor(u,r.name):{}),f,_=!1,m=t.length-1;m>=0;m--){var h={};for(var g in r)h[g]=g==="access"?{}:r[g];for(var g in r.access)h.access[g]=r.access[g];h.addInitializer=function(D){if(_)throw new TypeError("Cannot add initializers after decoration has completed");s.push(a(D||null))};var v=(0,t[m])(l==="accessor"?{get:d.get,set:d.set}:d[c],h);if(l==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(f=a(v.get))&&(d.get=f),(f=a(v.set))&&(d.set=f),(f=a(v.init))&&i.unshift(f)}else(f=a(v))&&(l==="field"?i.unshift(f):d[c]=f)}u&&Object.defineProperty(u,r.name,d),_=!0}function Ll(n,e,t){for(var r=arguments.length>2,i=0;i<e.length;i++)t=r?e[i].call(n,t):e[i].call(n);return r?t:void 0}function Al(n){return typeof n=="symbol"?n:"".concat(n)}function Ol(n,e,t){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(n,"name",{configurable:!0,value:t?"".concat(t," ",e):e})}function Rl(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function Nl(n,e,t,r){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function l(d){try{u(r.next(d))}catch(f){a(f)}}function c(d){try{u(r.throw(d))}catch(f){a(f)}}function u(d){d.done?s(d.value):i(d.value).then(l,c)}u((r=r.apply(n,e||[])).next())})}function Fl(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=l(0),a.throw=l(1),a.return=l(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function l(u){return function(d){return c([u,d])}}function c(u){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(t=0)),t;)try{if(r=1,i&&(s=u[0]&2?i.return:u[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,u[1])).done)return s;switch(i=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){t.label=u[1];break}if(u[0]===6&&t.label<s[1]){t.label=s[1],s=u;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(u);break}s[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(n,t)}catch(d){u=[6,d],i=0}finally{r=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}var ps=Object.create?function(n,e,t,r){r===void 0&&(r=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,i)}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]};function Bl(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&ps(e,n,t)}function Yi(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function wa(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),i,s=[],a;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(l){a={error:l}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(a)throw a.error}}return s}function Vl(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(wa(arguments[e]));return n}function Gl(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),i=0,e=0;e<t;e++)for(var s=arguments[e],a=0,l=s.length;a<l;a++,i++)r[i]=s[a];return r}function jl(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return n.concat(s||Array.prototype.slice.call(e))}function Or(n){return this instanceof Or?(this.v=n,this):new Or(n)}function Kl(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",a),i[Symbol.asyncIterator]=function(){return this},i;function a(m){return function(h){return Promise.resolve(h).then(m,f)}}function l(m,h){r[m]&&(i[m]=function(g){return new Promise(function(v,D){s.push([m,g,v,D])>1||c(m,g)})},h&&(i[m]=h(i[m])))}function c(m,h){try{u(r[m](h))}catch(g){_(s[0][3],g)}}function u(m){m.value instanceof Or?Promise.resolve(m.value.v).then(d,f):_(s[0][2],m)}function d(m){c("next",m)}function f(m){c("throw",m)}function _(m,h){m(h),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Ul(n){var e,t;return e={},r("next"),r("throw",function(i){throw i}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(i,s){e[i]=n[i]?function(a){return(t=!t)?{value:Or(n[i](a)),done:!1}:s?s(a):a}:s}}function $l(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof Yi=="function"?Yi(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=n[s]&&function(a){return new Promise(function(l,c){a=n[s](a),i(l,c,a.done,a.value)})}}function i(s,a,l,c){Promise.resolve(c).then(function(u){s({value:u,done:l})},a)}}function Hl(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}var fd=Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e},na=function(n){return na=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},na(n)};function zl(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t=na(n),r=0;r<t.length;r++)t[r]!=="default"&&ps(e,n,t[r]);return fd(e,n),e}function ql(n){return n&&n.__esModule?n:{default:n}}function Wl(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)}function Yl(n,e,t,r,i){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!i:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?i.call(n,t):i?i.value=t:e.set(n,t),t}function Xl(n,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof n=="function"?e===n:n.has(e)}function Jl(n,e,t){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var r,i;if(t){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=e[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=e[Symbol.dispose],t&&(i=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");i&&(r=function(){try{i.call(this)}catch(s){return Promise.reject(s)}}),n.stack.push({value:e,dispose:r,async:t})}else t&&n.stack.push({async:!0});return e}var vd=typeof SuppressedError=="function"?SuppressedError:function(n,e,t){var r=new Error(t);return r.name="SuppressedError",r.error=n,r.suppressed=e,r};function Zl(n){function e(s){n.error=n.hasError?new vd(s,n.error,"An error was suppressed during disposal."):s,n.hasError=!0}var t,r=0;function i(){for(;t=n.stack.pop();)try{if(!t.async&&r===1)return r=0,n.stack.push(t),Promise.resolve().then(i);if(t.dispose){var s=t.dispose.call(t.value);if(t.async)return r|=2,Promise.resolve(s).then(i,function(a){return e(a),i()})}else r|=1}catch(a){e(a)}if(r===1)return n.hasError?Promise.reject(n.error):Promise.resolve();if(n.hasError)throw n.error}return i()}function Ql(n,e){return typeof n=="string"&&/^\.\.?\//.test(n)?n.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(t,r,i,s,a){return r?e?".jsx":".js":i&&(!s||!a)?t:i+s+"."+a.toLowerCase()+"js"}):n}const hd={__extends:xl,__assign:Wi,__rest:kl,__decorate:Ml,__param:Pl,__esDecorate:Tl,__runInitializers:Ll,__propKey:Al,__setFunctionName:Ol,__metadata:Rl,__awaiter:Nl,__generator:Fl,__createBinding:ps,__exportStar:Bl,__values:Yi,__read:wa,__spread:Vl,__spreadArrays:Gl,__spreadArray:jl,__await:Or,__asyncGenerator:Kl,__asyncDelegator:Ul,__asyncValues:$l,__makeTemplateObject:Hl,__importStar:zl,__importDefault:ql,__classPrivateFieldGet:Wl,__classPrivateFieldSet:Yl,__classPrivateFieldIn:Xl,__addDisposableResource:Jl,__disposeResources:Zl,__rewriteRelativeImportExtension:Ql},pd=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:Jl,get __assign(){return Wi},__asyncDelegator:Ul,__asyncGenerator:Kl,__asyncValues:$l,__await:Or,__awaiter:Nl,__classPrivateFieldGet:Wl,__classPrivateFieldIn:Xl,__classPrivateFieldSet:Yl,__createBinding:ps,__decorate:Ml,__disposeResources:Zl,__esDecorate:Tl,__exportStar:Bl,__extends:xl,__generator:Fl,__importDefault:ql,__importStar:zl,__makeTemplateObject:Hl,__metadata:Rl,__param:Pl,__propKey:Al,__read:wa,__rest:kl,__rewriteRelativeImportExtension:Ql,__runInitializers:Ll,__setFunctionName:Ol,__spread:Vl,__spreadArray:jl,__spreadArrays:Gl,__values:Yi,default:hd},Symbol.toStringTag,{value:"Module"})),gd=dd(pd);var lt={};Object.defineProperty(lt,"__esModule",{value:!0});lt.MODEL_NAMES=lt.DeviceModelId=void 0;var ut;(function(n){n.ORIGINAL="original",n.ORIGINALV2="originalv2",n.ORIGINALMK2="original-mk2",n.ORIGINALMK2SCISSOR="original-mk2-scissor",n.MINI="mini",n.XL="xl",n.PEDAL="pedal",n.PLUS="plus",n.NEO="neo",n.STUDIO="studio",n.MODULE6="6-module",n.MODULE15="15-module",n.MODULE32="32-module",n.NETWORK_DOCK="network-dock"})(ut||(lt.DeviceModelId=ut={}));lt.MODEL_NAMES={[ut.ORIGINAL]:"Stream Deck",[ut.MINI]:"Stream Deck Mini",[ut.XL]:"Stream Deck XL",[ut.ORIGINALV2]:"Stream Deck",[ut.ORIGINALMK2]:"Stream Deck MK.2",[ut.ORIGINALMK2SCISSOR]:"Stream Deck MK.2 (Scissor)",[ut.PLUS]:"Stream Deck +",[ut.PEDAL]:"Stream Deck Pedal",[ut.NEO]:"Stream Deck Neo",[ut.STUDIO]:"Stream Deck Studio",[ut.MODULE6]:"Stream Deck 6 Module",[ut.MODULE15]:"Stream Deck 15 Module",[ut.MODULE32]:"Stream Deck 32 Module",[ut.NETWORK_DOCK]:"Stream Deck Network Dock"};var ki={},Mi={},zr={},ec={exports:{}};(function(n){var e=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function i(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function s(c,u,d,f,_){if(typeof d!="function")throw new TypeError("The listener must be a function");var m=new i(d,f||c,_),h=t?t+u:u;return c._events[h]?c._events[h].fn?c._events[h]=[c._events[h],m]:c._events[h].push(m):(c._events[h]=m,c._eventsCount++),c}function a(c,u){--c._eventsCount===0?c._events=new r:delete c._events[u]}function l(){this._events=new r,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],d,f;if(this._eventsCount===0)return u;for(f in d=this._events)e.call(d,f)&&u.push(t?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},l.prototype.listeners=function(u){var d=t?t+u:u,f=this._events[d];if(!f)return[];if(f.fn)return[f.fn];for(var _=0,m=f.length,h=new Array(m);_<m;_++)h[_]=f[_].fn;return h},l.prototype.listenerCount=function(u){var d=t?t+u:u,f=this._events[d];return f?f.fn?1:f.length:0},l.prototype.emit=function(u,d,f,_,m,h){var g=t?t+u:u;if(!this._events[g])return!1;var v=this._events[g],D=arguments.length,T,k;if(v.fn){switch(v.once&&this.removeListener(u,v.fn,void 0,!0),D){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,d),!0;case 3:return v.fn.call(v.context,d,f),!0;case 4:return v.fn.call(v.context,d,f,_),!0;case 5:return v.fn.call(v.context,d,f,_,m),!0;case 6:return v.fn.call(v.context,d,f,_,m,h),!0}for(k=1,T=new Array(D-1);k<D;k++)T[k-1]=arguments[k];v.fn.apply(v.context,T)}else{var A=v.length,O;for(k=0;k<A;k++)switch(v[k].once&&this.removeListener(u,v[k].fn,void 0,!0),D){case 1:v[k].fn.call(v[k].context);break;case 2:v[k].fn.call(v[k].context,d);break;case 3:v[k].fn.call(v[k].context,d,f);break;case 4:v[k].fn.call(v[k].context,d,f,_);break;default:if(!T)for(O=1,T=new Array(D-1);O<D;O++)T[O-1]=arguments[O];v[k].fn.apply(v[k].context,T)}}return!0},l.prototype.on=function(u,d,f){return s(this,u,d,f,!1)},l.prototype.once=function(u,d,f){return s(this,u,d,f,!0)},l.prototype.removeListener=function(u,d,f,_){var m=t?t+u:u;if(!this._events[m])return this;if(!d)return a(this,m),this;var h=this._events[m];if(h.fn)h.fn===d&&(!_||h.once)&&(!f||h.context===f)&&a(this,m);else{for(var g=0,v=[],D=h.length;g<D;g++)(h[g].fn!==d||_&&!h[g].once||f&&h[g].context!==f)&&v.push(h[g]);v.length?this._events[m]=v.length===1?v[0]:v:a(this,m)}return this},l.prototype.removeAllListeners=function(u){var d;return u?(d=t?t+u:u,this._events[d]&&a(this,d)):(this._events=new r,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=t,l.EventEmitter=l,n.exports=l})(ec);var tc=ec.exports,jr={};Object.defineProperty(jr,"__esModule",{value:!0});jr.wrapBufferToPreparedBuffer=_d;jr.unwrapPreparedBufferToBuffer=md;function _d(n,e,t,r){let i=t;return r&&(typeof Buffer<"u"?i=t.map(s=>Buffer.from(s).toString("base64")):i=t.map(s=>btoa(String.fromCharCode(...s)))),{if_you_change_this_you_will_break_everything:"This is a encoded form of the buffer, exactly as the Stream Deck expects it. Do not touch this object, or you can crash your stream deck",modelId:n,type:e,do_not_touch:i}}function md(n,e){const t=e;if(t.modelId!==n)throw new Error("Prepared buffer is for a different model!");return t.do_not_touch.map(r=>{if(typeof r=="string")return typeof Buffer<"u"?Buffer.from(r,"base64"):new Uint8Array(atob(r).split("").map(i=>i.charCodeAt(0)));if(r instanceof Uint8Array)return r;throw new Error("Prepared buffer is not a string or Uint8Array!")})}var Xa;function Nn(){var i,s,a,l,c;if(Xa)return zr;Xa=1,Object.defineProperty(zr,"__esModule",{value:!0}),zr.StreamDeckBase=void 0;const n=tc,e=Xi(),t=jr;class r extends n.EventEmitter{constructor(f,_,m){var h;super();$e(this,"device");$e(this,"deviceProperties");U(this,i);U(this,s);U(this,a);U(this,l);U(this,c);this.device=f,this.deviceProperties=m.deviceProperties,F(this,i,m.properties),F(this,s,m.buttonsLcd),F(this,a,m.lcdSegmentDisplay),F(this,l,m.inputService),F(this,c,m.encoderLed),(h=m.events)==null||h.listen((g,...v)=>this.emit(g,...v)),this.device.on("input",g=>p(this,l).handleInput(g)),this.device.on("error",g=>{this.emit("error",g)})}get CONTROLS(){return this.deviceProperties.CONTROLS}get MODEL(){return this.deviceProperties.MODEL}get PRODUCT_NAME(){return this.deviceProperties.PRODUCT_NAME}get HAS_NFC_READER(){return this.deviceProperties.HAS_NFC_READER}checkValidKeyIndex(f,_){const m=this.deviceProperties.CONTROLS.find(h=>h.type==="button"&&h.index===f);if(!m)throw new TypeError("Expected a valid keyIndex");if(_&&m.feedbackType!==_)throw new TypeError("Expected a keyIndex with expected feedbackType")}calculateFillPanelDimensions(f){return p(this,s).calculateFillPanelDimensions(f)}async close(){return this.device.close()}async getHidDeviceInfo(){return this.device.getDeviceInfo()}async setBrightness(f){return p(this,i).setBrightness(f)}async resetToLogo(){return p(this,i).resetToLogo()}async getFirmwareVersion(){return p(this,i).getFirmwareVersion()}async getAllFirmwareVersions(){return p(this,i).getAllFirmwareVersions()}async getSerialNumber(){return p(this,i).getSerialNumber()}async sendPreparedBuffer(f){const _=(0,t.unwrapPreparedBufferToBuffer)(this.deviceProperties.MODEL,f);await this.device.sendReports(_)}async fillKeyColor(f,_,m,h){this.checkValidKeyIndex(f,null),await p(this,s).fillKeyColor(f,_,m,h)}async fillKeyBuffer(f,_,m){this.checkValidKeyIndex(f,"lcd"),await p(this,s).fillKeyBuffer(f,_,m)}async prepareFillKeyBuffer(f,_,m,h){return p(this,s).prepareFillKeyBuffer(f,_,m,h)}async fillPanelBuffer(f,_){await p(this,s).fillPanelBuffer(f,_)}async prepareFillPanelBuffer(f,_,m){return p(this,s).prepareFillPanelBuffer(f,_,m)}async clearKey(f){this.checkValidKeyIndex(f,null),await p(this,s).clearKey(f)}async clearPanel(){const f=[];f.push(p(this,s).clearPanel()),p(this,a)&&f.push(p(this,a).clearAllLcdSegments()),await Promise.all(f)}async fillLcd(...f){if(!p(this,a))throw new Error("Not supported for this model");return p(this,a).fillLcd(...f)}async fillLcdRegion(...f){if(!p(this,a))throw new Error("Not supported for this model");return p(this,a).fillLcdRegion(...f)}async prepareFillLcdRegion(...f){if(!p(this,a))throw new Error("Not supported for this model");return p(this,a).prepareFillLcdRegion(...f)}async clearLcdSegment(...f){if(!p(this,a))throw new Error("Not supported for this model");return p(this,a).clearLcdSegment(...f)}async setEncoderColor(...f){if(!p(this,c))throw new Error("Not supported for this model");return p(this,c).setEncoderColor(...f)}async setEncoderRingSingleColor(...f){if(!p(this,c))throw new Error("Not supported for this model");return p(this,c).setEncoderRingSingleColor(...f)}async setEncoderRingColors(...f){if(!p(this,c))throw new Error("Not supported for this model");return p(this,c).setEncoderRingColors(...f)}async getChildDeviceInfo(){const f=await this.device.getChildDeviceInfo();if(!f||f.vendorId!==e.VENDOR_ID)return null;const _=e.DEVICE_MODELS.find(m=>m.productIds.includes(f.productId));return _?{...f,model:_.id}:null}}return i=new WeakMap,s=new WeakMap,a=new WeakMap,l=new WeakMap,c=new WeakMap,zr.StreamDeckBase=r,zr}var gs={};Object.defineProperty(gs,"__esModule",{value:!0});gs.Gen1PropertiesService=void 0;var Qt;class yd{constructor(e){U(this,Qt);F(this,Qt,e)}async setBrightness(e){if(e<0||e>100)throw new RangeError("Expected brightness percentage to be between 0 and 100");const t=new Uint8Array([5,85,170,209,1,e,0,0,0,0,0,0,0,0,0,0,0]);await p(this,Qt).sendFeatureReport(t)}async resetToLogo(){const e=new Uint8Array([11,99,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);await p(this,Qt).sendFeatureReport(e)}async getFirmwareVersion(){let e;try{e=await p(this,Qt).getFeatureReport(4,32)}catch{e=await p(this,Qt).getFeatureReport(4,17)}const t=e.indexOf(0,5);return new TextDecoder("ascii").decode(e.subarray(5,t===-1?void 0:t))}async getAllFirmwareVersions(){return{}}async getSerialNumber(){let e;try{e=await p(this,Qt).getFeatureReport(3,32)}catch{e=await p(this,Qt).getFeatureReport(3,17)}return new TextDecoder("ascii").decode(e.subarray(5,17))}}Qt=new WeakMap;gs.Gen1PropertiesService=yd;var wi={};Object.defineProperty(wi,"__esModule",{value:!0});wi.DefaultButtonsLcdService=void 0;const Ja=jr;var ai,oi,fn,dt;class wd{constructor(e,t,r,i){U(this,ai);U(this,oi);U(this,fn);U(this,dt);F(this,ai,e),F(this,oi,t),F(this,fn,r),F(this,dt,i)}getLcdButtonControls(){return p(this,dt).CONTROLS.filter(e=>e.type==="button"&&e.feedbackType==="lcd")}calculateLcdGridSpan(e){if(e.length===0)return null;const t=e.map(i=>i.row),r=e.map(i=>i.column);return{minRow:Math.min(...t),maxRow:Math.max(...t),minCol:Math.min(...r),maxCol:Math.max(...r)}}calculateDimensionsFromGridSpan(e,t,r){if(r)throw new Error("Not implemented");{const i=e.maxRow-e.minRow+1;return{width:(e.maxCol-e.minCol+1)*t.width,height:i*t.height}}}calculateFillPanelDimensions(e){const t=this.getLcdButtonControls(),r=this.calculateLcdGridSpan(t);return!r||t.length===0?null:this.calculateDimensionsFromGridSpan(r,t[0].pixelSize,e==null?void 0:e.withPadding)}async clearPanel(){const e=[];if(p(this,dt).FULLSCREEN_PANELS>0)for(let t=0;t<p(this,dt).FULLSCREEN_PANELS;t++)e.push(p(this,fn).sendFeatureReport(new Uint8Array([3,5,t,0,0,0])));else for(const t of p(this,dt).CONTROLS)if(t.type==="button")switch(t.feedbackType){case"rgb":e.push(this.sendKeyRgb(t.hidIndex,0,0,0));break;case"lcd":if(p(this,dt).SUPPORTS_RGB_KEY_FILL)e.push(this.sendKeyRgb(t.hidIndex,0,0,0));else{const r=new Uint8Array(t.pixelSize.width*t.pixelSize.height*3);e.push(this.fillImageRangeControl(t,r,{format:"rgb",offset:0,stride:t.pixelSize.width*3}))}break}await Promise.all(e)}async clearKey(e){const t=p(this,dt).CONTROLS.find(r=>r.type==="button"&&r.index===e);if(!t||t.feedbackType==="none")throw new TypeError("Expected a valid keyIndex");if(p(this,dt).SUPPORTS_RGB_KEY_FILL||t.feedbackType==="rgb")await this.sendKeyRgb(e,0,0,0);else{const r=new Uint8Array(t.pixelSize.width*t.pixelSize.height*3);await this.fillImageRangeControl(t,r,{format:"rgb",offset:0,stride:t.pixelSize.width*3})}}async fillKeyColor(e,t,r,i){this.checkRGBValue(t),this.checkRGBValue(r),this.checkRGBValue(i);const s=p(this,dt).CONTROLS.find(a=>a.type==="button"&&a.index===e);if(!s||s.feedbackType==="none")throw new TypeError("Expected a valid keyIndex");if(p(this,dt).SUPPORTS_RGB_KEY_FILL||s.feedbackType==="rgb")await this.sendKeyRgb(e,t,r,i);else{const a=s.pixelSize.width*s.pixelSize.height,l=new Uint8Array(a*4),c=new DataView(l.buffer,l.byteOffset,l.byteLength);c.setUint8(0,t),c.setUint8(1,r),c.setUint8(2,i),c.setUint8(3,255);const u=c.getUint32(0);for(let d=1;d<a;d++)c.setUint32(d*4,u);await this.fillImageRangeControl(s,l,{format:"rgba",offset:0,stride:s.pixelSize.width*4})}}async fillKeyBuffer(e,t,r){const i=await this.prepareFillKeyBufferInner(e,t,r);await p(this,fn).sendReports(i)}async prepareFillKeyBufferInner(e,t,r){const i=(r==null?void 0:r.format)??"rgb";this.checkSourceFormat(i);const s=p(this,dt).CONTROLS.find(l=>l.type==="button"&&l.index===e);if(!s||s.feedbackType==="none")throw new TypeError("Expected a valid keyIndex");if(s.feedbackType!=="lcd")throw new TypeError(`keyIndex ${s.index} does not support lcd feedback`);const a=s.pixelSize.width*s.pixelSize.height*i.length;if(t.length!==a)throw new RangeError(`Expected image buffer of length ${a}, got length ${t.length}`);return this.prepareFillImageRangeControl(s,t,{format:i,offset:0,stride:s.pixelSize.width*i.length})}async prepareFillKeyBuffer(e,t,r,i){const s=await this.prepareFillKeyBufferInner(e,t,r);return(0,Ja.wrapBufferToPreparedBuffer)(p(this,dt).MODEL,"fill-key",s,i??!1)}async fillPanelBuffer(e,t){const r=await this.prepareFillPanelBufferInner(e,t);await p(this,fn).sendReports(r)}async prepareFillPanelBufferInner(e,t){const r=(t==null?void 0:t.format)??"rgb";this.checkSourceFormat(r);const i=this.getLcdButtonControls(),s=this.calculateLcdGridSpan(i);if(!s||i.length===0)throw new Error("Panel does not support being filled");const a=this.calculateDimensionsFromGridSpan(s,i[0].pixelSize,t==null?void 0:t.withPadding),l=r.length*a.width*a.height;if(e.length!==l)throw new RangeError(`Expected image buffer of length ${l}, got length ${e.length}`);const c=a.width*r.length,u=[];for(const f of i){const _=f.row-s.minRow,m=f.column-s.minCol,h=f.pixelSize.width*r.length,g=c*_*f.pixelSize.height,v=m*h;u.push(this.prepareFillImageRangeControl(f,e,{format:r,offset:g+v,stride:c}))}return(await Promise.all(u)).flat()}async prepareFillPanelBuffer(e,t,r){const i=await this.prepareFillPanelBufferInner(e,t);return(0,Ja.wrapBufferToPreparedBuffer)(p(this,dt).MODEL,"fill-panel",i,r??!1)}async sendKeyRgb(e,t,r,i){await p(this,fn).sendFeatureReport(new Uint8Array([3,6,e,t,r,i]))}async fillImageRangeControl(e,t,r){const i=await this.prepareFillImageRangeControl(e,t,r);await p(this,fn).sendReports(i)}async prepareFillImageRangeControl(e,t,r){if(e.feedbackType!=="lcd")throw new TypeError(`keyIndex ${e.index} does not support lcd feedback`);const i=await p(this,oi).convertPixelBuffer(t,r,e.pixelSize);return p(this,ai).generateFillImageWrites({keyIndex:e.hidIndex},i)}checkRGBValue(e){if(e<0||e>255)throw new TypeError("Expected a valid color RGB value 0 - 255")}checkSourceFormat(e){switch(e){case"rgb":case"rgba":case"bgr":case"bgra":break;default:{const t=e;throw new TypeError(`Expected a known color format not "${t}"`)}}}}ai=new WeakMap,oi=new WeakMap,fn=new WeakMap,dt=new WeakMap;wi.DefaultButtonsLcdService=wd;var _s={},Cn={},Za;function Fn(){if(Za)return Cn;Za=1,Object.defineProperty(Cn,"__esModule",{value:!0}),Cn.BMP_HEADER_LENGTH=void 0,Cn.transformImageBuffer=n,Cn.writeBMPHeader=e,Cn.uint8ArrayToDataView=t;function n(r,i,s,a,l,c){const u=t(r),d=new Uint8Array(a+l*c*s.colorMode.length),f=t(d),_=i.format.substring(0,3)!==s.colorMode.substring(0,3);for(let m=0;m<c;m++){const h=a+l*s.colorMode.length*m;for(let g=0;g<l;g++){let v=s.xFlip?l-g-1:g,D=s.yFlip?c-m-1:m;if(s.rotate){const K=v;v=D,D=K}const T=D*i.stride+i.offset+v*i.format.length,k=u.getUint8(T),A=u.getUint8(T+1),O=u.getUint8(T+2),R=h+g*s.colorMode.length;_?(f.setUint8(R,O),f.setUint8(R+1,A),f.setUint8(R+2,k)):(f.setUint8(R,k),f.setUint8(R+1,A),f.setUint8(R+2,O)),s.colorMode.length===4&&f.setUint8(R+3,255)}}return d}Cn.BMP_HEADER_LENGTH=54;function e(r,i,s,a,l){const c=t(r);c.setUint8(0,66),c.setUint8(1,77),c.setUint32(2,a+54,!0),c.setInt16(6,0,!0),c.setInt16(8,0,!0),c.setUint32(10,54,!0),c.setUint32(14,40,!0),c.setInt32(18,i,!0),c.setInt32(22,s,!0),c.setInt16(26,1,!0),c.setInt16(28,24,!0),c.setInt32(30,0,!0),c.setInt32(34,a,!0),c.setInt32(38,l,!0),c.setInt32(42,l,!0),c.setInt32(46,0,!0),c.setInt32(50,0,!0)}function t(r){return new DataView(r.buffer,r.byteOffset,r.byteLength)}return Cn}Object.defineProperty(_s,"__esModule",{value:!0});_s.BitmapButtonLcdImagePacker=void 0;const Pi=Fn();var li,ci;class bd{constructor(e,t){U(this,li);U(this,ci);F(this,li,e),F(this,ci,t)}async convertPixelBuffer(e,t,r){const i=(0,Pi.transformImageBuffer)(e,t,p(this,li),Pi.BMP_HEADER_LENGTH,r.width,r.height);return(0,Pi.writeBMPHeader)(i,r.width,r.height,i.length-Pi.BMP_HEADER_LENGTH,p(this,ci)),i}}li=new WeakMap,ci=new WeakMap;_s.BitmapButtonLcdImagePacker=bd;var cr={};Object.defineProperty(cr,"__esModule",{value:!0});cr.CallbackHook=void 0;var Sr;class Sd{constructor(){U(this,Sr,null)}emit(e,...t){if(!p(this,Sr))throw new Error("No listener setup");p(this,Sr).call(this,e,...t)}listen(e){F(this,Sr,e)}}Sr=new WeakMap;cr.CallbackHook=Sd;var Kr={};Object.defineProperty(Kr,"__esModule",{value:!0});Kr.ButtonOnlyInputService=void 0;var Dr,Cr;class Dd{constructor(e,t){$e(this,"deviceProperties");U(this,Dr);U(this,Cr);this.deviceProperties=e,F(this,Cr,t);const r=this.deviceProperties.CONTROLS.filter(i=>i.type==="button").map(i=>i.index);F(this,Dr,new Array(Math.max(-1,...r)+1).fill(!1))}handleInput(e){const t=this.deviceProperties.KEY_DATA_OFFSET||0;for(const r of this.deviceProperties.CONTROLS){if(r.type!=="button")continue;const i=!!e[t+r.hidIndex];i!==p(this,Dr)[r.index]&&(p(this,Dr)[r.index]=i,i?p(this,Cr).emit("down",r):p(this,Cr).emit("up",r))}}}Dr=new WeakMap,Cr=new WeakMap;Kr.ButtonOnlyInputService=Dd;var Qa;function nc(){if(Qa)return Mi;Qa=1,Object.defineProperty(Mi,"__esModule",{value:!0}),Mi.StreamDeckGen1Factory=l;const n=Nn(),e=gs,t=wi,r=_s,i=cr,s=Kr;function a(c){return{...c,KEY_DATA_OFFSET:0,HAS_NFC_READER:!1,SUPPORTS_CHILD_DEVICES:!1}}function l(c,u,d,f,_,m){const h=a(d),g=new i.CallbackHook;return new n.StreamDeckBase(c,u,{deviceProperties:h,events:g,properties:new e.Gen1PropertiesService(c),buttonsLcd:new t.DefaultButtonsLcdService(f,new r.BitmapButtonLcdImagePacker(_,m),c,h),lcdSegmentDisplay:null,inputService:new s.ButtonOnlyInputService(h,g),encoderLed:null})}return Mi}var sn={},Et={};Object.defineProperty(Et,"__esModule",{value:!0});Et.StreamdeckNeoLcdImageHeaderGenerator=Et.StreamdeckPlusLcdImageHeaderGenerator=Et.StreamdeckGen2ImageHeaderGenerator=Et.StreamdeckGen1ImageHeaderGenerator=void 0;const ms=Fn();class Cd{getFillImageCommandHeaderLength(){return 16}writeFillImageCommandHeader(e,t,r,i,s){const a=(0,ms.uint8ArrayToDataView)(e);a.setUint8(0,2),a.setUint8(1,1),a.setUint16(2,r,!0),a.setUint8(4,i?1:0),a.setUint8(5,t.keyIndex+1)}}Et.StreamdeckGen1ImageHeaderGenerator=Cd;class Ed{getFillImageCommandHeaderLength(){return 8}writeFillImageCommandHeader(e,t,r,i,s){const a=(0,ms.uint8ArrayToDataView)(e);a.setUint8(0,2),a.setUint8(1,7),a.setUint8(2,t.keyIndex),a.setUint8(3,i?1:0),a.setUint16(4,s,!0),a.setUint16(6,r++,!0)}}Et.StreamdeckGen2ImageHeaderGenerator=Ed;class Id{getFillImageCommandHeaderLength(){return 16}writeFillImageCommandHeader(e,t,r,i,s){const a=(0,ms.uint8ArrayToDataView)(e);a.setUint8(0,2),a.setUint8(1,12),a.setUint16(2,t.x,!0),a.setUint16(4,t.y,!0),a.setUint16(6,t.width,!0),a.setUint16(8,t.height,!0),a.setUint8(10,i?1:0),a.setUint16(11,r,!0),a.setUint16(13,s,!0)}}Et.StreamdeckPlusLcdImageHeaderGenerator=Id;class xd{getFillImageCommandHeaderLength(){return 8}writeFillImageCommandHeader(e,t,r,i,s){const a=(0,ms.uint8ArrayToDataView)(e);a.setUint8(0,2),a.setUint8(1,11),a.setUint8(2,0),a.setUint8(3,i?1:0),a.setUint16(4,s,!0),a.setUint16(6,r,!0)}}Et.StreamdeckNeoLcdImageHeaderGenerator=xd;Object.defineProperty(sn,"__esModule",{value:!0});sn.StreamdeckDefaultImageWriter=sn.StreamdeckOriginalImageWriter=void 0;const kd=Et;class Md{constructor(){$e(this,"headerGenerator",new kd.StreamdeckGen1ImageHeaderGenerator)}generateFillImageWrites(e,t){const i=this.headerGenerator.getFillImageCommandHeaderLength(),s=t.length/2,a=new Uint8Array(8191);this.headerGenerator.writeFillImageCommandHeader(a,e,1,!1,s),a.set(t.subarray(0,s),i);const l=new Uint8Array(8191);return this.headerGenerator.writeFillImageCommandHeader(l,e,2,!0,s),l.set(t.subarray(s),i),[a,l]}}sn.StreamdeckOriginalImageWriter=Md;class Pd{constructor(e){$e(this,"headerGenerator");this.headerGenerator=e}generateFillImageWrites(e,t){const i=this.headerGenerator.getFillImageCommandHeaderLength(),s=1024-i,a=[];let l=t.length;for(let c=0;l>0;c++){const u=new Uint8Array(1024),d=Math.min(l,s);this.headerGenerator.writeFillImageCommandHeader(u,e,c,l<=s,d);const f=t.length-l;l-=d,u.set(t.subarray(f,f+d),i),a.push(u)}return a}}sn.StreamdeckDefaultImageWriter=Pd;var Gt={};Object.defineProperty(Gt,"__esModule",{value:!0});Gt.generateButtonsGrid=Td;Gt.freezeDefinitions=Ad;function Td(n,e,t,r=!1,i=0){const s=[];for(let a=0;a<e;a++)for(let l=0;l<n;l++){const c=a*n+l,u=r?Ld(n,c):c;s.push({type:"button",row:a,column:l+i,index:c,hidIndex:u,feedbackType:"lcd",pixelSize:t})}return s}function Ld(n,e){const t=(n-1)/2,r=(e%n-t)*-t;return e+r}function Ad(n){return Object.freeze(n.map(e=>Object.freeze(e)))}var eo;function Od(){if(eo)return ki;eo=1,Object.defineProperty(ki,"__esModule",{value:!0}),ki.StreamDeckOriginalFactory=s;const n=nc(),e=lt,t=sn,r=Gt,i={MODEL:e.DeviceModelId.ORIGINAL,PRODUCT_NAME:e.MODEL_NAMES[e.DeviceModelId.ORIGINAL],SUPPORTS_RGB_KEY_FILL:!1,CONTROLS:(0,r.freezeDefinitions)((0,r.generateButtonsGrid)(5,3,{width:72,height:72},!0)),KEY_SPACING_HORIZONTAL:25,KEY_SPACING_VERTICAL:25,FULLSCREEN_PANELS:0};function s(a,l){return(0,n.StreamDeckGen1Factory)(a,l,i,new t.StreamdeckOriginalImageWriter,{colorMode:"bgr",xFlip:!0},3780)}return ki}var Ti={},to;function Rd(){if(to)return Ti;to=1,Object.defineProperty(Ti,"__esModule",{value:!0}),Ti.StreamDeck6KeyFactory=a;const n=nc(),e=lt,t=Gt,r=sn,i=Et,s={SUPPORTS_RGB_KEY_FILL:!1,CONTROLS:(0,t.freezeDefinitions)((0,t.generateButtonsGrid)(3,2,{width:80,height:80})),KEY_SPACING_HORIZONTAL:28,KEY_SPACING_VERTICAL:28,FULLSCREEN_PANELS:0};function a(l,c,u,d){const f={...s,MODEL:l,PRODUCT_NAME:e.MODEL_NAMES[l]};return(0,n.StreamDeckGen1Factory)(c,u,f,new r.StreamdeckDefaultImageWriter(new i.StreamdeckGen1ImageHeaderGenerator),{colorMode:"bgr",rotate:!0,yFlip:!0},2835)}return Ti}var Li={},ur={},bi={};Object.defineProperty(bi,"__esModule",{value:!0});bi.Gen2PropertiesService=void 0;class Nd{constructor(e){$e(this,"device");this.device=e}async setBrightness(e){if(e<0||e>100)throw new RangeError("Expected brightness percentage to be between 0 and 100");const t=new Uint8Array([3,8,e,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);await this.device.sendFeatureReport(t)}async resetToLogo(){const e=new Uint8Array([3,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);await this.device.sendFeatureReport(e)}async getFirmwareVersion(){const e=await this.device.getFeatureReport(5,32),t=e[1]+2;return new TextDecoder("ascii").decode(e.subarray(6,t))}async getAllFirmwareVersions(){return{AP2:await this.getFirmwareVersion()}}async getSerialNumber(){const e=await this.device.getFeatureReport(6,32),t=e[1]+2;return new TextDecoder("ascii").decode(e.subarray(2,t))}}bi.Gen2PropertiesService=Nd;var ys={};Object.defineProperty(ys,"__esModule",{value:!0});ys.JpegButtonLcdImagePacker=void 0;const Fd=Fn();var ui,Er;class Bd{constructor(e,t){U(this,ui);U(this,Er);F(this,ui,e),F(this,Er,t)}async convertPixelBuffer(e,t,r){const i=(0,Fd.transformImageBuffer)(e,t,{colorMode:"rgba",xFlip:p(this,Er),yFlip:p(this,Er)},0,r.width,r.height);return p(this,ui).call(this,i,r.width,r.height)}}ui=new WeakMap,Er=new WeakMap;ys.JpegButtonLcdImagePacker=Bd;var ws={};Object.defineProperty(ws,"__esModule",{value:!0});ws.Gen2InputService=void 0;const Vd=Kr,Gd=Fn();var $t,Jn,Ir,di,Rn,rc,ic,sc;class jd extends Vd.ButtonOnlyInputService{constructor(t,r){super(t,r);U(this,Rn);U(this,$t);U(this,Jn);U(this,Ir);U(this,di);F(this,$t,r),F(this,Jn,t.CONTROLS.filter(s=>s.type==="encoder"));const i=Math.max(-1,...p(this,Jn).map(s=>s.index));F(this,Ir,new Array(i+1).fill(!1)),F(this,di,t.CONTROLS.filter(s=>s.type==="lcd-segment"))}handleInput(t){switch(t[0]){case 0:super.handleInput(t);break;case 2:Fe(this,Rn,rc).call(this,t);break;case 3:Fe(this,Rn,ic).call(this,t);break;case 4:Fe(this,Rn,sc).call(this,t);break}}}$t=new WeakMap,Jn=new WeakMap,Ir=new WeakMap,di=new WeakMap,Rn=new WeakSet,rc=function(t){const r=p(this,di).find(a=>a.id===0);if(!r)return;const i=(0,Gd.uint8ArrayToDataView)(t),s={x:i.getUint16(5,!0),y:i.getUint16(7,!0)};switch(t[3]){case 1:p(this,$t).emit("lcdShortPress",r,s);break;case 2:p(this,$t).emit("lcdLongPress",r,s);break;case 3:{const a={x:i.getUint16(9,!0),y:i.getUint16(11,!0)};p(this,$t).emit("lcdSwipe",r,s,a);break}}},ic=function(t){switch(t[3]){case 0:for(const r of p(this,Jn)){const i=!!t[4+r.hidIndex];i!==p(this,Ir)[r.index]&&(p(this,Ir)[r.index]=i,i?p(this,$t).emit("down",r):p(this,$t).emit("up",r))}break;case 1:for(const r of p(this,Jn)){const s=new Int8Array(t.buffer,t.byteOffset,t.byteLength)[4+r.hidIndex];s!==0&&p(this,$t).emit("rotate",r,s)}break}},sc=function(t){if(!this.deviceProperties.HAS_NFC_READER)return;const r=t[1]+t[2]*256,i=new TextDecoder("ascii").decode(t.subarray(3,3+r));p(this,$t).emit("nfcRead",i)};ws.Gen2InputService=jd;var bs={};Object.defineProperty(bs,"__esModule",{value:!0});bs.EncoderLedService=void 0;var Zn,Mn;class Kd{constructor(e,t){U(this,Zn);U(this,Mn);F(this,Zn,e),F(this,Mn,t.filter(r=>r.type==="encoder"))}async clearAll(){const e=[];for(const t of p(this,Mn))t.hasLed&&e.push(this.setEncoderColor(t.index,0,0,0)),t.ledRingSteps>0&&e.push(this.setEncoderRingSingleColor(t.index,0,0,0));await Promise.all(e)}async setEncoderColor(e,t,r,i){const s=p(this,Mn).find(l=>l.index===e);if(!s)throw new Error(`Invalid encoder index ${e}`);if(!s.hasLed)throw new Error("Encoder does not have an LED");const a=new Uint8Array(1024);a[0]=2,a[1]=16,a[2]=e,a[3]=t,a[4]=r,a[5]=i,await p(this,Zn).sendReports([a])}async setEncoderRingSingleColor(e,t,r,i){const s=p(this,Mn).find(l=>l.index===e);if(!s)throw new Error(`Invalid encoder index ${e}`);if(s.ledRingSteps<=0)throw new Error("Encoder does not have an LED ring");const a=new Uint8Array(1024);a[0]=2,a[1]=15,a[2]=e;for(let l=0;l<s.ledRingSteps;l++){const c=3+l*3;a[c]=t,a[c+1]=r,a[c+2]=i}await p(this,Zn).sendReports([a])}async setEncoderRingColors(e,t){const r=p(this,Mn).find(a=>a.index===e);if(!r)throw new Error(`Invalid encoder index ${e}`);if(r.ledRingSteps<=0)throw new Error("Encoder does not have an LED ring");if(t.length!==r.ledRingSteps*3)throw new Error("Invalid colors length");let i=t instanceof Uint8Array?t:new Uint8Array(t);if(r.lcdRingOffset){const a=i;i=new Uint8Array(a.length),i.set(a.slice(r.lcdRingOffset*3),0),i.set(a.slice(0,r.lcdRingOffset*3),r.lcdRingOffset*3)}const s=new Uint8Array(1024);s[0]=2,s[1]=15,s[2]=e,s.set(i,3),await p(this,Zn).sendReports([s])}}Zn=new WeakMap,Mn=new WeakMap;bs.EncoderLedService=Kd;Object.defineProperty(ur,"__esModule",{value:!0});ur.createBaseGen2Properties=Zd;const Ud=sn,$d=Et,Hd=wi,zd=cr,qd=bi,Wd=ys,Yd=ws,Xd=bs;function Jd(n){return{...n,KEY_DATA_OFFSET:3}}function Zd(n,e,t,r,i){const s=Jd(t),a=new zd.CallbackHook;return{deviceProperties:s,events:a,properties:r??new qd.Gen2PropertiesService(n),buttonsLcd:new Hd.DefaultButtonsLcdService(new Ud.StreamdeckDefaultImageWriter(new $d.StreamdeckGen2ImageHeaderGenerator),new Wd.JpegButtonLcdImagePacker(e.encodeJPEG,!i),n,s),lcdSegmentDisplay:null,inputService:new Yd.Gen2InputService(s,a),encoderLed:new Xd.EncoderLedService(n,t.CONTROLS)}}var no;function Qd(){if(no)return Li;no=1,Object.defineProperty(Li,"__esModule",{value:!0}),Li.StreamDeck32KeyFactory=s;const n=Nn(),e=ur,t=lt,r=Gt,i={SUPPORTS_RGB_KEY_FILL:!1,CONTROLS:(0,r.freezeDefinitions)((0,r.generateButtonsGrid)(8,4,{width:96,height:96})),KEY_SPACING_HORIZONTAL:32,KEY_SPACING_VERTICAL:39,FULLSCREEN_PANELS:0,HAS_NFC_READER:!1,SUPPORTS_CHILD_DEVICES:!1};function s(a,l,c,u){const d={...i,MODEL:a,PRODUCT_NAME:t.MODEL_NAMES[a]},f=(0,e.createBaseGen2Properties)(l,c,d,null);return new n.StreamDeckBase(l,c,f)}return Li}var Ai={},ro;function ef(){if(ro)return Ai;ro=1,Object.defineProperty(Ai,"__esModule",{value:!0}),Ai.StreamDeck15KeyFactory=s;const n=Nn(),e=ur,t=lt,r=Gt,i={SUPPORTS_RGB_KEY_FILL:!1,CONTROLS:(0,r.freezeDefinitions)((0,r.generateButtonsGrid)(5,3,{width:72,height:72})),KEY_SPACING_HORIZONTAL:25,KEY_SPACING_VERTICAL:25,FULLSCREEN_PANELS:0,HAS_NFC_READER:!1,SUPPORTS_CHILD_DEVICES:!1};function s(a,l,c,u){const d={...i,MODEL:a,PRODUCT_NAME:t.MODEL_NAMES[a]},f=(0,e.createBaseGen2Properties)(l,c,d,null);return new n.StreamDeckBase(l,c,f)}return Ai}var Oi={},Ss={};Object.defineProperty(Ss,"__esModule",{value:!0});Ss.StreamDeckPlusLcdService=void 0;const tf=Et,nf=sn,rf=Fn(),sf=jr,af=lt;var fi,Qn,vn,ns;class of{constructor(e,t,r){U(this,fi);U(this,Qn);U(this,vn);U(this,ns,new nf.StreamdeckDefaultImageWriter(new tf.StreamdeckPlusLcdImageHeaderGenerator));F(this,fi,e),F(this,Qn,t),F(this,vn,r)}async fillLcd(e,t,r){const i=p(this,vn).find(a=>a.id===e);if(!i)throw new Error(`Invalid lcd segment index ${e}`);const s=await this.prepareFillControlRegion(i,0,0,t,{format:r.format,width:i.pixelSize.width,height:i.pixelSize.height});await p(this,Qn).sendReports(s)}async fillLcdRegion(e,t,r,i,s){const a=p(this,vn).find(c=>c.id===e);if(!a)throw new Error(`Invalid lcd segment index ${e}`);const l=await this.prepareFillControlRegion(a,t,r,i,s);await p(this,Qn).sendReports(l)}async prepareFillLcdRegion(e,t,r,i,s,a){const l=p(this,vn).find(u=>u.id===e);if(!l)throw new Error(`Invalid lcd segment index ${e}`);const c=await this.prepareFillControlRegion(l,t,r,i,s);return(0,sf.wrapBufferToPreparedBuffer)(af.DeviceModelId.PLUS,"fill-lcd-region",c,a??!1)}async clearLcdSegment(e){const t=p(this,vn).find(s=>s.id===e);if(!t)throw new Error(`Invalid lcd segment index ${e}`);const r=new Uint8Array(t.pixelSize.width*t.pixelSize.height*4),i=await this.prepareFillControlRegion(t,0,0,r,{format:"rgba",width:t.pixelSize.width,height:t.pixelSize.height});await p(this,Qn).sendReports(i)}async clearAllLcdSegments(){const e=[];for(const t of p(this,vn))e.push(this.clearLcdSegment(t.id));await Promise.all(e)}async prepareFillControlRegion(e,t,r,i,s){const a=e.pixelSize;if(t<0||t+s.width>a.width)throw new TypeError("Image will not fit within the lcd segment");if(r<0||r+s.height>a.height)throw new TypeError("Image will not fit within the lcd segment");const l=s.width*s.height*s.format.length;if(i.length!==l)throw new RangeError(`Expected image buffer of length ${l}, got length ${i.length}`);const c=await this.convertFillLcdBuffer(i,s);return p(this,ns).generateFillImageWrites({...s,x:t,y:r},c)}async convertFillLcdBuffer(e,t){const r={format:t.format,offset:0,stride:t.width*t.format.length},i=(0,rf.transformImageBuffer)(e,r,{colorMode:"rgba"},0,t.width,t.height);return p(this,fi).call(this,i,t.width,t.height)}}fi=new WeakMap,Qn=new WeakMap,vn=new WeakMap,ns=new WeakMap;Ss.StreamDeckPlusLcdService=of;var io;function lf(){if(io)return Oi;io=1,Object.defineProperty(Oi,"__esModule",{value:!0}),Oi.StreamDeckPlusFactory=c;const n=Nn(),e=ur,t=lt,r=Gt,i=Ss,s=(0,r.generateButtonsGrid)(4,2,{width:120,height:120});s.push({type:"lcd-segment",row:2,column:0,columnSpan:4,rowSpan:1,id:0,pixelSize:Object.freeze({width:800,height:100}),drawRegions:!0},{type:"encoder",row:3,column:0,index:0,hidIndex:0,hasLed:!1,ledRingSteps:0},{type:"encoder",row:3,column:1,index:1,hidIndex:1,hasLed:!1,ledRingSteps:0},{type:"encoder",row:3,column:2,index:2,hidIndex:2,hasLed:!1,ledRingSteps:0},{type:"encoder",row:3,column:3,index:3,hidIndex:3,hasLed:!1,ledRingSteps:0});const a={MODEL:t.DeviceModelId.PLUS,PRODUCT_NAME:t.MODEL_NAMES[t.DeviceModelId.PLUS],SUPPORTS_RGB_KEY_FILL:!0,CONTROLS:(0,r.freezeDefinitions)(s),KEY_SPACING_HORIZONTAL:99,KEY_SPACING_VERTICAL:40,FULLSCREEN_PANELS:0,HAS_NFC_READER:!1,SUPPORTS_CHILD_DEVICES:!1},l=a.CONTROLS.filter(u=>u.type==="lcd-segment");function c(u,d){const f=(0,e.createBaseGen2Properties)(u,d,a,null,!0);return f.lcdSegmentDisplay=new i.StreamDeckPlusLcdService(d.encodeJPEG,u,l),new n.StreamDeckBase(u,d,f)}return Oi}var Ri={},Ds={};Object.defineProperty(Ds,"__esModule",{value:!0});Ds.PedalPropertiesService=void 0;var xr;class cf{constructor(e){U(this,xr);F(this,xr,e)}async setBrightness(e){}async resetToLogo(){}async getFirmwareVersion(){const e=await p(this,xr).getFeatureReport(5,32),t=e.indexOf(0,6);return new TextDecoder("ascii").decode(e.subarray(6,t===-1?void 0:t))}async getAllFirmwareVersions(){return{AP2:await this.getFirmwareVersion()}}async getSerialNumber(){const e=await p(this,xr).getFeatureReport(6,32);return new TextDecoder("ascii").decode(e.subarray(2,14))}}xr=new WeakMap;Ds.PedalPropertiesService=cf;var Si={};Object.defineProperty(Si,"__esModule",{value:!0});Si.FakeLcdService=void 0;class uf{calculateFillPanelDimensions(e){return null}async clearKey(e){}async clearPanel(){}async fillKeyColor(e,t,r,i){}async fillKeyBuffer(e,t,r){}async prepareFillKeyBuffer(e,t,r,i){throw new Error("Not supported")}async fillPanelBuffer(e,t){}async prepareFillPanelBuffer(e,t,r){throw new Error("Not supported")}}Si.FakeLcdService=uf;var so;function df(){if(so)return Ri;so=1,Object.defineProperty(Ri,"__esModule",{value:!0}),Ri.StreamDeckPedalFactory=u;const n=Nn(),e=lt,t=Gt,r=Ds,i=Si,s=cr,a=Kr,l=[{type:"button",row:0,column:0,index:0,hidIndex:0,feedbackType:"none"},{type:"button",row:0,column:1,index:1,hidIndex:1,feedbackType:"none"},{type:"button",row:0,column:2,index:2,hidIndex:2,feedbackType:"none"}],c={MODEL:e.DeviceModelId.PEDAL,PRODUCT_NAME:e.MODEL_NAMES[e.DeviceModelId.PEDAL],KEY_DATA_OFFSET:3,SUPPORTS_RGB_KEY_FILL:!1,CONTROLS:(0,t.freezeDefinitions)(l),KEY_SPACING_HORIZONTAL:0,KEY_SPACING_VERTICAL:0,FULLSCREEN_PANELS:0,HAS_NFC_READER:!1,SUPPORTS_CHILD_DEVICES:!1};function u(d,f){const _=new s.CallbackHook;return new n.StreamDeckBase(d,f,{deviceProperties:c,events:_,properties:new r.PedalPropertiesService(d),buttonsLcd:new i.FakeLcdService,lcdSegmentDisplay:null,inputService:new a.ButtonOnlyInputService(c,_),encoderLed:null})}return Ri}var Ni={},Cs={};Object.defineProperty(Cs,"__esModule",{value:!0});Cs.StreamDeckNeoLcdService=void 0;const ff=Et,vf=sn,hf=Fn();var vi,hi,er,rs;class pf{constructor(e,t,r){U(this,vi);U(this,hi);U(this,er);U(this,rs,new vf.StreamdeckDefaultImageWriter(new ff.StreamdeckNeoLcdImageHeaderGenerator));F(this,vi,e),F(this,hi,t),F(this,er,r)}async fillLcdRegion(e,t,r,i,s){throw new Error("Not supported for this model")}async prepareFillLcdRegion(e,t,r,i,s,a){throw new Error("Not supported for this model")}async fillLcd(e,t,r){const i=p(this,er).find(c=>c.id===e);if(!i)throw new Error(`Invalid lcd segment index ${e}`);const s=i.pixelSize.width*i.pixelSize.height*r.format.length;if(t.length!==s)throw new RangeError(`Expected image buffer of length ${s}, got length ${t.length}`);const a=await this.convertFillLcdBuffer(t,i.pixelSize,r),l=p(this,rs).generateFillImageWrites(null,a);await p(this,hi).sendReports(l)}async clearLcdSegment(e){const t=p(this,er).find(i=>i.id===e);if(!t)throw new Error(`Invalid lcd segment index ${e}`);const r=new Uint8Array(t.pixelSize.width*t.pixelSize.height*4);await this.fillLcd(e,r,{format:"rgba"})}async clearAllLcdSegments(){const e=[];for(const t of p(this,er))e.push(this.clearLcdSegment(t.id));await Promise.all(e)}async convertFillLcdBuffer(e,t,r){const i={format:r.format,offset:0,stride:t.width*r.format.length},s=(0,hf.transformImageBuffer)(e,i,{colorMode:"rgba",xFlip:!0,yFlip:!0},0,t.width,t.height);return p(this,vi).call(this,s,t.width,t.height)}}vi=new WeakMap,hi=new WeakMap,er=new WeakMap,rs=new WeakMap;Cs.StreamDeckNeoLcdService=pf;var ao;function gf(){if(ao)return Ni;ao=1,Object.defineProperty(Ni,"__esModule",{value:!0}),Ni.StreamDeckNeoFactory=c;const n=Nn(),e=lt,t=ur,r=Gt,i=Cs,s=(0,r.generateButtonsGrid)(4,2,{width:96,height:96});s.push({type:"button",row:2,column:0,index:8,hidIndex:8,feedbackType:"rgb"},{type:"lcd-segment",row:2,column:1,columnSpan:2,rowSpan:1,id:0,pixelSize:{width:248,height:58},drawRegions:!1},{type:"button",row:2,column:3,index:9,hidIndex:9,feedbackType:"rgb"});const a={MODEL:e.DeviceModelId.NEO,PRODUCT_NAME:e.MODEL_NAMES[e.DeviceModelId.NEO],CONTROLS:(0,r.freezeDefinitions)(s),KEY_SPACING_HORIZONTAL:30,KEY_SPACING_VERTICAL:30,FULLSCREEN_PANELS:0,HAS_NFC_READER:!1,SUPPORTS_CHILD_DEVICES:!1,SUPPORTS_RGB_KEY_FILL:!0},l=a.CONTROLS.filter(u=>u.type==="lcd-segment");function c(u,d){const f=(0,t.createBaseGen2Properties)(u,d,a,null);return f.lcdSegmentDisplay=new i.StreamDeckNeoLcdService(d.encodeJPEG,u,l),new n.StreamDeckBase(u,d,f)}return Ni}var Gs={},Es={},Fi={},oo;function ba(){if(oo)return Fi;oo=1,Object.defineProperty(Fi,"__esModule",{value:!0}),Fi.parseAllFirmwareVersionsHelper=e;const n=Fn();async function e(t){const r=new TextDecoder("ascii"),i={};if(t.ap2){const s=(0,n.uint8ArrayToDataView)(t.ap2);i.AP2=r.decode(t.ap2.subarray(6,14)),i.AP2_CHECKSUM=s.getUint32(2,!1).toString(16)}if(t.encoderLd&&(t.encoderLd[0]===24||t.encoderLd[1]===24)){const s=(0,n.uint8ArrayToDataView)(t.encoderLd);i.ENCODER_LD=r.decode(t.encoderLd.subarray(2,10)),i.ENCODER_LD_CHECKSUM=s.getUint32(10,!1).toString(16)}if(t.encoderAp2&&(t.encoderAp2[0]===24||t.encoderAp2[1]===24)){const s=(0,n.uint8ArrayToDataView)(t.encoderAp2);i.ENCODER_AP2=r.decode(t.encoderAp2.subarray(2,10)),i.ENCODER_AP2_CHECKSUM=s.getUint32(10,!1).toString(16)}return i}return Fi}Object.defineProperty(Es,"__esModule",{value:!0});Es.StudioPropertiesService=void 0;const _f=ba(),mf=bi;class yf extends mf.Gen2PropertiesService{async getAllFirmwareVersions(){const[e,t,r]=await Promise.all([this.device.getFeatureReport(5,32),this.device.getFeatureReport(17,32),this.device.getFeatureReport(19,32)]);return(0,_f.parseAllFirmwareVersionsHelper)({ap2:e,encoderAp2:t,encoderLd:r})}}Es.StudioPropertiesService=yf;var lo;function wf(){return lo||(lo=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.studioProperties=void 0,n.StreamDeckStudioFactory=l;const e=Nn(),t=ur,r=lt,i=Gt,s=Es,a=[{type:"encoder",row:0,column:0,index:0,hidIndex:0,hasLed:!0,ledRingSteps:24},...(0,i.generateButtonsGrid)(16,2,{width:144,height:112},!1,1),{type:"encoder",row:0,column:17,index:1,hidIndex:1,hasLed:!0,ledRingSteps:24,lcdRingOffset:12}];n.studioProperties={MODEL:r.DeviceModelId.STUDIO,PRODUCT_NAME:r.MODEL_NAMES[r.DeviceModelId.STUDIO],SUPPORTS_RGB_KEY_FILL:!0,CONTROLS:(0,i.freezeDefinitions)(a),KEY_SPACING_HORIZONTAL:0,KEY_SPACING_VERTICAL:0,FULLSCREEN_PANELS:2,HAS_NFC_READER:!0,SUPPORTS_CHILD_DEVICES:!0};function l(c,u,d){const f=(0,t.createBaseGen2Properties)(c,u,n.studioProperties,d??new s.StudioPropertiesService(c),!0);return new e.StreamDeckBase(c,u,f)}}(Gs)),Gs}var Bi={},Is={};Object.defineProperty(Is,"__esModule",{value:!0});Is.FakeInputService=void 0;class bf{handleInput(e){}}Is.FakeInputService=bf;var xs={};Object.defineProperty(xs,"__esModule",{value:!0});xs.NetworkDockPropertiesService=void 0;const Sf=ba();var tr;class Df{constructor(e){U(this,tr);F(this,tr,e)}async setBrightness(e){}async resetToLogo(){}async getFirmwareVersion(){const e=await p(this,tr).getFeatureReport(131,-1);return new TextDecoder("ascii").decode(e.subarray(8,16))}async getAllFirmwareVersions(){const[e]=await Promise.all([p(this,tr).getFeatureReport(131,-1)]);return(0,Sf.parseAllFirmwareVersionsHelper)({ap2:e.slice(2),encoderAp2:null,encoderLd:null})}async getSerialNumber(){const e=await p(this,tr).getFeatureReport(132,-1),t=e[3];return new TextDecoder("ascii").decode(e.subarray(4,4+t))}}tr=new WeakMap;xs.NetworkDockPropertiesService=Df;var co;function Cf(){if(co)return Bi;co=1,Object.defineProperty(Bi,"__esModule",{value:!0}),Bi.NetworkDockFactory=c;const n=Nn(),e=lt,t=Gt,r=cr,i=Si,s=Is,a=xs,l={MODEL:e.DeviceModelId.NETWORK_DOCK,PRODUCT_NAME:e.MODEL_NAMES[e.DeviceModelId.NETWORK_DOCK],KEY_DATA_OFFSET:0,SUPPORTS_RGB_KEY_FILL:!1,CONTROLS:(0,t.freezeDefinitions)([]),KEY_SPACING_HORIZONTAL:0,KEY_SPACING_VERTICAL:0,FULLSCREEN_PANELS:0,HAS_NFC_READER:!1,SUPPORTS_CHILD_DEVICES:!0};function c(u,d,f){const _=new r.CallbackHook;return new n.StreamDeckBase(u,d,{deviceProperties:l,events:_,properties:new a.NetworkDockPropertiesService(u),buttonsLcd:new i.FakeLcdService,lcdSegmentDisplay:null,inputService:new s.FakeInputService,encoderLed:null})}return Bi}var js={},uo;function Ef(){return uo||(uo=1,Object.defineProperty(js,"__esModule",{value:!0})),js}var Ks={},fo;function If(){return fo||(fo=1,Object.defineProperty(Ks,"__esModule",{value:!0})),Ks}var qr={},vo;function xf(){if(vo)return qr;vo=1,Object.defineProperty(qr,"__esModule",{value:!0}),qr.StreamDeckProxy=void 0;class n{constructor(t){$e(this,"device");this.device=t}get CONTROLS(){return this.device.CONTROLS}get MODEL(){return this.device.MODEL}get PRODUCT_NAME(){return this.device.PRODUCT_NAME}get HAS_NFC_READER(){return this.device.HAS_NFC_READER}calculateFillPanelDimensions(...t){return this.device.calculateFillPanelDimensions(...t)}async close(){return this.device.close()}async getHidDeviceInfo(...t){return this.device.getHidDeviceInfo(...t)}async sendPreparedBuffer(...t){return this.device.sendPreparedBuffer(...t)}async fillKeyColor(...t){return this.device.fillKeyColor(...t)}async fillKeyBuffer(...t){return this.device.fillKeyBuffer(...t)}async prepareFillKeyBuffer(...t){return this.device.prepareFillKeyBuffer(...t)}async fillPanelBuffer(...t){return this.device.fillPanelBuffer(...t)}async prepareFillPanelBuffer(...t){return this.device.prepareFillPanelBuffer(...t)}async clearKey(...t){return this.device.clearKey(...t)}async clearPanel(...t){return this.device.clearPanel(...t)}async setBrightness(...t){return this.device.setBrightness(...t)}async resetToLogo(...t){return this.device.resetToLogo(...t)}async getFirmwareVersion(){return this.device.getFirmwareVersion()}async getAllFirmwareVersions(){return this.device.getAllFirmwareVersions()}async getSerialNumber(){return this.device.getSerialNumber()}async fillLcd(...t){return this.device.fillLcd(...t)}async setEncoderColor(...t){return this.device.setEncoderColor(...t)}async setEncoderRingSingleColor(...t){return this.device.setEncoderRingSingleColor(...t)}async setEncoderRingColors(...t){return this.device.setEncoderRingColors(...t)}async fillLcdRegion(...t){return this.device.fillLcdRegion(...t)}async prepareFillLcdRegion(...t){return this.device.prepareFillLcdRegion(...t)}async clearLcdSegment(...t){return this.device.clearLcdSegment(...t)}async getChildDeviceInfo(...t){return this.device.getChildDeviceInfo(...t)}eventNames(){return this.device.eventNames()}listeners(t){return this.device.listeners(t)}listenerCount(t){return this.device.listenerCount(t)}emit(t,...r){return this.device.emit(t,...r)}on(t,r,i){return this.device.on(t,r,i),this}addListener(t,r,i){return this.device.addListener(t,r,i),this}once(t,r,i){return this.device.once(t,r,i),this}removeListener(t,r,i,s){return this.device.removeListener(t,r,i,s),this}off(t,r,i,s){return this.device.off(t,r,i,s),this}removeAllListeners(t){return this.device.removeAllListeners(t),this}}return qr.StreamDeckProxy=n,qr}var ho;function Xi(){return ho||(ho=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.DEVICE_MODELS=n.DEVICE_MODELS2=n.DeviceModelType=n.VENDOR_ID=n.parseAllFirmwareVersionsHelper=n.uint8ArrayToDataView=n.StreamDeckProxy=void 0;const e=gd,t=lt,r=Od(),i=Rd(),s=Qd(),a=ef(),l=lf(),c=df(),u=gf(),d=wf(),f=Cf();e.__exportStar(Ef(),n),e.__exportStar(lt,n),e.__exportStar(If(),n);var _=xf();Object.defineProperty(n,"StreamDeckProxy",{enumerable:!0,get:function(){return _.StreamDeckProxy}});var m=Fn();Object.defineProperty(n,"uint8ArrayToDataView",{enumerable:!0,get:function(){return m.uint8ArrayToDataView}});var h=ba();Object.defineProperty(n,"parseAllFirmwareVersionsHelper",{enumerable:!0,get:function(){return h.parseAllFirmwareVersionsHelper}}),n.VENDOR_ID=4057;var g;(function(v){v.STREAMDECK="streamdeck",v.PEDAL="pedal",v.NETWORK_DOCK="network-dock"})(g||(n.DeviceModelType=g={})),n.DEVICE_MODELS2={[t.DeviceModelId.ORIGINAL]:{type:g.STREAMDECK,productIds:[96],factory:r.StreamDeckOriginalFactory,hasNativeTcp:!1},[t.DeviceModelId.MINI]:{type:g.STREAMDECK,productIds:[99,144],factory:(...v)=>(0,i.StreamDeck6KeyFactory)(t.DeviceModelId.MINI,...v),hasNativeTcp:!1},[t.DeviceModelId.XL]:{type:g.STREAMDECK,productIds:[108,143],factory:(...v)=>(0,s.StreamDeck32KeyFactory)(t.DeviceModelId.XL,...v),hasNativeTcp:!1},[t.DeviceModelId.ORIGINALV2]:{type:g.STREAMDECK,productIds:[109],factory:(...v)=>(0,a.StreamDeck15KeyFactory)(t.DeviceModelId.ORIGINALV2,...v),hasNativeTcp:!1},[t.DeviceModelId.ORIGINALMK2]:{type:g.STREAMDECK,productIds:[128],factory:(...v)=>(0,a.StreamDeck15KeyFactory)(t.DeviceModelId.ORIGINALMK2,...v),hasNativeTcp:!1},[t.DeviceModelId.ORIGINALMK2SCISSOR]:{type:g.STREAMDECK,productIds:[165],factory:(...v)=>(0,a.StreamDeck15KeyFactory)(t.DeviceModelId.ORIGINALMK2SCISSOR,...v),hasNativeTcp:!1},[t.DeviceModelId.PLUS]:{type:g.STREAMDECK,productIds:[132],factory:l.StreamDeckPlusFactory,hasNativeTcp:!1},[t.DeviceModelId.PEDAL]:{type:g.PEDAL,productIds:[134],factory:c.StreamDeckPedalFactory,hasNativeTcp:!1},[t.DeviceModelId.NEO]:{type:g.STREAMDECK,productIds:[154],factory:u.StreamDeckNeoFactory,hasNativeTcp:!1},[t.DeviceModelId.STUDIO]:{type:g.STREAMDECK,productIds:[170],factory:d.StreamDeckStudioFactory,hasNativeTcp:!0},[t.DeviceModelId.MODULE6]:{type:g.STREAMDECK,productIds:[184],factory:(...v)=>(0,i.StreamDeck6KeyFactory)(t.DeviceModelId.MODULE6,...v),hasNativeTcp:!1},[t.DeviceModelId.MODULE15]:{type:g.STREAMDECK,productIds:[185],factory:(...v)=>(0,a.StreamDeck15KeyFactory)(t.DeviceModelId.MODULE15,...v),hasNativeTcp:!1},[t.DeviceModelId.MODULE32]:{type:g.STREAMDECK,productIds:[186],factory:(...v)=>(0,s.StreamDeck32KeyFactory)(t.DeviceModelId.MODULE32,...v),hasNativeTcp:!1},[t.DeviceModelId.NETWORK_DOCK]:{type:g.NETWORK_DOCK,productIds:[65535],factory:f.NetworkDockFactory,hasNativeTcp:!0}},n.DEVICE_MODELS=Object.entries(n.DEVICE_MODELS2).map(([v,D])=>{const T=v;return{id:T,productName:t.MODEL_NAMES[T],...D}})}(Vs)),Vs}var ks={},Sa={},ac={exports:{}};(function(n){var e=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function i(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function s(c,u,d,f,_){if(typeof d!="function")throw new TypeError("The listener must be a function");var m=new i(d,f||c,_),h=t?t+u:u;return c._events[h]?c._events[h].fn?c._events[h]=[c._events[h],m]:c._events[h].push(m):(c._events[h]=m,c._eventsCount++),c}function a(c,u){--c._eventsCount===0?c._events=new r:delete c._events[u]}function l(){this._events=new r,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],d,f;if(this._eventsCount===0)return u;for(f in d=this._events)e.call(d,f)&&u.push(t?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},l.prototype.listeners=function(u){var d=t?t+u:u,f=this._events[d];if(!f)return[];if(f.fn)return[f.fn];for(var _=0,m=f.length,h=new Array(m);_<m;_++)h[_]=f[_].fn;return h},l.prototype.listenerCount=function(u){var d=t?t+u:u,f=this._events[d];return f?f.fn?1:f.length:0},l.prototype.emit=function(u,d,f,_,m,h){var g=t?t+u:u;if(!this._events[g])return!1;var v=this._events[g],D=arguments.length,T,k;if(v.fn){switch(v.once&&this.removeListener(u,v.fn,void 0,!0),D){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,d),!0;case 3:return v.fn.call(v.context,d,f),!0;case 4:return v.fn.call(v.context,d,f,_),!0;case 5:return v.fn.call(v.context,d,f,_,m),!0;case 6:return v.fn.call(v.context,d,f,_,m,h),!0}for(k=1,T=new Array(D-1);k<D;k++)T[k-1]=arguments[k];v.fn.apply(v.context,T)}else{var A=v.length,O;for(k=0;k<A;k++)switch(v[k].once&&this.removeListener(u,v[k].fn,void 0,!0),D){case 1:v[k].fn.call(v[k].context);break;case 2:v[k].fn.call(v[k].context,d);break;case 3:v[k].fn.call(v[k].context,d,f);break;case 4:v[k].fn.call(v[k].context,d,f,_);break;default:if(!T)for(O=1,T=new Array(D-1);O<D;O++)T[O-1]=arguments[O];v[k].fn.apply(v[k].context,T)}}return!0},l.prototype.on=function(u,d,f){return s(this,u,d,f,!1)},l.prototype.once=function(u,d,f){return s(this,u,d,f,!0)},l.prototype.removeListener=function(u,d,f,_){var m=t?t+u:u;if(!this._events[m])return this;if(!d)return a(this,m),this;var h=this._events[m];if(h.fn)h.fn===d&&(!_||h.once)&&(!f||h.context===f)&&a(this,m);else{for(var g=0,v=[],D=h.length;g<D;g++)(h[g].fn!==d||_&&!h[g].once||f&&h[g].context!==f)&&v.push(h[g]);v.length?this._events[m]=v.length===1?v[0]:v:a(this,m)}return this},l.prototype.removeAllListeners=function(u){var d;return u?(d=t?t+u:u,this._events[d]&&a(this,d)):(this._events=new r,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=t,l.EventEmitter=l,n.exports=l})(ac);var kf=ac.exports,Ms={exports:{}},Mf=(n,e)=>(e=e||(()=>{}),n.then(t=>new Promise(r=>{r(e())}).then(()=>t),t=>new Promise(r=>{r(e())}).then(()=>{throw t})));const Pf=Mf;class oc extends Error{constructor(e){super(e),this.name="TimeoutError"}}const lc=(n,e,t)=>new Promise((r,i)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){r(n);return}const s=setTimeout(()=>{if(typeof t=="function"){try{r(t())}catch(c){i(c)}return}const a=typeof t=="string"?t:`Promise timed out after ${e} milliseconds`,l=t instanceof Error?t:new oc(a);typeof n.cancel=="function"&&n.cancel(),i(l)},e);Pf(n.then(r,i),()=>{clearTimeout(s)})});Ms.exports=lc;Ms.exports.default=lc;Ms.exports.TimeoutError=oc;var Tf=Ms.exports,Da={},Ca={};Object.defineProperty(Ca,"__esModule",{value:!0});function Lf(n,e,t){let r=0,i=n.length;for(;i>0;){const s=i/2|0;let a=r+s;t(n[a],e)<=0?(r=++a,i-=s+1):i=s}return r}Ca.default=Lf;Object.defineProperty(Da,"__esModule",{value:!0});const Af=Ca;class Of{constructor(){this._queue=[]}enqueue(e,t){t=Object.assign({priority:0},t);const r={priority:t.priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority){this._queue.push(r);return}const i=Af.default(this._queue,r,(s,a)=>a.priority-s.priority);this._queue.splice(i,0,r)}dequeue(){const e=this._queue.shift();return e==null?void 0:e.run}filter(e){return this._queue.filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return this._queue.length}}Da.default=Of;Object.defineProperty(Sa,"__esModule",{value:!0});const Rf=kf,cc=Tf,Nf=Da,Vi=()=>{},Ff=new cc.TimeoutError;class Bf extends Rf{constructor(e){var t,r,i,s;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=Vi,this._resolveIdle=Vi,e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:Nf.default},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(r=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(s=(i=e.interval)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||e.interval===0,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=e.throwOnTimeout===!0,this._isPaused=e.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=Vi,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=Vi,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const e=Date.now();if(this._intervalId===void 0){const t=this._intervalEnd-e;if(t<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},t)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const t=this._queue.dequeue();return t?(this.emit("active"),t(),e&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,t={}){return new Promise((r,i)=>{const s=async()=>{this._pendingCount++,this._intervalCount++;try{const a=this._timeout===void 0&&t.timeout===void 0?e():cc.default(Promise.resolve(e()),t.timeout===void 0?this._timeout:t.timeout,()=>{(t.throwOnTimeout===void 0?this._throwOnTimeout:t.throwOnTimeout)&&i(Ff)});r(await a)}catch(a){i(a)}this._next()};this._queue.enqueue(s,t),this._tryToStartAnother(),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async r=>this.add(r,t)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(e=>{const t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(e=>{const t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}}Sa.default=Bf;Object.defineProperty(ks,"__esModule",{value:!0});ks.WebHIDDevice=void 0;const Vf=tc,Gf=Sa;class jf extends Vf.EventEmitter{constructor(t){super();$e(this,"device");$e(this,"reportQueue",new Gf.default({concurrency:1}));this.device=t,this.device.addEventListener("inputreport",r=>{if(r.reportId===1){const i=new Uint8Array(r.data.buffer,r.data.byteOffset,r.data.byteLength);this.emit("input",i)}})}async close(){return this.device.close()}async forget(){return this.device.forget()}async sendFeatureReport(t){return this.device.sendFeatureReport(t[0],t.subarray(1))}async getFeatureReport(t,r){const i=await this.device.receiveFeatureReport(t);return new Uint8Array(i.buffer,i.byteOffset,i.byteLength)}async sendReports(t){return this.reportQueue.add(async()=>{for(const r of t)await this.device.sendReport(r[0],r.subarray(1))})}async getDeviceInfo(){return{path:void 0,productId:this.device.productId,vendorId:this.device.vendorId}}async getChildDeviceInfo(){return null}}ks.WebHIDDevice=jf;var Ea={};Object.defineProperty(Ea,"__esModule",{value:!0});Ea.encodeJPEG=Kf;async function Kf(n,e,t){const r=await new Promise((i,s)=>{const a=document.createElement("canvas");a.width=e,a.height=t;const l=a.getContext("2d");if(l){const c=l.createImageData(e,t);c.data.set(n),l.putImageData(c,0,0),a.toBlob(u=>{u?i(u):s(new Error("No image generated"))},"image/jpeg",.9)}else s(new Error("Failed to get canvas context"))});return new Uint8Array(await r.arrayBuffer())}var ti={};Object.defineProperty(ti,"__esModule",{value:!0});ti.StreamDeckWeb=void 0;const Uf=Xi();class $f extends Uf.StreamDeckProxy{constructor(t,r){super(t);$e(this,"hid");this.hid=r}async forget(){await this.hid.forget()}async fillKeyCanvas(t,r){const i=r.getContext("2d");if(!i)throw new Error("Failed to get canvas context");const s=this.CONTROLS.find(l=>l.type==="button"&&l.index===t);if(!s||s.feedbackType==="none")throw new TypeError("Expected a valid keyIndex");if(s.feedbackType!=="lcd")throw new TypeError(`keyIndex ${s.index} does not support lcd feedback`);const a=i.getImageData(0,0,s.pixelSize.width,s.pixelSize.height);return this.device.fillKeyBuffer(t,a.data,{format:"rgba"})}async fillPanelCanvas(t){const r=t.getContext("2d");if(!r)throw new Error("Failed to get canvas context");const i=this.device.calculateFillPanelDimensions();if(!i)throw new Error("Panel does not support filling");const s=r.getImageData(0,0,i.width,i.height);return this.device.fillPanelBuffer(s.data,{format:"rgba"})}}ti.StreamDeckWeb=$f;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.StreamDeckWeb=n.StreamDeckProxy=n.DeviceModelId=n.VENDOR_ID=void 0,n.requestStreamDecks=l,n.getStreamDecks=c,n.openDevice=u;const e=Xi(),t=ks,r=Ea,i=ti;var s=Xi();Object.defineProperty(n,"VENDOR_ID",{enumerable:!0,get:function(){return s.VENDOR_ID}}),Object.defineProperty(n,"DeviceModelId",{enumerable:!0,get:function(){return s.DeviceModelId}}),Object.defineProperty(n,"StreamDeckProxy",{enumerable:!0,get:function(){return s.StreamDeckProxy}});var a=ti;Object.defineProperty(n,"StreamDeckWeb",{enumerable:!0,get:function(){return a.StreamDeckWeb}});async function l(d){const f=await navigator.hid.requestDevice({filters:[{vendorId:e.VENDOR_ID}]});return Promise.all(f.map(async _=>u(_,d)))}async function c(d){const _=(await navigator.hid.getDevices()).filter(h=>h.vendorId===e.VENDOR_ID);return(await Promise.all(_.map(async h=>u(h,d).catch(g=>null)))).filter(h=>!!h)}async function u(d,f){const _=e.DEVICE_MODELS.find(m=>d.vendorId===e.VENDOR_ID&&m.productIds.includes(d.productId));if(!_)throw new Error("Stream Deck is of unexpected type.");await d.open();try{const m={encodeJPEG:r.encodeJPEG,...f},h=new t.WebHIDDevice(d),g=_.factory(h,m||{});return new i.StreamDeckWeb(g,h)}catch(m){throw await d.close().catch(()=>null),m}}})(ea);const Hf={VENDOR_ID:4057};function zf(n){return n.vendorId===Hf.VENDOR_ID}class qf{constructor(){this.connectedDevices=new Map,this.listeners=new Map,this.buttonStates=new Map}on(e,t){this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e).add(t)}off(e,t){this.listeners.has(e)&&this.listeners.get(e).delete(t)}_emit(e,t){if(!this.listeners.has(e))return;const r=this.listeners.get(e);for(const i of r)i(t)}async requestDevice(){if(!navigator.hid)throw new Error("WebHID not supported in this browser");try{const e=await ea.requestStreamDecks();for(const t of e)await this._setupStreamDeck(t);return e[0]||null}catch(e){throw e.name==="NotAllowedError"?new Error("Failed to open Stream Deck. Please close the Elgato Stream Deck software and try again."):e}}async autoReconnect(){if(!navigator.hid)return console.warn("WebHID not supported"),[];try{const e=await ea.getStreamDecks(),t=[];for(const r of e)try{await this._setupStreamDeck(r),t.push(r)}catch(i){console.warn("Failed to reconnect to Stream Deck:",i)}return t}catch(e){return console.error("Failed to auto-reconnect Stream Deck devices:",e),[]}}async _setupStreamDeck(e){try{const t=e.serialNumber||e.SERIAL_NUMBER||`${e.PRODUCT_NAME||"StreamDeck"}-${e.MODEL||e.PRODUCT_ID||"unknown"}`.replace(/\s+/g,"-").toLowerCase();return console.log("Stream Deck serial number:",t,"Product:",e.PRODUCT_NAME,"Model:",e.MODEL),this.buttonStates.set(t,new Map),e.on("down",r=>{let i;if(typeof r=="number"?i=r:typeof r=="object"&&r!==null?i=r.index:typeof r=="string"&&(i=parseInt(r)),typeof i!="number"||isNaN(i)){console.warn("Could not extract button index from Stream Deck event:",r);return}const s=this.buttonStates.get(t);s&&typeof i=="number"&&s.set(i,!0),this._emit("buttondown",{device:e,serialNumber:t,button:i,model:e.PRODUCT_NAME||"Stream Deck"})}),e.on("up",r=>{let i;if(typeof r=="number"?i=r:typeof r=="object"&&r!==null?i=r.index:typeof r=="string"&&(i=parseInt(r)),typeof i!="number"||isNaN(i))return;const s=this.buttonStates.get(t);s&&typeof i=="number"&&s.set(i,!1),this._emit("buttonup",{device:e,serialNumber:t,button:i,model:e.PRODUCT_NAME||"Stream Deck"})}),await e.setBrightness(100),await e.clearPanel(),this.connectedDevices.set(t,e),this._emit("connected",{device:e,serialNumber:t,model:e.PRODUCT_NAME||"Stream Deck",buttonCount:e.NUM_KEYS}),e}catch(t){throw console.error("Failed to setup Stream Deck:",t),t}}async disconnectDevice(e){const t=this.connectedDevices.get(e);t&&(await t.close(),this.connectedDevices.delete(e),this.buttonStates.delete(e),this._emit("disconnected",{serialNumber:e}))}async setButtonColor(e,t,r){const i=this.connectedDevices.get(e);if(!i)return!1;const s=i.NUM_KEYS||15;if(t<0||t>=s)return!1;try{const a=this._parseColor(r);return a?(await i.fillKeyColor(t,a.r,a.g,a.b),!0):!1}catch(a){return console.error(`Failed to set button ${t} color on ${e}:`,a),!1}}async clearButtonColor(e,t){return await this.setButtonColor(e,t,"#000000")}_parseColor(e){const t=document.createElement("div");t.style.color=e,document.body.appendChild(t);const r=window.getComputedStyle(t).color;document.body.removeChild(t);const i=r.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/);return i?{r:parseInt(i[1]),g:parseInt(i[2]),b:parseInt(i[3])}:null}getConnectedDevices(){return Array.from(this.connectedDevices.values())}async disconnectAll(){const e=Array.from(this.connectedDevices.keys());for(const t of e)await this.disconnectDevice(t)}}class Di{constructor(e,t,r){this.id=e,this.name=t,this.type=r,this.controls=new Map,this.listeners=new Map}getValue(e){const t=this.controls.get(e);return t?t.value:0}_setValue(e,t,r=0,i=1){this.controls.has(e)||this.controls.set(e,{type:"value",value:0,min:r,max:i});const s=this.controls.get(e);s.value=t,s.min=r,s.max=i,this._emit("change",{controlId:e,value:t,control:s})}_trigger(e,t=1){this._emit("trigger",{controlId:e,velocity:t})}on(e,t){this.listeners.has(e)||this.listeners.set(e,[]),this.listeners.get(e).push(t)}off(e,t){if(!this.listeners.has(e))return;const r=this.listeners.get(e),i=r.indexOf(t);i!==-1&&r.splice(i,1)}_emit(e,t){if(!this.listeners.has(e))return;const r=this.listeners.get(e);for(const i of r)i(t)}disconnect(){}getControlIds(){return Array.from(this.controls.keys())}}class Wf extends Di{constructor(e){super(e.id,e.name||"MIDI Device","midi"),this.midiInput=e,this.midiInput.onmidimessage=this._handleMIDIMessage.bind(this)}_handleMIDIMessage(e){const[t,r,i]=e.data;switch(t&240){case 144:if(i>0){const u=`note-${r}`;this._trigger(u,i/127)}else{const u=`note-${r}`;this._emit("release",{controlId:u})}break;case 128:const a=`note-${r}`;this._emit("release",{controlId:a});break;case 176:const l=`cc-${r}`;this._setValue(l,i/127,0,1);break;case 224:const c=(i<<7|r)-8192;this._setValue("pitchbend",c/8192,-1,1);break}}disconnect(){this.midiInput&&(this.midiInput.onmidimessage=null)}}class Yf extends Di{constructor(e,t={}){super(e.productId.toString(),t.name||"HID Device","hid"),this.hidDevice=e,this.config=t,this.buttonStates=new Map,this.hidDevice.oninputreport=this._handleInputReport.bind(this)}_handleInputReport(e){const{data:t,reportId:r}=e,i=new Uint8Array(t.buffer);for(let s=0;s<i.length;s++){const a=i[s];for(let l=0;l<8;l++){const c=s*8+l,u=a>>l&1,d=`button-${c}`,f=this.buttonStates.get(d)||!1;u&&!f?(this.buttonStates.set(d,!0),this._trigger(d,127)):!u&&f&&(this.buttonStates.set(d,!1),this._emit("release",{controlId:d}))}}}async sendOutput(e,t){this.hidDevice&&this.hidDevice.opened&&await this.hidDevice.sendReport(e,t)}disconnect(){this.hidDevice&&(this.hidDevice.oninputreport=null,this.hidDevice.close()),this.buttonStates.clear()}}class Xf extends Di{constructor(){super("keyboard","Keyboard","keyboard"),this.pressedKeys=new Set,this._boundKeyDown=this._handleKeyDown.bind(this),this._boundKeyUp=this._handleKeyUp.bind(this),window.addEventListener("keydown",this._boundKeyDown),window.addEventListener("keyup",this._boundKeyUp)}_handleKeyDown(e){if(e.target.matches("input, textarea"))return;const t=`key-${e.code}`;this.pressedKeys.has(e.code)||(this.pressedKeys.add(e.code),this._trigger(t),this._setValue(t,1,0,1))}_handleKeyUp(e){const t=`key-${e.code}`;this.pressedKeys.has(e.code)&&(this.pressedKeys.delete(e.code),this._emit("release",{controlId:t}),this._setValue(t,0,0,1))}disconnect(){window.removeEventListener("keydown",this._boundKeyDown),window.removeEventListener("keyup",this._boundKeyUp),this.pressedKeys.clear()}}class Jf extends Di{constructor(e="Virtual"){super(`virtual-${Date.now()}`,e,"virtual")}trigger(e,t=1){this._trigger(e,t)}setValue(e,t){this._setValue(e,t,0,1)}addButton(e,t){this.controls.set(e,{type:"button",value:0,label:t})}addKnob(e,t,r=0){this.controls.set(e,{type:"knob",value:r,label:t,min:0,max:1})}}class Zf{constructor(){$e(this,"listeners",new Map);this.devices=new Map,this.midiAccess=null,this.keyboardDevice=null,this.streamDeckManager=new qf,this._setupStreamDeckListeners()}_setupStreamDeckListeners(){this.streamDeckManager.on("connected",({device:e,model:t,serialNumber:r})=>{console.log(`Stream Deck connected: ${t}`);const i=r,s=new Di(i,t||"Stream Deck","hid");s.streamDeck=e,this.devices.set(i,s),this._emit("deviceadded",s)}),this.streamDeckManager.on("buttondown",({device:e,button:t,model:r,serialNumber:i})=>{const s=i,a=this.devices.get(s);if(a){const l=`button-${t}`;a._trigger(l,127)}}),this.streamDeckManager.on("buttonup",({serialNumber:e,button:t})=>{const r=e,i=this.devices.get(r);if(i){const s=`button-${t}`;i._emit("release",{controlId:s})}}),this.streamDeckManager.on("disconnected",({serialNumber:e})=>{console.log("Stream Deck disconnected"),this.removeDevice(e)})}async initMIDI(){if(!navigator.requestMIDIAccess)return console.warn("WebMIDI not supported"),!1;try{this.midiAccess=await navigator.requestMIDIAccess(),this.midiAccess.onstatechange=this._handleMIDIStateChange.bind(this);for(const e of this.midiAccess.inputs.values())this._addMIDIDevice(e);return!0}catch(e){return console.error("Failed to initialize MIDI:",e),!1}}_handleMIDIStateChange(e){const t=e.port;t.type==="input"&&(t.state==="connected"?this._addMIDIDevice(t):t.state==="disconnected"&&this.removeDevice(t.id))}_addMIDIDevice(e){const t=new Wf(e);this.devices.set(t.id,t),this._emit("deviceadded",t)}async requestStreamDeck(){try{return await this.streamDeckManager.requestDevice()}catch(e){throw console.error("Failed to request Stream Deck:",e),e}}async autoReconnectStreamDecks(){try{const e=await this.streamDeckManager.autoReconnect();return console.log(`Auto-reconnected ${e.length} Stream Deck(s)`),e}catch(e){return console.error("Failed to auto-reconnect Stream Decks:",e),[]}}async requestHIDDevice(e=[]){if(!navigator.hid)return console.warn("WebHID not supported"),null;try{const t=await navigator.hid.requestDevice({filters:e});for(const r of t){if(zf(r))return await this.streamDeckManager.connectDevice(r);if(!r.opened)try{await r.open()}catch(s){throw console.error("Failed to open HID device:",s),new Error(`Cannot open device. Make sure it's not being used by another application. Error: ${s.message}`)}const i=new Yf(r);return this.devices.set(i.id,i),this._emit("deviceadded",i),i}}catch(t){throw console.error("Failed to request HID device:",t),t}return null}enableKeyboard(){return this.keyboardDevice||(this.keyboardDevice=new Xf,this.devices.set(this.keyboardDevice.id,this.keyboardDevice),this._emit("deviceadded",this.keyboardDevice)),this.keyboardDevice}createVirtual(e){const t=new Jf(e);return this.devices.set(t.id,t),this._emit("deviceadded",t),t}removeDevice(e){const t=this.devices.get(e);t&&(t.disconnect(),this.devices.delete(e),this._emit("deviceremoved",t))}getDevice(e){return this.devices.get(e)}getAllDevices(){return Array.from(this.devices.values())}getInputDevices(){return this.getAllDevices()}getInputDevice(e){return this.getDevice(e)}on(e,t){this.listeners.has(e)||this.listeners.set(e,[]),this.listeners.get(e).push(t)}off(e,t){if(!this.listeners.has(e))return;const r=this.listeners.get(e),i=r.indexOf(t);i!==-1&&r.splice(i,1)}_emit(e,t){if(!this.listeners.has(e))return;const r=this.listeners.get(e);for(const i of r)i(t)}disconnectAll(){for(const e of this.devices.values())e.disconnect();this.devices.clear()}}class Qf{constructor(e,t,r){this.inputDeviceManager=new Zf,this.mappingLibrary=e||new Cl,this.customPropertyManager=t||new Il,this.triggerManager=r||new El,this.listeners=new Map,this._setupInputListeners()}async initialize(){this.customPropertyManager.initialize(),this.inputDeviceManager.on("deviceadded",e=>{this._setupDeviceListeners(e),this._emit("deviceadded",e)}),this.inputDeviceManager.on("deviceremoved",e=>{this._emit("deviceremoved",e)}),await this.inputDeviceManager.initMIDI(),await this.inputDeviceManager.autoReconnectStreamDecks(),this.inputDeviceManager.enableKeyboard()}_setupInputListeners(){}_setupDeviceListeners(e){e.on("trigger",({controlId:t,velocity:r})=>{this._handleTrigger(e.id,t,r)}),e.on("release",({controlId:t})=>{this._handleRelease(e.id,t)}),e.on("change",({controlId:t,value:r})=>{this._handleValueChange(e.id,t,r)})}_generateClassName(e,t){return`${e.replace(/[^a-zA-Z0-9]/g,"_").toLowerCase()}_${t}`}_handleTrigger(e,t,r){const i=this.mappingLibrary.getByInput(e,t);if(i.length>0){const s=this._generateClassName(t,"down");this.triggerManager.addRawClass(s);const a=this._generateClassName(t,"up");this.triggerManager.removeRawClass(a);for(const l of i)l.mode==="trigger"&&(this.triggerManager.trigger(l),this._emit("trigger",{mapping:l,velocity:r}))}}_handleRelease(e,t){const r=this.mappingLibrary.getByInput(e,t);if(r.length>0){const i=this._generateClassName(t,"down");this.triggerManager.removeRawClass(i);const s=this._generateClassName(t,"up");this.triggerManager.addRawClass(s);for(const a of r)a.mode==="trigger"&&a.triggerType!=="always"&&(this.triggerManager.release(a),this._emit("release",{mapping:a}))}}_handleValueChange(e,t,r){const i=this.mappingLibrary.getByInput(e,t);for(const s of i)if(s.mode==="direct"){const a=s.getPropertyName(),l=s.mapValue(r);this.customPropertyManager.setProperty(a,l),this._emit("valuechange",{mapping:s,value:r,propertyValue:l})}}async requestStreamDeck(){return await this.inputDeviceManager.requestStreamDeck()}async requestHIDDevice(e=[]){return await this.inputDeviceManager.requestHIDDevice(e)}getInputDevices(){return this.inputDeviceManager.getAllDevices()}getInputDevice(e){return this.inputDeviceManager.getDevice(e)}createVirtualDevice(e){return this.inputDeviceManager.createVirtual(e)}setTriggerContainer(e){this.triggerManager.setContainer(e)}on(e,t){this.listeners.has(e)||this.listeners.set(e,[]),this.listeners.get(e).push(t)}off(e,t){if(!this.listeners.has(e))return;const r=this.listeners.get(e),i=r.indexOf(t);i!==-1&&r.splice(i,1)}_emit(e,t){if(!this.listeners.has(e))return;const r=this.listeners.get(e);for(const i of r)i(t)}destroy(){this.inputDeviceManager.disconnectAll(),this.customPropertyManager.destroy(),this.triggerManager.clearAll(),this.listeners.clear()}}Zc();var ev=dl("<title> </title>"),tv=dl("<svg><!><!></svg>");function _t(n,e){const t=Ya(e,["children","$$slots","$$events","$$legacy"]),r=Ya(t,["data","viewBox","size","width","height","color","stroke","fill","title"]);yt(e,!1);const i=Go();let s=de(e,"data",8,""),a=de(e,"viewBox",24,()=>h(s())),l=de(e,"size",8,"20px"),c=de(e,"width",24,l),u=de(e,"height",24,l),d=de(e,"color",8,"currentColor"),f=de(e,"stroke",24,d),_=de(e,"fill",24,d),m=de(e,"title",8,"");function h(k){const O=/viewBox="([\d\- \.]+)"/.exec(k);return O?O[1]:"0 0 20 20"}yu(()=>ll(s()),()=>{S(i,s().replace(/<svg[ \n]([^>]*)>/,"").replace("</svg>",""))}),wu(),Ju();var g=tv();qu(g,()=>({xmlns:"http://www.w3.org/2000/svg",width:c(),height:u(),viewBox:a(),stroke:f(),fill:_(),...r}));var v=y(g);{var D=k=>{var A=ev(),O=y(A);ie(()=>te(O,m())),P(k,A)};Pe(v,k=>{m()&&k(D)})}var T=w(v);pl(T,()=>o(i),!0),P(n,g),wt()}const nv=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30">
    <path fill="#2196f3" d="M 17 2 A 1 1 0 0 0 16.123047 2.5214844 L 8.1738281 15.433594 L 8.1738281 15.435547 A 1 1 0 0 0 8 16 A 1 1 0 0 0 9 17 L 14.5 17 L 13.019531 26.800781 A 1 1 0 0 0 13 27 A 1 1 0 0 0 14 28 A 1 1 0 0 0 14.882812 27.466797 L 14.884766 27.466797 L 22.806641 14.589844 L 22.796875 14.572266 C 22.915239 14.407976 23 14.217804 23 14 C 23 13.448 22.552 13 22 13 L 16.5 13 L 17.955078 3.2949219 A 1 1 0 0 0 18 3 A 1 1 0 0 0 17 2 z"></path>
</svg>
`,uc=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48">
    <path fill="#9C27B0" d="M21 4H26.001V43H21z" transform="rotate(45.001 23.5 23.5)"></path>
    <path fill="#9C27B0" d="M21 4H26.001V43H21z" transform="rotate(134.999 23.5 23.5)"></path>
</svg>
`;var rv=B('<button id="start" class="svelte-4b3o1e"><!> Connect DMX controller</button>'),iv=B('<button id="stop" class="svelte-4b3o1e"><!> Disconnect</button>'),sv=B('<header class="svelte-4b3o1e"><!></header>');function av(n,e){var t=sv(),r=y(t);{var i=a=>{var l=rv();l.__click=function(...u){var d;(d=e.onconnect)==null||d.apply(this,u)};var c=y(l);_t(c,{get data(){return nv}}),P(a,l)},s=a=>{var l=iv();l.__click=function(...u){var d;(d=e.ondisconnect)==null||d.apply(this,u)};var c=y(l);_t(c,{get data(){return uc}}),P(a,l)};Pe(r,a=>{e.connected?a(s,!1):a(i)})}P(n,t)}bt(["click"]);const ov='<svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 48 48" width="48px" height="48px"><path fill="#3F51B5" d="M17.8 18.1L10.4 25.4 6.2 21.3 4 23.5 10.4 29.9 20 20.3zM17.8 5.1L10.4 12.4 6.2 8.3 4 10.5 10.4 16.9 20 7.3zM17.8 31.1L10.4 38.4 6.2 34.3 4 36.5 10.4 42.9 20 33.3z"/><g><path fill="#90CAF9" d="M24 22H44V26H24zM24 9H44V13H24zM24 35H44V39H24z"/></g></svg>',lv='<svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 48 48" width="48px" height="48px" baseProfile="basic"><path fill="#64b5f6" d="M24,44C12.972,44,4,35.028,4,24S12.972,4,24,4s20,8.972,20,20S35.028,44,24,44z M24,6	C14.075,6,6,14.075,6,24s8.075,18,18,18s18-8.075,18-18S33.925,6,24,6z"/><path fill="#64b5f6" d="M24,37c-7.168,0-13-5.832-13-13s5.832-13,13-13s13,5.832,13,13S31.168,37,24,37z M24,13	c-6.065,0-11,4.935-11,11s4.935,11,11,11s11-4.935,11-11S30.065,13,24,13z"/><path fill="#64b5f6" d="M24,31c-3.86,0-7-3.14-7-7s3.14-7,7-7s7,3.14,7,7S27.86,31,24,31z M24,19c-2.757,0-5,2.243-5,5	s2.243,5,5,5s5-2.243,5-5S26.757,19,24,19z"/><circle cx="40" cy="14" r="2" fill="#0d47a1"/><circle cx="12" cy="39" r="3" fill="#5e35b1"/><circle cx="33" cy="32" r="3" fill="#0d47a1"/><circle cx="14" cy="8" r="2" fill="#5e35b1"/><circle cx="12" cy="25" r="2" fill="#0d47a1"/><circle cx="24" cy="24" r="3.094" fill="#ffe082"/></svg>',cv=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48">
  <path fill="#90a4ae" d="M6 6H42V8H6zM6 40H42V42H6z"></path>
  <path fill="#00bcd4" d="M11 24h6v14h-6V24zM21 17h6v14h-6V17zM31 10h6v14h-6V10z"></path>
</svg>
`,uv=`<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="48" height="48" viewBox="0 0 48 48">
<path fill="none" stroke="#02abc0" stroke-miterlimit="10" stroke-width="4" d="M8 21L8 10 19 10"></path><path fill="none" stroke="#02abc0" stroke-miterlimit="10" stroke-width="4" d="M8,10c5.763,6.146,13,15,20,15 c8.505,0,13-6.102,13-9.748C41,11.932,39.013,9,35.007,9C28.52,9,23.02,16.775,23.346,23.808C23.769,33.967,31.596,41,40,41"></path>
</svg>`,dv=`<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="48" height="48" viewBox="0 0 48 48">
<path fill="#2196F3" d="M11 5A7 7 0 1 0 11 19A7 7 0 1 0 11 5Z"></path><path fill="#FFA726" d="M23.082 28.861c.713 1.412 2.483 1.967 3.934 1.232 1.454-.734 2.059-2.488 1.346-3.899l-3.186-6.319c-.712-1.41-2.482-1.966-3.934-1.23-1.453.733-2.059 2.486-1.347 3.898L23.082 28.861zM28.39 26.234c.713 1.41 2.483 1.967 3.937 1.232 1.453-.733 2.057-2.488 1.344-3.9l-3.186-6.318c-.713-1.41-2.48-1.967-3.934-1.231-1.453.732-2.059 2.485-1.348 3.898L28.39 26.234zM33.7 23.607c.712 1.413 2.481 1.966 3.935 1.234 1.452-.734 2.058-2.49 1.344-3.9l-3.187-6.32c-.712-1.412-2.479-1.965-3.933-1.232-1.453.734-2.059 2.489-1.348 3.9L33.7 23.607zM40.215 23.421c-.307-.608.047.093.381.755C40.752 24.488 40.496 23.978 40.215 23.421z"></path><path fill="#FFA726" d="M20.815,22.174c-0.486,0.246-1.081,0.053-1.324-0.436l-5.78-11.459c-0.493-0.976-2.209-2.19-3.969-1.301c-1.76,0.89-1.757,3.085-1.313,3.967c0.243,0.482,3.405,6.754,6.226,12.342c2.339,4.635,4.438,8.803,4.438,8.803l-5.523-1.625c-1.83-0.603-3.687,0.198-4.15,2.302c-0.465,1.767,0.762,3.524,2.392,4.056l7.5,2.462c3.865,1.269,7.878,0.809,11.523-1.04l0.545-0.275l0.762-0.305l4.807-2.43l1.27-0.785c3.546-2.574,4.857-7.359,2.819-11.397c0,0-0.216-0.43-0.44-0.876c-0.175-0.344-0.857-1.696-2.6-5.153L20.815,22.174z"></path><g><path fill="#FFCDD2" d="M9.359 12.6c-.511-1.038-.135-2.27.846-2.751.976-.479 2.186-.024 2.692 1.011C13.409 11.898 9.869 13.635 9.359 12.6M11.882 37.605c-1.178-.316-1.874-1.527-1.561-2.707.319-1.178 1.531-1.875 2.707-1.559C14.207 33.657 13.061 37.924 11.882 37.605"></path></g>
</svg>`,fv=`<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="48" height="48" viewBox="0 0 48 48">
<path fill="#FFC107" d="M33 22L23.6 22 30 5 19 5 13 26 21.6 26 17 45z"></path>
</svg>`,vv=`<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="48" height="48" viewBox="0 0 48 48">
<path fill="#3F51B5" d="M36 34L33 31.5 39.8 24 33 16.5 36 14 45 24zM13 34L4 24 13 14 16 16.5 9.1 24 16 31.5z"></path><path fill="#2196F3" d="M21 39L17.2 37.7 27 9 30.8 10.3z"></path>
</svg>`;var hv=B('<option class="svelte-1f8dwwb"> </option>'),pv=B('<div class="add-device svelte-1f8dwwb"><select class="svelte-1f8dwwb"></select> <button class="svelte-1f8dwwb">Add Device</button></div>'),gv=B('<div class="clear-universe svelte-1f8dwwb"><button class="svelte-1f8dwwb">Clear</button></div>'),_v=B('<div class="tabs-container svelte-1f8dwwb"><nav class="svelte-1f8dwwb"><label class="svelte-1f8dwwb"><input type="radio" name="view" class="svelte-1f8dwwb"/> <!> Devices</label> <label class="svelte-1f8dwwb"><input type="radio" name="view" class="svelte-1f8dwwb"/> <!> Timeline</label> <label class="svelte-1f8dwwb"><input type="radio" name="view" class="svelte-1f8dwwb"/> <!> Animations</label> <label class="svelte-1f8dwwb"><input type="radio" name="view" class="svelte-1f8dwwb"/> <!> Inputs</label> <label class="svelte-1f8dwwb"><input type="radio" name="view" class="svelte-1f8dwwb"/> <!> Triggers</label> <label class="svelte-1f8dwwb"><input type="radio" name="view" class="svelte-1f8dwwb"/> <!> CSS</label> <label class="svelte-1f8dwwb"><input type="radio" name="view" class="svelte-1f8dwwb"/> <!> Universe</label></nav> <!> <!></div>');function mv(n,e){yt(e,!0);const t=[];let r=de(e,"view",15),i=de(e,"showAddDevice",3,!1),s=de(e,"deviceTypes",3,null),a=de(e,"selectedType",15),l=de(e,"onAddDevice",3,null),c=de(e,"onClearUniverse",3,null);var u=_v(),d=y(u),f=y(d),_=y(f);_.value=_.__value="devices";var m=w(_,2);_t(m,{get data(){return ov}});var h=w(f,2),g=y(h);g.value=g.__value="timeline";var v=w(g,2);_t(v,{get data(){return cv}});var D=w(h,2),T=y(D);T.value=T.__value="animations";var k=w(T,2);_t(k,{get data(){return uv}});var A=w(D,2),O=y(A);O.value=O.__value="inputs";var R=w(O,2);_t(R,{get data(){return dv}});var K=w(A,2),W=y(K);W.value=W.__value="triggers";var Ce=w(W,2);_t(Ce,{get data(){return fv}});var Se=w(K,2),se=y(Se);se.value=se.__value="css";var Q=w(se,2);_t(Q,{get data(){return vv}});var ne=w(Se,2),ve=y(ne);ve.value=ve.__value="universe";var ae=w(ve,2);_t(ae,{get data(){return lv}});var we=w(d,2);{var Ee=I=>{var q=pv(),x=y(q);Ge(x,21,()=>Object.entries(s()),We,(C,L)=>{var j=Be(()=>bo(o(L),2));let z=()=>o(j)[0],$=()=>o(j)[1];var xe=hv(),Ke=y(xe),G={};ie(()=>{te(Ke,$().name),G!==(G=z())&&(xe.value=(xe.__value=z())??"")}),P(C,xe)});var b=w(x,2);b.__click=function(...C){var L;(L=l())==null||L.apply(this,C)},hn(x,a),P(I,q)};Pe(we,I=>{i()&&r()==="devices"&&I(Ee)})}var Ie=w(we,2);{var E=I=>{var q=gv(),x=y(q);x.__click=function(...b){var C;(C=c())==null||C.apply(this,b)},P(I,q)};Pe(Ie,I=>{r()==="universe"&&c()&&I(E)})}Un(t,[],_,r,r),Un(t,[],g,r,r),Un(t,[],T,r,r),Un(t,[],O,r,r),Un(t,[],W,r,r),Un(t,[],se,r,r),Un(t,[],ve,r,r),P(n,u),wt()}bt(["click"]);var yv=B('<div class="channel svelte-134r4z3"><label class="svelte-134r4z3"></label> <input type="number" min="0" max="255" class="svelte-134r4z3"/></div>'),wv=B('<div class="universe-container svelte-134r4z3"><div class="channels-grid svelte-134r4z3"></div></div>');function bv(n,e){yt(e,!0);let t=V(be(new Array(512).fill(0))),r;function i(){e.dmxController&&S(t,Array.from(e.dmxController.getUniverse()),!0)}Gr(()=>{r=setInterval(i,100)}),vs(()=>{r&&clearInterval(r)});function s(c,u){const d=parseInt(u.target.value)||0;e.dmxController&&e.dmxController.setChannel(c,d),o(t)[c]=d}var a=wv(),l=y(a);Ge(l,21,()=>o(t),We,(c,u,d)=>{var f=yv(),_=y(f);Bt(_,"for",`ch-${d}`),_.textContent=d+1;var m=w(_,2);Bt(m,"id",`ch-${d}`),m.__change=h=>s(d,h),ie(()=>fr(m,o(u))),P(c,f)}),P(n,a),wt()}bt(["change"]);const po={RGB:{0:"Red",1:"Green",2:"Blue"},RGBA:{0:"Red",1:"Green",2:"Blue",3:"Amber"},RGBW:{0:"Red",1:"Green",2:"Blue",3:"White"},DIMMER:{0:"Dimmer"},SMOKE:{0:"Output"},MOVING_HEAD:{0:"Pan",1:"Tilt",2:"Dimmer",3:"Red",4:"Green",5:"Blue",6:"White"}};function Ia(n,e){const t=po[n],r=po[e];if(!t||!r)return{};const i={};for(const[s,a]of Object.entries(t))for(const[l,c]of Object.entries(r))if(a===c){i[parseInt(s)]=parseInt(l);break}return i}function Sv(n,e){const t=Ia(n,e);return Object.keys(t).length>0}function go(n,e,t,r){const i=Ia(n,e),s=[...r];for(const[a,l]of Object.entries(i))s[l]=t[a];return s}function ra(n,e){const t=Ia(n,e);return Object.values(t)}var Dv=B('<div class="xy-pad svelte-wbxrfb" role="slider" aria-label="Pan and Tilt Control" tabindex="0"><div class="grid-line vertical svelte-wbxrfb" style="left: 25%"></div> <div class="grid-line vertical svelte-wbxrfb" style="left: 50%"></div> <div class="grid-line vertical svelte-wbxrfb" style="left: 75%"></div> <div class="grid-line horizontal svelte-wbxrfb" style="top: 25%"></div> <div class="grid-line horizontal svelte-wbxrfb" style="top: 50%"></div> <div class="grid-line horizontal svelte-wbxrfb" style="top: 75%"></div> <div></div></div>');function Cv(n,e){yt(e,!0);let t=de(e,"panValue",15,127),r=de(e,"tiltValue",15,127),i=de(e,"onUpdate",3,null),s=V(null),a=V(!1);function l(g,v){if(!o(s))return;const D=o(s).getBoundingClientRect();let T=(g-D.left)/D.width,k=(v-D.top)/D.height;T=Math.max(0,Math.min(1,T)),k=Math.max(0,Math.min(1,k)),t(Math.round(T*255)),r(Math.round((1-k)*255)),i()&&i()(t(),r())}function c(g){S(a,!0),l(g.clientX,g.clientY),g.preventDefault()}function u(g){o(a)&&l(g.clientX,g.clientY)}nn(()=>{const g=()=>{S(a,!1)};return window.addEventListener("mouseup",g),()=>window.removeEventListener("mouseup",g)});let d=Be(()=>t()/255*100),f=Be(()=>(1-r()/255)*100);var _=Dv();_.__mousedown=c,_.__mousemove=u;var m=w(y(_),12);let h;rn(_,g=>S(s,g),()=>o(s)),ie(()=>{h=Ze(m,1,"crosshair svelte-wbxrfb",null,h,{active:o(a)}),Je(m,`left: ${o(d)??""}%; top: ${o(f)??""}%`)}),P(n,_),wt()}bt(["mousedown","mousemove"]);var Ev=B('<div class="control-xypad svelte-15qavlb"><label class="svelte-15qavlb"> </label> <div><!></div> <div class="xypad-inputs svelte-15qavlb"><input type="text" class="value-input svelte-15qavlb" title="Pan" maxlength="3"/> <input type="text" class="value-input svelte-15qavlb" title="Tilt" maxlength="3"/></div></div>'),Iv=B('<div class="control svelte-15qavlb"><label class="svelte-15qavlb"> </label> <div class="toggle-wrapper svelte-15qavlb"><button><span class="toggle-slider svelte-15qavlb"></span></button> <span class="toggle-label svelte-15qavlb"> </span></div> <input type="text" class="value-input svelte-15qavlb" maxlength="3"/></div>'),xv=B('<div class="control svelte-15qavlb"><label class="svelte-15qavlb"> </label> <div class="slider-wrapper svelte-15qavlb"><input type="range" min="0" max="255" class="color-slider svelte-15qavlb"/></div> <input type="text" class="value-input svelte-15qavlb" maxlength="3"/></div>'),kv=B('<div class="device-controls svelte-15qavlb"></div>');function xa(n,e){yt(e,!0);let t=de(e,"values",31,()=>be([])),r=de(e,"onChange",3,null),i=de(e,"disabledChannels",19,()=>[]);function s(g,v){t(t()[g]=v,!0),r()&&r()(g,v)}function a(g,v,D,T){t(t()[g]=D,!0),t(t()[v]=T,!0),r()&&(r()(g,D),r()(v,T))}function l(g,v){const T=t()[g]===v.onValue?v.offValue:v.onValue;s(g,T)}function c(g,v,D){const T=parseInt(v);!isNaN(T)&&T>=0&&T<=255?s(g,T):v===""?D.target.value="":D.target.value=t()[g]}function u(g){g.target.value=g.target.value.replace(/[^0-9]/g,"")}function d(g){return i().includes(g)}function f(g){const v=Qe[e.deviceType].controls;let D=0;for(let T=0;T<g;T++)v[T].type==="xypad"?D+=2:D+=1;return D}function _(g){switch(g){case"Red":return"linear-gradient(to right, rgb(0,0,0) 0%, rgb(255,0,0) 100%)";case"Green":return"linear-gradient(to right, rgb(0,0,0) 0%, rgb(0,255,0) 100%)";case"Blue":return"linear-gradient(to right, rgb(0,0,0) 0%, rgb(0,0,255) 100%)";case"Amber":return"linear-gradient(to right, rgb(0,0,0) 0%, rgb(255,191,0) 100%)";case"White":return"linear-gradient(to right, rgb(0,0,0) 0%, rgb(255,255,255) 100%)";case"Dimmer":case"Intensity":return"linear-gradient(to right, rgb(0,0,0) 0%, rgb(255,255,255) 100%)";case"Output":return"linear-gradient(to right, rgb(0,0,0) 0%, rgb(200,200,200) 100%)";default:return"linear-gradient(to right, rgb(0,0,0) 0%, rgb(128,128,128) 100%)"}}function m(g,v){switch(g){case"Red":return`rgb(${v}, 0, 0)`;case"Green":return`rgb(0, ${v}, 0)`;case"Blue":return`rgb(0, 0, ${v})`;case"Amber":return`rgb(${v}, ${Math.round(v*.749)}, 0)`;case"White":return`rgb(${v}, ${v}, ${v})`;case"Dimmer":case"Intensity":return`rgb(${v}, ${v}, ${v})`;case"Output":return`rgb(${Math.round(v*.784)}, ${Math.round(v*.784)}, ${Math.round(v*.784)})`;default:return`rgb(${Math.round(v*.5)}, ${Math.round(v*.5)}, ${Math.round(v*.5)})`}}var h=kv();Ge(h,21,()=>Qe[e.deviceType].controls,We,(g,v,D)=>{var T=sr(),k=et(T);{var A=R=>{const K=Be(()=>d(o(v).panIndex)),W=Be(()=>d(o(v).tiltIndex)),Ce=Be(()=>o(K)&&o(W));var Se=Ev(),se=y(Se),Q=y(se),ne=w(se,2);let ve;var ae=y(ne);Cv(ae,{onUpdate:(E,I)=>!o(Ce)&&a(o(v).panIndex,o(v).tiltIndex,E,I),get panValue(){return t()[o(v).panIndex]},set panValue(E){t(t()[o(v).panIndex]=E,!0)},get tiltValue(){return t()[o(v).tiltIndex]},set tiltValue(E){t(t()[o(v).tiltIndex]=E,!0)}});var we=w(ne,2),Ee=y(we);Ee.__input=u,Ee.__change=E=>!o(K)&&c(o(v).panIndex,E.target.value,E);var Ie=w(Ee,2);Ie.__input=u,Ie.__change=E=>!o(W)&&c(o(v).tiltIndex,E.target.value,E),ie(()=>{te(Q,o(v).name),ve=Ze(ne,1,"xypad-wrapper svelte-15qavlb",null,ve,{disabled:o(Ce)}),fr(Ee,t()[o(v).panIndex]),Ee.disabled=o(K),fr(Ie,t()[o(v).tiltIndex]),Ie.disabled=o(W)}),P(R,Se)},O=R=>{var K=sr(),W=et(K);{var Ce=se=>{const Q=Be(()=>f(D)),ne=Be(()=>d(o(Q))),ve=Be(()=>t()[o(Q)]===o(v).onValue);var ae=Iv(),we=y(ae),Ee=y(we),Ie=w(we,2),E=y(Ie);let I;E.__click=()=>!o(ne)&&l(o(Q),o(v));var q=w(E,2),x=y(q),b=w(Ie,2);b.__input=u,b.__change=C=>!o(ne)&&c(o(Q),C.target.value,C),ie(()=>{te(Ee,o(v).name),I=Ze(E,1,"toggle-switch svelte-15qavlb",null,I,{on:o(ve)}),E.disabled=o(ne),Bt(E,"aria-label",`${o(v).name??""} ${o(ve)?"on":"off"}`),te(x,o(ve)?"ON":"OFF"),fr(b,t()[o(Q)]),b.disabled=o(ne)}),P(se,ae)},Se=se=>{const Q=Be(()=>f(D)),ne=Be(()=>d(o(Q)));var ve=xv(),ae=y(ve),we=y(ae),Ee=w(ae,2),Ie=y(Ee);Ie.__input=I=>!o(ne)&&s(o(Q),parseInt(I.target.value));var E=w(Ee,2);E.__input=u,E.__change=I=>!o(ne)&&c(o(Q),I.target.value,I),ie((I,q)=>{te(we,o(v).name),fr(Ie,t()[o(Q)]),Je(Ie,`--slider-gradient: ${I??""}; --thumb-color: ${q??""}`),Ie.disabled=o(ne),fr(E,t()[o(Q)]),E.disabled=o(ne)},[()=>_(o(v).name),()=>m(o(v).name,t()[o(Q)])]),P(se,ve)};Pe(W,se=>{o(v).type==="toggle"?se(Ce):se(Se,!1)},!0)}P(R,K)};Pe(k,R=>{o(v).type==="xypad"?R(A):R(O,!1)})}P(g,T)}),P(n,h),wt()}bt(["input","change","click"]);const Mv=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
  <path d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"/>
</svg>
`,Pv=`<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="48" height="48" viewBox="0 0 48 48">
<path fill="#1976D2" d="M38 14h-3c-5.514 0-10 4.486-10 10s4.486 10 10 10h3c5.514 0 10-4.486 10-10S43.514 14 38 14M38 30h-3c-3.309 0-6-2.691-6-6s2.691-6 6-6h3c3.309 0 6 2.691 6 6S41.309 30 38 30M13 14h-3C4.486 14 0 18.486 0 24s4.486 10 10 10h3c5.514 0 10-4.486 10-10S18.514 14 13 14M13 30h-3c-3.309 0-6-2.691-6-6s2.691-6 6-6h3c3.309 0 6 2.691 6 6S16.309 30 13 30"></path><path fill="#42A5F5" d="M33,22H15c-1.104,0-2,0.896-2,2s0.896,2,2,2h18c1.104,0,2-0.896,2-2S34.104,22,33,22"></path>
</svg>`;var Tv=B('<div class="empty-state svelte-25wvt7"><p>No devices added yet. Add a device to get started!</p></div>'),Lv=B('<div class="device-card svelte-25wvt7"><div class="device-header svelte-25wvt7"><div class="color-preview svelte-25wvt7"></div> <h3 class="svelte-25wvt7"> </h3> <!> <button class="settings-btn svelte-25wvt7" title="Device settings"><!></button> <button class="remove-btn svelte-25wvt7"><!></button></div> <!></div>'),Av=B("<option> </option>"),Ov=B(`<select id="link-select" class="svelte-25wvt7"><option>None</option><!></select> <small class="link-help svelte-25wvt7">Link this device to follow another device's values</small>`,1),Rv=B('<p class="no-devices svelte-25wvt7">No compatible devices available to link</p>'),Nv=B('<form method="dialog" class="svelte-25wvt7"><h3 class="svelte-25wvt7">Device Settings</h3> <div class="dialog-input-group svelte-25wvt7"><label for="name-input" class="svelte-25wvt7">Name:</label> <input id="name-input" type="text" placeholder="Device name" class="svelte-25wvt7"/> <small class="css-id-preview svelte-25wvt7"> </small></div> <div class="dialog-input-group svelte-25wvt7"><label for="channel-input" class="svelte-25wvt7">Starting channel (1-512):</label> <input id="channel-input" type="number" min="1" max="512"/> <small class="channel-range svelte-25wvt7"> </small></div> <div class="dialog-input-group svelte-25wvt7"><label for="link-select" class="svelte-25wvt7">Link to device:</label> <!></div> <div class="dialog-buttons svelte-25wvt7"><button type="button" class="svelte-25wvt7">Cancel</button> <button type="submit" class="svelte-25wvt7">Save</button></div></form>'),Fv=B('<div class="devices-container svelte-25wvt7"><div class="devices-list svelte-25wvt7"><!> <!></div> <dialog class="settings-dialog svelte-25wvt7"><!></dialog></div>');function Bv(n,e){yt(e,!0);let t=de(e,"devices",31,()=>be([])),r=V(null),i=V(null),s=V(""),a=V(1),l=V(null);function c(E){var I;S(i,E,!0),S(s,E.name,!0),S(a,E.startChannel+1),S(l,E.linkedTo||null,!0),(I=o(r))==null||I.showModal()}function u(){var E;(E=o(r))==null||E.close(),S(i,null),S(s,""),S(l,null)}function d(){var I;return(o(s).trim()||((I=o(i))==null?void 0:I.name)||"").toLowerCase().replace(/[^a-z0-9]/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,"")}function f(){if(!o(i)||!_(o(i),o(a)-1))return;const E=Math.max(0,Math.min(511,o(a)-1)),I=new Hr(o(i).id,o(i).type,E,o(s).trim()||o(i).name,o(l));if(I.defaultValues=[...o(i).defaultValues],o(l)!==null){const q=t().find(x=>x.id===o(l));if(q){const x=go(q.type,I.type,q.defaultValues,I.defaultValues);I.defaultValues=x}}e.dmxController&&I.defaultValues.forEach((q,x)=>{const b=I.startChannel+x;e.dmxController.setChannel(b,q)}),t(t().map(q=>q.id===o(i).id?I:q)),u()}function _(E,I){const q=Qe[E.type].channels,x=I+q;if(x>512||I<0)return!1;for(let b of t()){if(b.id===E.id)continue;const C=Qe[b.type].channels,L=b.startChannel,j=L+C;if(I<j&&x>L)return!1}return!0}function m(){try{const E=localStorage.getItem("dmx-devices");if(E){const I=JSON.parse(E);return{devices:I.devices.map(x=>{const b=new Hr(x.id,x.type,x.startChannel,x.name,x.linkedTo,x.cssId);return b.defaultValues=x.defaultValues||new Array(Qe[x.type].channels).fill(0),b}),nextId:I.nextId||1}}}catch(E){console.error("Failed to load from localStorage:",E)}return{devices:[],nextId:1}}const h=t().length===0?m():{devices:t(),nextId:null};t().length===0&&t(h.devices);const g=t().length>0?Math.max(...t().map(E=>E.id)):0;let v=V(be(Math.max(g+1,h.nextId||1)));nn(()=>{try{const E={devices:t().map(I=>({id:I.id,name:I.name,type:I.type,startChannel:I.startChannel,defaultValues:I.defaultValues,linkedTo:I.linkedTo})),nextId:o(v)};localStorage.setItem("dmx-devices",JSON.stringify(E))}catch(E){console.error("Failed to save to localStorage:",E)}});function D(){if(t().length===0)return 0;let E=0;return t().forEach(I=>{const q=I.startChannel+Qe[I.type].channels;q>E&&(E=q)}),E>=512?0:E}function T(E=e.selectedType){const I=D(),q=new Hr(Pt(v),E,I);t([...t(),q])}function k(){t(t().map(E=>(E.defaultValues=E.defaultValues.map(()=>0),E)))}function A(E){t(t().map(I=>(I.linkedTo===E&&(I.linkedTo=null),I)).filter(I=>I.id!==E))}function O(E,I,q){const x=new Hr(E.id,E.type,E.startChannel,E.name,E.linkedTo);x.defaultValues=[...E.defaultValues],x.defaultValues[I]=q,t(t().map(b=>b.id===E.id?x:b)),R(x),K(x)}function R(E){e.dmxController&&E.defaultValues.forEach((I,q)=>{const x=E.startChannel+q;e.dmxController.setChannel(x,I)})}function K(E){t(t().map(I=>{if(I.linkedTo===E.id){const q=new Hr(I.id,I.type,I.startChannel,I.name,I.linkedTo),x=go(E.type,I.type,E.defaultValues,I.defaultValues);return q.defaultValues=x,R(q),q}return I}))}function W(E){return t().filter(I=>I.id!==E.id&&!I.isLinked()&&Sv(E.type,I.type)&&I.linkedTo!==E.id)}function Ce(E){if(!E.linkedTo)return[];const I=t().find(q=>q.id===E.linkedTo);return I?ra(I.type,E.type):[]}nn(()=>{e.dmxController&&t().forEach(E=>{R(E)})});var Se={addDevice:T,clearAllDeviceValues:k},se=Fv(),Q=y(se),ne=y(Q);{var ve=E=>{var I=Tv();P(E,I)};Pe(ne,E=>{t().length===0&&E(ve)})}var ae=w(ne,2);Ge(ae,17,t,E=>E.id,(E,I,q)=>{var x=Lv(),b=y(x),C=y(b),L=w(C,2),j=y(L),z=w(L,2);{var $=ce=>{_t(ce,{get data(){return Pv}})};Pe(z,ce=>{o(I).isLinked()&&ce($)})}var xe=w(z,2);xe.__click=()=>c(o(I));var Ke=y(xe);_t(Ke,{get data(){return Mv}});var G=w(xe,2);G.__click=()=>A(o(I).id);var Z=y(G);_t(Z,{get data(){return uc}});var pe=w(b,2);{let ce=Be(()=>Ce(o(I)));xa(pe,{get deviceType(){return o(I).type},onChange:(ge,He)=>O(o(I),ge,He),get disabledChannels(){return o(ce)},get values(){return o(I).defaultValues},set values(ge){o(I).defaultValues=ge}})}ie(ce=>{Je(C,`background-color: ${ce??""}`),te(j,o(I).name)},[()=>gn(o(I).type,o(I).defaultValues)]),P(E,x)});var we=w(Q,2),Ee=y(we);{var Ie=E=>{var I=Nv(),q=w(y(I),2),x=w(y(q),2),b=w(x,2),C=y(b),L=w(q,2),j=w(y(L),2);let z;var $=w(j,2),xe=y($),Ke=w(L,2),G=w(y(Ke),2);{var Z=ke=>{var Ve=Ov(),Ye=et(Ve),N=y(Ye);N.value=(N.__value=null)??"";var ee=w(N);Ge(ee,17,()=>W(o(i)),We,(oe,le)=>{var ue=Av(),Oe=y(ue),Re={};ie(()=>{te(Oe,`${o(le).name??""} (${Qe[o(le).type].name??""})`),Re!==(Re=o(le).id)&&(ue.value=(ue.__value=o(le).id)??"")}),P(oe,ue)}),hn(Ye,()=>o(l),oe=>S(l,oe)),P(ke,Ve)},pe=ke=>{var Ve=Rv();P(ke,Ve)};Pe(G,ke=>{W(o(i)).length>0||o(i).isLinked()?ke(Z):ke(pe,!1)})}var ce=w(Ke,2),ge=y(ce);ge.__click=u;var He=w(ge,2);ie((ke,Ve,Ye)=>{te(C,`CSS ID: #${ke??""}`),z=Ze(j,1,"svelte-25wvt7",null,z,Ve),te(xe,`Device uses ${Qe[o(i).type].channels??""} channels
                        (Ch ${o(a)??""}-${o(a)+Qe[o(i).type].channels-1})`),He.disabled=Ye},[d,()=>({valid:_(o(i),o(a)-1),invalid:!_(o(i),o(a)-1)}),()=>!_(o(i),o(a)-1)]),_a("submit",I,ke=>{ke.preventDefault(),f()}),Ar(x,()=>o(s),ke=>S(s,ke)),Ar(j,()=>o(a),ke=>S(a,ke)),P(E,I)};Pe(Ee,E=>{o(i)&&E(Ie)})}return rn(we,E=>S(r,E),()=>o(r)),P(n,se),wt(Se)}bt(["click"]);const Vv=`<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="48" height="48" viewBox="0 0 48 48">
<path fill="#2196F3" d="M14 34L14 14 34 24z"></path>
</svg>`,Gv=`<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="48" height="48" viewBox="0 0 48 48">
<path fill="#2196F3" d="M15 14H21V34H15zM27 14H33V34H27z"></path>
</svg>`,jv=`<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="48" height="48" viewBox="0 0 48 48">
<path fill="#FF3D00" d="M14 14H34V34H14z"></path>
</svg>`,ia={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>n*(2-n),easeInOutQuad:n=>n<.5?2*n*n:-1+(4-2*n)*n,easeInCubic:n=>n*n*n,easeOutCubic:n=>--n*n*n+1,easeInOutCubic:n=>n<.5?4*n*n*n:(n-1)*(2*n-2)*(2*n-2)+1,easeInSine:n=>1-Math.cos(n*Math.PI/2),easeOutSine:n=>Math.sin(n*Math.PI/2),easeInOutSine:n=>-(Math.cos(Math.PI*n)-1)/2};function Us(n,e,t,r="linear"){const s=(ia[r]||ia.linear)(t);return Math.round(n+(e-n)*s)}function Kv(){return Object.keys(ia)}class Ki{constructor(e,t,r,i="linear"){this.time=e,this.deviceId=t,this.values=[...r],this.easing=i}}class Qr{constructor(e=1e4,t=!0){this.duration=e,this.loop=t,this.keypoints=[],this.playing=!1,this.currentTime=0,this.lastUpdateTime=null}addKeypoint(e){this.keypoints.push(e),this.sortKeypoints()}removeKeypoint(e){const t=this.keypoints.indexOf(e);t>-1&&this.keypoints.splice(t,1)}updateKeypoint(e,t){const r=this.keypoints.indexOf(e);r>-1&&(this.keypoints[r]=t,this.sortKeypoints())}sortKeypoints(){this.keypoints.sort((e,t)=>e.time-t.time)}getDeviceKeypoints(e){return this.keypoints.filter(t=>t.deviceId===e)}getSurroundingKeypoints(e,t){const r=this.getDeviceKeypoints(e);if(r.length===0)return{before:null,after:null};let i=null,s=null;for(let a=0;a<r.length;a++)if(r[a].time<=t&&(i=r[a]),r[a].time>=t&&!s){s=r[a];break}return{before:i,after:s}}getDeviceValuesAtTime(e,t,r){const i=this.getDeviceKeypoints(e);if(i.length===0)return r;const s=i.find(f=>f.time===0),a=s?s.values:r,l=i[0],c=i[i.length-1];if(t<l.time){const f=l.time-0,_=t/f;return a.map((h,g)=>{const v=l.values[g];return Us(h,v,_,l.easing)})}if(t>c.time){const f=this.duration-c.time,_=(t-c.time)/f;return c.values.map((h,g)=>{const v=a[g];return Us(h,v,_,"linear")})}const{before:u,after:d}=this.getSurroundingKeypoints(e,t);if(u&&d&&u===d)return u.values;if(u&&d&&u!==d){const f=d.time-u.time,_=(t-u.time)/f;return u.values.map((h,g)=>{const v=d.values[g];return Us(h,v,_,d.easing)})}return u?u.values:a}getAllDeviceValuesAtTime(e){const t=new Map;return e.forEach(r=>{const i=this.getDeviceValuesAtTime(r.id,this.currentTime,r.defaultValues);t.set(r.id,i)}),t}play(){this.playing=!0,this.lastUpdateTime=Date.now()}pause(){this.playing=!1,this.lastUpdateTime=null}stop(){this.playing=!1,this.currentTime=0,this.lastUpdateTime=null}update(){if(!this.playing)return!1;const e=Date.now(),t=e-this.lastUpdateTime;return this.lastUpdateTime=e,this.currentTime+=t,this.currentTime>=this.duration&&(this.loop?this.currentTime=this.currentTime%this.duration:(this.currentTime=this.duration,this.pause())),!0}seek(e){this.currentTime=Math.max(0,Math.min(e,this.duration)),this.playing&&(this.lastUpdateTime=Date.now())}toJSON(){return{duration:this.duration,loop:this.loop,keypoints:this.keypoints.map(e=>({time:e.time,deviceId:e.deviceId,values:e.values,easing:e.easing}))}}static fromJSON(e){const t=new Qr(e.duration,e.loop);return t.keypoints=e.keypoints.map(r=>new Ki(r.time,r.deviceId,r.values,r.easing)),t}}var Uv=B('<div class="empty-state svelte-1swyu47"><p class="svelte-1swyu47">No devices</p> <p class="svelte-1swyu47">Add devices in the Devices tab</p></div>'),$v=B('<div class="device-name-row svelte-1swyu47"><div class="color-preview svelte-1swyu47"></div> <span> </span></div>'),Hv=B('<div class="time-marker svelte-1swyu47"><span class="svelte-1swyu47"></span></div>'),zv=B('<div class="empty-tracks svelte-1swyu47"></div>'),qv=B('<div class="gradient-segment svelte-1swyu47"></div>'),Wv=B("<div></div>"),Yv=B('<div class="device-track svelte-1swyu47"><!> <!></div>'),Xv=B("<option> </option>"),Jv=B('<dialog class="keypoint-dialog svelte-1swyu47"><div class="dialog-header svelte-1swyu47"><div class="dialog-title svelte-1swyu47"><div class="color-preview-large svelte-1swyu47"></div> <span> </span></div> <button class="close-btn svelte-1swyu47">Ã</button></div> <div class="dialog-time svelte-1swyu47"> </div> <div class="dialog-content svelte-1swyu47"><div class="dialog-field svelte-1swyu47"><label class="svelte-1swyu47">Easing:</label> <select class="svelte-1swyu47"></select></div> <!> <button class="delete-btn svelte-1swyu47">Delete Keypoint</button></div></dialog>'),Zv=B('<div class="timeline-view svelte-1swyu47"><div class="controls-bar svelte-1swyu47"><div class="playback-controls svelte-1swyu47"><button class="svelte-1swyu47"><!></button> <button title="Stop" class="svelte-1swyu47"><!></button></div> <div class="time-display svelte-1swyu47"> </div> <button class="settings-button svelte-1swyu47">Settings</button> <button class="clear-button svelte-1swyu47">Clear</button></div> <div class="timeline-editor svelte-1swyu47"><div class="device-names svelte-1swyu47"><div class="device-names-header svelte-1swyu47">Devices</div> <!></div> <div class="timeline-tracks-container svelte-1swyu47"><div class="timeline-tracks svelte-1swyu47"><div class="time-ruler svelte-1swyu47"></div> <div class="playhead svelte-1swyu47"></div> <div class="timeline-end svelte-1swyu47"></div> <!></div></div></div></div> <!> <dialog class="settings-dialog svelte-1swyu47"><form method="dialog" class="svelte-1swyu47"><h3 class="svelte-1swyu47">Timeline Settings</h3> <div class="dialog-field svelte-1swyu47"><label class="svelte-1swyu47">Duration (seconds):</label> <input type="number" min="1" step="1" class="svelte-1swyu47"/></div> <div class="dialog-field svelte-1swyu47"><label class="svelte-1swyu47"><input type="checkbox" class="svelte-1swyu47"/> Loop playback</label></div> <div class="dialog-actions svelte-1swyu47"><button type="button" class="svelte-1swyu47">Cancel</button> <button type="button" class="svelte-1swyu47">Save</button></div></form></dialog>',1);function Qv(n,e){yt(e,!0);let t=de(e,"dmxController",3,null),r=de(e,"devices",19,()=>[]);const i=Be(()=>r().filter(M=>{if(!M.linkedTo)return!0;const H=r().find(Me=>Me.id===M.linkedTo);if(!H)return!0;const ye=ra(H.type,M.type),Ne=Qe[M.type].channels;return ye.length<Ne}));function s(M){if(!M.linkedTo)return[];const H=r().find(ye=>ye.id===M.linkedTo);return H?ra(H.type,M.type):[]}function a(M){o(_);const H=o(d).getDeviceValuesAtTime(M.id,o(_),M.defaultValues);return gn(M.type,H)}function l(M,H){return gn(H.type,M.values)}function c(M){if(!M||!M.defaultValues||!M.type)return[];const H=G(M),ye=[],Ne=H.find(ht=>ht.time===0),Me=Ne?Ne.values:M.defaultValues;if(!Me||Me.length===0)return[];const ze=gn(M.type,Me);if(H.length===0)ye.push({left:0,width:o(ae),gradient:ze});else{const ht=H[0],qt=H[H.length-1];if(ht.time>0){const qe=l(ht,M);ye.push({left:0,width:ht.time/o(g)*o(ae),gradient:`linear-gradient(to right, ${ze}, ${qe})`})}for(let qe=0;qe<H.length-1;qe++){const Ue=H[qe],pt=H[qe+1],jn=l(Ue,M),jt=l(pt,M);ye.push({left:Ue.time/o(g)*o(ae),width:(pt.time-Ue.time)/o(g)*o(ae),gradient:`linear-gradient(to right, ${jn}, ${jt})`})}if(qt.time<o(g)){const qe=l(qt,M);ye.push({left:qt.time/o(g)*o(ae),width:(o(g)-qt.time)/o(g)*o(ae),gradient:`linear-gradient(to right, ${qe}, ${ze})`})}}return ye}function u(){try{const M=localStorage.getItem("dmx-timeline");if(M){const H=JSON.parse(M);return Qr.fromJSON(H)}}catch(M){console.error("Failed to load timeline from localStorage:",M)}return new Qr(3e4,!0)}let d=V(be(u())),f=V(null),_=V(be(o(d).currentTime)),m=V(0),h=V(be(o(d).playing)),g=V(be(o(d).duration)),v=V(null),D=V(null),T=V(be([])),k=V("linear"),A=Kv(),O=V(null),R=V(null),K=V(null),W=V(0),Ce=V(0),Se=V(!1),se=V(null),Q=V(o(d).duration/1e3),ne=V(be(o(d).loop));const ve=100,ae=Be(()=>o(g)/1e3*ve);nn(()=>{o(m),o(g);try{const M=o(d).toJSON();localStorage.setItem("dmx-timeline",JSON.stringify(M))}catch(M){console.error("Failed to save timeline to localStorage:",M)}});function we(M){const H=Math.floor(M/1e3),ye=Math.floor(H/60),Ne=H%60,Me=Math.floor(M%1e3/10);return`${String(ye).padStart(2,"0")}:${String(Ne).padStart(2,"0")}.${String(Me).padStart(2,"0")}`}function Ee(){if(o(f))return;function M(){o(d).update()&&(S(_,o(d).currentTime,!0),E()),S(f,requestAnimationFrame(M),!0)}M()}function Ie(){o(f)&&(cancelAnimationFrame(o(f)),S(f,null))}function E(){if(!t())return;const M=o(d).getAllDeviceValuesAtTime(r());r().forEach(H=>{const ye=M.get(H.id);ye&&ye.forEach((Ne,Me)=>{const ze=H.startChannel+Me;t().setChannel(ze,Ne)})})}function I(){o(d).playing?o(d).pause():(o(d).play(),Ee()),S(h,o(d).playing,!0)}function q(){o(d).stop(),S(_,o(d).currentTime,!0),S(h,o(d).playing,!0),Ie(),E()}function x(M){S(Se,!0),L(M),document.addEventListener("mousemove",b),document.addEventListener("mouseup",C)}function b(M){o(Se)&&L(M)}function C(){S(Se,!1),document.removeEventListener("mousemove",b),document.removeEventListener("mouseup",C)}function L(M){const H=document.querySelector(".time-ruler");if(!H)return;const ye=H.getBoundingClientRect(),Ne=M.clientX-ye.left,Me=Math.max(0,Math.min(o(g),Ne/o(ae)*o(g)));o(d).seek(Me),S(_,o(d).currentTime,!0),E()}function j(M,H){if(M.target.classList.contains("keypoint"))return;const ye=M.currentTarget.getBoundingClientRect(),Me=(M.clientX-ye.left)/o(ae)*o(g),ze=new Ki(Math.round(Me),H.id,[...H.defaultValues],"linear");o(d).addKeypoint(ze),Pt(m),z(H,ze)}function z(M,H){S(v,H,!0),S(D,M,!0),S(T,[...H.values],!0),S(k,H.easing,!0),S(R,`keypoint-${M.id}-${H.time}`),requestAnimationFrame(()=>{var ye;(ye=o(O))==null||ye.show()})}function $(){var M;(M=o(O))==null||M.close(),S(v,null),S(D,null),S(R,null)}function xe(){if(!o(v)||!o(D))return;const M=new Ki(o(v).time,o(D).id,o(T),o(k));o(d).updateKeypoint(o(v),M),Pt(m),S(v,M,!0),E()}function Ke(){o(v)&&confirm("Delete this keypoint?")&&(o(d).removeKeypoint(o(v)),Pt(m),$(),E())}function G(M){return o(m),o(d).getDeviceKeypoints(M.id)}function Z(M){return M.time/o(g)*o(ae)}function pe(){return o(_)/o(g)*o(ae)}function ce(M,H,ye){M.stopPropagation(),M.preventDefault(),S(K,H,!0),S(W,M.clientX,!0),S(Ce,H.time,!0),document.addEventListener("mousemove",ge),document.addEventListener("mouseup",He)}function ge(M){if(!o(K))return;const ye=(M.clientX-o(W))/o(ae)*o(g);let Ne=Math.round(o(Ce)+ye);if(Ne=Math.max(0,Math.min(o(g),Ne)),!o(i).find(ht=>ht.id===o(K).deviceId))return;const ze=new Ki(Ne,o(K).deviceId,o(K).values,o(K).easing);o(d).updateKeypoint(o(K),ze),S(K,ze,!0),o(v)===o(K)&&S(v,ze,!0),Pt(m)}function He(M){document.removeEventListener("mousemove",ge),document.removeEventListener("mouseup",He),S(K,null)}function ke(){var M;S(Q,o(d).duration/1e3),S(ne,o(d).loop,!0),(M=o(se))==null||M.showModal()}function Ve(){var M;o(d).duration=Math.max(1,o(Q))*1e3,o(d).loop=o(ne),S(g,o(d).duration,!0),o(d).currentTime>o(d).duration&&(o(d).currentTime=o(d).duration,S(_,o(d).currentTime,!0)),Pt(m),(M=o(se))==null||M.close()}function Ye(){confirm("Clear all keypoints? This cannot be undone.")&&(S(d,new Qr(3e4,!0),!0),S(_,0),S(g,o(d).duration,!0),S(h,o(d).playing,!0),Pt(m),$())}nn(()=>()=>{Ie()});var N=Zv(),ee=et(N),oe=y(ee),le=y(oe),ue=y(le);ue.__click=I;var Oe=y(ue);{let M=Be(()=>o(h)?Gv:Vv);_t(Oe,{get data(){return o(M)}})}var Re=w(ue,2);Re.__click=q;var re=y(Re);_t(re,{get data(){return jv}});var Y=w(le,2),Te=y(Y),De=w(Y,2);De.__click=ke;var Xe=w(De,2);Xe.__click=Ye;var X=w(oe,2),_e=y(X),J=w(y(_e),2);{var me=M=>{var H=Uv();P(M,H)},Le=M=>{var H=sr(),ye=et(H);Ge(ye,17,()=>o(i),We,(Ne,Me)=>{var ze=$v(),ht=y(ze),qt=w(ht,2),qe=y(qt);ie(Ue=>{Je(ht,`background-color: ${Ue??""}`),te(qe,o(Me).name)},[()=>a(o(Me))]),P(Ne,ze)}),P(M,H)};Pe(J,M=>{o(i).length===0?M(me):M(Le,!1)})}var rt=w(_e,2),zt=y(rt),cn=y(zt);cn.__mousedown=x,Ge(cn,21,()=>Array(Math.ceil(o(g)/1e3)),We,(M,H,ye)=>{var Ne=Hv();Je(Ne,`left: ${ye*ve}px`);var Me=y(Ne);Me.textContent=`${ye}s`,P(M,Ne)});var Sn=w(cn,2),ct=w(Sn,2),Bn=w(ct,2);{var Dn=M=>{var H=zv();P(M,H)},Vn=M=>{var H=sr(),ye=et(H);Ge(ye,17,()=>o(i),We,(Ne,Me)=>{var ze=Yv();ze.__click=qe=>j(qe,o(Me));var ht=y(ze);Ge(ht,17,()=>c(o(Me)),We,(qe,Ue)=>{var pt=qv();ie(()=>Je(pt,`left: ${o(Ue).left??""}px; width: ${o(Ue).width??""}px; background: ${o(Ue).gradient??""}`)),P(qe,pt)});var qt=w(ht,2);Ge(qt,17,()=>G(o(Me)),We,(qe,Ue)=>{var pt=Wv();let jn;pt.__mousedown=jt=>ce(jt,o(Ue),o(Me)),pt.__click=jt=>{jt.stopPropagation(),o(K)||z(o(Me),o(Ue))},ie((jt,Ci,Ts)=>{Bt(pt,"id",`keypoint-${o(Me).id??""}-${o(Ue).time??""}`),jn=Ze(pt,1,"keypoint svelte-1swyu47",null,jn,{selected:o(v)===o(Ue),dragging:o(K)===o(Ue)}),Je(pt,`left: ${jt??""}px; --keypoint-color: ${Ci??""}; anchor-name: --keypoint-${o(Me).id??""}-${o(Ue).time??""}`),Bt(pt,"title",`${Ts??""} - ${o(Ue).easing??""}`)},[()=>Z(o(Ue)),()=>l(o(Ue),o(Me)),()=>we(o(Ue).time)]),P(qe,pt)}),P(Ne,ze)}),P(M,H)};Pe(Bn,M=>{o(i).length===0?M(Dn):M(Vn,!1)})}var Gn=w(ee,2);{var Ps=M=>{var H=Jv(),ye=y(H),Ne=y(ye),Me=y(Ne),ze=w(Me,2),ht=y(ze),qt=w(Ne,2);qt.__click=$;var qe=w(ye,2),Ue=y(qe),pt=w(qe,2),jn=y(pt),jt=w(y(jn),2);jt.__change=xe,Ge(jt,21,()=>A,We,(un,Kn)=>{var Ei=Xv(),_c=y(Ei),La={};ie(()=>{te(_c,o(Kn)),La!==(La=o(Kn))&&(Ei.value=(Ei.__value=o(Kn))??"")}),P(un,Ei)});var Ci=w(jn,2);{let un=Be(()=>s(o(D)));xa(Ci,{get deviceType(){return o(D).type},onChange:xe,get disabledChannels(){return o(un)},get values(){return o(T)},set values(Kn){S(T,Kn,!0)}})}var Ts=w(Ci,2);Ts.__click=Ke,rn(H,un=>S(O,un),()=>o(O)),ie((un,Kn)=>{Je(H,`position-anchor: --${o(R)??""}`),Je(Me,`background-color: ${un??""}`),te(ht,o(D).name),te(Ue,Kn)},[()=>gn(o(D).type,o(T)),()=>we(o(v).time)]),hn(jt,()=>o(k),un=>S(k,un)),P(M,H)};Pe(Gn,M=>{o(v)&&o(D)&&o(R)&&M(Ps)})}var ka=w(Gn,2),dc=y(ka),Ma=w(y(dc),2),fc=w(y(Ma),2),Pa=w(Ma,2),vc=y(Pa),hc=y(vc),pc=w(Pa,2),Ta=y(pc);Ta.__click=()=>{var M;return(M=o(se))==null?void 0:M.close()};var gc=w(Ta,2);gc.__click=Ve,rn(ka,M=>S(se,M),()=>o(se)),ie((M,H,ye)=>{Bt(ue,"title",o(h)?"Pause":"Play"),te(Te,`${M??""} / ${H??""}`),Je(zt,`width: ${o(ae)??""}px`),Je(Sn,`left: ${ye??""}px`),Je(ct,`left: ${o(ae)??""}px`)},[()=>we(o(_)),()=>we(o(g)),pe]),Ar(fc,()=>o(Q),M=>S(Q,M)),Sl(hc,()=>o(ne),M=>S(ne,M)),P(n,N),wt()}bt(["click","mousedown","change"]);var eh=B("<button><!></button>");function Nt(n,e){let t=de(e,"variant",3,"primary"),r=de(e,"disabled",3,!1),i=de(e,"onclick",3,null),s=de(e,"type",3,"button");var a=eh();a.__click=function(...c){var u;(u=i())==null||u.apply(this,c)};var l=y(a);gl(l,()=>e.children),ie(()=>{Ze(a,1,`button ${t()??""}`,"svelte-18f749u"),a.disabled=r(),Bt(a,"type",s())}),P(n,a)}bt(["click"]);var th=B('<dialog class="dialog svelte-pz05fu"><div class="dialog-header svelte-pz05fu"><h2 class="svelte-pz05fu"> </h2> <button class="close-btn svelte-pz05fu">Ã</button></div> <div class="dialog-body svelte-pz05fu"><!></div></dialog>');function sa(n,e){yt(e,!0);let t=de(e,"onclose",3,null),r=de(e,"dialogRef",15,null);function i(){var _;(_=r())==null||_.close(),t()&&t()()}var s=th(),a=y(s),l=y(a),c=y(l),u=w(l,2);u.__click=i;var d=w(a,2),f=y(d);gl(f,()=>e.children),rn(s,_=>r(_),()=>r()),ie(()=>te(c,e.title)),P(n,s),wt()}bt(["click"]);var nh=B("<button><!></button>");function Rr(n,e){let t=de(e,"onclick",3,null),r=de(e,"disabled",3,!1),i=de(e,"size",3,"medium");var s=nh();s.__click=function(...l){var c;(c=t())==null||c.apply(this,l)};var a=y(s);_t(a,{get data(){return e.icon}}),ie(()=>{Ze(s,1,`icon-button ${i()??""}`,"svelte-cwtv5f"),s.disabled=r(),Bt(s,"aria-label",e.label),Bt(s,"title",e.label)}),P(n,s)}bt(["click"]);var rh=B("<style>{@html previewCSS}</style>"),ih=B('<div class="animation-preview svelte-1age76"><div class="preview-container svelte-1age76"><div class="preview-box svelte-1age76"></div></div> <div class="preview-controls svelte-1age76"><button class="preview-button svelte-1age76"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" class="svelte-1age76"><path d="M8 5v14l11-7z"></path></svg> Play</button> <button class="preview-button svelte-1age76"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" class="svelte-1age76"><path d="M6 6h12v12H6z"></path></svg> Stop</button></div></div> <!>',1);function sh(n,e){yt(e,!0),de(e,"animationVersion",3,0);let t=V(null),r=V(!1);function i(){!e.animation||!o(t)||(o(t).style.animation="none",S(r,!1),setTimeout(()=>{o(t).style.animation=`preview-${e.animation.name} 3s linear infinite`,S(r,!0)},10))}function s(){o(t)&&(o(t).style.animation="none",S(r,!1))}var a=ih(),l=et(a),c=y(l),u=y(c);rn(u,g=>S(t,g),()=>o(t));var d=w(c,2),f=y(d);f.__click=i;var _=w(f,2);_.__click=s;var m=w(l,2);{var h=g=>{var v=rh();P(g,v)};Pe(m,g=>{e.animation&&g(h)})}ie(()=>{f.disabled=!e.animation,_.disabled=!e.animation||!o(r)}),P(n,a),wt()}bt(["click"]);var ah=B('<p class="empty-state svelte-nhkann">No animations yet. Create one to get started!</p>'),oh=B('<div><span class="animation-name svelte-nhkann"> </span> <span class="keyframe-count svelte-nhkann"> </span> <!></div>'),lh=B('<div class="gradient-segment svelte-nhkann"></div>'),ch=B('<div><div class="keyframe-time svelte-nhkann"> </div></div>'),uh=B('<div class="keyframe-editor svelte-nhkann"><h4 class="svelte-nhkann"> </h4> <!> <div class="property-actions svelte-nhkann"><!></div></div>'),dh=B('<p class="empty-state svelte-nhkann">Select a keyframe to edit its values</p>'),fh=B('<div class="panel-header svelte-nhkann"><h3 class="svelte-nhkann"> </h3> <div class="device-type-badge svelte-nhkann"> </div></div> <div class="timeline-container svelte-nhkann"><div class="timeline-instructions svelte-nhkann">Click on the timeline to add a keyframe</div> <div class="timeline svelte-nhkann"><!> <!></div></div> <!>',1),vh=B('<div class="empty-state-large svelte-nhkann"><p>Select an animation to edit, or create a new one</p></div>'),hh=B('<div class="preview-section svelte-nhkann"><h4 class="svelte-nhkann">Animation Preview</h4> <!></div> <div class="css-section svelte-nhkann"><h4 class="svelte-nhkann">Generated CSS</h4> <pre class="css-output svelte-nhkann"> </pre></div>',1),ph=B('<p class="empty-state svelte-nhkann">No animation selected</p>'),gh=B("<option> </option>"),_h=B('<form method="dialog"><h3>Create New Animation</h3> <div class="dialog-field svelte-nhkann"><label for="animation-name" class="svelte-nhkann">Animation Name:</label> <input id="animation-name" type="text" placeholder="e.g., rainbow, pulse, sweep" class="svelte-nhkann"/></div> <div class="dialog-field svelte-nhkann"><label for="device-type" class="svelte-nhkann">Device Type:</label> <select id="device-type" class="svelte-nhkann"></select></div> <div class="dialog-buttons svelte-nhkann"><!> <!></div></form>'),mh=B('<h3>Delete Animation</h3> <p> </p> <p class="warning svelte-nhkann">This cannot be undone.</p> <div class="dialog-buttons svelte-nhkann"><!> <!></div>',1),yh=B('<div class="animations-view svelte-nhkann"><div class="left-panel svelte-nhkann"><div class="panel-header svelte-nhkann"><h3 class="svelte-nhkann">Animations</h3> <!></div> <div class="animations-list svelte-nhkann"><!></div></div> <div class="center-panel svelte-nhkann"><!></div> <div class="right-panel svelte-nhkann"><div class="panel-header svelte-nhkann"><h3 class="svelte-nhkann">Preview & CSS</h3></div> <!></div></div> <!> <!>',1);function wh(n,e){yt(e,!0),de(e,"devices",19,()=>[]);const t='<svg viewBox="0 0 24 24" fill="currentColor"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>',r='<svg viewBox="0 0 24 24" fill="currentColor"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>';let i=V(null),s=V(null),a=V(be([])),l=V(null),c=V(""),u=V("RGB"),d=V(null),f=V(null),_=V(be([0,0,0])),m=V(null),h=V(800),g=V(null),v=V(0),D=V(0),T=V(!1),k=V(0);function A(){if(S(a,e.animationLibrary.getAll(),!0),o(i)){const N=o(a).find(ee=>ee.name===o(i).name);N?S(i,N,!0):(S(i,null),S(s,null))}}Gr(()=>{A()});function O(N){S(i,N,!0),S(s,null)}function R(){var N;S(c,""),S(u,"RGB"),(N=o(l))==null||N.showModal()}function K(){var ue;if(!o(c).trim())return;const N=o(u),ee=Qe[N].channels,oe=new Array(ee).fill(0),le=new hs(o(c).trim(),N);le.addKeyframe(0,[...oe]),le.addKeyframe(1,[...oe]),e.animationLibrary.add(le),A(),O(le),(ue=o(l))==null||ue.close()}function W(N){var ee;S(f,N,!0),(ee=o(d))==null||ee.showModal()}function Ce(){var N;o(f)&&(e.animationLibrary.remove(o(f).name),A(),(N=o(d))==null||N.close(),S(f,null))}function Se(N){if(!o(i))return;const ee=Qe[o(i).deviceType].channels,oe=new Array(ee).fill(0);o(i).addKeyframe(N,oe),S(i,o(i),!0),Pt(k),e.animationLibrary.save();const le=o(i).keyframes.findIndex(ue=>Math.abs(ue.time-N)<.001);le!==-1&&Q(le)}function se(N){if(!o(i)||o(i).keyframes.length<=2){alert("Animation must have at least 2 keyframes");return}o(i).keyframes=o(i).keyframes.filter((ee,oe)=>oe!==N),S(i,o(i),!0),Pt(k),e.animationLibrary.save(),S(s,null)}function Q(N){if(!o(i))return;S(s,N,!0);const ee=o(i).keyframes[N];S(_,[...ee.values],!0)}function ne(){if(!o(i)||o(s)===null)return;const N=o(i).keyframes[o(s)];N.values=[...o(_)],S(i,o(i),!0),Pt(k),e.animationLibrary.save()}function ve(N){if(!o(i)||N.target.classList.contains("timeline-keyframe-marker"))return;const ee=N.currentTarget.getBoundingClientRect(),oe=N.clientX-ee.left,le=Math.max(0,Math.min(1,oe/o(h)));Se(le)}function ae(N,ee,oe){N.stopPropagation(),N.preventDefault(),S(g,{keyframe:ee,index:oe},!0),S(v,N.clientX,!0),S(D,ee.time,!0),S(T,!1),document.addEventListener("mousemove",we),document.addEventListener("mouseup",Ee)}function we(N){if(!o(g)||!o(i))return;const ee=N.clientX-o(v);Math.abs(ee)>3&&S(T,!0);const oe=ee/o(h);let le=o(D)+oe;le=Math.max(0,Math.min(1,le));const ue=o(g).keyframe;ue.time=le,o(i).keyframes=[...o(i).keyframes].sort((Re,re)=>Re.time-re.time),S(i,o(i),!0);const Oe=o(i).keyframes.indexOf(ue);S(s,Oe,!0),o(g).index=Oe,Pt(k)}function Ee(){o(g)&&(document.removeEventListener("mousemove",we),document.removeEventListener("mouseup",Ee),e.animationLibrary.save(),S(g,null))}function Ie(N){return o(k),N.time*o(h)}let E=Be(()=>(o(k),o(i)?o(i).getGradientSegments(o(h)):[])),I=Be(()=>(o(k),o(i)?o(i).keyframes:[]));var q=yh(),x=et(q),b=y(x),C=y(b),L=w(y(C),2);Rr(L,{icon:t,onclick:R,title:"Create new animation"});var j=w(C,2),z=y(j);{var $=N=>{var ee=ah();P(N,ee)},xe=N=>{var ee=sr(),oe=et(ee);Ge(oe,17,()=>o(a),We,(le,ue)=>{var Oe=oh();let Re;Oe.__click=()=>O(o(ue));var re=y(Oe),Y=y(re),Te=w(re,2),De=y(Te),Xe=w(Te,2);Rr(Xe,{icon:r,onclick:X=>{X.stopPropagation(),W(o(ue))},size:"small",title:"Delete animation"}),ie(()=>{var X;Re=Ze(Oe,1,"animation-item svelte-nhkann",null,Re,{selected:((X=o(i))==null?void 0:X.name)===o(ue).name}),te(Y,o(ue).name),te(De,`${o(ue).keyframes.length??""} keyframes`)}),P(le,Oe)}),P(N,ee)};Pe(z,N=>{o(a).length===0?N($):N(xe,!1)})}var Ke=w(b,2),G=y(Ke);{var Z=N=>{var ee=fh(),oe=et(ee),le=y(oe),ue=y(le),Oe=w(le,2),Re=y(Oe),re=w(oe,2),Y=w(y(re),2);Y.__click=ve;var Te=y(Y);Ge(Te,17,()=>o(E),We,(J,me)=>{var Le=lh();ie(()=>Je(Le,`left: ${o(me).left??""}px; width: ${o(me).width??""}px; background: ${o(me).gradient??""}`)),P(J,Le)});var De=w(Te,2);Ge(De,19,()=>o(I),(J,me)=>J.time+"-"+me,(J,me,Le)=>{var rt=ch();let zt;rt.__mousedown=ct=>ae(ct,o(me),o(Le)),rt.__click=ct=>{ct.stopPropagation(),o(T)||Q(o(Le))};var cn=y(rt),Sn=y(cn);ie((ct,Bn,Dn,Vn)=>{var Gn;zt=Ze(rt,1,"timeline-keyframe-marker svelte-nhkann",null,zt,{selected:o(s)===o(Le),dragging:((Gn=o(g))==null?void 0:Gn.keyframe)===o(me)}),Je(rt,`left: ${ct??""}px; --keyframe-color: ${Bn??""}`),Bt(rt,"title",`${Dn??""}%`),te(Sn,`${Vn??""}%`)},[()=>Ie(o(me)),()=>o(i).getKeyframeColor(o(me)),()=>(o(me).time*100).toFixed(0),()=>(o(me).time*100).toFixed(0)]),P(J,rt)}),rn(Y,J=>S(m,J),()=>o(m));var Xe=w(re,2);{var X=J=>{var me=uh(),Le=y(me),rt=y(Le),zt=w(Le,2);xa(zt,{get deviceType(){return o(i).deviceType},onChange:ne,get values(){return o(_)},set values(ct){S(_,ct,!0)}});var cn=w(zt,2),Sn=y(cn);{let ct=Be(()=>o(i).keyframes.length<=2);Nt(Sn,{onclick:()=>se(o(s)),get disabled(){return o(ct)},children:(Bn,Dn)=>{var Vn=Dt("Delete Keyframe");P(Bn,Vn)},$$slots:{default:!0}})}ie(ct=>te(rt,`Keyframe at ${ct??""}%`),[()=>(o(i).keyframes[o(s)].time*100).toFixed(0)]),P(J,me)},_e=J=>{var me=dh();P(J,me)};Pe(Xe,J=>{o(s)!==null?J(X):J(_e,!1)})}ie(()=>{te(ue,o(i).name),te(Re,Qe[o(i).deviceType].name)}),Xu(Y,"clientWidth",J=>S(h,J)),P(N,ee)},pe=N=>{var ee=vh();P(N,ee)};Pe(G,N=>{o(i)?N(Z):N(pe,!1)})}var ce=w(Ke,2),ge=w(y(ce),2);{var He=N=>{var ee=hh(),oe=et(ee),le=w(y(oe),2);sh(le,{get animation(){return o(i)},get animationVersion(){return o(k)}});var ue=w(oe,2),Oe=w(y(ue),2),Re=y(Oe);ie(re=>te(Re,re),[()=>o(i).toCSS()]),P(N,ee)},ke=N=>{var ee=ph();P(N,ee)};Pe(ge,N=>{o(i)?N(He):N(ke,!1)})}var Ve=w(x,2);sa(Ve,{get dialogRef(){return o(l)},set dialogRef(N){S(l,N,!0)},children:(N,ee)=>{var oe=_h(),le=w(y(oe),2),ue=w(y(le),2);ha(ue,!0);var Oe=w(le,2),Re=w(y(Oe),2);Ge(Re,21,()=>Object.entries(Qe),We,(De,Xe)=>{var X=Be(()=>bo(o(Xe),2));let _e=()=>o(X)[0],J=()=>o(X)[1];var me=gh(),Le=y(me),rt={};ie(()=>{te(Le,J().name),rt!==(rt=_e())&&(me.value=(me.__value=_e())??"")}),P(De,me)});var re=w(Oe,2),Y=y(re);Nt(Y,{type:"button",onclick:()=>{var De;return(De=o(l))==null?void 0:De.close()},children:(De,Xe)=>{var X=Dt("Cancel");P(De,X)},$$slots:{default:!0}});var Te=w(Y,2);Nt(Te,{type:"submit",primary:!0,children:(De,Xe)=>{var X=Dt("Create");P(De,X)},$$slots:{default:!0}}),_a("submit",oe,De=>{De.preventDefault(),K()}),Ar(ue,()=>o(c),De=>S(c,De)),hn(Re,()=>o(u),De=>S(u,De)),P(N,oe)},$$slots:{default:!0}});var Ye=w(Ve,2);sa(Ye,{get dialogRef(){return o(d)},set dialogRef(N){S(d,N,!0)},children:(N,ee)=>{var oe=mh(),le=w(et(oe),2),ue=y(le),Oe=w(le,4),Re=y(Oe);Nt(Re,{onclick:()=>{var Y;return(Y=o(d))==null?void 0:Y.close()},children:(Y,Te)=>{var De=Dt("Cancel");P(Y,De)},$$slots:{default:!0}});var re=w(Re,2);Nt(re,{onclick:Ce,primary:!0,children:(Y,Te)=>{var De=Dt("Delete");P(Y,De)},$$slots:{default:!0}}),ie(()=>{var Y;return te(ue,`Are you sure you want to delete "${((Y=o(f))==null?void 0:Y.name)??""}"?`)}),P(N,oe)},$$slots:{default:!0}}),P(n,q),wt()}bt(["click","mousedown"]);var bh=B('<div class="listening-indicator svelte-an69h5"><div class="pulse-dot svelte-an69h5"></div> Listening for inputs...</div>'),Sh=B('<p class="empty-state svelte-an69h5">No inputs detected yet. Start listening to detect inputs!</p>'),Dh=B('<div class="input-color-badge svelte-an69h5"></div>'),Ch=B('<input type="text" class="input-name-edit svelte-an69h5"/>'),Eh=B('<div class="input-name svelte-an69h5"> </div>'),Ih=B("<!> <!>",1),xh=B("<!> <!>",1),kh=B('<div class="input-item svelte-an69h5"><!> <div class="input-icon svelte-an69h5"><!></div> <div class="input-info svelte-an69h5"><!> <div class="input-details svelte-an69h5"><!> </div></div> <div class="input-actions svelte-an69h5"><!></div></div>'),Mh=B('<div class="inputs-view svelte-an69h5"><div class="left-panel svelte-an69h5"><div class="panel-header svelte-an69h5"><h3 class="svelte-an69h5">Listen for Inputs</h3></div> <div class="listen-section svelte-an69h5"><p class="instructions svelte-an69h5">Press any MIDI button, keyboard key, Stream Deck button, or move any MIDI control to detect and save it automatically.</p> <div class="button-group svelte-an69h5"><!> <!></div> <!></div></div> <div class="right-panel svelte-an69h5"><div class="panel-header svelte-an69h5"><h3 class="svelte-an69h5">Saved Inputs</h3></div> <div class="inputs-list svelte-an69h5"><!></div></div></div>');function Ph(n,e){yt(e,!0);const t='<svg viewBox="0 0 24 24" fill="currentColor"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>',r='<svg viewBox="0 0 24 24" fill="currentColor"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>',i='<svg viewBox="0 0 24 24" fill="currentColor"><path d="M20 5H4c-1.1 0-1.99.9-1.99 2L2 17c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm-9 3h2v2h-2V8zm0 3h2v2h-2v-2zM8 8h2v2H8V8zm0 3h2v2H8v-2zm-1 2H5v-2h2v2zm0-3H5V8h2v2zm9 7H8v-2h8v2zm0-4h-2v-2h2v2zm0-3h-2V8h2v2zm3 3h-2v-2h2v2zm0-3h-2V8h2v2z"/></svg>',s='<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"/></svg>',a='<svg viewBox="0 0 24 24" fill="currentColor"><path d="M4 6h16v2H4zm0 5h16v2H4zm0 5h16v2H4z"/></svg>';let l=V(!1),c=V(be([])),u=V(null),d=V(""),f=[];async function _(){try{await e.inputController.requestStreamDeck()}catch(C){alert(`Failed to connect Stream Deck: ${C.message}

Please close the Elgato Stream Deck software and try again.`)}}function m(){S(l,!0);const C=e.inputController.getInputDevices();for(const L of C){const j=z=>{h({deviceId:L.id,controlId:z.controlId,type:z.velocity!==void 0?"trigger":"change",device:L})};L.on("trigger",j),L.on("change",j),f.push({device:L,event:"trigger",handler:j}),f.push({device:L,event:"change",handler:j})}e.inputController.on("deviceadded",g)}function h(C){if(!o(l))return;const{deviceId:L,controlId:j,device:z}=C;if(!o(c).find(xe=>xe.inputDeviceId===L&&xe.inputControlId===j)){const xe=D((z==null?void 0:z.name)||L,j),Ke=(z==null?void 0:z.type)==="hid"&&z.id!=="keyboard",G=new yi({name:xe,mode:"input",inputDeviceId:L,inputControlId:j,color:Ke?void 0:null});if(e.mappingLibrary.add(G),R(),Ke&&j.startsWith("button-")){const Z=parseInt(j.replace("button-",""));if(!isNaN(Z)&&Z>=0){const pe=e.inputController.inputDeviceManager.streamDeckManager,ce=L;pe.setButtonColor(ce,Z,G.color).catch(ge=>{console.warn(`Could not set button ${Z} color:`,ge)})}}}}function g(C){if(!o(l))return;const L=j=>{h({deviceId:C.id,controlId:j.controlId,type:j.velocity!==void 0?"trigger":"change",device:C})};C.on("trigger",L),C.on("change",L),f.push({device:C,event:"trigger",handler:L}),f.push({device:C,event:"change",handler:L})}function v(){S(l,!1);for(const{device:C,event:L,handler:j}of f)C.off(L,j);f=[],e.inputController.off("deviceadded",g)}function D(C,L){const j=C.replace(/\s+/g,"_").toLowerCase(),z=L.replace(/[^a-zA-Z0-9]/g,"_").toLowerCase();return`${j}_${z}`}function T(C){S(u,C,!0),S(d,C.name,!0)}function k(){!o(u)||!o(d).trim()||(o(u).name=o(d).trim(),e.mappingLibrary.save(),R(),S(u,null),S(d,""))}function A(){S(u,null),S(d,"")}async function O(C){const L=e.mappingLibrary.get(C);if(!L)return;const j=e.inputController.getInputDevice(L.inputDeviceId);if((j==null?void 0:j.type)==="hid"&&j.id!=="keyboard"&&L.inputControlId.startsWith("button-")){const z=parseInt(L.inputControlId.replace("button-",""));if(!isNaN(z)&&z>=0){const $=e.inputController.inputDeviceManager.streamDeckManager,xe=L.inputDeviceId;await $.clearButtonColor(xe,z)}}e.mappingLibrary.remove(C),R()}function R(){S(c,e.mappingLibrary.getAll().filter(C=>C.mode==="input"),!0)}function K(C){const L=e.inputController.getInputDevice(C);switch(L==null?void 0:L.type){case"keyboard":return i;case"midi":return s;case"hid":return a;default:return s}}async function W(){const C=e.inputController.inputDeviceManager.streamDeckManager;if(C.getConnectedDevices().length!==0)for(const j of o(c)){const z=e.inputController.getInputDevice(j.inputDeviceId);if((z==null?void 0:z.type)==="hid"&&z.id!=="keyboard"&&j.inputControlId.startsWith("button-")){const $=parseInt(j.inputControlId.replace("button-",""));if(!isNaN($)&&$>=0){const xe=j.inputDeviceId;await C.setButtonColor(xe,$,j.color)}}}}Gr(()=>{R(),e.inputController.on("deviceadded",C=>{C.type==="hid"&&setTimeout(()=>W(),500)}),setTimeout(()=>W(),1e3)}),vs(()=>{v()});var Ce=Mh(),Se=y(Ce),se=w(y(Se),2),Q=w(y(se),2),ne=y(Q);{var ve=C=>{Nt(C,{onclick:v,primary:!0,children:(L,j)=>{var z=Dt("Stop Listening");P(L,z)},$$slots:{default:!0}})},ae=C=>{Nt(C,{onclick:m,primary:!0,children:(L,j)=>{var z=Dt("Start Listening");P(L,z)},$$slots:{default:!0}})};Pe(ne,C=>{o(l)?C(ve):C(ae,!1)})}var we=w(ne,2);Nt(we,{onclick:_,children:(C,L)=>{var j=Dt("Connect Stream Deck");P(C,j)},$$slots:{default:!0}});var Ee=w(Q,2);{var Ie=C=>{var L=bh();P(C,L)};Pe(Ee,C=>{o(l)&&C(Ie)})}var E=w(Se,2),I=w(y(E),2),q=y(I);{var x=C=>{var L=Sh();P(C,L)},b=C=>{var L=sr(),j=et(L);Ge(j,17,()=>o(c),z=>z.id,(z,$)=>{var xe=kh(),Ke=y(xe);{var G=re=>{var Y=Dh();ie(()=>Je(Y,`background-color: ${o($).color??""}`)),P(re,Y)};Pe(Ke,re=>{o($).color&&re(G)})}var Z=w(Ke,2),pe=y(Z);pl(pe,()=>K(o($).inputDeviceId));var ce=w(Z,2),ge=y(ce);{var He=re=>{var Y=Ch();Y.__keydown=Te=>{Te.key==="Enter"&&k(),Te.key==="Escape"&&A()},ha(Y,!0),Ar(Y,()=>o(d),Te=>S(d,Te)),P(re,Y)},ke=re=>{var Y=Eh(),Te=y(Y);ie(()=>te(Te,o($).name)),P(re,Y)};Pe(ge,re=>{var Y;((Y=o(u))==null?void 0:Y.id)===o($).id?re(He):re(ke,!1)})}var Ve=w(ge,2),Ye=y(Ve);{var N=re=>{var Y=Dt();ie(Te=>te(Y,Te),[()=>e.inputController.getInputDevice(o($).inputDeviceId).name]),P(re,Y)},ee=re=>{var Y=Dt();ie(()=>te(Y,o($).inputDeviceId)),P(re,Y)};Pe(Ye,re=>{e.inputController.getInputDevice(o($).inputDeviceId)?re(N):re(ee,!1)})}var oe=w(Ye),le=w(ce,2),ue=y(le);{var Oe=re=>{var Y=Ih(),Te=et(Y);Nt(Te,{onclick:k,size:"small",children:(Xe,X)=>{var _e=Dt("Save");P(Xe,_e)},$$slots:{default:!0}});var De=w(Te,2);Nt(De,{onclick:A,size:"small",children:(Xe,X)=>{var _e=Dt("Cancel");P(Xe,_e)},$$slots:{default:!0}}),P(re,Y)},Re=re=>{var Y=xh(),Te=et(Y);Rr(Te,{icon:r,onclick:()=>T(o($)),title:"Rename input"});var De=w(Te,2);Rr(De,{icon:t,onclick:()=>O(o($).id),title:"Delete input"}),P(re,Y)};Pe(ue,re=>{var Y;((Y=o(u))==null?void 0:Y.id)===o($).id?re(Oe):re(Re,!1)})}ie(()=>te(oe,` â ${o($).inputControlId??""}`)),P(z,xe)}),P(C,L)};Pe(q,C=>{o(c).length===0?C(x):C(b,!1)})}P(n,Ce),wt()}bt(["keydown"]);var Th=B('<p class="warning svelte-17ww3d9">No inputs available. Go to the Inputs tab to detect and save inputs first.</p>'),Lh=B('<p class="warning svelte-17ww3d9">No animations available. Go to the Animations tab to create animations first.</p>'),Ah=B('<p class="warning svelte-17ww3d9">No devices available. Go to the Devices tab to add devices first.</p>'),Oh=B('<div class="type-info svelte-17ww3d9"><strong class="svelte-17ww3d9"> </strong> <span class="svelte-17ww3d9"> </span></div>'),Rh=B('<div class="trigger-types svelte-17ww3d9"><h4 class="svelte-17ww3d9">Trigger Types</h4> <!></div>'),Nh=B('<p class="empty-state svelte-17ww3d9">No triggers created yet. Click the + button to create one!</p>'),Fh=B('<div class="trigger-item svelte-17ww3d9"><div class="trigger-header svelte-17ww3d9"><div class="trigger-name svelte-17ww3d9"> </div> <!></div> <div class="trigger-details svelte-17ww3d9"><div class="detail-row svelte-17ww3d9"><span class="label svelte-17ww3d9">Input:</span> <span class="value svelte-17ww3d9"> </span></div> <div class="detail-row svelte-17ww3d9"><span class="label svelte-17ww3d9">Type:</span> <span> </span></div> <div class="detail-row svelte-17ww3d9"><span class="label svelte-17ww3d9">Device:</span> <span class="value svelte-17ww3d9"> </span></div> <div class="detail-row svelte-17ww3d9"><span class="label svelte-17ww3d9">Animation:</span> <span class="value svelte-17ww3d9"> </span></div> <div class="detail-row svelte-17ww3d9"><span class="label svelte-17ww3d9">Duration:</span> <span class="value svelte-17ww3d9"> </span></div> <div class="detail-row svelte-17ww3d9"><span class="label svelte-17ww3d9">Loop:</span> <span class="value svelte-17ww3d9"> </span></div> <div class="detail-row svelte-17ww3d9"><span class="label svelte-17ww3d9">CSS Class:</span> <span class="value css-class svelte-17ww3d9"> </span></div></div></div>'),Bh=B("<option> </option>"),Vh=B("<option> </option>"),Gh=B("<option> </option>"),jh=B("<option> </option>"),Kh=B("<option> </option>"),Uh=B('<form method="dialog"><h3>Create New Trigger</h3> <div class="dialog-field svelte-17ww3d9"><label for="trigger-input" class="svelte-17ww3d9">Input:</label> <select id="trigger-input" class="svelte-17ww3d9"></select></div> <div class="dialog-field svelte-17ww3d9"><label for="trigger-type" class="svelte-17ww3d9">Trigger Type:</label> <select id="trigger-type" class="svelte-17ww3d9"></select></div> <div class="dialog-field svelte-17ww3d9"><label for="trigger-device" class="svelte-17ww3d9">Device:</label> <select id="trigger-device" class="svelte-17ww3d9"></select></div> <div class="dialog-field svelte-17ww3d9"><label for="trigger-animation" class="svelte-17ww3d9">Animation:</label> <select id="trigger-animation" class="svelte-17ww3d9"></select></div> <div class="dialog-field svelte-17ww3d9"><label for="trigger-duration" class="svelte-17ww3d9">Duration (ms):</label> <input id="trigger-duration" type="number" min="100" step="100" class="svelte-17ww3d9"/></div> <div class="dialog-field svelte-17ww3d9"><label for="trigger-easing" class="svelte-17ww3d9">Easing:</label> <select id="trigger-easing" class="svelte-17ww3d9"></select></div> <div class="dialog-field checkbox-field svelte-17ww3d9"><label class="svelte-17ww3d9"><input type="checkbox" class="svelte-17ww3d9"/> Loop animation infinitely</label></div> <div class="dialog-buttons svelte-17ww3d9"><!> <!></div></form>'),$h=B('<div class="triggers-view svelte-17ww3d9"><div class="left-panel svelte-17ww3d9"><div class="panel-header svelte-17ww3d9"><h3 class="svelte-17ww3d9">Create Trigger</h3> <!></div> <div class="info-section svelte-17ww3d9"><!> <!> <!> <!></div></div> <div class="right-panel svelte-17ww3d9"><div class="panel-header svelte-17ww3d9"><h3 class="svelte-17ww3d9">Triggers</h3></div> <div class="triggers-list svelte-17ww3d9"><!></div></div></div> <!>',1);function Hh(n,e){yt(e,!0);let t=de(e,"devices",19,()=>[]);const r='<svg viewBox="0 0 24 24" fill="currentColor"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>',i='<svg viewBox="0 0 24 24" fill="currentColor"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>';let s=V(be([])),a=V(be([])),l=V(be([])),c=V(null),u=V(null),d=V("pressed"),f=V(null),_=V(null),m=V(1e3),h=V(!1),g=V("linear");const v=[{value:"pressed",label:"Pressed",description:"Trigger when key/button is pressed down"},{value:"not-pressed",label:"Not Pressed",description:"Active when key/button is NOT pressed"},{value:"always",label:"Always",description:"Infinite loop animation"}],D=["linear","ease","ease-in","ease-out","ease-in-out","cubic-bezier(0.4, 0.0, 0.2, 1)","cubic-bezier(0.68, -0.55, 0.265, 1.55)"];function T(){S(s,e.mappingLibrary.getAll().filter(G=>G.mode==="input"),!0),S(a,e.animationLibrary.getAll(),!0),S(l,e.mappingLibrary.getAll().filter(G=>G.mode==="trigger"),!0)}function k(){T()}function A(){var G,Z,pe,ce;S(u,((G=o(s)[0])==null?void 0:G.id)||null,!0),S(d,"pressed"),S(f,((Z=t()[0])==null?void 0:Z.id)||null,!0),S(_,((pe=o(a)[0])==null?void 0:pe.name)||null,!0),S(m,1e3),S(h,!1),S(g,"linear"),(ce=o(c))==null||ce.showModal()}function O(){var pe;if(!o(u)||!o(f)||!o(_))return;const G=e.mappingLibrary.get(o(u));if(!G)return;const Z=new yi({name:`${G.name}_${o(d)}_${o(_)}`,mode:"trigger",triggerType:o(d),inputDeviceId:G.inputDeviceId,inputControlId:G.inputControlId,animationName:o(_),targetDeviceIds:[o(f)],duration:o(m),easing:o(g),iterations:o(h)?"infinite":1});e.mappingLibrary.add(Z),T(),(pe=o(c))==null||pe.close()}function R(G){e.mappingLibrary.remove(G),T()}function K(G,Z){const pe=o(s).find(ce=>ce.inputDeviceId===G&&ce.inputControlId===Z);return(pe==null?void 0:pe.name)||`${G}_${Z}`}function W(G){const Z=t().find(pe=>pe.id===G);return(Z==null?void 0:Z.name)||G}function Ce(G){const Z=v.find(pe=>pe.value===G);return(Z==null?void 0:Z.label)||G}function Se(G){const Z=G.inputControlId.replace(/[^a-zA-Z0-9]/g,"_").toLowerCase(),pe=G.triggerType==="pressed"?"down":G.triggerType==="not-pressed"?"up":"always";return`${Z}_${pe}`}Gr(()=>{T(),e.mappingLibrary.on("changed",k)}),vs(()=>{e.mappingLibrary.off("changed",k)});var se=$h(),Q=et(se),ne=y(Q),ve=y(ne),ae=w(y(ve),2);{let G=Be(()=>o(s).length===0||o(a).length===0||t().length===0);Rr(ae,{icon:r,onclick:A,title:"Create new trigger",get disabled(){return o(G)}})}var we=w(ve,2),Ee=y(we);{var Ie=G=>{var Z=Th();P(G,Z)};Pe(Ee,G=>{o(s).length===0&&G(Ie)})}var E=w(Ee,2);{var I=G=>{var Z=Lh();P(G,Z)};Pe(E,G=>{o(a).length===0&&G(I)})}var q=w(E,2);{var x=G=>{var Z=Ah();P(G,Z)};Pe(q,G=>{t().length===0&&G(x)})}var b=w(q,2);{var C=G=>{var Z=Rh(),pe=w(y(Z),2);Ge(pe,17,()=>v,We,(ce,ge)=>{var He=Oh(),ke=y(He),Ve=y(ke),Ye=w(ke,2),N=y(Ye);ie(()=>{te(Ve,`${o(ge).label??""}:`),te(N,o(ge).description)}),P(ce,He)}),P(G,Z)};Pe(b,G=>{o(s).length>0&&o(a).length>0&&t().length>0&&G(C)})}var L=w(ne,2),j=w(y(L),2),z=y(j);{var $=G=>{var Z=Nh();P(G,Z)},xe=G=>{var Z=sr(),pe=et(Z);Ge(pe,17,()=>o(l),ce=>ce.id,(ce,ge)=>{var He=Fh(),ke=y(He),Ve=y(ke),Ye=y(Ve),N=w(Ve,2);Rr(N,{icon:i,onclick:()=>R(o(ge).id),title:"Delete trigger"});var ee=w(ke,2),oe=y(ee),le=w(y(oe),2),ue=y(le),Oe=w(oe,2),Re=w(y(Oe),2),re=y(Re),Y=w(Oe,2),Te=w(y(Y),2),De=y(Te),Xe=w(Y,2),X=w(y(Xe),2),_e=y(X),J=w(Xe,2),me=w(y(J),2),Le=y(me),rt=w(J,2),zt=w(y(rt),2),cn=y(zt),Sn=w(rt,2),ct=w(y(Sn),2),Bn=y(ct);ie((Dn,Vn,Gn,Ps)=>{te(Ye,o(ge).name),te(ue,Dn),Ze(Re,1,`value type-${o(ge).triggerType??""}`,"svelte-17ww3d9"),te(re,Vn),te(De,Gn),te(_e,o(ge).animationName),te(Le,`${o(ge).duration??""}ms`),te(cn,o(ge).iterations==="infinite"?"Yes":"No"),te(Bn,`.${Ps??""}`)},[()=>K(o(ge).inputDeviceId,o(ge).inputControlId),()=>Ce(o(ge).triggerType),()=>o(ge).targetDeviceIds.map(Dn=>W(Dn)).join(", "),()=>Se(o(ge))]),P(ce,He)}),P(G,Z)};Pe(z,G=>{o(l).length===0?G($):G(xe,!1)})}var Ke=w(Q,2);sa(Ke,{get dialogRef(){return o(c)},set dialogRef(G){S(c,G,!0)},children:(G,Z)=>{var pe=Uh(),ce=w(y(pe),2),ge=w(y(ce),2);Ge(ge,21,()=>o(s),We,(X,_e)=>{var J=Bh(),me=y(J),Le={};ie(()=>{te(me,o(_e).name),Le!==(Le=o(_e).id)&&(J.value=(J.__value=o(_e).id)??"")}),P(X,J)});var He=w(ce,2),ke=w(y(He),2);Ge(ke,21,()=>v,We,(X,_e)=>{var J=Vh(),me=y(J),Le={};ie(()=>{te(me,`${o(_e).label??""} - ${o(_e).description??""}`),Le!==(Le=o(_e).value)&&(J.value=(J.__value=o(_e).value)??"")}),P(X,J)});var Ve=w(He,2),Ye=w(y(Ve),2);Ge(Ye,21,t,We,(X,_e)=>{var J=Gh(),me=y(J),Le={};ie(()=>{te(me,o(_e).name),Le!==(Le=o(_e).id)&&(J.value=(J.__value=o(_e).id)??"")}),P(X,J)});var N=w(Ve,2),ee=w(y(N),2);Ge(ee,21,()=>o(a),We,(X,_e)=>{var J=jh(),me=y(J),Le={};ie(()=>{te(me,o(_e).name),Le!==(Le=o(_e).name)&&(J.value=(J.__value=o(_e).name)??"")}),P(X,J)});var oe=w(N,2),le=w(y(oe),2),ue=w(oe,2),Oe=w(y(ue),2);Ge(Oe,21,()=>D,We,(X,_e)=>{var J=Kh(),me=y(J),Le={};ie(()=>{te(me,o(_e)),Le!==(Le=o(_e))&&(J.value=(J.__value=o(_e))??"")}),P(X,J)});var Re=w(ue,2),re=y(Re),Y=y(re),Te=w(Re,2),De=y(Te);Nt(De,{type:"button",onclick:()=>{var X;return(X=o(c))==null?void 0:X.close()},children:(X,_e)=>{var J=Dt("Cancel");P(X,J)},$$slots:{default:!0}});var Xe=w(De,2);Nt(Xe,{type:"submit",primary:!0,children:(X,_e)=>{var J=Dt("Create Trigger");P(X,J)},$$slots:{default:!0}}),_a("submit",pe,X=>{X.preventDefault(),O()}),hn(ge,()=>o(u),X=>S(u,X)),hn(ke,()=>o(d),X=>S(d,X)),hn(Ye,()=>o(f),X=>S(f,X)),hn(ee,()=>o(_),X=>S(_,X)),Ar(le,()=>o(m),X=>S(m,X)),hn(Oe,()=>o(g),X=>S(g,X)),Sl(Y,()=>o(h),X=>S(h,X)),P(G,pe)},$$slots:{default:!0}}),P(n,se),wt()}var zh=B('<div class="pan-tilt-indicator svelte-kr8awf"></div>'),qh=B('<div class="device-item svelte-kr8awf"><div class="device-preview-container svelte-kr8awf"><div class="device-preview svelte-kr8awf"><!></div></div> <div class="device-info svelte-kr8awf"><div class="device-id svelte-kr8awf"> </div> <div class="device-name svelte-kr8awf"> </div></div></div>'),Wh=B('<div class="css-view svelte-kr8awf"><div class="left-column svelte-kr8awf"><div class="device-list svelte-kr8awf"></div> <div class="animation-targets svelte-kr8awf"></div></div> <div class="right-column svelte-kr8awf"><div class="css-toolbar svelte-kr8awf"><button class="restore-button svelte-kr8awf">Restore Default CSS</button></div> <pre class="css-editor svelte-kr8awf" contenteditable="true" spellcheck="false"></pre></div></div>');function Yh(n,e){yt(e,!0);let t=de(e,"devices",19,()=>[]),r=de(e,"isActive",3,!1);function i(){const x=localStorage.getItem("dmx-css");if(x)return x;const b=e.cssGenerator.generate(t());return b&&b.trim().length>200?b:`/* CSS Animation Mode

Target devices using ID selectors based on device names.
Example: "Moving Head 1" becomes #moving_head_1

Supported properties:
- color: Maps to RGB(W) channels
- opacity: Maps to dimmer channel
- translate: x â pan, y â tilt (for moving heads)
- --smoke-output: For smoke machines (0-255)

Example animations:
*/

@keyframes rainbow {
    0%   { color: rgb(255, 0, 0); }
    16%  { color: rgb(255, 127, 0); }
    33%  { color: rgb(255, 255, 0); }
    50%  { color: rgb(0, 255, 0); }
    66%  { color: rgb(0, 0, 255); }
    83%  { color: rgb(75, 0, 130); }
    100% { color: rgb(148, 0, 211); }
}

@keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.2; }
}

@keyframes pan-tilt {
    0%   { translate: 0% 0%; }
    25%  { translate: 100% 0%; }
    50%  { translate: 100% 100%; }
    75%  { translate: 0% 100%; }
    100% { translate: 0% 0%; }
}

/* Apply rainbow animation to all devices */
* {
    animation: rainbow 5s linear infinite;
}
`}let s=V(be(i())),a,l=be({}),c=be({}),u=be({}),d=V(localStorage.getItem("dmx-css")!==null),f,_,m,h,g=0;function v(x,b){switch(x){case"RGB":return[b.Red||0,b.Green||0,b.Blue||0];case"RGBA":return[b.Red||0,b.Green||0,b.Blue||0,b.Amber||0];case"RGBW":return[b.Red||0,b.Green||0,b.Blue||0,b.White||0];case"DIMMER":return[b.Intensity||0];case"SMOKE":return[b.Output||0];case"MOVING_HEAD":return[b.Pan||127,b.Tilt||127,b.Dimmer||0,b.Red||0,b.Green||0,b.Blue||0,b.White||0];case"FLAMETHROWER":return[b.Safety||0,b.Fuel||0];default:return console.warn(`Unknown device type: ${x}`),[]}}function D(){if(!e.cssSampler)return;g++,g%60===0&&console.log(`[CSSView] Animation loop running, frame ${g}`);const x=e.cssSampler.sampleAll(t());t().forEach(b=>{const C=x.get(b.id);if(!C)return;const L=v(b.type,C);if(C.Red!==void 0&&C.Green!==void 0&&C.Blue!==void 0){const j=C.White!==void 0?C.White:255,z=`rgba(${C.Red}, ${C.Green}, ${C.Blue}, ${j/255})`;l[b.id]!==z&&console.log(`[CSSView] Preview color updated for ${b.name}:`,{old:l[b.id],new:z}),l[b.id]=z}else if(C.Intensity!==void 0){const j=C.Intensity/255;c[b.id]=j}b.type==="MOVING_HEAD"&&C.Pan!==void 0&&C.Tilt!==void 0&&(u[b.id]={pan:C.Pan,tilt:C.Tilt}),e.dmxController&&r()&&T(b,L)}),a=requestAnimationFrame(D)}function T(x,b){if(e.dmxController)for(let C=0;C<b.length;C++){const L=x.startChannel+C;e.dmxController.setChannel(L,b[C])}}function k(x){const b=x.target.textContent;f&&(f.textContent=`@scope (.animation-targets) {
${b}
}`),S(s,b,!0),localStorage.setItem("dmx-css",b),S(d,!0)}function A(x){f&&(f.textContent=`@scope (.animation-targets) {
${x}
}`)}function O(){if(!confirm("This will discard your custom CSS and generate a clean stylesheet from your devices, animations, and triggers. Continue?"))return;localStorage.removeItem("dmx-css"),S(d,!1);const x=e.cssGenerator.generate(t());S(s,x,!0),h&&(h.textContent=x),A(x)}function R(x){const{type:b,mapping:C}=x;if(C.mode==="trigger")if(b==="add"){const L=C.toCSS(t());L&&W(L)}else b==="remove"&&Ce(C.cssClassName)}function K(x){const{type:b,animation:C}=x;if(b==="add"){const L=C.toCSS();L&&Se(L)}else b==="remove"&&se(C.name)}function W(x){let b=o(s);const C=/\/\*\s*===\s*Triggers\s*===\s*\*\//,L=b.match(C);if(L){const j=L.index+L[0].length;b=b.slice(0,j)+`
`+x+`
`+b.slice(j)}else b+=`

/* === Triggers === */
`+x+`
`;S(s,b,!0),h&&(h.textContent=b),A(b),localStorage.setItem("dmx-css",b)}function Ce(x){const b=new RegExp(`\\.${x}\\s+[^{]+\\{[^}]*\\}\\n?`,"g");let C=o(s).replace(b,"");S(s,C,!0),h&&(h.textContent=C),A(C),localStorage.setItem("dmx-css",C)}function Se(x){let b=o(s);const C=/\/\*\s*===\s*Animations\s*===\s*\*\//,L=b.match(C);if(L){const j=L.index+L[0].length;b=b.slice(0,j)+`
`+x+`
`+b.slice(j)}else{const j=/\/\*\s*===\s*Triggers\s*===\s*\*\//,z=b.match(j);if(z){const $=z.index;b=b.slice(0,$)+`/* === Animations === */
`+x+`

`+b.slice($)}else b+=`

/* === Animations === */
`+x+`
`}S(s,b,!0),h&&(h.textContent=b),A(b),localStorage.setItem("dmx-css",b)}function se(x){const b=new RegExp(`@keyframes\\s+${x}\\s*\\{[^}]*(?:\\{[^}]*\\}[^}]*)*\\}\\n?`,"g");let C=o(s).replace(b,"");S(s,C,!0),h&&(h.textContent=C),A(C),localStorage.setItem("dmx-css",C)}function Q(x){let b=o(s);const C=/\/\*\s*===\s*Default Device Values\s*===\s*\*\//,L=b.match(C);if(L){const z=b.slice(L.index+L[0].length).match(/\/\*\s*===\s*Animations\s*===\s*\*\//);if(z){const $=L.index+L[0].length+z.index;b=b.slice(0,$)+`
`+x+`
`+b.slice($)}else{const $=L.index+L[0].length;b=b.slice(0,$)+`
`+x+`
`+b.slice($)}}else{const j=b.indexOf("*/")+2;j>1?b=b.slice(0,j)+`

/* === Default Device Values === */
/* These selectors set the default state for each device */
`+x+`
`+b.slice(j):b=`/* === Default Device Values === */
`+x+`

`+b}S(s,b,!0),h&&(h.textContent=b),A(b),localStorage.setItem("dmx-css",b)}Gr(()=>{const x=document.createElement("style");x.id="css-property-definitions",x.textContent=`
/* CSS Custom Property Definitions */
@property --safety {
  syntax: "none | probably";
  inherits: false;
  initial-value: none;
}

@property --fuel {
  syntax: "<percentage>";
  inherits: false;
  initial-value: 0%;
}

@property --smoke-output {
  syntax: "<number>";
  inherits: false;
  initial-value: 0;
}
`,document.head.appendChild(x),f=document.createElement("style"),f.id="css-animation-styles",document.head.appendChild(f),_&&(m=document.createElement("div"),m.className="trigger-classes",_.appendChild(m)),e.cssSampler&&m&&(e.cssSampler.initialize(m),e.cssSampler.updateDevices(t())),e.triggerManager&&m&&e.triggerManager.setContainer(m),e.mappingLibrary.on("changed",R),e.animationLibrary.on("changed",K),h&&(h.textContent=o(s)),A(o(s)),t().forEach(b=>{l[b.id]=gn(b.type,b.defaultValues),c[b.id]=1,b.type==="MOVING_HEAD"&&(u[b.id]={pan:b.defaultValues[0]||127,tilt:b.defaultValues[1]||127})}),a||D()});let ne=new Set;nn(()=>{if(e.cssSampler&&t()){e.cssSampler.updateDevices(t());const x=new Set(t().map(C=>C.id)),b=t().filter(C=>!ne.has(C.id));if(b.length>0&&ne.size>0)for(const C of b){const L=e.cssGenerator._generateDeviceDefaults(C);L&&Q(L)}ne=x}}),vs(()=>{a&&(cancelAnimationFrame(a),a=null),f&&f.parentNode&&f.parentNode.removeChild(f);const x=document.getElementById("css-property-definitions");x&&x.parentNode&&x.parentNode.removeChild(x),e.mappingLibrary.off("changed",R),e.animationLibrary.off("changed",K)});var ve=Wh(),ae=y(ve),we=y(ae);Ge(we,21,t,x=>x.id,(x,b)=>{var C=qh(),L=y(C),j=y(L),z=y(j);{var $=ce=>{const ge=Be(()=>u[o(b).id]),He=Be(()=>o(ge).pan/255*100),ke=Be(()=>(1-o(ge).tilt/255)*100);var Ve=zh();ie(()=>Je(Ve,`left: ${o(He)??""}%; top: ${o(ke)??""}%`)),P(ce,Ve)};Pe(z,ce=>{o(b).type==="MOVING_HEAD"&&u[o(b).id]&&ce($)})}var xe=w(L,2),Ke=y(xe),G=y(Ke),Z=w(Ke,2),pe=y(Z);ie(ce=>{Je(j,`background-color: ${ce??""}; opacity: ${(c[o(b).id]||1)??""}`),te(G,`#${o(b).cssId??""}`),te(pe,o(b).name)},[()=>l[o(b).id]||gn(o(b).type,o(b).defaultValues)]),P(x,C)});var Ee=w(we,2);rn(Ee,x=>_=x,()=>_);var Ie=w(ae,2),E=y(Ie),I=y(E);I.__click=O;var q=w(E,2);q.__input=k,rn(q,x=>h=x,()=>h),P(n,ve),wt()}bt(["click","input"]);var Xh=B("<!> <main><!> <div><!></div> <div><!></div> <div><!></div> <div><!></div> <div><!></div> <div><!></div> <div><!></div></main>",1);function Jh(n,e){yt(e,!0);let t=V("devices"),r=V(!1),i=be(new ad),s=V("RGB"),a=V(null),l=V(be([])),c=be(new ld),u=be(new Cl),d=be(new El),f=be(new Il),_=be(new ud),m=be(new cd(c,u)),h=be(new Qf(u,f,d));nn(()=>{h.initialize()});async function g(){try{await i.connect(),S(r,!0)}catch($){alert("Failed to connect: "+$.message)}}function v(){i.disconnect(),S(r,!1)}function D(){var $;($=o(a))!=null&&$.addDevice&&o(a).addDevice(o(s))}function T(){var $;i&&i.clearUniverse(),($=o(a))!=null&&$.clearAllDeviceValues&&o(a).clearAllDeviceValues()}var k=Xh(),A=et(k);av(A,{onconnect:g,ondisconnect:v,get connected(){return o(r)}});var O=w(A,2),R=y(O);mv(R,{showAddDevice:!0,get deviceTypes(){return Qe},onAddDevice:D,onClearUniverse:T,get view(){return o(t)},set view($){S(t,$,!0)},get selectedType(){return o(s)},set selectedType($){S(s,$,!0)}});var K=w(R,2);let W;var Ce=y(K);rn(Bv(Ce,{get dmxController(){return i},get animationLibrary(){return c},get mappingLibrary(){return u},get inputController(){return h},get cssGenerator(){return m},get selectedType(){return o(s)},set selectedType($){S(s,$,!0)},get devices(){return o(l)},set devices($){S(l,$,!0)}}),$=>S(a,$,!0),()=>o(a));var Se=w(K,2);let se;var Q=y(Se);bv(Q,{get dmxController(){return i}});var ne=w(Se,2);let ve;var ae=y(ne);Qv(ae,{get dmxController(){return i},get devices(){return o(l)}});var we=w(ne,2);let Ee;var Ie=y(we);wh(Ie,{get animationLibrary(){return c},get cssGenerator(){return m},get devices(){return o(l)}});var E=w(we,2);let I;var q=y(E);Ph(q,{get inputController(){return h},get mappingLibrary(){return u}});var x=w(E,2);let b;var C=y(x);Hh(C,{get mappingLibrary(){return u},get animationLibrary(){return c},get devices(){return o(l)}});var L=w(x,2);let j;var z=y(L);{let $=Be(()=>o(t)==="css");Yh(z,{get dmxController(){return i},get devices(){return o(l)},get animationLibrary(){return c},get mappingLibrary(){return u},get cssGenerator(){return m},get cssSampler(){return _},get triggerManager(){return d},get isActive(){return o($)}})}ie(()=>{W=Ze(K,1,"view-container svelte-1n46o8q",null,W,{hidden:o(t)!=="devices"}),se=Ze(Se,1,"view-container svelte-1n46o8q",null,se,{hidden:o(t)!=="universe"}),ve=Ze(ne,1,"view-container svelte-1n46o8q",null,ve,{hidden:o(t)!=="timeline"}),Ee=Ze(we,1,"view-container svelte-1n46o8q",null,Ee,{hidden:o(t)!=="animations"}),I=Ze(E,1,"view-container svelte-1n46o8q",null,I,{hidden:o(t)!=="inputs"}),b=Ze(x,1,"view-container svelte-1n46o8q",null,b,{hidden:o(t)!=="triggers"}),j=Ze(L,1,"view-container svelte-1n46o8q",null,j,{hidden:o(t)!=="css"})}),P(n,k),wt()}Ru(Jh,{target:document.getElementById("app")});
