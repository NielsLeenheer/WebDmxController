var sc=Object.defineProperty;var As=r=>{throw TypeError(r)};var oc=(r,e,t)=>e in r?sc(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var Je=(r,e,t)=>oc(r,typeof e!="symbol"?e+"":e,t),Ka=(r,e,t)=>e.has(r)||As("Cannot "+t);var p=(r,e,t)=>(Ka(r,e,"read from private field"),t?t.call(r):e.get(r)),W=(r,e,t)=>e.has(r)?As("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),U=(r,e,t,n)=>(Ka(r,e,"write to private field"),n?n.call(r,t):e.set(r,t),t),He=(r,e,t)=>(Ka(r,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();const mo=!1;var ps=Array.isArray,lc=Array.prototype.indexOf,ms=Array.from,cc=Object.defineProperty,Vr=Object.getOwnPropertyDescriptor,_o=Object.getOwnPropertyDescriptors,uc=Object.prototype,dc=Array.prototype,_s=Object.getPrototypeOf,Ts=Object.isExtensible;function Xn(r){return typeof r=="function"}function fc(r){return r()}function es(r){for(var e=0;e<r.length;e++)r[e]()}function go(){var r,e,t=new Promise((n,i)=>{r=n,e=i});return{promise:t,resolve:r,reject:e}}function vc(r,e){if(Array.isArray(r))return r;if(!(Symbol.iterator in r))return Array.from(r);const t=[];for(const n of r)if(t.push(n),t.length===e)break;return t}const gt=2,va=4,ha=8,Er=16,Ir=32,vn=64,pa=128,ut=1024,kt=2048,fr=4096,Ot=8192,Sr=16384,gs=32768,ln=65536,Ns=1<<17,yo=1<<18,Gn=1<<19,wo=1<<20,zt=256,Yi=512,Xi=32768,ts=1<<21,ys=1<<22,Br=1<<23,ur=Symbol("$state"),bo=Symbol("legacy props"),hc=Symbol(""),wn=new class extends Error{constructor(){super(...arguments);Je(this,"name","StaleReactionError");Je(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function So(r){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function pc(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function mc(r){throw new Error("https://svelte.dev/e/effect_in_teardown")}function _c(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function gc(r){throw new Error("https://svelte.dev/e/effect_orphan")}function yc(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function wc(r){throw new Error("https://svelte.dev/e/props_invalid_value")}function bc(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Sc(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Cc(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Dc(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const ma=1,_a=2,Co=4,xc=8,Ec=16,Ic=1,kc=2,Do=4,Pc=8,Mc=16,Lc=1,Ac=2,lt=Symbol(),Tc="http://www.w3.org/1999/xhtml",Nc="@attach";function Rc(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function Oc(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}let Fc=!1;function xo(r){return r===this.v}function Vc(r,e){return r!=r?e==e:r!==e||r!==null&&typeof r=="object"||typeof r=="function"}function Eo(r){return!Vc(r,this.v)}let $n=!1,Bc=!1;function jc(){$n=!0}let We=null;function Nn(r){We=r}function yt(r,e=!1,t){We={p:We,i:!1,c:null,e:null,s:r,x:null,l:$n&&!e?{s:null,u:null,$:[]}:null}}function wt(r){var e=We,t=e.e;if(t!==null){e.e=null;for(var n of t)zo(n)}return r!==void 0&&(e.x=r),e.i=!0,We=e.p,r??{}}function Ci(){return!$n||We!==null&&We.l===null}let Wr=[];function Io(){var r=Wr;Wr=[],es(r)}function Dr(r){if(Wr.length===0&&!ai){var e=Wr;queueMicrotask(()=>{e===Wr&&Io()})}Wr.push(r)}function Gc(){for(;Wr.length>0;)Io()}function ko(r){var e=De;if(e===null)return Ie.f|=Br,r;if(e.f&gs)Rn(r,e);else{if(!(e.f&pa))throw r;e.b.error(r)}}function Rn(r,e){for(;e!==null;){if(e.f&pa)try{e.b.error(r);return}catch(t){r=t}e=e.parent}throw r}const Ai=new Set;let Re=null,ii=null,ct=null,lr=[],ga=null,rs=!1,ai=!1;var Cn,Dn,Yr,Xr,ui,xn,En,_t,ns,qr,Po,Mo;const sa=class sa{constructor(){W(this,_t);Je(this,"committed",!1);Je(this,"current",new Map);Je(this,"previous",new Map);W(this,Cn,new Set);W(this,Dn,new Set);W(this,Yr,0);W(this,Xr,0);W(this,ui,null);W(this,xn,[]);W(this,En,[]);Je(this,"skipped_effects",new Set);Je(this,"is_fork",!1)}process(e){var n;lr=[],ii=null,this.apply();var t={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const i of e)He(this,_t,ns).call(this,i,t);this.is_fork||He(this,_t,Po).call(this),p(this,Xr)>0||this.is_fork?(He(this,_t,qr).call(this,t.effects),He(this,_t,qr).call(this,t.render_effects),He(this,_t,qr).call(this,t.block_effects)):(ii=this,Re=null,Rs(t.render_effects),Rs(t.effects),ii=null,(n=p(this,ui))==null||n.resolve()),ct=null}capture(e,t){this.previous.has(e)||this.previous.set(e,t),e.f&Br||(this.current.set(e,e.v),ct==null||ct.set(e,e.v))}activate(){Re=this,this.apply()}deactivate(){Re=null,ct=null}flush(){if(this.activate(),lr.length>0){if(Lo(),Re!==null&&Re!==this)return}else p(this,Yr)===0&&this.process([]);this.deactivate()}discard(){for(const e of p(this,Dn))e(this);p(this,Dn).clear()}increment(e){U(this,Yr,p(this,Yr)+1),e&&U(this,Xr,p(this,Xr)+1)}decrement(e){U(this,Yr,p(this,Yr)-1),e&&U(this,Xr,p(this,Xr)-1),this.revive()}revive(){for(const e of p(this,xn))dt(e,kt),cn(e);for(const e of p(this,En))dt(e,fr),cn(e);U(this,xn,[]),U(this,En,[]),this.flush()}oncommit(e){p(this,Cn).add(e)}ondiscard(e){p(this,Dn).add(e)}settled(){return(p(this,ui)??U(this,ui,go())).promise}static ensure(){if(Re===null){const e=Re=new sa;Ai.add(Re),ai||sa.enqueue(()=>{Re===e&&e.flush()})}return Re}static enqueue(e){Dr(e)}apply(){}};Cn=new WeakMap,Dn=new WeakMap,Yr=new WeakMap,Xr=new WeakMap,ui=new WeakMap,xn=new WeakMap,En=new WeakMap,_t=new WeakSet,ns=function(e,t){var f;e.f^=ut;for(var n=e.first;n!==null;){var i=n.f,a=(i&(Ir|vn))!==0,o=a&&(i&ut)!==0,c=o||(i&Ot)!==0||this.skipped_effects.has(n);if(n.f&pa&&((f=n.b)!=null&&f.is_pending())&&(t={parent:t,effect:n,effects:[],render_effects:[],block_effects:[]}),!c&&n.fn!==null){a?n.f^=ut:i&va?t.effects.push(n):Un(n)&&(n.f&Er&&t.block_effects.push(n),Fn(n));var l=n.first;if(l!==null){n=l;continue}}var u=n.parent;for(n=n.next;n===null&&u!==null;)u===t.effect&&(He(this,_t,qr).call(this,t.effects),He(this,_t,qr).call(this,t.render_effects),He(this,_t,qr).call(this,t.block_effects),t=t.parent),n=u.next,u=u.parent}},qr=function(e){for(const t of e)(t.f&kt?p(this,xn):p(this,En)).push(t),dt(t,ut)},Po=function(){if(p(this,Xr)===0){for(const e of p(this,Cn))e();p(this,Cn).clear()}p(this,Yr)===0&&He(this,_t,Mo).call(this)},Mo=function(){var i;if(Ai.size>1){this.previous.clear();var e=ct,t=!0,n={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const a of Ai){if(a===this){t=!1;continue}const o=[];for(const[l,u]of this.current){if(a.current.has(l))if(t&&u!==a.current.get(l))a.current.set(l,u);else continue;o.push(l)}if(o.length===0)continue;const c=[...a.current.keys()].filter(l=>!this.current.has(l));if(c.length>0){const l=new Set,u=new Map;for(const f of o)Ao(f,c,l,u);if(lr.length>0){Re=a,a.apply();for(const f of lr)He(i=a,_t,ns).call(i,f,n);lr=[],a.deactivate()}}}Re=null,ct=e}this.committed=!0,Ai.delete(this)};let wr=sa;function $c(r){var e=ai;ai=!0;try{for(var t;;){if(Gc(),lr.length===0&&(Re==null||Re.flush(),lr.length===0))return ga=null,t;Lo()}}finally{ai=e}}function Lo(){var r=Sn;rs=!0;try{var e=0;for(Bs(!0);lr.length>0;){var t=wr.ensure();if(e++>1e3){var n,i;Kc()}t.process(lr),jr.clear()}}finally{rs=!1,Bs(r),ga=null}}function Kc(){try{yc()}catch(r){Rn(r,ga)}}let Jt=null;function Rs(r){var e=r.length;if(e!==0){for(var t=0;t<e;){var n=r[t++];if(!(n.f&(Sr|Ot))&&Un(n)&&(Jt=new Set,Fn(n),n.deps===null&&n.first===null&&n.nodes_start===null&&(n.teardown===null&&n.ac===null?Xo(n):n.fn=null),(Jt==null?void 0:Jt.size)>0)){jr.clear();for(const i of Jt){if(i.f&(Sr|Ot))continue;const a=[i];let o=i.parent;for(;o!==null;)Jt.has(o)&&(Jt.delete(o),a.push(o)),o=o.parent;for(let c=a.length-1;c>=0;c--){const l=a[c];l.f&(Sr|Ot)||Fn(l)}}Jt.clear()}}Jt=null}}function Ao(r,e,t,n){if(!t.has(r)&&(t.add(r),r.reactions!==null))for(const i of r.reactions){const a=i.f;a&gt?Ao(i,e,t,n):a&(ys|Er)&&!(a&kt)&&To(i,e,n)&&(dt(i,kt),cn(i))}}function To(r,e,t){const n=t.get(r);if(n!==void 0)return n;if(r.deps!==null)for(const i of r.deps){if(e.includes(i))return!0;if(i.f&gt&&To(i,e,t))return t.set(i,!0),!0}return t.set(r,!1),!1}function cn(r){for(var e=ga=r;e.parent!==null;){e=e.parent;var t=e.f;if(rs&&e===De&&t&Er&&!(t&yo))return;if(t&(vn|Ir)){if(!(t&ut))return;e.f^=ut}}lr.push(e)}function Uc(r){let e=0,t=Gr(0),n;return()=>{iu()&&(s(t),hn(()=>(e===0&&(n=hr(()=>r(()=>si(t)))),e+=1,()=>{Dr(()=>{e-=1,e===0&&(n==null||n(),n=void 0,si(t))})})))}}var Hc=ln|Gn|pa;function zc(r,e,t){new qc(r,e,t)}var Kt,Ut,hs,nr,Jr,ir,Ht,xt,ar,_r,Ar,Zr,Tr,Qr,Nr,oa,st,Wc,Yc,is,zi,qi,as;class qc{constructor(e,t,n){W(this,st);Je(this,"parent");W(this,Kt,!1);W(this,Ut);W(this,hs,null);W(this,nr);W(this,Jr);W(this,ir);W(this,Ht,null);W(this,xt,null);W(this,ar,null);W(this,_r,null);W(this,Ar,null);W(this,Zr,0);W(this,Tr,0);W(this,Qr,!1);W(this,Nr,null);W(this,oa,Uc(()=>(U(this,Nr,Gr(p(this,Zr))),()=>{U(this,Nr,null)})));U(this,Ut,e),U(this,nr,t),U(this,Jr,n),this.parent=De.b,U(this,Kt,!!p(this,nr).pending),U(this,ir,Kn(()=>{De.b=this;{var i=He(this,st,is).call(this);try{U(this,Ht,Tt(()=>n(i)))}catch(a){this.error(a)}p(this,Tr)>0?He(this,st,qi).call(this):U(this,Kt,!1)}return()=>{var a;(a=p(this,Ar))==null||a.remove()}},Hc))}is_pending(){return p(this,Kt)||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!p(this,nr).pending}update_pending_count(e){He(this,st,as).call(this,e),U(this,Zr,p(this,Zr)+e),p(this,Nr)&&On(p(this,Nr),p(this,Zr))}get_effect_pending(){return p(this,oa).call(this),s(p(this,Nr))}error(e){var t=p(this,nr).onerror;let n=p(this,nr).failed;if(p(this,Qr)||!t&&!n)throw e;p(this,Ht)&&(at(p(this,Ht)),U(this,Ht,null)),p(this,xt)&&(at(p(this,xt)),U(this,xt,null)),p(this,ar)&&(at(p(this,ar)),U(this,ar,null));var i=!1,a=!1;const o=()=>{if(i){Oc();return}i=!0,a&&Dc(),wr.ensure(),U(this,Zr,0),p(this,ar)!==null&&bn(p(this,ar),()=>{U(this,ar,null)}),U(this,Kt,this.has_pending_snippet()),U(this,Ht,He(this,st,zi).call(this,()=>(U(this,Qr,!1),Tt(()=>p(this,Jr).call(this,p(this,Ut)))))),p(this,Tr)>0?He(this,st,qi).call(this):U(this,Kt,!1)};var c=Ie;try{Et(null),a=!0,t==null||t(e,o),a=!1}catch(l){Rn(l,p(this,ir)&&p(this,ir).parent)}finally{Et(c)}n&&Dr(()=>{U(this,ar,He(this,st,zi).call(this,()=>{wr.ensure(),U(this,Qr,!0);try{return Tt(()=>{n(p(this,Ut),()=>e,()=>o)})}catch(l){return Rn(l,p(this,ir).parent),null}finally{U(this,Qr,!1)}}))})}}Kt=new WeakMap,Ut=new WeakMap,hs=new WeakMap,nr=new WeakMap,Jr=new WeakMap,ir=new WeakMap,Ht=new WeakMap,xt=new WeakMap,ar=new WeakMap,_r=new WeakMap,Ar=new WeakMap,Zr=new WeakMap,Tr=new WeakMap,Qr=new WeakMap,Nr=new WeakMap,oa=new WeakMap,st=new WeakSet,Wc=function(){try{U(this,Ht,Tt(()=>p(this,Jr).call(this,p(this,Ut))))}catch(e){this.error(e)}U(this,Kt,!1)},Yc=function(){const e=p(this,nr).pending;e&&(U(this,xt,Tt(()=>e(p(this,Ut)))),wr.enqueue(()=>{var t=He(this,st,is).call(this);U(this,Ht,He(this,st,zi).call(this,()=>(wr.ensure(),Tt(()=>p(this,Jr).call(this,t))))),p(this,Tr)>0?He(this,st,qi).call(this):(bn(p(this,xt),()=>{U(this,xt,null)}),U(this,Kt,!1))}))},is=function(){var e=p(this,Ut);return p(this,Kt)&&(U(this,Ar,$r()),p(this,Ut).before(p(this,Ar)),e=p(this,Ar)),e},zi=function(e){var t=De,n=Ie,i=We;qt(p(this,ir)),Et(p(this,ir)),Nn(p(this,ir).ctx);try{return e()}catch(a){return ko(a),null}finally{qt(t),Et(n),Nn(i)}},qi=function(){const e=p(this,nr).pending;p(this,Ht)!==null&&(U(this,_r,document.createDocumentFragment()),p(this,_r).append(p(this,Ar)),Qo(p(this,Ht),p(this,_r))),p(this,xt)===null&&U(this,xt,Tt(()=>e(p(this,Ut))))},as=function(e){var t;if(!this.has_pending_snippet()){this.parent&&He(t=this.parent,st,as).call(t,e);return}U(this,Tr,p(this,Tr)+e),p(this,Tr)===0&&(U(this,Kt,!1),p(this,xt)&&bn(p(this,xt),()=>{U(this,xt,null)}),p(this,_r)&&(p(this,Ut).before(p(this,_r)),U(this,_r,null)))};function No(r,e,t,n){const i=Ci()?Di:ws;if(t.length===0&&r.length===0){n(e.map(i));return}var a=Re,o=De,c=Xc();function l(){Promise.all(t.map(u=>Jc(u))).then(u=>{c();try{n([...e.map(i),...u])}catch(f){o.f&Sr||Rn(f,o)}a==null||a.deactivate(),Ji()}).catch(u=>{Rn(u,o)})}r.length>0?Promise.all(r).then(()=>{c();try{return l()}finally{a==null||a.deactivate(),Ji()}}):l()}function Xc(){var r=De,e=Ie,t=We,n=Re;return function(a=!0){qt(r),Et(e),Nn(t),a&&(n==null||n.activate())}}function Ji(){qt(null),Et(null),Nn(null)}function Di(r){var e=gt|kt,t=Ie!==null&&Ie.f&gt?Ie:null;return De===null||t!==null&&t.f&zt?e|=zt:De.f|=Gn,{ctx:We,deps:null,effects:null,equals:xo,f:e,fn:r,reactions:null,rv:0,v:lt,wv:0,parent:t??De,ac:null}}function Jc(r,e){let t=De;t===null&&pc();var n=t.b,i=void 0,a=Gr(lt),o=!Ie,c=new Map;return cu(()=>{var g;var l=go();i=l.promise;try{Promise.resolve(r()).then(l.resolve,l.reject).then(()=>{u===Re&&u.committed&&u.deactivate(),Ji()})}catch(m){l.reject(m),Ji()}var u=Re;if(o){var f=!n.is_pending();n.update_pending_count(1),u.increment(f),(g=c.get(u))==null||g.reject(wn),c.delete(u),c.set(u,l)}const d=(m,h=void 0)=>{if(u.activate(),h)h!==wn&&(a.f|=Br,On(a,h));else{a.f&Br&&(a.f^=Br),On(a,m);for(const[y,v]of c){if(c.delete(y),y===u)break;v.reject(wn)}}o&&(n.update_pending_count(-1),u.decrement(f))};l.promise.then(d,m=>d(null,m||"unknown"))}),ba(()=>{for(const l of c.values())l.reject(wn)}),new Promise(l=>{function u(f){function d(){f===i?l(a):u(i)}f.then(d,d)}u(i)})}function ge(r){const e=Di(r);return el(e),e}function ws(r){const e=Di(r);return e.equals=Eo,e}function Ro(r){var e=r.effects;if(e!==null){r.effects=null;for(var t=0;t<e.length;t+=1)at(e[t])}}function Zc(r){for(var e=r.parent;e!==null;){if(!(e.f&gt))return e;e=e.parent}return null}function bs(r){var e,t=De;qt(Zc(r));try{r.f&=~Xi,Ro(r),e=il(r)}finally{qt(t)}return e}function Oo(r){var e=bs(r);if(r.equals(e)||(r.v=e,r.wv=rl()),!pn)if(ct!==null)ct.set(r,r.v);else{var t=(Fr||r.f&zt)&&r.deps!==null?fr:ut;dt(r,t)}}let ss=new Set;const jr=new Map;let Fo=!1;function Gr(r,e){var t={f:0,v:r,reactions:null,equals:xo,rv:0,wv:0};return t}function z(r,e){const t=Gr(r);return el(t),t}function Vo(r,e=!1,t=!0){var i;const n=Gr(r);return e||(n.equals=Eo),$n&&t&&We!==null&&We.l!==null&&((i=We.l).s??(i.s=[])).push(n),n}function C(r,e,t=!1){Ie!==null&&(!er||Ie.f&Ns)&&Ci()&&Ie.f&(gt|Er|ys|Ns)&&!(Ct!=null&&Ct.includes(r))&&Cc();let n=t?Ae(e):e;return On(r,n)}function On(r,e){if(!r.equals(e)){var t=r.v;pn?jr.set(r,e):jr.set(r,t),r.v=e;var n=wr.ensure();n.capture(r,t),r.f&gt&&(r.f&kt&&bs(r),dt(r,r.f&zt?fr:ut)),r.wv=rl(),Bo(r,kt),Ci()&&De!==null&&De.f&ut&&!(De.f&(Ir|vn))&&($t===null?du([r]):$t.push(r)),!n.is_fork&&ss.size>0&&!Fo&&Qc()}return e}function Qc(){Fo=!1;const r=Array.from(ss);for(const e of r)e.f&ut&&dt(e,fr),Un(e)&&Fn(e);ss.clear()}function Zi(r,e=1){var t=s(r),n=e===1?t++:t--;return C(r,t),n}function si(r){C(r,r.v+1)}function Bo(r,e){var t=r.reactions;if(t!==null)for(var n=Ci(),i=t.length,a=0;a<i;a++){var o=t[a],c=o.f;if(!(!n&&o===De)){var l=(c&kt)===0;l&&dt(o,e),c&gt?c&Xi||(o.f|=Xi,Bo(o,fr)):l&&(c&Er&&Jt!==null&&Jt.add(o),cn(o))}}}function Ae(r){if(typeof r!="object"||r===null||ur in r)return r;const e=_s(r);if(e!==uc&&e!==dc)return r;var t=new Map,n=ps(r),i=z(0),a=sn,o=c=>{if(sn===a)return c();var l=Ie,u=sn;Et(null),Gs(a);var f=c();return Et(l),Gs(u),f};return n&&t.set("length",z(r.length)),new Proxy(r,{defineProperty(c,l,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&bc();var f=t.get(l);return f===void 0?f=o(()=>{var d=z(u.value);return t.set(l,d),d}):C(f,u.value,!0),!0},deleteProperty(c,l){var u=t.get(l);if(u===void 0){if(l in c){const f=o(()=>z(lt));t.set(l,f),si(i)}}else C(u,lt),si(i);return!0},get(c,l,u){var m;if(l===ur)return r;var f=t.get(l),d=l in c;if(f===void 0&&(!d||(m=Vr(c,l))!=null&&m.writable)&&(f=o(()=>{var h=Ae(d?c[l]:lt),y=z(h);return y}),t.set(l,f)),f!==void 0){var g=s(f);return g===lt?void 0:g}return Reflect.get(c,l,u)},getOwnPropertyDescriptor(c,l){var u=Reflect.getOwnPropertyDescriptor(c,l);if(u&&"value"in u){var f=t.get(l);f&&(u.value=s(f))}else if(u===void 0){var d=t.get(l),g=d==null?void 0:d.v;if(d!==void 0&&g!==lt)return{enumerable:!0,configurable:!0,value:g,writable:!0}}return u},has(c,l){var g;if(l===ur)return!0;var u=t.get(l),f=u!==void 0&&u.v!==lt||Reflect.has(c,l);if(u!==void 0||De!==null&&(!f||(g=Vr(c,l))!=null&&g.writable)){u===void 0&&(u=o(()=>{var m=f?Ae(c[l]):lt,h=z(m);return h}),t.set(l,u));var d=s(u);if(d===lt)return!1}return f},set(c,l,u,f){var L;var d=t.get(l),g=l in c;if(n&&l==="length")for(var m=u;m<d.v;m+=1){var h=t.get(m+"");h!==void 0?C(h,lt):m in c&&(h=o(()=>z(lt)),t.set(m+"",h))}if(d===void 0)(!g||(L=Vr(c,l))!=null&&L.writable)&&(d=o(()=>z(void 0)),C(d,Ae(u)),t.set(l,d));else{g=d.v!==lt;var y=o(()=>Ae(u));C(d,y)}var v=Reflect.getOwnPropertyDescriptor(c,l);if(v!=null&&v.set&&v.set.call(f,u),!g){if(n&&typeof l=="string"){var x=t.get("length"),M=Number(l);Number.isInteger(M)&&M>=x.v&&C(x,M+1)}si(i)}return!0},ownKeys(c){s(i);var l=Reflect.ownKeys(c).filter(d=>{var g=t.get(d);return g===void 0||g.v!==lt});for(var[u,f]of t)f.v!==lt&&!(u in c)&&l.push(u);return l},setPrototypeOf(){Sc()}})}function Os(r){try{if(r!==null&&typeof r=="object"&&ur in r)return r[ur]}catch{}return r}function jo(r,e){return Object.is(Os(r),Os(e))}var Fs,Go,$o,Ko;function eu(){if(Fs===void 0){Fs=window,Go=/Firefox/.test(navigator.userAgent);var r=Element.prototype,e=Node.prototype,t=Text.prototype;$o=Vr(e,"firstChild").get,Ko=Vr(e,"nextSibling").get,Ts(r)&&(r.__click=void 0,r.__className=void 0,r.__attributes=null,r.__style=void 0,r.__e=void 0),Ts(t)&&(t.__t=void 0)}}function $r(r=""){return document.createTextNode(r)}function cr(r){return $o.call(r)}function xi(r){return Ko.call(r)}function _(r,e){return cr(r)}function he(r,e=!1){{var t=cr(r);return t instanceof Comment&&t.data===""?xi(t):t}}function w(r,e=1,t=!1){let n=r;for(;e--;)n=xi(n);return n}function tu(r){r.textContent=""}function Uo(){return!1}function Qi(r,e){if(e){const t=document.body;r.autofocus=!0,Dr(()=>{document.activeElement===t&&r.focus()})}}let Vs=!1;function ru(){Vs||(Vs=!0,document.addEventListener("reset",r=>{Promise.resolve().then(()=>{var e;if(!r.defaultPrevented)for(const t of r.target.elements)(e=t.__on_r)==null||e.call(t)})},{capture:!0}))}function ya(r){var e=Ie,t=De;Et(null),qt(null);try{return r()}finally{Et(e),qt(t)}}function wa(r,e,t,n=t){r.addEventListener(e,()=>ya(t));const i=r.__on_r;i?r.__on_r=()=>{i(),n(!0)}:r.__on_r=()=>n(!0),ru()}function Ho(r){De===null&&Ie===null&&gc(),Ie!==null&&Ie.f&zt&&De===null&&_c(),pn&&mc()}function nu(r,e){var t=e.last;t===null?e.last=e.first=r:(t.next=r,r.prev=t,e.last=r)}function vr(r,e,t,n=!0){var i=De;i!==null&&i.f&Ot&&(r|=Ot);var a={ctx:We,deps:null,nodes_start:null,nodes_end:null,f:r|kt,first:null,fn:e,last:null,next:null,parent:i,b:i&&i.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(t)try{Fn(a),a.f|=gs}catch(l){throw at(a),l}else e!==null&&cn(a);if(n){var o=a;if(t&&o.deps===null&&o.teardown===null&&o.nodes_start===null&&o.first===o.last&&!(o.f&Gn)&&(o=o.first,r&Er&&r&ln&&o!==null&&(o.f|=ln)),o!==null&&(o.parent=i,i!==null&&nu(o,i),Ie!==null&&Ie.f&gt&&!(r&vn))){var c=Ie;(c.effects??(c.effects=[])).push(o)}}return a}function iu(){return Ie!==null&&!er}function ba(r){const e=vr(ha,null,!1);return dt(e,ut),e.teardown=r,e}function xr(r){Ho();var e=De.f,t=!Ie&&(e&Ir)!==0&&(e&gs)===0;if(t){var n=We;(n.e??(n.e=[])).push(r)}else return zo(r)}function zo(r){return vr(va|wo,r,!1)}function au(r){return Ho(),vr(ha|wo,r,!0)}function su(r){wr.ensure();const e=vr(vn|Gn,r,!0);return(t={})=>new Promise(n=>{t.outro?bn(e,()=>{at(e),n(void 0)}):(at(e),n(void 0))})}function Ei(r){return vr(va,r,!1)}function ou(r,e){var t=We,n={effect:null,ran:!1,deps:r};t.l.$.push(n),n.effect=hn(()=>{r(),!n.ran&&(n.ran=!0,hr(e))})}function lu(){var r=We;hn(()=>{for(var e of r.l.$){e.deps();var t=e.effect;t.f&ut&&dt(t,fr),Un(t)&&Fn(t),e.ran=!1}})}function cu(r){return vr(ys|Gn,r,!0)}function hn(r,e=0){return vr(ha|e,r,!0)}function Z(r,e=[],t=[],n=[],i=!1){No(n,e,t,a=>{vr(i?va:ha,()=>r(...a.map(s)),!0)})}function Kn(r,e=0){var t=vr(Er|e,r,!0);return t}function Tt(r,e=!0){return vr(Ir|Gn,r,!0,e)}function qo(r){var e=r.teardown;if(e!==null){const t=pn,n=Ie;js(!0),Et(null);try{e.call(null)}finally{js(t),Et(n)}}}function Wo(r,e=!1){var t=r.first;for(r.first=r.last=null;t!==null;){const i=t.ac;i!==null&&ya(()=>{i.abort(wn)});var n=t.next;t.f&vn?t.parent=null:at(t,e),t=n}}function uu(r){for(var e=r.first;e!==null;){var t=e.next;e.f&Ir||at(e),e=t}}function at(r,e=!0){var t=!1;(e||r.f&yo)&&r.nodes_start!==null&&r.nodes_end!==null&&(Yo(r.nodes_start,r.nodes_end),t=!0),Wo(r,e&&!t),ea(r,0),dt(r,Sr);var n=r.transitions;if(n!==null)for(const a of n)a.stop();qo(r);var i=r.parent;i!==null&&i.first!==null&&Xo(r),r.next=r.prev=r.teardown=r.ctx=r.deps=r.fn=r.nodes_start=r.nodes_end=r.ac=null}function Yo(r,e){for(;r!==null;){var t=r===e?null:xi(r);r.remove(),r=t}}function Xo(r){var e=r.parent,t=r.prev,n=r.next;t!==null&&(t.next=n),n!==null&&(n.prev=t),e!==null&&(e.first===r&&(e.first=n),e.last===r&&(e.last=t))}function bn(r,e,t=!0){var n=[];Ss(r,n,!0),Jo(n,()=>{t&&at(r),e&&e()})}function Jo(r,e){var t=r.length;if(t>0){var n=()=>--t||e();for(var i of r)i.out(n)}else e()}function Ss(r,e,t){if(!(r.f&Ot)){if(r.f^=Ot,r.transitions!==null)for(const o of r.transitions)(o.is_global||t)&&e.push(o);for(var n=r.first;n!==null;){var i=n.next,a=(n.f&ln)!==0||(n.f&Ir)!==0&&(r.f&Er)!==0;Ss(n,e,a?t:!1),n=i}}}function Cs(r){Zo(r,!0)}function Zo(r,e){if(r.f&Ot){r.f^=Ot,r.f&ut||(dt(r,kt),cn(r));for(var t=r.first;t!==null;){var n=t.next,i=(t.f&ln)!==0||(t.f&Ir)!==0;Zo(t,i?e:!1),t=n}if(r.transitions!==null)for(const a of r.transitions)(a.is_global||e)&&a.in()}}function Qo(r,e){for(var t=r.nodes_start,n=r.nodes_end;t!==null;){var i=t===n?null:xi(t);e.append(t),t=i}}let Sn=!1;function Bs(r){Sn=r}let pn=!1;function js(r){pn=r}let Ie=null,er=!1;function Et(r){Ie=r}let De=null;function qt(r){De=r}let Ct=null;function el(r){Ie!==null&&(Ct===null?Ct=[r]:Ct.push(r))}let bt=null,Lt=0,$t=null;function du(r){$t=r}let tl=1,li=0,sn=li;function Gs(r){sn=r}let Fr=!1;function rl(){return++tl}function Un(r){var d;var e=r.f;if(e&kt)return!0;if(e&fr){var t=r.deps,n=(e&zt)!==0;if(e&gt&&(r.f&=~Xi),t!==null){var i,a,o=(e&Yi)!==0,c=n&&De!==null&&!Fr,l=t.length;if((o||c)&&(De===null||!(De.f&Sr))){var u=r,f=u.parent;for(i=0;i<l;i++)a=t[i],(o||!((d=a==null?void 0:a.reactions)!=null&&d.includes(u)))&&(a.reactions??(a.reactions=[])).push(u);o&&(u.f^=Yi),c&&f!==null&&!(f.f&zt)&&(u.f^=zt)}for(i=0;i<l;i++)if(a=t[i],Un(a)&&Oo(a),a.wv>r.wv)return!0}(!n||De!==null&&!Fr)&&dt(r,ut)}return!1}function nl(r,e,t=!0){var n=r.reactions;if(n!==null&&!(Ct!=null&&Ct.includes(r)))for(var i=0;i<n.length;i++){var a=n[i];a.f&gt?nl(a,e,!1):e===a&&(t?dt(a,kt):a.f&ut&&dt(a,fr),cn(a))}}function il(r){var y;var e=bt,t=Lt,n=$t,i=Ie,a=Fr,o=Ct,c=We,l=er,u=sn,f=r.f;bt=null,Lt=0,$t=null,Fr=(f&zt)!==0&&(er||!Sn||Ie===null),Ie=f&(Ir|vn)?null:r,Ct=null,Nn(r.ctx),er=!1,sn=++li,r.ac!==null&&(ya(()=>{r.ac.abort(wn)}),r.ac=null);try{r.f|=ts;var d=r.fn,g=d(),m=r.deps;if(bt!==null){var h;if(ea(r,Lt),m!==null&&Lt>0)for(m.length=Lt+bt.length,h=0;h<bt.length;h++)m[Lt+h]=bt[h];else r.deps=m=bt;if(!Fr||f&gt&&r.reactions!==null)for(h=Lt;h<m.length;h++)((y=m[h]).reactions??(y.reactions=[])).push(r)}else m!==null&&Lt<m.length&&(ea(r,Lt),m.length=Lt);if(Ci()&&$t!==null&&!er&&m!==null&&!(r.f&(gt|fr|kt)))for(h=0;h<$t.length;h++)nl($t[h],r);return i!==null&&i!==r&&(li++,$t!==null&&(n===null?n=$t:n.push(...$t))),r.f&Br&&(r.f^=Br),g}catch(v){return ko(v)}finally{r.f^=ts,bt=e,Lt=t,$t=n,Ie=i,Fr=a,Ct=o,Nn(c),er=l,sn=u}}function fu(r,e){let t=e.reactions;if(t!==null){var n=lc.call(t,r);if(n!==-1){var i=t.length-1;i===0?t=e.reactions=null:(t[n]=t[i],t.pop())}}t===null&&e.f&gt&&(bt===null||!bt.includes(e))&&(dt(e,fr),e.f&(zt|Yi)||(e.f^=Yi),Ro(e),ea(e,0))}function ea(r,e){var t=r.deps;if(t!==null)for(var n=e;n<t.length;n++)fu(r,t[n])}function Fn(r){var e=r.f;if(!(e&Sr)){dt(r,ut);var t=De,n=Sn;De=r,Sn=!0;try{e&Er?uu(r):Wo(r),qo(r);var i=il(r);r.teardown=typeof i=="function"?i:null,r.wv=tl;var a;mo&&Bc&&r.f&kt&&r.deps}finally{Sn=n,De=t}}}async function vu(){await Promise.resolve(),$c()}function s(r){var e=r.f,t=(e&gt)!==0;if(Ie!==null&&!er){var n=De!==null&&(De.f&Sr)!==0;if(!n&&!(Ct!=null&&Ct.includes(r))){var i=Ie.deps;if(Ie.f&ts)r.rv<li&&(r.rv=li,bt===null&&i!==null&&i[Lt]===r?Lt++:bt===null?bt=[r]:(!Fr||!bt.includes(r))&&bt.push(r));else{(Ie.deps??(Ie.deps=[])).push(r);var a=r.reactions;a===null?r.reactions=[Ie]:a.includes(Ie)||a.push(Ie)}}}else if(t&&r.deps===null&&r.effects===null){var o=r,c=o.parent;c!==null&&!(c.f&zt)&&(o.f^=zt)}if(pn){if(jr.has(r))return jr.get(r);if(t){o=r;var l=o.v;return(!(o.f&ut)&&o.reactions!==null||al(o))&&(l=bs(o)),jr.set(o,l),l}}else if(t){if(o=r,ct!=null&&ct.has(o))return ct.get(o);Un(o)&&Oo(o)}if(ct!=null&&ct.has(r))return ct.get(r);if(r.f&Br)throw r.v;return r.v}function al(r){if(r.v===lt)return!0;if(r.deps===null)return!1;for(const e of r.deps)if(jr.has(e)||e.f&gt&&al(e))return!0;return!1}function hr(r){var e=er;try{return er=!0,r()}finally{er=e}}const hu=-7169;function dt(r,e){r.f=r.f&hu|e}function sl(r){if(!(typeof r!="object"||!r||r instanceof EventTarget)){if(ur in r)os(r);else if(!Array.isArray(r))for(let e in r){const t=r[e];typeof t=="object"&&t&&ur in t&&os(t)}}}function os(r,e=new Set){if(typeof r=="object"&&r!==null&&!(r instanceof EventTarget)&&!e.has(r)){e.add(r),r instanceof Date&&r.getTime();for(let n in r)try{os(r[n],e)}catch{}const t=_s(r);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const n=_o(t);for(let i in n){const a=n[i].get;if(a)try{a.call(r)}catch{}}}}}function pu(r){return r.endsWith("capture")&&r!=="gotpointercapture"&&r!=="lostpointercapture"}const mu=["beforeinput","click","change","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"];function _u(r){return mu.includes(r)}const gu={formnovalidate:"formNoValidate",ismap:"isMap",nomodule:"noModule",playsinline:"playsInline",readonly:"readOnly",defaultvalue:"defaultValue",defaultchecked:"defaultChecked",srcobject:"srcObject",novalidate:"noValidate",allowfullscreen:"allowFullscreen",disablepictureinpicture:"disablePictureInPicture",disableremoteplayback:"disableRemotePlayback"};function yu(r){return r=r.toLowerCase(),gu[r]??r}const wu=["touchstart","touchmove"];function bu(r){return wu.includes(r)}const ol=new Set,ls=new Set;function ll(r,e,t,n={}){function i(a){if(n.capture||ri.call(e,a),!a.cancelBubble)return ya(()=>t==null?void 0:t.call(this,a))}return r.startsWith("pointer")||r.startsWith("touch")||r==="wheel"?Dr(()=>{e.addEventListener(r,i,n)}):e.addEventListener(r,i,n),i}function on(r,e,t,n,i){var a={capture:n,passive:i},o=ll(r,e,t,a);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&ba(()=>{e.removeEventListener(r,o,a)})}function Pt(r){for(var e=0;e<r.length;e++)ol.add(r[e]);for(var t of ls)t(r)}let $s=null;function ri(r){var v;var e=this,t=e.ownerDocument,n=r.type,i=((v=r.composedPath)==null?void 0:v.call(r))||[],a=i[0]||r.target;$s=r;var o=0,c=$s===r&&r.__root;if(c){var l=i.indexOf(c);if(l!==-1&&(e===document||e===window)){r.__root=e;return}var u=i.indexOf(e);if(u===-1)return;l<=u&&(o=l)}if(a=i[o]||r.target,a!==e){cc(r,"currentTarget",{configurable:!0,get(){return a||t}});var f=Ie,d=De;Et(null),qt(null);try{for(var g,m=[];a!==null;){var h=a.assignedSlot||a.parentNode||a.host||null;try{var y=a["__"+n];y!=null&&(!a.disabled||r.target===a)&&y.call(a,r)}catch(x){g?m.push(x):g=x}if(r.cancelBubble||h===e||h===null)break;a=h}if(g){for(let x of m)queueMicrotask(()=>{throw x});throw g}}finally{r.__root=e,delete r.currentTarget,Et(f),qt(d)}}}function Ds(r){var e=document.createElement("template");return e.innerHTML=r.replaceAll("<!>","<!---->"),e.content}function Vn(r,e){var t=De;t.nodes_start===null&&(t.nodes_start=r,t.nodes_end=e)}function O(r,e){var t=(e&Lc)!==0,n=(e&Ac)!==0,i,a=!r.startsWith("<!>");return()=>{i===void 0&&(i=Ds(a?r:"<!>"+r),t||(i=cr(i)));var o=n||Go?document.importNode(i,!0):i.cloneNode(!0);if(t){var c=cr(o),l=o.lastChild;Vn(c,l)}else Vn(o,o);return o}}function Su(r,e,t="svg"){var n=!r.startsWith("<!>"),i=`<${t}>${n?r:"<!>"+r}</${t}>`,a;return()=>{if(!a){var o=Ds(i),c=cr(o);a=cr(c)}var l=a.cloneNode(!0);return Vn(l,l),l}}function cl(r,e){return Su(r,e,"svg")}function rt(r=""){{var e=$r(r+"");return Vn(e,e),e}}function it(){var r=document.createDocumentFragment(),e=document.createComment(""),t=$r();return r.append(e,t),Vn(e,t),r}function S(r,e){r!==null&&r.before(e)}function ne(r,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(r.__t??(r.__t=r.nodeValue))&&(r.__t=t,r.nodeValue=t+"")}function Cu(r,e){return Du(r,e)}const gn=new Map;function Du(r,{target:e,anchor:t,props:n={},events:i,context:a,intro:o=!0}){eu();var c=new Set,l=d=>{for(var g=0;g<d.length;g++){var m=d[g];if(!c.has(m)){c.add(m);var h=bu(m);e.addEventListener(m,ri,{passive:h});var y=gn.get(m);y===void 0?(document.addEventListener(m,ri,{passive:h}),gn.set(m,1)):gn.set(m,y+1)}}};l(ms(ol)),ls.add(l);var u=void 0,f=su(()=>{var d=t??e.appendChild($r());return zc(d,{pending:()=>{}},g=>{if(a){yt({});var m=We;m.c=a}i&&(n.$$events=i),u=r(g,n)||{},a&&wt()}),()=>{var h;for(var g of c){e.removeEventListener(g,ri);var m=gn.get(g);--m===0?(document.removeEventListener(g,ri),gn.delete(g)):gn.set(g,m)}ls.delete(l),d!==t&&((h=d.parentNode)==null||h.removeChild(d))}});return xu.set(u,f),u}let xu=new WeakMap;var Zt,sr,At,di,fi,la;class ul{constructor(e,t=!0){Je(this,"anchor");W(this,Zt,new Map);W(this,sr,new Map);W(this,At,new Map);W(this,di,!0);W(this,fi,()=>{var e=Re;if(p(this,Zt).has(e)){var t=p(this,Zt).get(e),n=p(this,sr).get(t);if(n)Cs(n);else{var i=p(this,At).get(t);i&&(p(this,sr).set(t,i.effect),p(this,At).delete(t),i.fragment.lastChild.remove(),this.anchor.before(i.fragment),n=i.effect)}for(const[a,o]of p(this,Zt)){if(p(this,Zt).delete(a),a===e)break;const c=p(this,At).get(o);c&&(at(c.effect),p(this,At).delete(o))}for(const[a,o]of p(this,sr)){if(a===t)continue;const c=()=>{if(Array.from(p(this,Zt).values()).includes(a)){var u=document.createDocumentFragment();Qo(o,u),u.append($r()),p(this,At).set(a,{effect:o,fragment:u})}else at(o);p(this,sr).delete(a)};p(this,di)||!n?bn(o,c,!1):c()}}});W(this,la,e=>{p(this,Zt).delete(e);const t=Array.from(p(this,Zt).values());for(const[n,i]of p(this,At))t.includes(n)||(at(i.effect),p(this,At).delete(n))});this.anchor=e,U(this,di,t)}ensure(e,t){var n=Re,i=Uo();if(t&&!p(this,sr).has(e)&&!p(this,At).has(e))if(i){var a=document.createDocumentFragment(),o=$r();a.append(o),p(this,At).set(e,{effect:Tt(()=>t(o)),fragment:a})}else p(this,sr).set(e,Tt(()=>t(this.anchor)));if(p(this,Zt).set(n,e),i){for(const[c,l]of p(this,sr))c===e?n.skipped_effects.delete(l):n.skipped_effects.add(l);for(const[c,l]of p(this,At))c===e?n.skipped_effects.delete(l.effect):n.skipped_effects.add(l.effect);n.oncommit(p(this,fi)),n.ondiscard(p(this,la))}else p(this,fi).call(this)}}Zt=new WeakMap,sr=new WeakMap,At=new WeakMap,di=new WeakMap,fi=new WeakMap,la=new WeakMap;function ce(r,e,t=!1){var n=new ul(r),i=t?ln:0;function a(o,c){n.ensure(o,c)}Kn(()=>{var o=!1;e((c,l=!0)=>{o=!0,a(l,c)}),o||a(!1,null)},i)}function qe(r,e){return e}function Eu(r,e,t){for(var n=r.items,i=[],a=e.length,o=0;o<a;o++)Ss(e[o].e,i,!0);var c=a>0&&i.length===0&&t!==null;if(c){var l=t.parentNode;tu(l),l.append(t),n.clear(),rr(r,e[0].prev,e[a-1].next)}Jo(i,()=>{for(var u=0;u<a;u++){var f=e[u];c||(n.delete(f.k),rr(r,f.prev,f.next)),at(f.e,!c)}})}function Pe(r,e,t,n,i,a=null){var o=r,c={flags:e,items:new Map,first:null},l=(e&Co)!==0;if(l){var u=r;o=u.appendChild($r())}var f=null,d=!1,g=new Map,m=ws(()=>{var x=t();return ps(x)?x:x==null?[]:ms(x)}),h,y;function v(){Iu(y,h,c,g,o,i,e,n,t),a!==null&&(h.length===0?f?Cs(f):f=Tt(()=>a(o)):f!==null&&bn(f,()=>{f=null}))}Kn(()=>{y??(y=De),h=s(m);var x=h.length;if(!(d&&x===0)){d=x===0;var M,L,F,I;if(Uo()){var P=new Set,j=Re;for(L=0;L<x;L+=1){F=h[L],I=n(F,L);var Y=c.items.get(I)??g.get(I);Y?e&(ma|_a)&&dl(Y,F,L,e):(M=fl(null,c,null,null,F,I,L,i,e,t,!0),g.set(I,M)),P.add(I)}for(const[oe,ue]of c.items)P.has(oe)||j.skipped_effects.add(ue.e);j.oncommit(v)}else v();s(m)}})}function Iu(r,e,t,n,i,a,o,c,l){var G,b,D,A;var u=(o&xc)!==0,f=(o&(ma|_a))!==0,d=e.length,g=t.items,m=t.first,h=m,y,v=null,x,M=[],L=[],F,I,P,j;if(u)for(j=0;j<d;j+=1)F=e[j],I=c(F,j),P=g.get(I),P!==void 0&&((G=P.a)==null||G.measure(),(x??(x=new Set)).add(P));for(j=0;j<d;j+=1){if(F=e[j],I=c(F,j),P=g.get(I),P===void 0){var Y=n.get(I);if(Y!==void 0){n.delete(I),g.set(I,Y);var oe=v?v.next:h;rr(t,v,Y),rr(t,Y,oe),Ua(Y,oe,i),v=Y}else{var ue=h?h.e.nodes_start:i;v=fl(ue,t,v,v===null?t.first:v.next,F,I,j,a,o,l)}g.set(I,v),M=[],L=[],h=v.next;continue}if(f&&dl(P,F,j,o),P.e.f&Ot&&(Cs(P.e),u&&((b=P.a)==null||b.unfix(),(x??(x=new Set)).delete(P))),P!==h){if(y!==void 0&&y.has(P)){if(M.length<L.length){var re=L[0],le;v=re.prev;var ye=M[0],_e=M[M.length-1];for(le=0;le<M.length;le+=1)Ua(M[le],re,i);for(le=0;le<L.length;le+=1)y.delete(L[le]);rr(t,ye.prev,_e.next),rr(t,v,ye),rr(t,_e,re),h=re,v=_e,j-=1,M=[],L=[]}else y.delete(P),Ua(P,h,i),rr(t,P.prev,P.next),rr(t,P,v===null?t.first:v.next),rr(t,v,P),v=P;continue}for(M=[],L=[];h!==null&&h.k!==I;)h.e.f&Ot||(y??(y=new Set)).add(h),L.push(h),h=h.next;if(h===null)continue;P=h}M.push(P),v=P,h=P.next}if(h!==null||y!==void 0){for(var de=y===void 0?[]:ms(y);h!==null;)h.e.f&Ot||de.push(h),h=h.next;var ke=de.length;if(ke>0){var Q=o&Co&&d===0?i:null;if(u){for(j=0;j<ke;j+=1)(D=de[j].a)==null||D.measure();for(j=0;j<ke;j+=1)(A=de[j].a)==null||A.fix()}Eu(t,de,Q)}}u&&Dr(()=>{var T;if(x!==void 0)for(P of x)(T=P.a)==null||T.apply()}),r.first=t.first&&t.first.e,r.last=v&&v.e;for(var V of n.values())at(V.e);n.clear()}function dl(r,e,t,n){n&ma&&On(r.v,e),n&_a?On(r.i,t):r.i=t}function fl(r,e,t,n,i,a,o,c,l,u,f){var d=(l&ma)!==0,g=(l&Ec)===0,m=d?g?Vo(i,!1,!1):Gr(i):i,h=l&_a?Gr(o):o,y={i:h,v:m,k:a,a:null,e:null,prev:t,next:n};try{if(r===null){var v=document.createDocumentFragment();v.append(r=$r())}return y.e=Tt(()=>c(r,m,h,u),Fc),y.e.prev=t&&t.e,y.e.next=n&&n.e,t===null?f||(e.first=y):(t.next=y,t.e.next=y.e),n!==null&&(n.prev=y,n.e.prev=y.e),y}finally{}}function Ua(r,e,t){for(var n=r.next?r.next.e.nodes_start:t,i=e?e.e.nodes_start:t,a=r.e.nodes_start;a!==null&&a!==n;){var o=xi(a);i.before(a),a=o}}function rr(r,e,t){e===null?r.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function un(r,e,t=!1,n=!1,i=!1){var a=r,o="";Z(()=>{var c=De;if(o!==(o=e()??"")&&(c.nodes_start!==null&&(Yo(c.nodes_start,c.nodes_end),c.nodes_start=c.nodes_end=null),o!=="")){var l=o+"";t?l=`<svg>${l}</svg>`:n&&(l=`<math>${l}</math>`);var u=Ds(l);if((t||n)&&(u=cr(u)),Vn(cr(u),u.lastChild),t||n)for(;cr(u);)a.before(cr(u));else a.before(u)}})}function Wi(r,e,...t){var n=new ul(r);Kn(()=>{const i=e()??null;n.ensure(i,i&&(a=>i(a,...t)))},ln)}function ku(r,e){var t=void 0,n;Kn(()=>{t!==(t=e())&&(n&&(at(n),n=null),t&&(n=Tt(()=>{Ei(()=>t(r))})))})}function vl(r){var e,t,n="";if(typeof r=="string"||typeof r=="number")n+=r;else if(typeof r=="object")if(Array.isArray(r)){var i=r.length;for(e=0;e<i;e++)r[e]&&(t=vl(r[e]))&&(n&&(n+=" "),n+=t)}else for(t in r)r[t]&&(n&&(n+=" "),n+=t);return n}function Pu(){for(var r,e,t=0,n="",i=arguments.length;t<i;t++)(r=arguments[t])&&(e=vl(r))&&(n&&(n+=" "),n+=e);return n}function Mu(r){return typeof r=="object"?Pu(r):r??""}const Ks=[...` 	
\r\fÂ \v\uFEFF`];function Lu(r,e,t){var n=r==null?"":""+r;if(e&&(n=n?n+" "+e:e),t){for(var i in t)if(t[i])n=n?n+" "+i:i;else if(n.length)for(var a=i.length,o=0;(o=n.indexOf(i,o))>=0;){var c=o+a;(o===0||Ks.includes(n[o-1]))&&(c===n.length||Ks.includes(n[c]))?n=(o===0?"":n.substring(0,o))+n.substring(c+1):o=c}}return n===""?null:n}function Us(r,e=!1){var t=e?" !important;":";",n="";for(var i in r){var a=r[i];a!=null&&a!==""&&(n+=" "+i+": "+a+t)}return n}function Ha(r){return r[0]!=="-"||r[1]!=="-"?r.toLowerCase():r}function Au(r,e){if(e){var t="",n,i;if(Array.isArray(e)?(n=e[0],i=e[1]):n=e,r){r=String(r).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var a=!1,o=0,c=!1,l=[];n&&l.push(...Object.keys(n).map(Ha)),i&&l.push(...Object.keys(i).map(Ha));var u=0,f=-1;const y=r.length;for(var d=0;d<y;d++){var g=r[d];if(c?g==="/"&&r[d-1]==="*"&&(c=!1):a?a===g&&(a=!1):g==="/"&&r[d+1]==="*"?c=!0:g==='"'||g==="'"?a=g:g==="("?o++:g===")"&&o--,!c&&a===!1&&o===0){if(g===":"&&f===-1)f=d;else if(g===";"||d===y-1){if(f!==-1){var m=Ha(r.substring(u,f).trim());if(!l.includes(m)){g!==";"&&d++;var h=r.substring(u,d).trim();t+=" "+h+";"}}u=d+1,f=-1}}}}return n&&(t+=Us(n)),i&&(t+=Us(i,!0)),t=t.trim(),t===""?null:t}return r==null?null:String(r)}function St(r,e,t,n,i,a){var o=r.__className;if(o!==t||o===void 0){var c=Lu(t,n,a);c==null?r.removeAttribute("class"):e?r.className=c:r.setAttribute("class",c),r.__className=t}else if(a&&i!==a)for(var l in a){var u=!!a[l];(i==null||u!==!!i[l])&&r.classList.toggle(l,u)}return a}function za(r,e={},t,n){for(var i in t){var a=t[i];e[i]!==a&&(t[i]==null?r.style.removeProperty(i):r.style.setProperty(i,a,n))}}function Rt(r,e,t,n){var i=r.__style;if(i!==e){var a=Au(e,n);a==null?r.removeAttribute("style"):r.style.cssText=a,r.__style=e}else n&&(Array.isArray(n)?(za(r,t==null?void 0:t[0],n[0]),za(r,t==null?void 0:t[1],n[1],"important")):za(r,t,n));return n}function ta(r,e,t=!1){if(r.multiple){if(e==null)return;if(!ps(e))return Rc();for(var n of r.options)n.selected=e.includes(oi(n));return}for(n of r.options){var i=oi(n);if(jo(i,e)){n.selected=!0;return}}(!t||e!==void 0)&&(r.selectedIndex=-1)}function hl(r){var e=new MutationObserver(()=>{ta(r,r.__value)});e.observe(r,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),ba(()=>{e.disconnect()})}function tt(r,e,t=e){var n=new WeakSet,i=!0;wa(r,"change",a=>{var o=a?"[selected]":":checked",c;if(r.multiple)c=[].map.call(r.querySelectorAll(o),oi);else{var l=r.querySelector(o)??r.querySelector("option:not([disabled])");c=l&&oi(l)}t(c),Re!==null&&n.add(Re)}),Ei(()=>{var a=e();if(r===document.activeElement){var o=ii??Re;if(n.has(o))return}if(ta(r,a,i),i&&a===void 0){var c=r.querySelector(":checked");c!==null&&(a=oi(c),t(a))}r.__value=a,i=!1}),hl(r)}function oi(r){return"__value"in r?r.__value:r.value}const Jn=Symbol("class"),Zn=Symbol("style"),pl=Symbol("is custom element"),ml=Symbol("is html");function Gt(r,e){var t=Sa(r);t.value===(t.value=e??void 0)||r.value===e&&(e!==0||r.nodeName!=="PROGRESS")||(r.value=e??"")}function Tu(r,e){var t=Sa(r);t.checked!==(t.checked=e??void 0)&&(r.checked=e)}function Nu(r,e){e?r.hasAttribute("selected")||r.setAttribute("selected",""):r.removeAttribute("selected")}function Ft(r,e,t,n){var i=Sa(r);i[e]!==(i[e]=t)&&(e==="loading"&&(r[hc]=t),t==null?r.removeAttribute(e):typeof t!="string"&&_l(r).includes(e)?r[e]=t:r.setAttribute(e,t))}function Ru(r,e,t,n,i=!1,a=!1){var o=Sa(r),c=o[pl],l=!o[ml],u=e||{},f=r.tagName==="OPTION";for(var d in e)d in t||(t[d]=null);t.class?t.class=Mu(t.class):t[Jn]&&(t.class=null),t[Zn]&&(t.style??(t.style=null));var g=_l(r);for(const F in t){let I=t[F];if(f&&F==="value"&&I==null){r.value=r.__value="",u[F]=I;continue}if(F==="class"){var m=r.namespaceURI==="http://www.w3.org/1999/xhtml";St(r,m,I,n,e==null?void 0:e[Jn],t[Jn]),u[F]=I,u[Jn]=t[Jn];continue}if(F==="style"){Rt(r,I,e==null?void 0:e[Zn],t[Zn]),u[F]=I,u[Zn]=t[Zn];continue}var h=u[F];if(!(I===h&&!(I===void 0&&r.hasAttribute(F)))){u[F]=I;var y=F[0]+F[1];if(y!=="$$")if(y==="on"){const P={},j="$$"+F;let Y=F.slice(2);var v=_u(Y);if(pu(Y)&&(Y=Y.slice(0,-7),P.capture=!0),!v&&h){if(I!=null)continue;r.removeEventListener(Y,u[j],P),u[j]=null}if(I!=null)if(v)r[`__${Y}`]=I,Pt([Y]);else{let oe=function(ue){u[F].call(this,ue)};var L=oe;u[j]=ll(Y,r,oe,P)}else v&&(r[`__${Y}`]=void 0)}else if(F==="style")Ft(r,F,I);else if(F==="autofocus")Qi(r,!!I);else if(!c&&(F==="__value"||F==="value"&&I!=null))r.value=r.__value=I;else if(F==="selected"&&f)Nu(r,I);else{var x=F;l||(x=yu(x));var M=x==="defaultValue"||x==="defaultChecked";if(I==null&&!c&&!M)if(o[F]=null,x==="value"||x==="checked"){let P=r;const j=e===void 0;if(x==="value"){let Y=P.defaultValue;P.removeAttribute(x),P.defaultValue=Y,P.value=P.__value=j?Y:null}else{let Y=P.defaultChecked;P.removeAttribute(x),P.defaultChecked=Y,P.checked=j?Y:!1}}else r.removeAttribute(F);else M||g.includes(x)&&(c||typeof I!="string")?(r[x]=I,x in o&&(o[x]=lt)):typeof I!="function"&&Ft(r,x,I)}}}return u}function Ou(r,e,t=[],n=[],i=[],a,o=!1,c=!1){No(i,t,n,l=>{var u=void 0,f={},d=r.nodeName==="SELECT",g=!1;if(Kn(()=>{var h=e(...l.map(s)),y=Ru(r,u,h,a,o,c);g&&d&&"value"in h&&ta(r,h.value);for(let x of Object.getOwnPropertySymbols(f))h[x]||at(f[x]);for(let x of Object.getOwnPropertySymbols(h)){var v=h[x];x.description===Nc&&(!u||v!==u[x])&&(f[x]&&at(f[x]),f[x]=Tt(()=>ku(r,()=>v))),y[x]=v}u=y}),d){var m=r;Ei(()=>{ta(m,u.value,!0),hl(m)})}g=!0})}function Sa(r){return r.__attributes??(r.__attributes={[pl]:r.nodeName.includes("-"),[ml]:r.namespaceURI===Tc})}var Hs=new Map;function _l(r){var e=r.getAttribute("is")||r.nodeName,t=Hs.get(e);if(t)return t;Hs.set(e,t=[]);for(var n,i=r,a=Element.prototype;a!==i;){n=_o(i);for(var o in n)n[o].set&&t.push(o);i=_s(i)}return t}function br(r,e,t=e){var n=new WeakSet;wa(r,"input",async i=>{var a=i?r.defaultValue:r.value;if(a=Wa(r)?Ya(a):a,t(a),Re!==null&&n.add(Re),await vu(),a!==(a=e())){var o=r.selectionStart,c=r.selectionEnd,l=r.value.length;if(r.value=a??"",c!==null){var u=r.value.length;o===c&&c===l&&u>l?(r.selectionStart=u,r.selectionEnd=u):(r.selectionStart=o,r.selectionEnd=Math.min(c,u))}}}),hr(e)==null&&r.value&&(t(Wa(r)?Ya(r.value):r.value),Re!==null&&n.add(Re)),hn(()=>{var i=e();if(r===document.activeElement){var a=ii??Re;if(n.has(a))return}Wa(r)&&i===Ya(r.value)||r.type==="date"&&!i&&!r.value||i!==r.value&&(r.value=i??"")})}const qa=new Set;function yn(r,e,t,n,i=n){var a=t.getAttribute("type")==="checkbox",o=r;if(e!==null)for(var c of e)o=o[c]??(o[c]=[]);o.push(t),wa(t,"change",()=>{var l=t.__value;a&&(l=Fu(o,l,t.checked)),i(l)},()=>i(a?[]:null)),hn(()=>{var l=n();a?(l=l||[],t.checked=l.includes(t.__value)):t.checked=jo(t.__value,l)}),ba(()=>{var l=o.indexOf(t);l!==-1&&o.splice(l,1)}),qa.has(o)||(qa.add(o),Dr(()=>{o.sort((l,u)=>l.compareDocumentPosition(u)===4?-1:1),qa.delete(o)})),Dr(()=>{})}function ni(r,e,t=e){wa(r,"change",n=>{var i=n?r.defaultChecked:r.checked;t(i)}),hr(e)==null&&t(r.checked),hn(()=>{var n=e();r.checked=!!n})}function Fu(r,e,t){for(var n=new Set,i=0;i<r.length;i+=1)r[i].checked&&n.add(r[i].__value);return t||n.delete(e),Array.from(n)}function Wa(r){var e=r.type;return e==="number"||e==="range"}function Ya(r){return r===""?null:+r}var Rr,In,vi,ca,gl;const ua=class ua{constructor(e){W(this,ca);W(this,Rr,new WeakMap);W(this,In);W(this,vi);U(this,vi,e)}observe(e,t){var n=p(this,Rr).get(e)||new Set;return n.add(t),p(this,Rr).set(e,n),He(this,ca,gl).call(this).observe(e,p(this,vi)),()=>{var i=p(this,Rr).get(e);i.delete(t),i.size===0&&(p(this,Rr).delete(e),p(this,In).unobserve(e))}}};Rr=new WeakMap,In=new WeakMap,vi=new WeakMap,ca=new WeakSet,gl=function(){return p(this,In)??U(this,In,new ResizeObserver(e=>{for(var t of e){ua.entries.set(t.target,t);for(var n of p(this,Rr).get(t.target)||[])n(t)}}))},Je(ua,"entries",new WeakMap);let cs=ua;var Vu=new cs({box:"border-box"});function Bu(r,e,t){var n=Vu.observe(r,()=>t(r[e]));Ei(()=>(hr(()=>t(r[e])),n))}function zs(r,e){return r===e||(r==null?void 0:r[ur])===e}function dn(r={},e,t,n){return Ei(()=>{var i,a;return hn(()=>{i=a,a=[],hr(()=>{r!==t(...a)&&(e(r,...a),i&&zs(t(...i),r)&&e(null,...i))})}),()=>{Dr(()=>{a&&zs(t(...a),r)&&e(null,...a)})}}),r}function ju(r=!1){const e=We,t=e.l.u;if(!t)return;let n=()=>sl(e.s);if(r){let i=0,a={};const o=Di(()=>{let c=!1;const l=e.s;for(const u in l)l[u]!==a[u]&&(a[u]=l[u],c=!0);return c&&i++,i});n=()=>s(o)}t.b.length&&au(()=>{qs(e,n),es(t.b)}),xr(()=>{const i=hr(()=>t.m.map(fc));return()=>{for(const a of i)typeof a=="function"&&a()}}),t.a.length&&xr(()=>{qs(e,n),es(t.a)})}function qs(r,e){if(r.l.s)for(const t of r.l.s)s(t);e()}let Ti=!1;function Gu(r){var e=Ti;try{return Ti=!1,[r(),Ti]}finally{Ti=e}}const $u={get(r,e){if(!r.exclude.includes(e))return s(r.version),e in r.special?r.special[e]():r.props[e]},set(r,e,t){if(!(e in r.special)){var n=De;try{qt(r.parent_effect),r.special[e]=pe({get[e](){return r.props[e]}},e,Do)}finally{qt(n)}}return r.special[e](t),Zi(r.version),!0},getOwnPropertyDescriptor(r,e){if(!r.exclude.includes(e)&&e in r.props)return{enumerable:!0,configurable:!0,value:r.props[e]}},deleteProperty(r,e){return r.exclude.includes(e)||(r.exclude.push(e),Zi(r.version)),!0},has(r,e){return r.exclude.includes(e)?!1:e in r.props},ownKeys(r){return Reflect.ownKeys(r.props).filter(e=>!r.exclude.includes(e))}};function Ws(r,e){return new Proxy({props:r,exclude:e,special:{},version:Gr(0),parent_effect:De},$u)}const Ku={get(r,e){let t=r.props.length;for(;t--;){let n=r.props[t];if(Xn(n)&&(n=n()),typeof n=="object"&&n!==null&&e in n)return n[e]}},set(r,e,t){let n=r.props.length;for(;n--;){let i=r.props[n];Xn(i)&&(i=i());const a=Vr(i,e);if(a&&a.set)return a.set(t),!0}return!1},getOwnPropertyDescriptor(r,e){let t=r.props.length;for(;t--;){let n=r.props[t];if(Xn(n)&&(n=n()),typeof n=="object"&&n!==null&&e in n){const i=Vr(n,e);return i&&!i.configurable&&(i.configurable=!0),i}}},has(r,e){if(e===ur||e===bo)return!1;for(let t of r.props)if(Xn(t)&&(t=t()),t!=null&&e in t)return!0;return!1},ownKeys(r){const e=[];for(let t of r.props)if(Xn(t)&&(t=t()),!!t){for(const n in t)e.includes(n)||e.push(n);for(const n of Object.getOwnPropertySymbols(t))e.includes(n)||e.push(n)}return e}};function Uu(...r){return new Proxy({props:r},Ku)}function pe(r,e,t,n){var L;var i=!$n||(t&kc)!==0,a=(t&Pc)!==0,o=(t&Mc)!==0,c=n,l=!0,u=()=>(l&&(l=!1,c=o?hr(n):n),c),f;if(a){var d=ur in r||bo in r;f=((L=Vr(r,e))==null?void 0:L.set)??(d&&e in r?F=>r[e]=F:void 0)}var g,m=!1;a?[g,m]=Gu(()=>r[e]):g=r[e],g===void 0&&n!==void 0&&(g=u(),f&&(i&&wc(),f(g)));var h;if(i?h=()=>{var F=r[e];return F===void 0?u():(l=!0,F)}:h=()=>{var F=r[e];return F!==void 0&&(c=void 0),F===void 0?c:F},i&&!(t&Do))return h;if(f){var y=r.$$legacy;return function(F,I){return arguments.length>0?((!i||!I||y||m)&&f(I?h():F),F):h()}}var v=!1,x=(t&Ic?Di:ws)(()=>(v=!1,h()));a&&s(x);var M=De;return function(F,I){if(arguments.length>0){const P=I?s(x):i&&a?Ae(F):F;return C(x,P),v=!0,c!==void 0&&(c=P),F}return pn&&v||M.f&Sr?x.v:s(x)}}function Hn(r){We===null&&So(),$n&&We.l!==null?Hu(We).m.push(r):xr(()=>{const e=hr(r);if(typeof e=="function")return e})}function Ca(r){We===null&&So(),Hn(()=>()=>hr(r))}function Hu(r){var e=r.l;return e.u??(e.u={a:[],b:[],m:[]})}const zu="5";var po;typeof window<"u"&&((po=window.__svelte??(window.__svelte={})).v??(po.v=new Set)).add(zu);const qu=0,Wu=126,Yu=231,Xu=6;class Ju{constructor(){this.universe=new Uint8Array(512).fill(0),this.device=null,this.interval=null,this.updateRate=1e3/60,this.connected=!1}async connect(){if(!("usb"in navigator))throw new Error("WebUSB is not supported in this browser");try{return this.device=await navigator.usb.requestDevice({filters:[{vendorId:1027}]}),await this.device.open(),await this.device.claimInterface(0),await this.device.controlTransferOut({requestType:"class",recipient:"interface",request:34,value:1,index:0}),this.connected=!0,this.interval=setInterval(()=>{this.sendUniverse()},this.updateRate),!0}catch(e){throw console.error("Failed to connect:",e),e}}disconnect(){this.interval&&(clearInterval(this.interval),this.interval=null),this.device&&(this.device.close(),this.device=null),this.connected=!1}setChannel(e,t){e>=0&&e<512&&(this.universe[e]=Math.max(0,Math.min(255,t)))}getChannel(e){return this.universe[e]||0}setChannels(e,t){t.forEach((n,i)=>{this.setChannel(e+i,n)})}getUniverse(){return this.universe}clearUniverse(){this.universe.fill(0)}sendUniverse(){if(!this.device||!this.connected)return;const e=Uint8Array.from([qu,...this.universe]),t=Uint8Array.from([Wu,Xu,e.length&255,e.length>>8&255,...e,Yu]);this.device.transferOut(2,t).catch(n=>{console.error("Failed to send DMX data:",n)})}}const Me={RGB:{name:"RGB Light",channels:3,components:[{name:"Red",channel:0},{name:"Green",channel:1},{name:"Blue",channel:2}],controls:[{name:"Color",type:"rgb",components:{r:0,g:1,b:2}}]},RGBA:{name:"RGBA Light",channels:4,components:[{name:"Red",channel:0},{name:"Green",channel:1},{name:"Blue",channel:2},{name:"Amber",channel:3}],controls:[{name:"Color",type:"rgb",components:{r:0,g:1,b:2}},{name:"Amber",type:"slider",color:"#ffbf00",components:{value:3}}]},RGBW:{name:"RGBW Light",channels:4,components:[{name:"Red",channel:0},{name:"Green",channel:1},{name:"Blue",channel:2},{name:"White",channel:3}],controls:[{name:"Color",type:"rgb",components:{r:0,g:1,b:2}},{name:"White",type:"slider",color:"#808080",components:{value:3}}]},DIMMER:{name:"Dimmer",channels:1,components:[{name:"Intensity",channel:0}],controls:[{name:"Intensity",type:"slider",color:"#888888",components:{value:0}}]},SMOKE:{name:"Smoke Machine",channels:1,components:[{name:"Output",channel:0}],controls:[{name:"Output",type:"slider",color:"#666666",components:{value:0}}]},MOVING_HEAD:{name:"Moving Head (Basic)",channels:7,components:[{name:"Pan",channel:0},{name:"Tilt",channel:1},{name:"Dimmer",channel:2},{name:"Red",channel:3},{name:"Green",channel:4},{name:"Blue",channel:5},{name:"White",channel:6}],controls:[{name:"Pan/Tilt",type:"xypad",components:{x:0,y:1}},{name:"Dimmer",type:"slider",color:"#888888",components:{value:2}},{name:"Color",type:"rgb",components:{r:3,g:4,b:5}},{name:"White",type:"slider",color:"#808080",components:{value:6}}]},FLAMETHROWER:{name:"Flamethrower",channels:2,components:[{name:"Safety",channel:0},{name:"Fuel",channel:1}],controls:[{name:"Safety",type:"toggle",offValue:0,onValue:125,components:{value:0}},{name:"Fuel",type:"slider",color:"#ff5722",components:{value:1}}]}};class Qn{constructor(e,t,n,i="",a=null,o=null,c=null,l=!1){this.id=e,this.type=t,this.startChannel=n,this.name=i||`${Me[t].name} ${e}`,this.defaultValues=new Array(Me[t].channels).fill(0),this.linkedTo=a,this.syncedControls=c,this.mirrorPan=l,this.cssId=o||this.generateCssId(this.name)}generateCssId(e){return e.toLowerCase().replace(/[^a-z0-9]/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,"")}updateCssId(){this.cssId=this.generateCssId(this.name)}setValue(e,t){this.defaultValues[e]=Math.max(0,Math.min(255,t))}getValue(e){return this.defaultValues[e]}getChannelValues(){return this.defaultValues}isLinked(){return this.linkedTo!==null}}function fn(r,e){if(!e||e.length===0)return"#000000";switch(r){case"RGB":{const[t,n,i]=e;return`rgb(${t}, ${n}, ${i})`}case"RGBA":{const[t,n,i,a]=e,o=255,c=191,l=0,u=Math.min(255,t+o*a/255),f=Math.min(255,n+c*a/255),d=Math.min(255,i+l*a/255);return`rgb(${Math.round(u)}, ${Math.round(f)}, ${Math.round(d)})`}case"RGBW":{const[t,n,i,a]=e,o=Math.min(255,t+a),c=Math.min(255,n+a),l=Math.min(255,i+a);return`rgb(${Math.round(o)}, ${Math.round(c)}, ${Math.round(l)})`}case"MOVING_HEAD":{const t=e[2]||0,n=e[3]||0,i=e[4]||0,a=e[5]||0,o=e[6]||0;let c=Math.min(255,n+o),l=Math.min(255,i+o),u=Math.min(255,a+o);return c=Math.round(c*t/255),l=Math.round(l*t/255),u=Math.round(u*t/255),`rgb(${c}, ${l}, ${u})`}case"DIMMER":{const t=e[0]||0;return`rgb(${t}, ${t}, ${t})`}case"SMOKE":{const t=e[0]||0,n=Math.round(t*.7);return`rgb(${Math.round(t*.5)}, ${Math.round(t*.5)}, ${n})`}default:return"#000000"}}const Zu={xypad:{properties:{x:{name:"--pan",convert:r=>`${(r/255*100-50).toFixed(1)}%`},y:{name:"--tilt",convert:r=>`${(r/255*100).toFixed(1)}%`}}},rgb:{properties:{color:{name:"color",convert:"color"}}},slider:{properties:{value:{getName:r=>r==="Dimmer"||r==="Intensity"?"--intensity":r==="White"?"--white":r==="Amber"?"--amber":`--${r.toLowerCase().replace(/\s+/g,"-")}`,convert:(r,e)=>e==="Dimmer"||e==="Intensity"?(r/255).toFixed(3):e==="White"||e==="Amber"?`${(r/255*100).toFixed(1)}%`:r.toString()}}}};function yl(r,e,t,n){const i={};for(const a of r){const o=Zu[a.type];if(o){if(a.type==="xypad"){const c=e[a.components.x].channel,l=e[a.components.y].channel,u=t[c]||0,f=t[l]||0;i[o.properties.x.name]=o.properties.x.convert(u),i[o.properties.y.name]=o.properties.y.convert(f)}else if(a.type==="rgb")i.color=fn(n,t);else if(a.type==="slider"){const c=e[a.components.value].channel,l=t[c]||0,u=o.properties.value.getName(a.name),f=o.properties.value.convert(l,a.name);i[u]=f}}}return i}class Qu{constructor(e=0,t="RGB",n=[0,0,0]){this.time=e,this.deviceType=t,this.values=[...n]}getProperties(){const e=fn(this.deviceType,this.values);if(this.deviceType==="MOVING_HEAD"){const t=this.values[0]||0,n=this.values[1]||0,i=t/255*100-50,a=n/255*100-50;return{color:e,transform:`translate(${i}%, ${a}%)`}}return{color:e}}toCSS(){const e=this.getProperties(),t=Object.entries(e).map(([i,a])=>`${i}: ${a}`).join("; ");return`${Math.round(this.time*100)}% { ${t}; }`}}class Da{constructor(e="animation",t="RGB",n=[],i=null,a=null,o=null){this.name=e,this.controls=a||[],this.displayName=o,this.keyframes=n,this.cssName=i||this._generateCSSName()}getControlsForRendering(){if(!this.controls||this.controls.length===0)return{controls:Me.RGB.controls,components:Me.RGB.components};for(const[e,t]of Object.entries(Me))if(this.controls.every(i=>t.controls.some(a=>a.name===i)))return{controls:t.controls.filter(a=>this.controls.includes(a.name)),components:t.components};return{controls:Me.RGB.controls,components:Me.RGB.components}}_generateCSSName(){return this.name?this.name.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""):"animation"}updateCSSName(){this.cssName=this._generateCSSName()}addKeyframe(e,t){const{controls:n,components:i}=this.getControlsForRendering();let a="RGB";for(const[c,l]of Object.entries(Me))if(l.controls===n&&l.components===i){a=c;break}const o=new Qu(e,a,t);return this.keyframes=[...this.keyframes,o].sort((c,l)=>c.time-l.time),o}removeKeyframe(e){const t=this.keyframes.indexOf(e);t!==-1&&this.keyframes.splice(t,1)}toCSS(){if(this.keyframes.length===0)return"";const e=this.keyframes.map(t=>{const n=Math.round(t.time*100),i=this._getKeyframeProperties(t),a=Object.entries(i).map(([o,c])=>`${o}: ${c}`).join("; ");return`${n}% { ${a}; }`}).join(`
  `);return`@keyframes ${this.cssName} {
  ${e}
}`}_getKeyframeProperties(e){const{controls:t,components:n}=this.getControlsForRendering(),i=yl(t,n,e.values,e.deviceType);return Object.keys(i).length===0&&(i.color=fn(e.deviceType,e.values)),i}getKeyframeColor(e){return fn(e.deviceType,e.values)}getValuesAtTime(e){if(this.keyframes.length===0){const{components:n}=this.getControlsForRendering(),i=n.length;return new Array(i).fill(0)}const t=[...this.keyframes].sort((n,i)=>n.time-i.time);if(e<=t[0].time)return[...t[0].values];if(e>=t[t.length-1].time)return[...t[t.length-1].values];for(let n=0;n<t.length-1;n++){const i=t[n],a=t[n+1];if(e>=i.time&&e<=a.time){const o=(e-i.time)/(a.time-i.time),c=[];for(let l=0;l<i.values.length;l++){const u=i.values[l],f=a.values[l];c.push(Math.round(u+(f-u)*o))}return c}}return[...t[0].values]}getGradientSegments(e=1e3){if(this.keyframes.length===0)return[{left:0,width:e,gradient:"#000000"}];const t=[],n=[...this.keyframes].sort((a,o)=>a.time-o.time);if(n[0].time>0){const a=this.getKeyframeColor(n[0]);t.push({left:0,width:n[0].time*e,gradient:`linear-gradient(to right, #000000, ${a})`})}for(let a=0;a<n.length-1;a++){const o=n[a],c=n[a+1],l=this.getKeyframeColor(o),u=this.getKeyframeColor(c);t.push({left:o.time*e,width:(c.time-o.time)*e,gradient:`linear-gradient(to right, ${l}, ${u})`})}const i=n[n.length-1];if(i.time<1){const a=this.getKeyframeColor(i);t.push({left:i.time*e,width:(1-i.time)*e,gradient:`linear-gradient(to right, ${a}, #000000)`})}return t}getAffectedChannels(){const{controls:e,components:t}=this.getControlsForRendering();if(!this.controls||this.controls.length===0)return Array.from({length:t.length},(i,a)=>a);const n=new Set;for(const i of e)for(const a of Object.values(i.components)){const o=t[a].channel;n.add(o)}return Array.from(n).sort((i,a)=>i-a)}getNumChannels(){return this.getAffectedChannels().length}getDisplayName(){return this.displayName?this.displayName:this.controls&&this.controls.length>0?this.controls.join(", "):"Animation"}getControlNames(){return this.controls||[]}toJSON(){return{name:this.name,controls:this.controls,displayName:this.displayName,keyframes:this.keyframes.map(e=>({time:e.time,deviceType:e.deviceType,values:e.values}))}}static fromJSON(e){let t=e.controls||null;if(!t&&e.controlName&&(t=[e.controlName]),!t&&e.deviceType){const a=Me[e.deviceType];a&&(t=a.controls.map(o=>o.name))}(!t||t.length===0)&&(t=["Color"]);const n=e.displayName||null,i=new Da(e.name,"RGB",[],null,t,n);for(const a of e.keyframes)if(a.values)i.addKeyframe(a.time,a.values);else if(a.properties){const o=new Array(i.deviceType==="RGB"?3:4).fill(0);i.addKeyframe(a.time,o)}return i}}class ed{constructor(){this.animations=new Map,this.listeners=new Map,this.load()}on(e,t){this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e).add(t)}off(e,t){this.listeners.has(e)&&this.listeners.get(e).delete(t)}_emit(e,t){if(!this.listeners.has(e))return;const n=this.listeners.get(e);for(const i of n)i(t)}add(e){this.animations.set(e.name,e),this.save(),this._emit("changed",{type:"add",animation:e})}remove(e){const t=this.animations.get(e);this.animations.delete(e),this.save(),this._emit("changed",{type:"remove",animation:t,name:e})}get(e){return this.animations.get(e)}getAll(){return Array.from(this.animations.values())}has(e){return this.animations.has(e)}rename(e,t){const n=this.animations.get(e);return n?(n.name=t,this.animations.delete(e),this.animations.set(t,n),this.save(),!0):!1}toCSS(){return this.getAll().map(e=>e.toCSS()).filter(e=>e).join(`

`)}save(){const e=this.getAll().map(t=>t.toJSON());localStorage.setItem("dmx-animations",JSON.stringify(e))}load(){const e=localStorage.getItem("dmx-animations");if(e)try{const t=JSON.parse(e);for(const n of t){const i=Da.fromJSON(n);this.animations.set(i.name,i)}}catch(t){console.error("Failed to load animations:",t)}}clear(){this.animations.clear(),this.save()}}class Bn{constructor(e={}){this.id=e.id||`mapping-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,this.name=e.name||"Untitled Mapping",this.mode=e.mode||"trigger",this.inputDeviceId=e.inputDeviceId||null,this.inputControlId=e.inputControlId||null,this.inputDeviceName=e.inputDeviceName||null,this.color="color"in e?e.color:this._generateRandomColor(),this.triggerType=e.triggerType||"pressed",this.actionType=e.actionType||"animation",this.animationName=e.animationName||null,this.duration=e.duration||1e3,this.easing=e.easing||"linear",this.iterations=e.iterations||1,this.targetDeviceIds=e.targetDeviceIds||[],this.setValueDeviceId=e.setValueDeviceId||null,this.channelValues=e.channelValues||{},this.propertyName=e.propertyName||"--value",this.propertyType=e.propertyType||"percentage",this.range=e.range||[0,100],this.cssClassName=e.cssClassName||this._generateClassName(),this.cssClassDown=e.cssClassDown||(this.isButtonInput()?this._generateButtonDownClass():null),this.cssClassUp=e.cssClassUp||(this.isButtonInput()?this._generateButtonUpClass():null),this.cssProperty=e.cssProperty||(this.isButtonInput()?null:this._generatePropertyName())}_generateRandomColor(){const e=Math.floor(Math.random()*360),t=70+Math.floor(Math.random()*30),n=50+Math.floor(Math.random()*20);return`hsl(${e}, ${t}%, ${n}%)`}_generateClassName(){if(!this.inputDeviceId||!this.inputControlId)return`mapping-${this.id}`;const e=this.inputControlId.replace(/[^a-zA-Z0-9]/g,"_").toLowerCase();if(this.mode==="input")return e;const t=this.triggerType==="pressed"?"down":this.triggerType==="not-pressed"?"up":"always";return`${e}_${t}`}updateClassName(){this.cssClassName=this._generateClassName()}_generatePropertyName(){return this.name?`--${this.name.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")}`:"--value"}_generateButtonDownClass(){return this.name?`${this.name.toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,"")}_down`:""}_generateButtonUpClass(){return this.name?`${this.name.toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,"")}_up`:""}updateCSSIdentifiers(){this.isButtonInput()?(this.cssClassDown=this._generateButtonDownClass(),this.cssClassUp=this._generateButtonUpClass(),this.cssProperty=null):(this.cssProperty=this._generatePropertyName(),this.cssClassDown=null,this.cssClassUp=null)}toCSS(e=[]){return this.mode==="trigger"?this._generateTriggerCSS(e):""}_generateTriggerCSS(e=[]){if(!this.animationName)return"";const t=this.targetDeviceIds.map(a=>{const o=e.find(c=>c.id===a);return o?`#${o.cssId}`:null}).filter(a=>a!==null).join(", ");if(!t)return"";const n=this.iterations==="infinite"?"infinite":this.iterations,i=(this.duration/1e3).toFixed(3);return`.${this.cssClassName} ${t} {
  animation: ${this.animationName} ${i}s ${this.easing} ${n};
}`}getPropertyName(){return this.propertyName.startsWith("--")?this.propertyName:`--${this.propertyName}`}getInputPropertyName(){return this.cssProperty}isButtonInput(){return this.inputControlId?this.inputControlId.startsWith("button-")||this.inputControlId.startsWith("note-")||this.inputControlId.startsWith("key-"):!1}getButtonDownClass(){return this.cssClassDown}getButtonUpClass(){return this.cssClassUp}mapValue(e){const[t,n]=this.range,i=t+(n-t)*e;switch(this.propertyType){case"percentage":return`${i.toFixed(1)}%`;case"degrees":return`${i.toFixed(1)}deg`;case"number":return i.toFixed(2);default:return i.toString()}}toJSON(){return{id:this.id,name:this.name,mode:this.mode,inputDeviceId:this.inputDeviceId,inputControlId:this.inputControlId,inputDeviceName:this.inputDeviceName,color:this.color,triggerType:this.triggerType,actionType:this.actionType,animationName:this.animationName,duration:this.duration,easing:this.easing,iterations:this.iterations,targetDeviceIds:this.targetDeviceIds,setValueDeviceId:this.setValueDeviceId,channelValues:this.channelValues,propertyName:this.propertyName,propertyType:this.propertyType,range:this.range,cssClassName:this.cssClassName}}static fromJSON(e){const t=new Bn(e);return t.mode==="input"&&t.cssClassName.match(/_(down|up|always)$/)&&(t.cssClassName=t._generateClassName()),t}}class wl{constructor(){this.mappings=new Map,this.listeners=new Map,this.load()}on(e,t){this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e).add(t)}off(e,t){this.listeners.has(e)&&this.listeners.get(e).delete(t)}_emit(e,t){if(!this.listeners.has(e))return;const n=this.listeners.get(e);for(const i of n)i(t)}add(e){return this.mappings.set(e.id,e),this.save(),this._emit("changed",{type:"add",mapping:e}),e}update(e){this.mappings.has(e.id)&&(this.mappings.set(e.id,e),this.save(),this._emit("changed",{type:"update",mapping:e}))}remove(e){const t=this.mappings.get(e);this.mappings.delete(e),this.save(),this._emit("changed",{type:"remove",mapping:t,id:e})}get(e){return this.mappings.get(e)}getAll(){return Array.from(this.mappings.values())}getByInput(e,t){return this.getAll().filter(n=>n.inputDeviceId===e&&n.inputControlId===t)}getTriggerMappings(){return this.getAll().filter(e=>e.mode==="trigger")}getDirectMappings(){return this.getAll().filter(e=>e.mode==="direct")}toCSS(e=[]){return this.getTriggerMappings().map(t=>t.toCSS(e)).filter(t=>t).join(`

`)}save(){const e=this.getAll().map(t=>t.toJSON());localStorage.setItem("dmx-mappings",JSON.stringify(e))}load(){const e=localStorage.getItem("dmx-mappings");if(e)try{const t=JSON.parse(e);for(const n of t){const i=Bn.fromJSON(n);this.mappings.set(i.id,i)}}catch(t){console.error("Failed to load mappings:",t)}}clear(){this.mappings.clear(),this.save()}}class bl{constructor(){this.activeClasses=new Set,this.notPressedClasses=new Set,this.alwaysClasses=new Set,this.container=null,this.setValueCallback=null,this.activeSetValueMappings=new Map}setContainer(e){this.container=e;for(const t of this.notPressedClasses)e.classList.add(t);for(const t of this.alwaysClasses)e.classList.add(t)}setSetValueCallback(e){this.setValueCallback=e}register(e){e.mode==="trigger"&&(e.actionType==="animation"?e.triggerType==="not-pressed"?(this.notPressedClasses.add(e.cssClassName),this.container&&this.container.classList.add(e.cssClassName)):e.triggerType==="always"&&(this.alwaysClasses.add(e.cssClassName),this.container&&this.container.classList.add(e.cssClassName)):e.actionType==="setValue"&&e.triggerType==="always"&&this.setValueCallback&&(this.setValueCallback(e.setValueDeviceId,e.channelValues),this.activeSetValueMappings.set(e.id,e)))}unregister(e){e.mode==="trigger"&&(e.actionType==="animation"?(this.notPressedClasses.delete(e.cssClassName),this.alwaysClasses.delete(e.cssClassName),this.container&&this.container.classList.remove(e.cssClassName)):e.actionType==="setValue"&&this.activeSetValueMappings.delete(e.id))}trigger(e){if(e.mode==="trigger"){if(e.actionType==="animation"){if(!this.container)return;const t=e.cssClassName;e.triggerType==="pressed"?(this.container.classList.add(t),this.activeClasses.add(t)):e.triggerType==="not-pressed"&&this.container.classList.remove(t)}else if(e.actionType==="setValue"){if(!this.setValueCallback)return;e.triggerType==="pressed"?(this.setValueCallback(e.setValueDeviceId,e.channelValues),this.activeSetValueMappings.set(e.id,e)):e.triggerType==="not-pressed"&&this.activeSetValueMappings.delete(e.id)}}}release(e){if(e.mode==="trigger"){if(e.actionType==="animation"){if(!this.container)return;const t=e.cssClassName;e.triggerType==="pressed"?(this.container.classList.remove(t),this.activeClasses.delete(t)):e.triggerType==="not-pressed"&&this.container.classList.add(t)}else if(e.actionType==="setValue"){if(!this.setValueCallback)return;e.triggerType==="pressed"?this.activeSetValueMappings.delete(e.id):e.triggerType==="not-pressed"&&(this.setValueCallback(e.setValueDeviceId,e.channelValues),this.activeSetValueMappings.set(e.id,e))}}}addRawClass(e){this.container&&this.container.classList.add(e)}removeRawClass(e){this.container&&this.container.classList.remove(e)}clearAll(){if(this.container){for(const e of this.activeClasses)this.container.classList.remove(e);this.activeClasses.clear()}}}class td{constructor(e,t){this.animationLibrary=e,this.mappingLibrary=t}generate(e=[]){const t=[];if(t.push("/* DMX Controller - Generated CSS */"),t.push("/* This stylesheet is auto-generated from your animations and input mappings */"),t.push("/* You can edit this CSS and the changes will be reflected in the interface */"),t.push(`/* Note: @property definitions are in a separate, non-editable include */
`),e.length>0){t.push("/* === Default Device Values === */"),t.push("/* These selectors set the default state for each device */");for(const o of e){const c=this._generateDeviceDefaults(o);c&&t.push(c)}t.push("")}const n=this.animationLibrary.toCSS();n&&(t.push("/* === Animations === */"),t.push(n),t.push(""));const i=this.mappingLibrary.toCSS(e);i&&(t.push("/* === Triggers === */"),t.push(i),t.push(""));const a=this.mappingLibrary.getDirectMappings();if(a.length>0){t.push("/* === Custom Properties (Direct Control) === */"),t.push("/* These properties are updated live via JavaScript */"),t.push(":root {");for(const o of a){const c=o.getPropertyName(),l=o.mapValue(0);t.push(`  ${c}: ${l}; /* ${o.name} */`)}t.push(`}
`)}return t.push("/* === Custom Styles === */"),t.push("/* Add your custom CSS below to override device defaults and apply animations */"),t.push(""),t.join(`
`)}_generateDeviceDefaults(e){const t=Me[e.type];if(!t||e.isLinked&&e.isLinked())return null;const n=e.defaultValues||[],i=yl(t.controls,t.components,n,e.type);if(e.type==="FLAMETHROWER"){const[o,c]=n;i["--safety"]=o>=125?"probably":"none"}if(Object.keys(i).length===0)return null;const a=Object.entries(i).map(([o,c])=>`  ${o}: ${c};`);return`#${e.cssId} {
${a.join(`
`)}
}`}}class rd{constructor(){this.deviceElements=new Map,this.container=null,this.previousValues=new Map}initialize(e){this.container=e}updateDevices(e){if(this.container){for(const[t,n]of this.deviceElements)e.find(i=>i.id===t)||(n.remove(),this.deviceElements.delete(t));for(const t of e){let n=this.deviceElements.get(t.id);const i=t.cssId;n?n.id!==i&&(n.id=i):(n=document.createElement("div"),n.id=i,n.className="dmx-device",n.dataset.deviceType=t.type,this.container.appendChild(n),this.deviceElements.set(t.id,n)),n.dataset.deviceName=t.name,n.dataset.deviceType=t.type}}}sampleDevice(e){const t=this.deviceElements.get(e.id);if(!t)return console.warn(`[CSSSampler] No element found for device ${e.id}`),null;t.offsetHeight;const n=window.getComputedStyle(t),i={};switch(e.type){case"RGB":Object.assign(i,this._sampleRGB(n));break;case"RGBA":Object.assign(i,this._sampleRGBA(n));break;case"RGBW":Object.assign(i,this._sampleRGBW(n));break;case"DIMMER":Object.assign(i,this._sampleDimmer(n));break;case"SMOKE":Object.assign(i,this._sampleSmoke(n));break;case"MOVING_HEAD":Object.assign(i,this._sampleMovingHead(n));break;case"FLAMETHROWER":Object.assign(i,this._sampleFlamethrower(n));break}return this.previousValues.set(e.id,{...i}),i}sampleAll(e){const t=new Map;for(const n of e){const i=this.sampleDevice(n);i&&t.set(n.id,i)}return t}_sampleRGB(e){const t=this._parseComputedColor(e.color);return{Red:t.r,Green:t.g,Blue:t.b}}_sampleRGBA(e){const t=this._parseComputedColor(e.color),i=(e.getPropertyValue("--amber")||"0%").match(/(\d+(?:\.\d+)?)/),a=i?parseFloat(i[1]):0,o=Math.round(Math.max(0,Math.min(100,a))*255/100);return{Red:t.r,Green:t.g,Blue:t.b,Amber:o}}_sampleRGBW(e){const t=this._parseComputedColor(e.color),n=Math.min(t.r,t.g,t.b);return{Red:t.r,Green:t.g,Blue:t.b,White:n}}_sampleDimmer(e){const t=parseFloat(e.opacity)||1;return{Intensity:Math.round(t*255)}}_sampleSmoke(e){const n=(e.getPropertyValue("--smoke")||"0%").match(/(\d+(?:\.\d+)?)/),i=n?parseFloat(n[1]):0;return{Output:Math.round(Math.max(0,Math.min(100,i))*255/100)}}_sampleMovingHead(e){const t=this._parseComputedColor(e.color),n=parseFloat(e.opacity)||1,i=e.getPropertyValue("--pan")||"0%",a=e.getPropertyValue("--tilt")||"0%",o=i.match(/(-?\d+(?:\.\d+)?)/),c=o?parseFloat(o[1]):0,l=Math.round((Math.max(-50,Math.min(50,c))+50)/100*255),u=a.match(/(\d+(?:\.\d+)?)/),f=u?parseFloat(u[1]):0,d=Math.round(Math.max(0,Math.min(100,f))*255/100);return{Pan:l,Tilt:d,Dimmer:Math.round(n*255),Red:t.r,Green:t.g,Blue:t.b,White:Math.min(t.r,t.g,t.b)}}_sampleFlamethrower(e){const t=e.getPropertyValue("--safety")||"none",n=e.getPropertyValue("--fuel")||"0%",i=t.trim()==="probably"?125:0,a=n.match(/(\d+(?:\.\d+)?)/),o=a?parseFloat(a[1]):0,c=Math.round(Math.max(0,Math.min(100,o))*255/100);return{Safety:i,Fuel:c}}_parseComputedColor(e){const t=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([\d.]+))?\)/);return t?{r:parseInt(t[1]),g:parseInt(t[2]),b:parseInt(t[3]),a:t[4]?parseFloat(t[4]):1}:{r:0,g:0,b:0,a:1}}_parseTranslate(e){if(!e||e==="none")return{x:127,y:127};const t=e.match(/translate\(([^,)]+)(?:,?\s+([^)]+))?\)/);if(t){const n=this._parsePercentage(t[1]),i=t[2]?this._parsePercentage(t[2]):n;return{x:Math.round(n*255/100),y:Math.round(i*255/100)}}return{x:127,y:127}}_parsePercentage(e){const t=parseFloat(e);return e.includes("%")?Math.max(0,Math.min(100,t)):Math.max(0,Math.min(100,t/255*100))}getElement(e){return this.deviceElements.get(e)}clear(){for(const e of this.deviceElements.values())e.remove();this.deviceElements.clear()}}class Sl{constructor(){this.properties=new Map,this.styleElement=null}initialize(){this.styleElement=document.createElement("style"),this.styleElement.id="dmx-custom-properties",document.head.appendChild(this.styleElement),this._updateStyle()}setProperty(e,t){e.startsWith("--")||(e=`--${e}`),this.properties.set(e,t),this._updateStyle()}getProperty(e){return e.startsWith("--")||(e=`--${e}`),this.properties.get(e)}_updateStyle(){if(!this.styleElement)return;const e=Array.from(this.properties.entries()).map(([t,n])=>`  ${t}: ${n};`).join(`
`);this.styleElement.textContent=`:root {
${e}
}`}getAll(){return Array.from(this.properties.entries()).map(([e,t])=>({name:e,value:t}))}clear(){this.properties.clear(),this._updateStyle()}destroy(){this.styleElement&&(this.styleElement.remove(),this.styleElement=null),this.properties.clear()}}function nd(r){if(r.__esModule)return r;var e=r.default;if(typeof e=="function"){var t=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(n){var i=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:function(){return r[n]}})}),t}var us={},Xa={},ds=function(r,e){return ds=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},ds(r,e)};function Cl(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");ds(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var ra=function(){return ra=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},ra.apply(this,arguments)};function Dl(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t}function xl(r,e,t,n){var i=arguments.length,a=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(r,e,t,n);else for(var c=r.length-1;c>=0;c--)(o=r[c])&&(a=(i<3?o(a):i>3?o(e,t,a):o(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a}function El(r,e){return function(t,n){e(t,n,r)}}function Il(r,e,t,n,i,a){function o(x){if(x!==void 0&&typeof x!="function")throw new TypeError("Function expected");return x}for(var c=n.kind,l=c==="getter"?"get":c==="setter"?"set":"value",u=!e&&r?n.static?r:r.prototype:null,f=e||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),d,g=!1,m=t.length-1;m>=0;m--){var h={};for(var y in n)h[y]=y==="access"?{}:n[y];for(var y in n.access)h.access[y]=n.access[y];h.addInitializer=function(x){if(g)throw new TypeError("Cannot add initializers after decoration has completed");a.push(o(x||null))};var v=(0,t[m])(c==="accessor"?{get:f.get,set:f.set}:f[l],h);if(c==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(d=o(v.get))&&(f.get=d),(d=o(v.set))&&(f.set=d),(d=o(v.init))&&i.unshift(d)}else(d=o(v))&&(c==="field"?i.unshift(d):f[l]=d)}u&&Object.defineProperty(u,n.name,f),g=!0}function kl(r,e,t){for(var n=arguments.length>2,i=0;i<e.length;i++)t=n?e[i].call(r,t):e[i].call(r);return n?t:void 0}function Pl(r){return typeof r=="symbol"?r:"".concat(r)}function Ml(r,e,t){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(r,"name",{configurable:!0,value:t?"".concat(t," ",e):e})}function Ll(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function Al(r,e,t,n){function i(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function c(f){try{u(n.next(f))}catch(d){o(d)}}function l(f){try{u(n.throw(f))}catch(d){o(d)}}function u(f){f.done?a(f.value):i(f.value).then(c,l)}u((n=n.apply(r,e||[])).next())})}function Tl(r,e){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=c(0),o.throw=c(1),o.return=c(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(u){return function(f){return l([u,f])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(t=0)),t;)try{if(n=1,i&&(a=u[0]&2?i.return:u[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,u[1])).done)return a;switch(i=0,a&&(u=[u[0]&2,a.value]),u[0]){case 0:case 1:a=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!a||u[1]>a[0]&&u[1]<a[3])){t.label=u[1];break}if(u[0]===6&&t.label<a[1]){t.label=a[1],a=u;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(u);break}a[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(r,t)}catch(f){u=[6,f],i=0}finally{n=a=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}var xa=Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]};function Nl(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&xa(e,r,t)}function na(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function xs(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),i,a=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(c){o={error:c}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(o)throw o.error}}return a}function Rl(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(xs(arguments[e]));return r}function Ol(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var n=Array(r),i=0,e=0;e<t;e++)for(var a=arguments[e],o=0,c=a.length;o<c;o++,i++)n[i]=a[o];return n}function Fl(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,a;n<i;n++)(a||!(n in e))&&(a||(a=Array.prototype.slice.call(e,0,n)),a[n]=e[n]);return r.concat(a||Array.prototype.slice.call(e))}function jn(r){return this instanceof jn?(this.v=r,this):new jn(r)}function Vl(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),i,a=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(m){return function(h){return Promise.resolve(h).then(m,d)}}function c(m,h){n[m]&&(i[m]=function(y){return new Promise(function(v,x){a.push([m,y,v,x])>1||l(m,y)})},h&&(i[m]=h(i[m])))}function l(m,h){try{u(n[m](h))}catch(y){g(a[0][3],y)}}function u(m){m.value instanceof jn?Promise.resolve(m.value.v).then(f,d):g(a[0][2],m)}function f(m){l("next",m)}function d(m){l("throw",m)}function g(m,h){m(h),a.shift(),a.length&&l(a[0][0],a[0][1])}}function Bl(r){var e,t;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,a){e[i]=r[i]?function(o){return(t=!t)?{value:jn(r[i](o)),done:!1}:a?a(o):o}:a}}function jl(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof na=="function"?na(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(a){t[a]=r[a]&&function(o){return new Promise(function(c,l){o=r[a](o),i(c,l,o.done,o.value)})}}function i(a,o,c,l){Promise.resolve(l).then(function(u){a({value:u,done:c})},o)}}function Gl(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}var id=Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e},fs=function(r){return fs=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},fs(r)};function $l(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t=fs(r),n=0;n<t.length;n++)t[n]!=="default"&&xa(e,r,t[n]);return id(e,r),e}function Kl(r){return r&&r.__esModule?r:{default:r}}function Ul(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)}function Hl(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t}function zl(r,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof r=="function"?e===r:r.has(e)}function ql(r,e,t){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var n,i;if(t){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=e[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=e[Symbol.dispose],t&&(i=n)}if(typeof n!="function")throw new TypeError("Object not disposable.");i&&(n=function(){try{i.call(this)}catch(a){return Promise.reject(a)}}),r.stack.push({value:e,dispose:n,async:t})}else t&&r.stack.push({async:!0});return e}var ad=typeof SuppressedError=="function"?SuppressedError:function(r,e,t){var n=new Error(t);return n.name="SuppressedError",n.error=r,n.suppressed=e,n};function Wl(r){function e(a){r.error=r.hasError?new ad(a,r.error,"An error was suppressed during disposal."):a,r.hasError=!0}var t,n=0;function i(){for(;t=r.stack.pop();)try{if(!t.async&&n===1)return n=0,r.stack.push(t),Promise.resolve().then(i);if(t.dispose){var a=t.dispose.call(t.value);if(t.async)return n|=2,Promise.resolve(a).then(i,function(o){return e(o),i()})}else n|=1}catch(o){e(o)}if(n===1)return r.hasError?Promise.reject(r.error):Promise.resolve();if(r.hasError)throw r.error}return i()}function Yl(r,e){return typeof r=="string"&&/^\.\.?\//.test(r)?r.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(t,n,i,a,o){return n?e?".jsx":".js":i&&(!a||!o)?t:i+a+"."+o.toLowerCase()+"js"}):r}const sd={__extends:Cl,__assign:ra,__rest:Dl,__decorate:xl,__param:El,__esDecorate:Il,__runInitializers:kl,__propKey:Pl,__setFunctionName:Ml,__metadata:Ll,__awaiter:Al,__generator:Tl,__createBinding:xa,__exportStar:Nl,__values:na,__read:xs,__spread:Rl,__spreadArrays:Ol,__spreadArray:Fl,__await:jn,__asyncGenerator:Vl,__asyncDelegator:Bl,__asyncValues:jl,__makeTemplateObject:Gl,__importStar:$l,__importDefault:Kl,__classPrivateFieldGet:Ul,__classPrivateFieldSet:Hl,__classPrivateFieldIn:zl,__addDisposableResource:ql,__disposeResources:Wl,__rewriteRelativeImportExtension:Yl},od=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:ql,get __assign(){return ra},__asyncDelegator:Bl,__asyncGenerator:Vl,__asyncValues:jl,__await:jn,__awaiter:Al,__classPrivateFieldGet:Ul,__classPrivateFieldIn:zl,__classPrivateFieldSet:Hl,__createBinding:xa,__decorate:xl,__disposeResources:Wl,__esDecorate:Il,__exportStar:Nl,__extends:Cl,__generator:Tl,__importDefault:Kl,__importStar:$l,__makeTemplateObject:Gl,__metadata:Ll,__param:El,__propKey:Pl,__read:xs,__rest:Dl,__rewriteRelativeImportExtension:Yl,__runInitializers:kl,__setFunctionName:Ml,__spread:Rl,__spreadArray:Fl,__spreadArrays:Ol,__values:na,default:sd},Symbol.toStringTag,{value:"Module"})),ld=nd(od);var ft={};Object.defineProperty(ft,"__esModule",{value:!0});ft.MODEL_NAMES=ft.DeviceModelId=void 0;var pt;(function(r){r.ORIGINAL="original",r.ORIGINALV2="originalv2",r.ORIGINALMK2="original-mk2",r.ORIGINALMK2SCISSOR="original-mk2-scissor",r.MINI="mini",r.XL="xl",r.PEDAL="pedal",r.PLUS="plus",r.NEO="neo",r.STUDIO="studio",r.MODULE6="6-module",r.MODULE15="15-module",r.MODULE32="32-module",r.NETWORK_DOCK="network-dock"})(pt||(ft.DeviceModelId=pt={}));ft.MODEL_NAMES={[pt.ORIGINAL]:"Stream Deck",[pt.MINI]:"Stream Deck Mini",[pt.XL]:"Stream Deck XL",[pt.ORIGINALV2]:"Stream Deck",[pt.ORIGINALMK2]:"Stream Deck MK.2",[pt.ORIGINALMK2SCISSOR]:"Stream Deck MK.2 (Scissor)",[pt.PLUS]:"Stream Deck +",[pt.PEDAL]:"Stream Deck Pedal",[pt.NEO]:"Stream Deck Neo",[pt.STUDIO]:"Stream Deck Studio",[pt.MODULE6]:"Stream Deck 6 Module",[pt.MODULE15]:"Stream Deck 15 Module",[pt.MODULE32]:"Stream Deck 32 Module",[pt.NETWORK_DOCK]:"Stream Deck Network Dock"};var Ni={},Ri={},ei={},Xl={exports:{}};(function(r){var e=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function i(l,u,f){this.fn=l,this.context=u,this.once=f||!1}function a(l,u,f,d,g){if(typeof f!="function")throw new TypeError("The listener must be a function");var m=new i(f,d||l,g),h=t?t+u:u;return l._events[h]?l._events[h].fn?l._events[h]=[l._events[h],m]:l._events[h].push(m):(l._events[h]=m,l._eventsCount++),l}function o(l,u){--l._eventsCount===0?l._events=new n:delete l._events[u]}function c(){this._events=new n,this._eventsCount=0}c.prototype.eventNames=function(){var u=[],f,d;if(this._eventsCount===0)return u;for(d in f=this._events)e.call(f,d)&&u.push(t?d.slice(1):d);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(f)):u},c.prototype.listeners=function(u){var f=t?t+u:u,d=this._events[f];if(!d)return[];if(d.fn)return[d.fn];for(var g=0,m=d.length,h=new Array(m);g<m;g++)h[g]=d[g].fn;return h},c.prototype.listenerCount=function(u){var f=t?t+u:u,d=this._events[f];return d?d.fn?1:d.length:0},c.prototype.emit=function(u,f,d,g,m,h){var y=t?t+u:u;if(!this._events[y])return!1;var v=this._events[y],x=arguments.length,M,L;if(v.fn){switch(v.once&&this.removeListener(u,v.fn,void 0,!0),x){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,f),!0;case 3:return v.fn.call(v.context,f,d),!0;case 4:return v.fn.call(v.context,f,d,g),!0;case 5:return v.fn.call(v.context,f,d,g,m),!0;case 6:return v.fn.call(v.context,f,d,g,m,h),!0}for(L=1,M=new Array(x-1);L<x;L++)M[L-1]=arguments[L];v.fn.apply(v.context,M)}else{var F=v.length,I;for(L=0;L<F;L++)switch(v[L].once&&this.removeListener(u,v[L].fn,void 0,!0),x){case 1:v[L].fn.call(v[L].context);break;case 2:v[L].fn.call(v[L].context,f);break;case 3:v[L].fn.call(v[L].context,f,d);break;case 4:v[L].fn.call(v[L].context,f,d,g);break;default:if(!M)for(I=1,M=new Array(x-1);I<x;I++)M[I-1]=arguments[I];v[L].fn.apply(v[L].context,M)}}return!0},c.prototype.on=function(u,f,d){return a(this,u,f,d,!1)},c.prototype.once=function(u,f,d){return a(this,u,f,d,!0)},c.prototype.removeListener=function(u,f,d,g){var m=t?t+u:u;if(!this._events[m])return this;if(!f)return o(this,m),this;var h=this._events[m];if(h.fn)h.fn===f&&(!g||h.once)&&(!d||h.context===d)&&o(this,m);else{for(var y=0,v=[],x=h.length;y<x;y++)(h[y].fn!==f||g&&!h[y].once||d&&h[y].context!==d)&&v.push(h[y]);v.length?this._events[m]=v.length===1?v[0]:v:o(this,m)}return this},c.prototype.removeAllListeners=function(u){var f;return u?(f=t?t+u:u,this._events[f]&&o(this,f)):(this._events=new n,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=t,c.EventEmitter=c,r.exports=c})(Xl);var Jl=Xl.exports,zn={};Object.defineProperty(zn,"__esModule",{value:!0});zn.wrapBufferToPreparedBuffer=cd;zn.unwrapPreparedBufferToBuffer=ud;function cd(r,e,t,n){let i=t;return n&&(typeof Buffer<"u"?i=t.map(a=>Buffer.from(a).toString("base64")):i=t.map(a=>btoa(String.fromCharCode(...a)))),{if_you_change_this_you_will_break_everything:"This is a encoded form of the buffer, exactly as the Stream Deck expects it. Do not touch this object, or you can crash your stream deck",modelId:r,type:e,do_not_touch:i}}function ud(r,e){const t=e;if(t.modelId!==r)throw new Error("Prepared buffer is for a different model!");return t.do_not_touch.map(n=>{if(typeof n=="string")return typeof Buffer<"u"?Buffer.from(n,"base64"):new Uint8Array(atob(n).split("").map(i=>i.charCodeAt(0)));if(n instanceof Uint8Array)return n;throw new Error("Prepared buffer is not a string or Uint8Array!")})}var Ys;function Ur(){var i,a,o,c,l;if(Ys)return ei;Ys=1,Object.defineProperty(ei,"__esModule",{value:!0}),ei.StreamDeckBase=void 0;const r=Jl,e=ia(),t=zn;class n extends r.EventEmitter{constructor(d,g,m){var h;super();Je(this,"device");Je(this,"deviceProperties");W(this,i);W(this,a);W(this,o);W(this,c);W(this,l);this.device=d,this.deviceProperties=m.deviceProperties,U(this,i,m.properties),U(this,a,m.buttonsLcd),U(this,o,m.lcdSegmentDisplay),U(this,c,m.inputService),U(this,l,m.encoderLed),(h=m.events)==null||h.listen((y,...v)=>this.emit(y,...v)),this.device.on("input",y=>p(this,c).handleInput(y)),this.device.on("error",y=>{this.emit("error",y)})}get CONTROLS(){return this.deviceProperties.CONTROLS}get MODEL(){return this.deviceProperties.MODEL}get PRODUCT_NAME(){return this.deviceProperties.PRODUCT_NAME}get HAS_NFC_READER(){return this.deviceProperties.HAS_NFC_READER}checkValidKeyIndex(d,g){const m=this.deviceProperties.CONTROLS.find(h=>h.type==="button"&&h.index===d);if(!m)throw new TypeError("Expected a valid keyIndex");if(g&&m.feedbackType!==g)throw new TypeError("Expected a keyIndex with expected feedbackType")}calculateFillPanelDimensions(d){return p(this,a).calculateFillPanelDimensions(d)}async close(){return this.device.close()}async getHidDeviceInfo(){return this.device.getDeviceInfo()}async setBrightness(d){return p(this,i).setBrightness(d)}async resetToLogo(){return p(this,i).resetToLogo()}async getFirmwareVersion(){return p(this,i).getFirmwareVersion()}async getAllFirmwareVersions(){return p(this,i).getAllFirmwareVersions()}async getSerialNumber(){return p(this,i).getSerialNumber()}async sendPreparedBuffer(d){const g=(0,t.unwrapPreparedBufferToBuffer)(this.deviceProperties.MODEL,d);await this.device.sendReports(g)}async fillKeyColor(d,g,m,h){this.checkValidKeyIndex(d,null),await p(this,a).fillKeyColor(d,g,m,h)}async fillKeyBuffer(d,g,m){this.checkValidKeyIndex(d,"lcd"),await p(this,a).fillKeyBuffer(d,g,m)}async prepareFillKeyBuffer(d,g,m,h){return p(this,a).prepareFillKeyBuffer(d,g,m,h)}async fillPanelBuffer(d,g){await p(this,a).fillPanelBuffer(d,g)}async prepareFillPanelBuffer(d,g,m){return p(this,a).prepareFillPanelBuffer(d,g,m)}async clearKey(d){this.checkValidKeyIndex(d,null),await p(this,a).clearKey(d)}async clearPanel(){const d=[];d.push(p(this,a).clearPanel()),p(this,o)&&d.push(p(this,o).clearAllLcdSegments()),await Promise.all(d)}async fillLcd(...d){if(!p(this,o))throw new Error("Not supported for this model");return p(this,o).fillLcd(...d)}async fillLcdRegion(...d){if(!p(this,o))throw new Error("Not supported for this model");return p(this,o).fillLcdRegion(...d)}async prepareFillLcdRegion(...d){if(!p(this,o))throw new Error("Not supported for this model");return p(this,o).prepareFillLcdRegion(...d)}async clearLcdSegment(...d){if(!p(this,o))throw new Error("Not supported for this model");return p(this,o).clearLcdSegment(...d)}async setEncoderColor(...d){if(!p(this,l))throw new Error("Not supported for this model");return p(this,l).setEncoderColor(...d)}async setEncoderRingSingleColor(...d){if(!p(this,l))throw new Error("Not supported for this model");return p(this,l).setEncoderRingSingleColor(...d)}async setEncoderRingColors(...d){if(!p(this,l))throw new Error("Not supported for this model");return p(this,l).setEncoderRingColors(...d)}async getChildDeviceInfo(){const d=await this.device.getChildDeviceInfo();if(!d||d.vendorId!==e.VENDOR_ID)return null;const g=e.DEVICE_MODELS.find(m=>m.productIds.includes(d.productId));return g?{...d,model:g.id}:null}}return i=new WeakMap,a=new WeakMap,o=new WeakMap,c=new WeakMap,l=new WeakMap,ei.StreamDeckBase=n,ei}var Ea={};Object.defineProperty(Ea,"__esModule",{value:!0});Ea.Gen1PropertiesService=void 0;var or;class dd{constructor(e){W(this,or);U(this,or,e)}async setBrightness(e){if(e<0||e>100)throw new RangeError("Expected brightness percentage to be between 0 and 100");const t=new Uint8Array([5,85,170,209,1,e,0,0,0,0,0,0,0,0,0,0,0]);await p(this,or).sendFeatureReport(t)}async resetToLogo(){const e=new Uint8Array([11,99,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);await p(this,or).sendFeatureReport(e)}async getFirmwareVersion(){let e;try{e=await p(this,or).getFeatureReport(4,32)}catch{e=await p(this,or).getFeatureReport(4,17)}const t=e.indexOf(0,5);return new TextDecoder("ascii").decode(e.subarray(5,t===-1?void 0:t))}async getAllFirmwareVersions(){return{}}async getSerialNumber(){let e;try{e=await p(this,or).getFeatureReport(3,32)}catch{e=await p(this,or).getFeatureReport(3,17)}return new TextDecoder("ascii").decode(e.subarray(5,17))}}or=new WeakMap;Ea.Gen1PropertiesService=dd;var Ii={};Object.defineProperty(Ii,"__esModule",{value:!0});Ii.DefaultButtonsLcdService=void 0;const Xs=zn;var hi,pi,gr,mt;class fd{constructor(e,t,n,i){W(this,hi);W(this,pi);W(this,gr);W(this,mt);U(this,hi,e),U(this,pi,t),U(this,gr,n),U(this,mt,i)}getLcdButtonControls(){return p(this,mt).CONTROLS.filter(e=>e.type==="button"&&e.feedbackType==="lcd")}calculateLcdGridSpan(e){if(e.length===0)return null;const t=e.map(i=>i.row),n=e.map(i=>i.column);return{minRow:Math.min(...t),maxRow:Math.max(...t),minCol:Math.min(...n),maxCol:Math.max(...n)}}calculateDimensionsFromGridSpan(e,t,n){if(n)throw new Error("Not implemented");{const i=e.maxRow-e.minRow+1;return{width:(e.maxCol-e.minCol+1)*t.width,height:i*t.height}}}calculateFillPanelDimensions(e){const t=this.getLcdButtonControls(),n=this.calculateLcdGridSpan(t);return!n||t.length===0?null:this.calculateDimensionsFromGridSpan(n,t[0].pixelSize,e==null?void 0:e.withPadding)}async clearPanel(){const e=[];if(p(this,mt).FULLSCREEN_PANELS>0)for(let t=0;t<p(this,mt).FULLSCREEN_PANELS;t++)e.push(p(this,gr).sendFeatureReport(new Uint8Array([3,5,t,0,0,0])));else for(const t of p(this,mt).CONTROLS)if(t.type==="button")switch(t.feedbackType){case"rgb":e.push(this.sendKeyRgb(t.hidIndex,0,0,0));break;case"lcd":if(p(this,mt).SUPPORTS_RGB_KEY_FILL)e.push(this.sendKeyRgb(t.hidIndex,0,0,0));else{const n=new Uint8Array(t.pixelSize.width*t.pixelSize.height*3);e.push(this.fillImageRangeControl(t,n,{format:"rgb",offset:0,stride:t.pixelSize.width*3}))}break}await Promise.all(e)}async clearKey(e){const t=p(this,mt).CONTROLS.find(n=>n.type==="button"&&n.index===e);if(!t||t.feedbackType==="none")throw new TypeError("Expected a valid keyIndex");if(p(this,mt).SUPPORTS_RGB_KEY_FILL||t.feedbackType==="rgb")await this.sendKeyRgb(e,0,0,0);else{const n=new Uint8Array(t.pixelSize.width*t.pixelSize.height*3);await this.fillImageRangeControl(t,n,{format:"rgb",offset:0,stride:t.pixelSize.width*3})}}async fillKeyColor(e,t,n,i){this.checkRGBValue(t),this.checkRGBValue(n),this.checkRGBValue(i);const a=p(this,mt).CONTROLS.find(o=>o.type==="button"&&o.index===e);if(!a||a.feedbackType==="none")throw new TypeError("Expected a valid keyIndex");if(p(this,mt).SUPPORTS_RGB_KEY_FILL||a.feedbackType==="rgb")await this.sendKeyRgb(e,t,n,i);else{const o=a.pixelSize.width*a.pixelSize.height,c=new Uint8Array(o*4),l=new DataView(c.buffer,c.byteOffset,c.byteLength);l.setUint8(0,t),l.setUint8(1,n),l.setUint8(2,i),l.setUint8(3,255);const u=l.getUint32(0);for(let f=1;f<o;f++)l.setUint32(f*4,u);await this.fillImageRangeControl(a,c,{format:"rgba",offset:0,stride:a.pixelSize.width*4})}}async fillKeyBuffer(e,t,n){const i=await this.prepareFillKeyBufferInner(e,t,n);await p(this,gr).sendReports(i)}async prepareFillKeyBufferInner(e,t,n){const i=(n==null?void 0:n.format)??"rgb";this.checkSourceFormat(i);const a=p(this,mt).CONTROLS.find(c=>c.type==="button"&&c.index===e);if(!a||a.feedbackType==="none")throw new TypeError("Expected a valid keyIndex");if(a.feedbackType!=="lcd")throw new TypeError(`keyIndex ${a.index} does not support lcd feedback`);const o=a.pixelSize.width*a.pixelSize.height*i.length;if(t.length!==o)throw new RangeError(`Expected image buffer of length ${o}, got length ${t.length}`);return this.prepareFillImageRangeControl(a,t,{format:i,offset:0,stride:a.pixelSize.width*i.length})}async prepareFillKeyBuffer(e,t,n,i){const a=await this.prepareFillKeyBufferInner(e,t,n);return(0,Xs.wrapBufferToPreparedBuffer)(p(this,mt).MODEL,"fill-key",a,i??!1)}async fillPanelBuffer(e,t){const n=await this.prepareFillPanelBufferInner(e,t);await p(this,gr).sendReports(n)}async prepareFillPanelBufferInner(e,t){const n=(t==null?void 0:t.format)??"rgb";this.checkSourceFormat(n);const i=this.getLcdButtonControls(),a=this.calculateLcdGridSpan(i);if(!a||i.length===0)throw new Error("Panel does not support being filled");const o=this.calculateDimensionsFromGridSpan(a,i[0].pixelSize,t==null?void 0:t.withPadding),c=n.length*o.width*o.height;if(e.length!==c)throw new RangeError(`Expected image buffer of length ${c}, got length ${e.length}`);const l=o.width*n.length,u=[];for(const d of i){const g=d.row-a.minRow,m=d.column-a.minCol,h=d.pixelSize.width*n.length,y=l*g*d.pixelSize.height,v=m*h;u.push(this.prepareFillImageRangeControl(d,e,{format:n,offset:y+v,stride:l}))}return(await Promise.all(u)).flat()}async prepareFillPanelBuffer(e,t,n){const i=await this.prepareFillPanelBufferInner(e,t);return(0,Xs.wrapBufferToPreparedBuffer)(p(this,mt).MODEL,"fill-panel",i,n??!1)}async sendKeyRgb(e,t,n,i){await p(this,gr).sendFeatureReport(new Uint8Array([3,6,e,t,n,i]))}async fillImageRangeControl(e,t,n){const i=await this.prepareFillImageRangeControl(e,t,n);await p(this,gr).sendReports(i)}async prepareFillImageRangeControl(e,t,n){if(e.feedbackType!=="lcd")throw new TypeError(`keyIndex ${e.index} does not support lcd feedback`);const i=await p(this,pi).convertPixelBuffer(t,n,e.pixelSize);return p(this,hi).generateFillImageWrites({keyIndex:e.hidIndex},i)}checkRGBValue(e){if(e<0||e>255)throw new TypeError("Expected a valid color RGB value 0 - 255")}checkSourceFormat(e){switch(e){case"rgb":case"rgba":case"bgr":case"bgra":break;default:{const t=e;throw new TypeError(`Expected a known color format not "${t}"`)}}}}hi=new WeakMap,pi=new WeakMap,gr=new WeakMap,mt=new WeakMap;Ii.DefaultButtonsLcdService=fd;var Ia={},Lr={},Js;function Hr(){if(Js)return Lr;Js=1,Object.defineProperty(Lr,"__esModule",{value:!0}),Lr.BMP_HEADER_LENGTH=void 0,Lr.transformImageBuffer=r,Lr.writeBMPHeader=e,Lr.uint8ArrayToDataView=t;function r(n,i,a,o,c,l){const u=t(n),f=new Uint8Array(o+c*l*a.colorMode.length),d=t(f),g=i.format.substring(0,3)!==a.colorMode.substring(0,3);for(let m=0;m<l;m++){const h=o+c*a.colorMode.length*m;for(let y=0;y<c;y++){let v=a.xFlip?c-y-1:y,x=a.yFlip?l-m-1:m;if(a.rotate){const j=v;v=x,x=j}const M=x*i.stride+i.offset+v*i.format.length,L=u.getUint8(M),F=u.getUint8(M+1),I=u.getUint8(M+2),P=h+y*a.colorMode.length;g?(d.setUint8(P,I),d.setUint8(P+1,F),d.setUint8(P+2,L)):(d.setUint8(P,L),d.setUint8(P+1,F),d.setUint8(P+2,I)),a.colorMode.length===4&&d.setUint8(P+3,255)}}return f}Lr.BMP_HEADER_LENGTH=54;function e(n,i,a,o,c){const l=t(n);l.setUint8(0,66),l.setUint8(1,77),l.setUint32(2,o+54,!0),l.setInt16(6,0,!0),l.setInt16(8,0,!0),l.setUint32(10,54,!0),l.setUint32(14,40,!0),l.setInt32(18,i,!0),l.setInt32(22,a,!0),l.setInt16(26,1,!0),l.setInt16(28,24,!0),l.setInt32(30,0,!0),l.setInt32(34,o,!0),l.setInt32(38,c,!0),l.setInt32(42,c,!0),l.setInt32(46,0,!0),l.setInt32(50,0,!0)}function t(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}return Lr}Object.defineProperty(Ia,"__esModule",{value:!0});Ia.BitmapButtonLcdImagePacker=void 0;const Oi=Hr();var mi,_i;class vd{constructor(e,t){W(this,mi);W(this,_i);U(this,mi,e),U(this,_i,t)}async convertPixelBuffer(e,t,n){const i=(0,Oi.transformImageBuffer)(e,t,p(this,mi),Oi.BMP_HEADER_LENGTH,n.width,n.height);return(0,Oi.writeBMPHeader)(i,n.width,n.height,i.length-Oi.BMP_HEADER_LENGTH,p(this,_i)),i}}mi=new WeakMap,_i=new WeakMap;Ia.BitmapButtonLcdImagePacker=vd;var mn={};Object.defineProperty(mn,"__esModule",{value:!0});mn.CallbackHook=void 0;var kn;class hd{constructor(){W(this,kn,null)}emit(e,...t){if(!p(this,kn))throw new Error("No listener setup");p(this,kn).call(this,e,...t)}listen(e){U(this,kn,e)}}kn=new WeakMap;mn.CallbackHook=hd;var qn={};Object.defineProperty(qn,"__esModule",{value:!0});qn.ButtonOnlyInputService=void 0;var Pn,Mn;class pd{constructor(e,t){Je(this,"deviceProperties");W(this,Pn);W(this,Mn);this.deviceProperties=e,U(this,Mn,t);const n=this.deviceProperties.CONTROLS.filter(i=>i.type==="button").map(i=>i.index);U(this,Pn,new Array(Math.max(-1,...n)+1).fill(!1))}handleInput(e){const t=this.deviceProperties.KEY_DATA_OFFSET||0;for(const n of this.deviceProperties.CONTROLS){if(n.type!=="button")continue;const i=!!e[t+n.hidIndex];i!==p(this,Pn)[n.index]&&(p(this,Pn)[n.index]=i,i?p(this,Mn).emit("down",n):p(this,Mn).emit("up",n))}}}Pn=new WeakMap,Mn=new WeakMap;qn.ButtonOnlyInputService=pd;var Zs;function Zl(){if(Zs)return Ri;Zs=1,Object.defineProperty(Ri,"__esModule",{value:!0}),Ri.StreamDeckGen1Factory=c;const r=Ur(),e=Ea,t=Ii,n=Ia,i=mn,a=qn;function o(l){return{...l,KEY_DATA_OFFSET:0,HAS_NFC_READER:!1,SUPPORTS_CHILD_DEVICES:!1}}function c(l,u,f,d,g,m){const h=o(f),y=new i.CallbackHook;return new r.StreamDeckBase(l,u,{deviceProperties:h,events:y,properties:new e.Gen1PropertiesService(l),buttonsLcd:new t.DefaultButtonsLcdService(d,new n.BitmapButtonLcdImagePacker(g,m),l,h),lcdSegmentDisplay:null,inputService:new a.ButtonOnlyInputService(h,y),encoderLed:null})}return Ri}var dr={},It={};Object.defineProperty(It,"__esModule",{value:!0});It.StreamdeckNeoLcdImageHeaderGenerator=It.StreamdeckPlusLcdImageHeaderGenerator=It.StreamdeckGen2ImageHeaderGenerator=It.StreamdeckGen1ImageHeaderGenerator=void 0;const ka=Hr();class md{getFillImageCommandHeaderLength(){return 16}writeFillImageCommandHeader(e,t,n,i,a){const o=(0,ka.uint8ArrayToDataView)(e);o.setUint8(0,2),o.setUint8(1,1),o.setUint16(2,n,!0),o.setUint8(4,i?1:0),o.setUint8(5,t.keyIndex+1)}}It.StreamdeckGen1ImageHeaderGenerator=md;class _d{getFillImageCommandHeaderLength(){return 8}writeFillImageCommandHeader(e,t,n,i,a){const o=(0,ka.uint8ArrayToDataView)(e);o.setUint8(0,2),o.setUint8(1,7),o.setUint8(2,t.keyIndex),o.setUint8(3,i?1:0),o.setUint16(4,a,!0),o.setUint16(6,n++,!0)}}It.StreamdeckGen2ImageHeaderGenerator=_d;class gd{getFillImageCommandHeaderLength(){return 16}writeFillImageCommandHeader(e,t,n,i,a){const o=(0,ka.uint8ArrayToDataView)(e);o.setUint8(0,2),o.setUint8(1,12),o.setUint16(2,t.x,!0),o.setUint16(4,t.y,!0),o.setUint16(6,t.width,!0),o.setUint16(8,t.height,!0),o.setUint8(10,i?1:0),o.setUint16(11,n,!0),o.setUint16(13,a,!0)}}It.StreamdeckPlusLcdImageHeaderGenerator=gd;class yd{getFillImageCommandHeaderLength(){return 8}writeFillImageCommandHeader(e,t,n,i,a){const o=(0,ka.uint8ArrayToDataView)(e);o.setUint8(0,2),o.setUint8(1,11),o.setUint8(2,0),o.setUint8(3,i?1:0),o.setUint16(4,a,!0),o.setUint16(6,n,!0)}}It.StreamdeckNeoLcdImageHeaderGenerator=yd;Object.defineProperty(dr,"__esModule",{value:!0});dr.StreamdeckDefaultImageWriter=dr.StreamdeckOriginalImageWriter=void 0;const wd=It;class bd{constructor(){Je(this,"headerGenerator",new wd.StreamdeckGen1ImageHeaderGenerator)}generateFillImageWrites(e,t){const i=this.headerGenerator.getFillImageCommandHeaderLength(),a=t.length/2,o=new Uint8Array(8191);this.headerGenerator.writeFillImageCommandHeader(o,e,1,!1,a),o.set(t.subarray(0,a),i);const c=new Uint8Array(8191);return this.headerGenerator.writeFillImageCommandHeader(c,e,2,!0,a),c.set(t.subarray(a),i),[o,c]}}dr.StreamdeckOriginalImageWriter=bd;class Sd{constructor(e){Je(this,"headerGenerator");this.headerGenerator=e}generateFillImageWrites(e,t){const i=this.headerGenerator.getFillImageCommandHeaderLength(),a=1024-i,o=[];let c=t.length;for(let l=0;c>0;l++){const u=new Uint8Array(1024),f=Math.min(c,a);this.headerGenerator.writeFillImageCommandHeader(u,e,l,c<=a,f);const d=t.length-c;c-=f,u.set(t.subarray(d,d+f),i),o.push(u)}return o}}dr.StreamdeckDefaultImageWriter=Sd;var Wt={};Object.defineProperty(Wt,"__esModule",{value:!0});Wt.generateButtonsGrid=Cd;Wt.freezeDefinitions=xd;function Cd(r,e,t,n=!1,i=0){const a=[];for(let o=0;o<e;o++)for(let c=0;c<r;c++){const l=o*r+c,u=n?Dd(r,l):l;a.push({type:"button",row:o,column:c+i,index:l,hidIndex:u,feedbackType:"lcd",pixelSize:t})}return a}function Dd(r,e){const t=(r-1)/2,n=(e%r-t)*-t;return e+n}function xd(r){return Object.freeze(r.map(e=>Object.freeze(e)))}var Qs;function Ed(){if(Qs)return Ni;Qs=1,Object.defineProperty(Ni,"__esModule",{value:!0}),Ni.StreamDeckOriginalFactory=a;const r=Zl(),e=ft,t=dr,n=Wt,i={MODEL:e.DeviceModelId.ORIGINAL,PRODUCT_NAME:e.MODEL_NAMES[e.DeviceModelId.ORIGINAL],SUPPORTS_RGB_KEY_FILL:!1,CONTROLS:(0,n.freezeDefinitions)((0,n.generateButtonsGrid)(5,3,{width:72,height:72},!0)),KEY_SPACING_HORIZONTAL:25,KEY_SPACING_VERTICAL:25,FULLSCREEN_PANELS:0};function a(o,c){return(0,r.StreamDeckGen1Factory)(o,c,i,new t.StreamdeckOriginalImageWriter,{colorMode:"bgr",xFlip:!0},3780)}return Ni}var Fi={},eo;function Id(){if(eo)return Fi;eo=1,Object.defineProperty(Fi,"__esModule",{value:!0}),Fi.StreamDeck6KeyFactory=o;const r=Zl(),e=ft,t=Wt,n=dr,i=It,a={SUPPORTS_RGB_KEY_FILL:!1,CONTROLS:(0,t.freezeDefinitions)((0,t.generateButtonsGrid)(3,2,{width:80,height:80})),KEY_SPACING_HORIZONTAL:28,KEY_SPACING_VERTICAL:28,FULLSCREEN_PANELS:0};function o(c,l,u,f){const d={...a,MODEL:c,PRODUCT_NAME:e.MODEL_NAMES[c]};return(0,r.StreamDeckGen1Factory)(l,u,d,new n.StreamdeckDefaultImageWriter(new i.StreamdeckGen1ImageHeaderGenerator),{colorMode:"bgr",rotate:!0,yFlip:!0},2835)}return Fi}var Vi={},_n={},ki={};Object.defineProperty(ki,"__esModule",{value:!0});ki.Gen2PropertiesService=void 0;class kd{constructor(e){Je(this,"device");this.device=e}async setBrightness(e){if(e<0||e>100)throw new RangeError("Expected brightness percentage to be between 0 and 100");const t=new Uint8Array([3,8,e,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);await this.device.sendFeatureReport(t)}async resetToLogo(){const e=new Uint8Array([3,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);await this.device.sendFeatureReport(e)}async getFirmwareVersion(){const e=await this.device.getFeatureReport(5,32),t=e[1]+2;return new TextDecoder("ascii").decode(e.subarray(6,t))}async getAllFirmwareVersions(){return{AP2:await this.getFirmwareVersion()}}async getSerialNumber(){const e=await this.device.getFeatureReport(6,32),t=e[1]+2;return new TextDecoder("ascii").decode(e.subarray(2,t))}}ki.Gen2PropertiesService=kd;var Pa={};Object.defineProperty(Pa,"__esModule",{value:!0});Pa.JpegButtonLcdImagePacker=void 0;const Pd=Hr();var gi,Ln;class Md{constructor(e,t){W(this,gi);W(this,Ln);U(this,gi,e),U(this,Ln,t)}async convertPixelBuffer(e,t,n){const i=(0,Pd.transformImageBuffer)(e,t,{colorMode:"rgba",xFlip:p(this,Ln),yFlip:p(this,Ln)},0,n.width,n.height);return p(this,gi).call(this,i,n.width,n.height)}}gi=new WeakMap,Ln=new WeakMap;Pa.JpegButtonLcdImagePacker=Md;var Ma={};Object.defineProperty(Ma,"__esModule",{value:!0});Ma.Gen2InputService=void 0;const Ld=qn,Ad=Hr();var Qt,en,An,yi,Kr,Ql,ec,tc;class Td extends Ld.ButtonOnlyInputService{constructor(t,n){super(t,n);W(this,Kr);W(this,Qt);W(this,en);W(this,An);W(this,yi);U(this,Qt,n),U(this,en,t.CONTROLS.filter(a=>a.type==="encoder"));const i=Math.max(-1,...p(this,en).map(a=>a.index));U(this,An,new Array(i+1).fill(!1)),U(this,yi,t.CONTROLS.filter(a=>a.type==="lcd-segment"))}handleInput(t){switch(t[0]){case 0:super.handleInput(t);break;case 2:He(this,Kr,Ql).call(this,t);break;case 3:He(this,Kr,ec).call(this,t);break;case 4:He(this,Kr,tc).call(this,t);break}}}Qt=new WeakMap,en=new WeakMap,An=new WeakMap,yi=new WeakMap,Kr=new WeakSet,Ql=function(t){const n=p(this,yi).find(o=>o.id===0);if(!n)return;const i=(0,Ad.uint8ArrayToDataView)(t),a={x:i.getUint16(5,!0),y:i.getUint16(7,!0)};switch(t[3]){case 1:p(this,Qt).emit("lcdShortPress",n,a);break;case 2:p(this,Qt).emit("lcdLongPress",n,a);break;case 3:{const o={x:i.getUint16(9,!0),y:i.getUint16(11,!0)};p(this,Qt).emit("lcdSwipe",n,a,o);break}}},ec=function(t){switch(t[3]){case 0:for(const n of p(this,en)){const i=!!t[4+n.hidIndex];i!==p(this,An)[n.index]&&(p(this,An)[n.index]=i,i?p(this,Qt).emit("down",n):p(this,Qt).emit("up",n))}break;case 1:for(const n of p(this,en)){const a=new Int8Array(t.buffer,t.byteOffset,t.byteLength)[4+n.hidIndex];a!==0&&p(this,Qt).emit("rotate",n,a)}break}},tc=function(t){if(!this.deviceProperties.HAS_NFC_READER)return;const n=t[1]+t[2]*256,i=new TextDecoder("ascii").decode(t.subarray(3,3+n));p(this,Qt).emit("nfcRead",i)};Ma.Gen2InputService=Td;var La={};Object.defineProperty(La,"__esModule",{value:!0});La.EncoderLedService=void 0;var tn,Or;class Nd{constructor(e,t){W(this,tn);W(this,Or);U(this,tn,e),U(this,Or,t.filter(n=>n.type==="encoder"))}async clearAll(){const e=[];for(const t of p(this,Or))t.hasLed&&e.push(this.setEncoderColor(t.index,0,0,0)),t.ledRingSteps>0&&e.push(this.setEncoderRingSingleColor(t.index,0,0,0));await Promise.all(e)}async setEncoderColor(e,t,n,i){const a=p(this,Or).find(c=>c.index===e);if(!a)throw new Error(`Invalid encoder index ${e}`);if(!a.hasLed)throw new Error("Encoder does not have an LED");const o=new Uint8Array(1024);o[0]=2,o[1]=16,o[2]=e,o[3]=t,o[4]=n,o[5]=i,await p(this,tn).sendReports([o])}async setEncoderRingSingleColor(e,t,n,i){const a=p(this,Or).find(c=>c.index===e);if(!a)throw new Error(`Invalid encoder index ${e}`);if(a.ledRingSteps<=0)throw new Error("Encoder does not have an LED ring");const o=new Uint8Array(1024);o[0]=2,o[1]=15,o[2]=e;for(let c=0;c<a.ledRingSteps;c++){const l=3+c*3;o[l]=t,o[l+1]=n,o[l+2]=i}await p(this,tn).sendReports([o])}async setEncoderRingColors(e,t){const n=p(this,Or).find(o=>o.index===e);if(!n)throw new Error(`Invalid encoder index ${e}`);if(n.ledRingSteps<=0)throw new Error("Encoder does not have an LED ring");if(t.length!==n.ledRingSteps*3)throw new Error("Invalid colors length");let i=t instanceof Uint8Array?t:new Uint8Array(t);if(n.lcdRingOffset){const o=i;i=new Uint8Array(o.length),i.set(o.slice(n.lcdRingOffset*3),0),i.set(o.slice(0,n.lcdRingOffset*3),n.lcdRingOffset*3)}const a=new Uint8Array(1024);a[0]=2,a[1]=15,a[2]=e,a.set(i,3),await p(this,tn).sendReports([a])}}tn=new WeakMap,Or=new WeakMap;La.EncoderLedService=Nd;Object.defineProperty(_n,"__esModule",{value:!0});_n.createBaseGen2Properties=Ud;const Rd=dr,Od=It,Fd=Ii,Vd=mn,Bd=ki,jd=Pa,Gd=Ma,$d=La;function Kd(r){return{...r,KEY_DATA_OFFSET:3}}function Ud(r,e,t,n,i){const a=Kd(t),o=new Vd.CallbackHook;return{deviceProperties:a,events:o,properties:n??new Bd.Gen2PropertiesService(r),buttonsLcd:new Fd.DefaultButtonsLcdService(new Rd.StreamdeckDefaultImageWriter(new Od.StreamdeckGen2ImageHeaderGenerator),new jd.JpegButtonLcdImagePacker(e.encodeJPEG,!i),r,a),lcdSegmentDisplay:null,inputService:new Gd.Gen2InputService(a,o),encoderLed:new $d.EncoderLedService(r,t.CONTROLS)}}var to;function Hd(){if(to)return Vi;to=1,Object.defineProperty(Vi,"__esModule",{value:!0}),Vi.StreamDeck32KeyFactory=a;const r=Ur(),e=_n,t=ft,n=Wt,i={SUPPORTS_RGB_KEY_FILL:!1,CONTROLS:(0,n.freezeDefinitions)((0,n.generateButtonsGrid)(8,4,{width:96,height:96})),KEY_SPACING_HORIZONTAL:32,KEY_SPACING_VERTICAL:39,FULLSCREEN_PANELS:0,HAS_NFC_READER:!1,SUPPORTS_CHILD_DEVICES:!1};function a(o,c,l,u){const f={...i,MODEL:o,PRODUCT_NAME:t.MODEL_NAMES[o]},d=(0,e.createBaseGen2Properties)(c,l,f,null);return new r.StreamDeckBase(c,l,d)}return Vi}var Bi={},ro;function zd(){if(ro)return Bi;ro=1,Object.defineProperty(Bi,"__esModule",{value:!0}),Bi.StreamDeck15KeyFactory=a;const r=Ur(),e=_n,t=ft,n=Wt,i={SUPPORTS_RGB_KEY_FILL:!1,CONTROLS:(0,n.freezeDefinitions)((0,n.generateButtonsGrid)(5,3,{width:72,height:72})),KEY_SPACING_HORIZONTAL:25,KEY_SPACING_VERTICAL:25,FULLSCREEN_PANELS:0,HAS_NFC_READER:!1,SUPPORTS_CHILD_DEVICES:!1};function a(o,c,l,u){const f={...i,MODEL:o,PRODUCT_NAME:t.MODEL_NAMES[o]},d=(0,e.createBaseGen2Properties)(c,l,f,null);return new r.StreamDeckBase(c,l,d)}return Bi}var ji={},Aa={};Object.defineProperty(Aa,"__esModule",{value:!0});Aa.StreamDeckPlusLcdService=void 0;const qd=It,Wd=dr,Yd=Hr(),Xd=zn,Jd=ft;var wi,rn,yr,da;class Zd{constructor(e,t,n){W(this,wi);W(this,rn);W(this,yr);W(this,da,new Wd.StreamdeckDefaultImageWriter(new qd.StreamdeckPlusLcdImageHeaderGenerator));U(this,wi,e),U(this,rn,t),U(this,yr,n)}async fillLcd(e,t,n){const i=p(this,yr).find(o=>o.id===e);if(!i)throw new Error(`Invalid lcd segment index ${e}`);const a=await this.prepareFillControlRegion(i,0,0,t,{format:n.format,width:i.pixelSize.width,height:i.pixelSize.height});await p(this,rn).sendReports(a)}async fillLcdRegion(e,t,n,i,a){const o=p(this,yr).find(l=>l.id===e);if(!o)throw new Error(`Invalid lcd segment index ${e}`);const c=await this.prepareFillControlRegion(o,t,n,i,a);await p(this,rn).sendReports(c)}async prepareFillLcdRegion(e,t,n,i,a,o){const c=p(this,yr).find(u=>u.id===e);if(!c)throw new Error(`Invalid lcd segment index ${e}`);const l=await this.prepareFillControlRegion(c,t,n,i,a);return(0,Xd.wrapBufferToPreparedBuffer)(Jd.DeviceModelId.PLUS,"fill-lcd-region",l,o??!1)}async clearLcdSegment(e){const t=p(this,yr).find(a=>a.id===e);if(!t)throw new Error(`Invalid lcd segment index ${e}`);const n=new Uint8Array(t.pixelSize.width*t.pixelSize.height*4),i=await this.prepareFillControlRegion(t,0,0,n,{format:"rgba",width:t.pixelSize.width,height:t.pixelSize.height});await p(this,rn).sendReports(i)}async clearAllLcdSegments(){const e=[];for(const t of p(this,yr))e.push(this.clearLcdSegment(t.id));await Promise.all(e)}async prepareFillControlRegion(e,t,n,i,a){const o=e.pixelSize;if(t<0||t+a.width>o.width)throw new TypeError("Image will not fit within the lcd segment");if(n<0||n+a.height>o.height)throw new TypeError("Image will not fit within the lcd segment");const c=a.width*a.height*a.format.length;if(i.length!==c)throw new RangeError(`Expected image buffer of length ${c}, got length ${i.length}`);const l=await this.convertFillLcdBuffer(i,a);return p(this,da).generateFillImageWrites({...a,x:t,y:n},l)}async convertFillLcdBuffer(e,t){const n={format:t.format,offset:0,stride:t.width*t.format.length},i=(0,Yd.transformImageBuffer)(e,n,{colorMode:"rgba"},0,t.width,t.height);return p(this,wi).call(this,i,t.width,t.height)}}wi=new WeakMap,rn=new WeakMap,yr=new WeakMap,da=new WeakMap;Aa.StreamDeckPlusLcdService=Zd;var no;function Qd(){if(no)return ji;no=1,Object.defineProperty(ji,"__esModule",{value:!0}),ji.StreamDeckPlusFactory=l;const r=Ur(),e=_n,t=ft,n=Wt,i=Aa,a=(0,n.generateButtonsGrid)(4,2,{width:120,height:120});a.push({type:"lcd-segment",row:2,column:0,columnSpan:4,rowSpan:1,id:0,pixelSize:Object.freeze({width:800,height:100}),drawRegions:!0},{type:"encoder",row:3,column:0,index:0,hidIndex:0,hasLed:!1,ledRingSteps:0},{type:"encoder",row:3,column:1,index:1,hidIndex:1,hasLed:!1,ledRingSteps:0},{type:"encoder",row:3,column:2,index:2,hidIndex:2,hasLed:!1,ledRingSteps:0},{type:"encoder",row:3,column:3,index:3,hidIndex:3,hasLed:!1,ledRingSteps:0});const o={MODEL:t.DeviceModelId.PLUS,PRODUCT_NAME:t.MODEL_NAMES[t.DeviceModelId.PLUS],SUPPORTS_RGB_KEY_FILL:!0,CONTROLS:(0,n.freezeDefinitions)(a),KEY_SPACING_HORIZONTAL:99,KEY_SPACING_VERTICAL:40,FULLSCREEN_PANELS:0,HAS_NFC_READER:!1,SUPPORTS_CHILD_DEVICES:!1},c=o.CONTROLS.filter(u=>u.type==="lcd-segment");function l(u,f){const d=(0,e.createBaseGen2Properties)(u,f,o,null,!0);return d.lcdSegmentDisplay=new i.StreamDeckPlusLcdService(f.encodeJPEG,u,c),new r.StreamDeckBase(u,f,d)}return ji}var Gi={},Ta={};Object.defineProperty(Ta,"__esModule",{value:!0});Ta.PedalPropertiesService=void 0;var Tn;class ef{constructor(e){W(this,Tn);U(this,Tn,e)}async setBrightness(e){}async resetToLogo(){}async getFirmwareVersion(){const e=await p(this,Tn).getFeatureReport(5,32),t=e.indexOf(0,6);return new TextDecoder("ascii").decode(e.subarray(6,t===-1?void 0:t))}async getAllFirmwareVersions(){return{AP2:await this.getFirmwareVersion()}}async getSerialNumber(){const e=await p(this,Tn).getFeatureReport(6,32);return new TextDecoder("ascii").decode(e.subarray(2,14))}}Tn=new WeakMap;Ta.PedalPropertiesService=ef;var Pi={};Object.defineProperty(Pi,"__esModule",{value:!0});Pi.FakeLcdService=void 0;class tf{calculateFillPanelDimensions(e){return null}async clearKey(e){}async clearPanel(){}async fillKeyColor(e,t,n,i){}async fillKeyBuffer(e,t,n){}async prepareFillKeyBuffer(e,t,n,i){throw new Error("Not supported")}async fillPanelBuffer(e,t){}async prepareFillPanelBuffer(e,t,n){throw new Error("Not supported")}}Pi.FakeLcdService=tf;var io;function rf(){if(io)return Gi;io=1,Object.defineProperty(Gi,"__esModule",{value:!0}),Gi.StreamDeckPedalFactory=u;const r=Ur(),e=ft,t=Wt,n=Ta,i=Pi,a=mn,o=qn,c=[{type:"button",row:0,column:0,index:0,hidIndex:0,feedbackType:"none"},{type:"button",row:0,column:1,index:1,hidIndex:1,feedbackType:"none"},{type:"button",row:0,column:2,index:2,hidIndex:2,feedbackType:"none"}],l={MODEL:e.DeviceModelId.PEDAL,PRODUCT_NAME:e.MODEL_NAMES[e.DeviceModelId.PEDAL],KEY_DATA_OFFSET:3,SUPPORTS_RGB_KEY_FILL:!1,CONTROLS:(0,t.freezeDefinitions)(c),KEY_SPACING_HORIZONTAL:0,KEY_SPACING_VERTICAL:0,FULLSCREEN_PANELS:0,HAS_NFC_READER:!1,SUPPORTS_CHILD_DEVICES:!1};function u(f,d){const g=new a.CallbackHook;return new r.StreamDeckBase(f,d,{deviceProperties:l,events:g,properties:new n.PedalPropertiesService(f),buttonsLcd:new i.FakeLcdService,lcdSegmentDisplay:null,inputService:new o.ButtonOnlyInputService(l,g),encoderLed:null})}return Gi}var $i={},Na={};Object.defineProperty(Na,"__esModule",{value:!0});Na.StreamDeckNeoLcdService=void 0;const nf=It,af=dr,sf=Hr();var bi,Si,nn,fa;class of{constructor(e,t,n){W(this,bi);W(this,Si);W(this,nn);W(this,fa,new af.StreamdeckDefaultImageWriter(new nf.StreamdeckNeoLcdImageHeaderGenerator));U(this,bi,e),U(this,Si,t),U(this,nn,n)}async fillLcdRegion(e,t,n,i,a){throw new Error("Not supported for this model")}async prepareFillLcdRegion(e,t,n,i,a,o){throw new Error("Not supported for this model")}async fillLcd(e,t,n){const i=p(this,nn).find(l=>l.id===e);if(!i)throw new Error(`Invalid lcd segment index ${e}`);const a=i.pixelSize.width*i.pixelSize.height*n.format.length;if(t.length!==a)throw new RangeError(`Expected image buffer of length ${a}, got length ${t.length}`);const o=await this.convertFillLcdBuffer(t,i.pixelSize,n),c=p(this,fa).generateFillImageWrites(null,o);await p(this,Si).sendReports(c)}async clearLcdSegment(e){const t=p(this,nn).find(i=>i.id===e);if(!t)throw new Error(`Invalid lcd segment index ${e}`);const n=new Uint8Array(t.pixelSize.width*t.pixelSize.height*4);await this.fillLcd(e,n,{format:"rgba"})}async clearAllLcdSegments(){const e=[];for(const t of p(this,nn))e.push(this.clearLcdSegment(t.id));await Promise.all(e)}async convertFillLcdBuffer(e,t,n){const i={format:n.format,offset:0,stride:t.width*n.format.length},a=(0,sf.transformImageBuffer)(e,i,{colorMode:"rgba",xFlip:!0,yFlip:!0},0,t.width,t.height);return p(this,bi).call(this,a,t.width,t.height)}}bi=new WeakMap,Si=new WeakMap,nn=new WeakMap,fa=new WeakMap;Na.StreamDeckNeoLcdService=of;var ao;function lf(){if(ao)return $i;ao=1,Object.defineProperty($i,"__esModule",{value:!0}),$i.StreamDeckNeoFactory=l;const r=Ur(),e=ft,t=_n,n=Wt,i=Na,a=(0,n.generateButtonsGrid)(4,2,{width:96,height:96});a.push({type:"button",row:2,column:0,index:8,hidIndex:8,feedbackType:"rgb"},{type:"lcd-segment",row:2,column:1,columnSpan:2,rowSpan:1,id:0,pixelSize:{width:248,height:58},drawRegions:!1},{type:"button",row:2,column:3,index:9,hidIndex:9,feedbackType:"rgb"});const o={MODEL:e.DeviceModelId.NEO,PRODUCT_NAME:e.MODEL_NAMES[e.DeviceModelId.NEO],CONTROLS:(0,n.freezeDefinitions)(a),KEY_SPACING_HORIZONTAL:30,KEY_SPACING_VERTICAL:30,FULLSCREEN_PANELS:0,HAS_NFC_READER:!1,SUPPORTS_CHILD_DEVICES:!1,SUPPORTS_RGB_KEY_FILL:!0},c=o.CONTROLS.filter(u=>u.type==="lcd-segment");function l(u,f){const d=(0,t.createBaseGen2Properties)(u,f,o,null);return d.lcdSegmentDisplay=new i.StreamDeckNeoLcdService(f.encodeJPEG,u,c),new r.StreamDeckBase(u,f,d)}return $i}var Ja={},Ra={},Ki={},so;function Es(){if(so)return Ki;so=1,Object.defineProperty(Ki,"__esModule",{value:!0}),Ki.parseAllFirmwareVersionsHelper=e;const r=Hr();async function e(t){const n=new TextDecoder("ascii"),i={};if(t.ap2){const a=(0,r.uint8ArrayToDataView)(t.ap2);i.AP2=n.decode(t.ap2.subarray(6,14)),i.AP2_CHECKSUM=a.getUint32(2,!1).toString(16)}if(t.encoderLd&&(t.encoderLd[0]===24||t.encoderLd[1]===24)){const a=(0,r.uint8ArrayToDataView)(t.encoderLd);i.ENCODER_LD=n.decode(t.encoderLd.subarray(2,10)),i.ENCODER_LD_CHECKSUM=a.getUint32(10,!1).toString(16)}if(t.encoderAp2&&(t.encoderAp2[0]===24||t.encoderAp2[1]===24)){const a=(0,r.uint8ArrayToDataView)(t.encoderAp2);i.ENCODER_AP2=n.decode(t.encoderAp2.subarray(2,10)),i.ENCODER_AP2_CHECKSUM=a.getUint32(10,!1).toString(16)}return i}return Ki}Object.defineProperty(Ra,"__esModule",{value:!0});Ra.StudioPropertiesService=void 0;const cf=Es(),uf=ki;class df extends uf.Gen2PropertiesService{async getAllFirmwareVersions(){const[e,t,n]=await Promise.all([this.device.getFeatureReport(5,32),this.device.getFeatureReport(17,32),this.device.getFeatureReport(19,32)]);return(0,cf.parseAllFirmwareVersionsHelper)({ap2:e,encoderAp2:t,encoderLd:n})}}Ra.StudioPropertiesService=df;var oo;function ff(){return oo||(oo=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.studioProperties=void 0,r.StreamDeckStudioFactory=c;const e=Ur(),t=_n,n=ft,i=Wt,a=Ra,o=[{type:"encoder",row:0,column:0,index:0,hidIndex:0,hasLed:!0,ledRingSteps:24},...(0,i.generateButtonsGrid)(16,2,{width:144,height:112},!1,1),{type:"encoder",row:0,column:17,index:1,hidIndex:1,hasLed:!0,ledRingSteps:24,lcdRingOffset:12}];r.studioProperties={MODEL:n.DeviceModelId.STUDIO,PRODUCT_NAME:n.MODEL_NAMES[n.DeviceModelId.STUDIO],SUPPORTS_RGB_KEY_FILL:!0,CONTROLS:(0,i.freezeDefinitions)(o),KEY_SPACING_HORIZONTAL:0,KEY_SPACING_VERTICAL:0,FULLSCREEN_PANELS:2,HAS_NFC_READER:!0,SUPPORTS_CHILD_DEVICES:!0};function c(l,u,f){const d=(0,t.createBaseGen2Properties)(l,u,r.studioProperties,f??new a.StudioPropertiesService(l),!0);return new e.StreamDeckBase(l,u,d)}}(Ja)),Ja}var Ui={},Oa={};Object.defineProperty(Oa,"__esModule",{value:!0});Oa.FakeInputService=void 0;class vf{handleInput(e){}}Oa.FakeInputService=vf;var Fa={};Object.defineProperty(Fa,"__esModule",{value:!0});Fa.NetworkDockPropertiesService=void 0;const hf=Es();var an;class pf{constructor(e){W(this,an);U(this,an,e)}async setBrightness(e){}async resetToLogo(){}async getFirmwareVersion(){const e=await p(this,an).getFeatureReport(131,-1);return new TextDecoder("ascii").decode(e.subarray(8,16))}async getAllFirmwareVersions(){const[e]=await Promise.all([p(this,an).getFeatureReport(131,-1)]);return(0,hf.parseAllFirmwareVersionsHelper)({ap2:e.slice(2),encoderAp2:null,encoderLd:null})}async getSerialNumber(){const e=await p(this,an).getFeatureReport(132,-1),t=e[3];return new TextDecoder("ascii").decode(e.subarray(4,4+t))}}an=new WeakMap;Fa.NetworkDockPropertiesService=pf;var lo;function mf(){if(lo)return Ui;lo=1,Object.defineProperty(Ui,"__esModule",{value:!0}),Ui.NetworkDockFactory=l;const r=Ur(),e=ft,t=Wt,n=mn,i=Pi,a=Oa,o=Fa,c={MODEL:e.DeviceModelId.NETWORK_DOCK,PRODUCT_NAME:e.MODEL_NAMES[e.DeviceModelId.NETWORK_DOCK],KEY_DATA_OFFSET:0,SUPPORTS_RGB_KEY_FILL:!1,CONTROLS:(0,t.freezeDefinitions)([]),KEY_SPACING_HORIZONTAL:0,KEY_SPACING_VERTICAL:0,FULLSCREEN_PANELS:0,HAS_NFC_READER:!1,SUPPORTS_CHILD_DEVICES:!0};function l(u,f,d){const g=new n.CallbackHook;return new r.StreamDeckBase(u,f,{deviceProperties:c,events:g,properties:new o.NetworkDockPropertiesService(u),buttonsLcd:new i.FakeLcdService,lcdSegmentDisplay:null,inputService:new a.FakeInputService,encoderLed:null})}return Ui}var Za={},co;function _f(){return co||(co=1,Object.defineProperty(Za,"__esModule",{value:!0})),Za}var Qa={},uo;function gf(){return uo||(uo=1,Object.defineProperty(Qa,"__esModule",{value:!0})),Qa}var ti={},fo;function yf(){if(fo)return ti;fo=1,Object.defineProperty(ti,"__esModule",{value:!0}),ti.StreamDeckProxy=void 0;class r{constructor(t){Je(this,"device");this.device=t}get CONTROLS(){return this.device.CONTROLS}get MODEL(){return this.device.MODEL}get PRODUCT_NAME(){return this.device.PRODUCT_NAME}get HAS_NFC_READER(){return this.device.HAS_NFC_READER}calculateFillPanelDimensions(...t){return this.device.calculateFillPanelDimensions(...t)}async close(){return this.device.close()}async getHidDeviceInfo(...t){return this.device.getHidDeviceInfo(...t)}async sendPreparedBuffer(...t){return this.device.sendPreparedBuffer(...t)}async fillKeyColor(...t){return this.device.fillKeyColor(...t)}async fillKeyBuffer(...t){return this.device.fillKeyBuffer(...t)}async prepareFillKeyBuffer(...t){return this.device.prepareFillKeyBuffer(...t)}async fillPanelBuffer(...t){return this.device.fillPanelBuffer(...t)}async prepareFillPanelBuffer(...t){return this.device.prepareFillPanelBuffer(...t)}async clearKey(...t){return this.device.clearKey(...t)}async clearPanel(...t){return this.device.clearPanel(...t)}async setBrightness(...t){return this.device.setBrightness(...t)}async resetToLogo(...t){return this.device.resetToLogo(...t)}async getFirmwareVersion(){return this.device.getFirmwareVersion()}async getAllFirmwareVersions(){return this.device.getAllFirmwareVersions()}async getSerialNumber(){return this.device.getSerialNumber()}async fillLcd(...t){return this.device.fillLcd(...t)}async setEncoderColor(...t){return this.device.setEncoderColor(...t)}async setEncoderRingSingleColor(...t){return this.device.setEncoderRingSingleColor(...t)}async setEncoderRingColors(...t){return this.device.setEncoderRingColors(...t)}async fillLcdRegion(...t){return this.device.fillLcdRegion(...t)}async prepareFillLcdRegion(...t){return this.device.prepareFillLcdRegion(...t)}async clearLcdSegment(...t){return this.device.clearLcdSegment(...t)}async getChildDeviceInfo(...t){return this.device.getChildDeviceInfo(...t)}eventNames(){return this.device.eventNames()}listeners(t){return this.device.listeners(t)}listenerCount(t){return this.device.listenerCount(t)}emit(t,...n){return this.device.emit(t,...n)}on(t,n,i){return this.device.on(t,n,i),this}addListener(t,n,i){return this.device.addListener(t,n,i),this}once(t,n,i){return this.device.once(t,n,i),this}removeListener(t,n,i,a){return this.device.removeListener(t,n,i,a),this}off(t,n,i,a){return this.device.off(t,n,i,a),this}removeAllListeners(t){return this.device.removeAllListeners(t),this}}return ti.StreamDeckProxy=r,ti}var vo;function ia(){return vo||(vo=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.DEVICE_MODELS=r.DEVICE_MODELS2=r.DeviceModelType=r.VENDOR_ID=r.parseAllFirmwareVersionsHelper=r.uint8ArrayToDataView=r.StreamDeckProxy=void 0;const e=ld,t=ft,n=Ed(),i=Id(),a=Hd(),o=zd(),c=Qd(),l=rf(),u=lf(),f=ff(),d=mf();e.__exportStar(_f(),r),e.__exportStar(ft,r),e.__exportStar(gf(),r);var g=yf();Object.defineProperty(r,"StreamDeckProxy",{enumerable:!0,get:function(){return g.StreamDeckProxy}});var m=Hr();Object.defineProperty(r,"uint8ArrayToDataView",{enumerable:!0,get:function(){return m.uint8ArrayToDataView}});var h=Es();Object.defineProperty(r,"parseAllFirmwareVersionsHelper",{enumerable:!0,get:function(){return h.parseAllFirmwareVersionsHelper}}),r.VENDOR_ID=4057;var y;(function(v){v.STREAMDECK="streamdeck",v.PEDAL="pedal",v.NETWORK_DOCK="network-dock"})(y||(r.DeviceModelType=y={})),r.DEVICE_MODELS2={[t.DeviceModelId.ORIGINAL]:{type:y.STREAMDECK,productIds:[96],factory:n.StreamDeckOriginalFactory,hasNativeTcp:!1},[t.DeviceModelId.MINI]:{type:y.STREAMDECK,productIds:[99,144],factory:(...v)=>(0,i.StreamDeck6KeyFactory)(t.DeviceModelId.MINI,...v),hasNativeTcp:!1},[t.DeviceModelId.XL]:{type:y.STREAMDECK,productIds:[108,143],factory:(...v)=>(0,a.StreamDeck32KeyFactory)(t.DeviceModelId.XL,...v),hasNativeTcp:!1},[t.DeviceModelId.ORIGINALV2]:{type:y.STREAMDECK,productIds:[109],factory:(...v)=>(0,o.StreamDeck15KeyFactory)(t.DeviceModelId.ORIGINALV2,...v),hasNativeTcp:!1},[t.DeviceModelId.ORIGINALMK2]:{type:y.STREAMDECK,productIds:[128],factory:(...v)=>(0,o.StreamDeck15KeyFactory)(t.DeviceModelId.ORIGINALMK2,...v),hasNativeTcp:!1},[t.DeviceModelId.ORIGINALMK2SCISSOR]:{type:y.STREAMDECK,productIds:[165],factory:(...v)=>(0,o.StreamDeck15KeyFactory)(t.DeviceModelId.ORIGINALMK2SCISSOR,...v),hasNativeTcp:!1},[t.DeviceModelId.PLUS]:{type:y.STREAMDECK,productIds:[132],factory:c.StreamDeckPlusFactory,hasNativeTcp:!1},[t.DeviceModelId.PEDAL]:{type:y.PEDAL,productIds:[134],factory:l.StreamDeckPedalFactory,hasNativeTcp:!1},[t.DeviceModelId.NEO]:{type:y.STREAMDECK,productIds:[154],factory:u.StreamDeckNeoFactory,hasNativeTcp:!1},[t.DeviceModelId.STUDIO]:{type:y.STREAMDECK,productIds:[170],factory:f.StreamDeckStudioFactory,hasNativeTcp:!0},[t.DeviceModelId.MODULE6]:{type:y.STREAMDECK,productIds:[184],factory:(...v)=>(0,i.StreamDeck6KeyFactory)(t.DeviceModelId.MODULE6,...v),hasNativeTcp:!1},[t.DeviceModelId.MODULE15]:{type:y.STREAMDECK,productIds:[185],factory:(...v)=>(0,o.StreamDeck15KeyFactory)(t.DeviceModelId.MODULE15,...v),hasNativeTcp:!1},[t.DeviceModelId.MODULE32]:{type:y.STREAMDECK,productIds:[186],factory:(...v)=>(0,a.StreamDeck32KeyFactory)(t.DeviceModelId.MODULE32,...v),hasNativeTcp:!1},[t.DeviceModelId.NETWORK_DOCK]:{type:y.NETWORK_DOCK,productIds:[65535],factory:d.NetworkDockFactory,hasNativeTcp:!0}},r.DEVICE_MODELS=Object.entries(r.DEVICE_MODELS2).map(([v,x])=>{const M=v;return{id:M,productName:t.MODEL_NAMES[M],...x}})}(Xa)),Xa}var Va={},Is={},rc={exports:{}};(function(r){var e=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function i(l,u,f){this.fn=l,this.context=u,this.once=f||!1}function a(l,u,f,d,g){if(typeof f!="function")throw new TypeError("The listener must be a function");var m=new i(f,d||l,g),h=t?t+u:u;return l._events[h]?l._events[h].fn?l._events[h]=[l._events[h],m]:l._events[h].push(m):(l._events[h]=m,l._eventsCount++),l}function o(l,u){--l._eventsCount===0?l._events=new n:delete l._events[u]}function c(){this._events=new n,this._eventsCount=0}c.prototype.eventNames=function(){var u=[],f,d;if(this._eventsCount===0)return u;for(d in f=this._events)e.call(f,d)&&u.push(t?d.slice(1):d);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(f)):u},c.prototype.listeners=function(u){var f=t?t+u:u,d=this._events[f];if(!d)return[];if(d.fn)return[d.fn];for(var g=0,m=d.length,h=new Array(m);g<m;g++)h[g]=d[g].fn;return h},c.prototype.listenerCount=function(u){var f=t?t+u:u,d=this._events[f];return d?d.fn?1:d.length:0},c.prototype.emit=function(u,f,d,g,m,h){var y=t?t+u:u;if(!this._events[y])return!1;var v=this._events[y],x=arguments.length,M,L;if(v.fn){switch(v.once&&this.removeListener(u,v.fn,void 0,!0),x){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,f),!0;case 3:return v.fn.call(v.context,f,d),!0;case 4:return v.fn.call(v.context,f,d,g),!0;case 5:return v.fn.call(v.context,f,d,g,m),!0;case 6:return v.fn.call(v.context,f,d,g,m,h),!0}for(L=1,M=new Array(x-1);L<x;L++)M[L-1]=arguments[L];v.fn.apply(v.context,M)}else{var F=v.length,I;for(L=0;L<F;L++)switch(v[L].once&&this.removeListener(u,v[L].fn,void 0,!0),x){case 1:v[L].fn.call(v[L].context);break;case 2:v[L].fn.call(v[L].context,f);break;case 3:v[L].fn.call(v[L].context,f,d);break;case 4:v[L].fn.call(v[L].context,f,d,g);break;default:if(!M)for(I=1,M=new Array(x-1);I<x;I++)M[I-1]=arguments[I];v[L].fn.apply(v[L].context,M)}}return!0},c.prototype.on=function(u,f,d){return a(this,u,f,d,!1)},c.prototype.once=function(u,f,d){return a(this,u,f,d,!0)},c.prototype.removeListener=function(u,f,d,g){var m=t?t+u:u;if(!this._events[m])return this;if(!f)return o(this,m),this;var h=this._events[m];if(h.fn)h.fn===f&&(!g||h.once)&&(!d||h.context===d)&&o(this,m);else{for(var y=0,v=[],x=h.length;y<x;y++)(h[y].fn!==f||g&&!h[y].once||d&&h[y].context!==d)&&v.push(h[y]);v.length?this._events[m]=v.length===1?v[0]:v:o(this,m)}return this},c.prototype.removeAllListeners=function(u){var f;return u?(f=t?t+u:u,this._events[f]&&o(this,f)):(this._events=new n,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=t,c.EventEmitter=c,r.exports=c})(rc);var wf=rc.exports,Ba={exports:{}},bf=(r,e)=>(e=e||(()=>{}),r.then(t=>new Promise(n=>{n(e())}).then(()=>t),t=>new Promise(n=>{n(e())}).then(()=>{throw t})));const Sf=bf;class nc extends Error{constructor(e){super(e),this.name="TimeoutError"}}const ic=(r,e,t)=>new Promise((n,i)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){n(r);return}const a=setTimeout(()=>{if(typeof t=="function"){try{n(t())}catch(l){i(l)}return}const o=typeof t=="string"?t:`Promise timed out after ${e} milliseconds`,c=t instanceof Error?t:new nc(o);typeof r.cancel=="function"&&r.cancel(),i(c)},e);Sf(r.then(n,i),()=>{clearTimeout(a)})});Ba.exports=ic;Ba.exports.default=ic;Ba.exports.TimeoutError=nc;var Cf=Ba.exports,ks={},Ps={};Object.defineProperty(Ps,"__esModule",{value:!0});function Df(r,e,t){let n=0,i=r.length;for(;i>0;){const a=i/2|0;let o=n+a;t(r[o],e)<=0?(n=++o,i-=a+1):i=a}return n}Ps.default=Df;Object.defineProperty(ks,"__esModule",{value:!0});const xf=Ps;class Ef{constructor(){this._queue=[]}enqueue(e,t){t=Object.assign({priority:0},t);const n={priority:t.priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority){this._queue.push(n);return}const i=xf.default(this._queue,n,(a,o)=>o.priority-a.priority);this._queue.splice(i,0,n)}dequeue(){const e=this._queue.shift();return e==null?void 0:e.run}filter(e){return this._queue.filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return this._queue.length}}ks.default=Ef;Object.defineProperty(Is,"__esModule",{value:!0});const If=wf,ac=Cf,kf=ks,Hi=()=>{},Pf=new ac.TimeoutError;class Mf extends If{constructor(e){var t,n,i,a;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=Hi,this._resolveIdle=Hi,e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:kf.default},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(n=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(a=(i=e.interval)===null||i===void 0?void 0:i.toString())!==null&&a!==void 0?a:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||e.interval===0,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=e.throwOnTimeout===!0,this._isPaused=e.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=Hi,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=Hi,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const e=Date.now();if(this._intervalId===void 0){const t=this._intervalEnd-e;if(t<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},t)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const t=this._queue.dequeue();return t?(this.emit("active"),t(),e&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,t={}){return new Promise((n,i)=>{const a=async()=>{this._pendingCount++,this._intervalCount++;try{const o=this._timeout===void 0&&t.timeout===void 0?e():ac.default(Promise.resolve(e()),t.timeout===void 0?this._timeout:t.timeout,()=>{(t.throwOnTimeout===void 0?this._throwOnTimeout:t.throwOnTimeout)&&i(Pf)});n(await o)}catch(o){i(o)}this._next()};this._queue.enqueue(a,t),this._tryToStartAnother(),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async n=>this.add(n,t)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(e=>{const t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(e=>{const t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}}Is.default=Mf;Object.defineProperty(Va,"__esModule",{value:!0});Va.WebHIDDevice=void 0;const Lf=Jl,Af=Is;class Tf extends Lf.EventEmitter{constructor(t){super();Je(this,"device");Je(this,"reportQueue",new Af.default({concurrency:1}));this.device=t,this.device.addEventListener("inputreport",n=>{if(n.reportId===1){const i=new Uint8Array(n.data.buffer,n.data.byteOffset,n.data.byteLength);this.emit("input",i)}})}async close(){return this.device.close()}async forget(){return this.device.forget()}async sendFeatureReport(t){return this.device.sendFeatureReport(t[0],t.subarray(1))}async getFeatureReport(t,n){const i=await this.device.receiveFeatureReport(t);return new Uint8Array(i.buffer,i.byteOffset,i.byteLength)}async sendReports(t){return this.reportQueue.add(async()=>{for(const n of t)await this.device.sendReport(n[0],n.subarray(1))})}async getDeviceInfo(){return{path:void 0,productId:this.device.productId,vendorId:this.device.vendorId}}async getChildDeviceInfo(){return null}}Va.WebHIDDevice=Tf;var Ms={};Object.defineProperty(Ms,"__esModule",{value:!0});Ms.encodeJPEG=Nf;async function Nf(r,e,t){const n=await new Promise((i,a)=>{const o=document.createElement("canvas");o.width=e,o.height=t;const c=o.getContext("2d");if(c){const l=c.createImageData(e,t);l.data.set(r),c.putImageData(l,0,0),o.toBlob(u=>{u?i(u):a(new Error("No image generated"))},"image/jpeg",.9)}else a(new Error("Failed to get canvas context"))});return new Uint8Array(await n.arrayBuffer())}var ci={};Object.defineProperty(ci,"__esModule",{value:!0});ci.StreamDeckWeb=void 0;const Rf=ia();class Of extends Rf.StreamDeckProxy{constructor(t,n){super(t);Je(this,"hid");this.hid=n}async forget(){await this.hid.forget()}async fillKeyCanvas(t,n){const i=n.getContext("2d");if(!i)throw new Error("Failed to get canvas context");const a=this.CONTROLS.find(c=>c.type==="button"&&c.index===t);if(!a||a.feedbackType==="none")throw new TypeError("Expected a valid keyIndex");if(a.feedbackType!=="lcd")throw new TypeError(`keyIndex ${a.index} does not support lcd feedback`);const o=i.getImageData(0,0,a.pixelSize.width,a.pixelSize.height);return this.device.fillKeyBuffer(t,o.data,{format:"rgba"})}async fillPanelCanvas(t){const n=t.getContext("2d");if(!n)throw new Error("Failed to get canvas context");const i=this.device.calculateFillPanelDimensions();if(!i)throw new Error("Panel does not support filling");const a=n.getImageData(0,0,i.width,i.height);return this.device.fillPanelBuffer(a.data,{format:"rgba"})}}ci.StreamDeckWeb=Of;(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.StreamDeckWeb=r.StreamDeckProxy=r.DeviceModelId=r.VENDOR_ID=void 0,r.requestStreamDecks=c,r.getStreamDecks=l,r.openDevice=u;const e=ia(),t=Va,n=Ms,i=ci;var a=ia();Object.defineProperty(r,"VENDOR_ID",{enumerable:!0,get:function(){return a.VENDOR_ID}}),Object.defineProperty(r,"DeviceModelId",{enumerable:!0,get:function(){return a.DeviceModelId}}),Object.defineProperty(r,"StreamDeckProxy",{enumerable:!0,get:function(){return a.StreamDeckProxy}});var o=ci;Object.defineProperty(r,"StreamDeckWeb",{enumerable:!0,get:function(){return o.StreamDeckWeb}});async function c(f){const d=await navigator.hid.requestDevice({filters:[{vendorId:e.VENDOR_ID}]});return Promise.all(d.map(async g=>u(g,f)))}async function l(f){const g=(await navigator.hid.getDevices()).filter(h=>h.vendorId===e.VENDOR_ID);return(await Promise.all(g.map(async h=>u(h,f).catch(y=>null)))).filter(h=>!!h)}async function u(f,d){const g=e.DEVICE_MODELS.find(m=>f.vendorId===e.VENDOR_ID&&m.productIds.includes(f.productId));if(!g)throw new Error("Stream Deck is of unexpected type.");await f.open();try{const m={encodeJPEG:n.encodeJPEG,...d},h=new t.WebHIDDevice(f),y=g.factory(h,m||{});return new i.StreamDeckWeb(y,h)}catch(m){throw await f.close().catch(()=>null),m}}})(us);const Ff={VENDOR_ID:4057};function Vf(r){return r.vendorId===Ff.VENDOR_ID}class Bf{constructor(){this.connectedDevices=new Map,this.listeners=new Map,this.buttonStates=new Map}on(e,t){this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e).add(t)}off(e,t){this.listeners.has(e)&&this.listeners.get(e).delete(t)}_emit(e,t){if(!this.listeners.has(e))return;const n=this.listeners.get(e);for(const i of n)i(t)}async requestDevice(){if(!navigator.hid)throw new Error("WebHID not supported in this browser");try{const e=await us.requestStreamDecks();for(const t of e)await this._setupStreamDeck(t);return e[0]||null}catch(e){throw e.name==="NotAllowedError"?new Error("Failed to open Stream Deck. Please close the Elgato Stream Deck software and try again."):e}}async autoReconnect(){if(!navigator.hid)return console.warn("WebHID not supported"),[];try{const e=await us.getStreamDecks(),t=[];for(const n of e)try{await this._setupStreamDeck(n),t.push(n)}catch(i){console.warn("Failed to reconnect to Stream Deck:",i)}return t}catch(e){return console.error("Failed to auto-reconnect Stream Deck devices:",e),[]}}async _setupStreamDeck(e){try{const t=e.serialNumber||e.SERIAL_NUMBER||`${e.PRODUCT_NAME||"StreamDeck"}-${e.MODEL||e.PRODUCT_ID||"unknown"}`.replace(/\s+/g,"-").toLowerCase();return console.log("Stream Deck serial number:",t,"Product:",e.PRODUCT_NAME,"Model:",e.MODEL),this.buttonStates.set(t,new Map),e.on("down",n=>{let i;if(typeof n=="number"?i=n:typeof n=="object"&&n!==null?i=n.index:typeof n=="string"&&(i=parseInt(n)),typeof i!="number"||isNaN(i)){console.warn("Could not extract button index from Stream Deck event:",n);return}const a=this.buttonStates.get(t);a&&typeof i=="number"&&a.set(i,!0),this._emit("buttondown",{device:e,serialNumber:t,button:i,model:e.PRODUCT_NAME||"Stream Deck"})}),e.on("up",n=>{let i;if(typeof n=="number"?i=n:typeof n=="object"&&n!==null?i=n.index:typeof n=="string"&&(i=parseInt(n)),typeof i!="number"||isNaN(i))return;const a=this.buttonStates.get(t);a&&typeof i=="number"&&a.set(i,!1),this._emit("buttonup",{device:e,serialNumber:t,button:i,model:e.PRODUCT_NAME||"Stream Deck"})}),await e.setBrightness(100),await e.clearPanel(),this.connectedDevices.set(t,e),this._emit("connected",{device:e,serialNumber:t,model:e.PRODUCT_NAME||"Stream Deck",buttonCount:e.NUM_KEYS}),e}catch(t){throw console.error("Failed to setup Stream Deck:",t),t}}async disconnectDevice(e){const t=this.connectedDevices.get(e);t&&(await t.close(),this.connectedDevices.delete(e),this.buttonStates.delete(e),this._emit("disconnected",{serialNumber:e}))}async setButtonColor(e,t,n){const i=this.connectedDevices.get(e);if(!i)return!1;const a=i.NUM_KEYS||15;if(t<0||t>=a)return!1;try{const o=this._parseColor(n);return o?(await i.fillKeyColor(t,o.r,o.g,o.b),!0):!1}catch(o){return console.error(`Failed to set button ${t} color on ${e}:`,o),!1}}async clearButtonColor(e,t){return await this.setButtonColor(e,t,"#000000")}_parseColor(e){const t=document.createElement("div");t.style.color=e,document.body.appendChild(t);const n=window.getComputedStyle(t).color;document.body.removeChild(t);const i=n.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/);return i?{r:parseInt(i[1]),g:parseInt(i[2]),b:parseInt(i[3])}:null}getConnectedDevices(){return Array.from(this.connectedDevices.values())}async disconnectAll(){const e=Array.from(this.connectedDevices.keys());for(const t of e)await this.disconnectDevice(t)}}class Mi{constructor(e,t,n){this.id=e,this.name=t,this.type=n,this.controls=new Map,this.listeners=new Map}getValue(e){const t=this.controls.get(e);return t?t.value:0}_setValue(e,t,n=0,i=1){this.controls.has(e)||this.controls.set(e,{type:"value",value:0,min:n,max:i});const a=this.controls.get(e);a.value=t,a.min=n,a.max=i,this._emit("change",{controlId:e,value:t,control:a})}_trigger(e,t=1){this._emit("trigger",{controlId:e,velocity:t})}on(e,t){this.listeners.has(e)||this.listeners.set(e,[]),this.listeners.get(e).push(t)}off(e,t){if(!this.listeners.has(e))return;const n=this.listeners.get(e),i=n.indexOf(t);i!==-1&&n.splice(i,1)}_emit(e,t){if(!this.listeners.has(e))return;const n=this.listeners.get(e);for(const i of n)i(t)}disconnect(){}getControlIds(){return Array.from(this.controls.keys())}}class jf extends Mi{constructor(e){super(e.id,e.name||"MIDI Device","midi"),this.midiInput=e,this.midiInput.onmidimessage=this._handleMIDIMessage.bind(this)}_handleMIDIMessage(e){const[t,n,i]=e.data;switch(t&240){case 144:if(i>0){const u=`note-${n}`;this._trigger(u,i/127)}else{const u=`note-${n}`;this._emit("release",{controlId:u})}break;case 128:const o=`note-${n}`;this._emit("release",{controlId:o});break;case 176:const c=`cc-${n}`;this._setValue(c,i/127,0,1);break;case 224:const l=(i<<7|n)-8192;this._setValue("pitchbend",l/8192,-1,1);break}}disconnect(){this.midiInput&&(this.midiInput.onmidimessage=null)}}class Gf extends Mi{constructor(e,t={}){super(e.productId.toString(),t.name||"HID Device","hid"),this.hidDevice=e,this.config=t,this.buttonStates=new Map,this.hidDevice.oninputreport=this._handleInputReport.bind(this)}_handleInputReport(e){const{data:t,reportId:n}=e,i=new Uint8Array(t.buffer);for(let a=0;a<i.length;a++){const o=i[a];for(let c=0;c<8;c++){const l=a*8+c,u=o>>c&1,f=`button-${l}`,d=this.buttonStates.get(f)||!1;u&&!d?(this.buttonStates.set(f,!0),this._trigger(f,127)):!u&&d&&(this.buttonStates.set(f,!1),this._emit("release",{controlId:f}))}}}async sendOutput(e,t){this.hidDevice&&this.hidDevice.opened&&await this.hidDevice.sendReport(e,t)}disconnect(){this.hidDevice&&(this.hidDevice.oninputreport=null,this.hidDevice.close()),this.buttonStates.clear()}}class $f extends Mi{constructor(){super("keyboard","Keyboard","keyboard"),this.pressedKeys=new Set,this._boundKeyDown=this._handleKeyDown.bind(this),this._boundKeyUp=this._handleKeyUp.bind(this),window.addEventListener("keydown",this._boundKeyDown),window.addEventListener("keyup",this._boundKeyUp)}_handleKeyDown(e){if(e.target.matches("input, textarea"))return;const t=`key-${e.code}`;this.pressedKeys.has(e.code)||(this.pressedKeys.add(e.code),this._trigger(t),this._setValue(t,1,0,1))}_handleKeyUp(e){const t=`key-${e.code}`;this.pressedKeys.has(e.code)&&(this.pressedKeys.delete(e.code),this._emit("release",{controlId:t}),this._setValue(t,0,0,1))}disconnect(){window.removeEventListener("keydown",this._boundKeyDown),window.removeEventListener("keyup",this._boundKeyUp),this.pressedKeys.clear()}}class Kf extends Mi{constructor(e="Virtual"){super(`virtual-${Date.now()}`,e,"virtual")}trigger(e,t=1){this._trigger(e,t)}setValue(e,t){this._setValue(e,t,0,1)}addButton(e,t){this.controls.set(e,{type:"button",value:0,label:t})}addKnob(e,t,n=0){this.controls.set(e,{type:"knob",value:n,label:t,min:0,max:1})}}class Uf{constructor(){Je(this,"listeners",new Map);this.devices=new Map,this.midiAccess=null,this.keyboardDevice=null,this.streamDeckManager=new Bf,this._setupStreamDeckListeners()}_setupStreamDeckListeners(){this.streamDeckManager.on("connected",({device:e,model:t,serialNumber:n})=>{console.log(`Stream Deck connected: ${t}`);const i=n,a=new Mi(i,t||"Stream Deck","hid");a.streamDeck=e,this.devices.set(i,a),this._emit("deviceadded",a)}),this.streamDeckManager.on("buttondown",({device:e,button:t,model:n,serialNumber:i})=>{const a=i,o=this.devices.get(a);if(o){const c=`button-${t}`;o._trigger(c,127)}}),this.streamDeckManager.on("buttonup",({serialNumber:e,button:t})=>{const n=e,i=this.devices.get(n);if(i){const a=`button-${t}`;i._emit("release",{controlId:a})}}),this.streamDeckManager.on("disconnected",({serialNumber:e})=>{console.log("Stream Deck disconnected"),this.removeDevice(e)})}async initMIDI(){if(!navigator.requestMIDIAccess)return console.warn("WebMIDI not supported"),!1;try{this.midiAccess=await navigator.requestMIDIAccess(),this.midiAccess.onstatechange=this._handleMIDIStateChange.bind(this);for(const e of this.midiAccess.inputs.values())this._addMIDIDevice(e);return!0}catch(e){return console.error("Failed to initialize MIDI:",e),!1}}_handleMIDIStateChange(e){const t=e.port;t.type==="input"&&(t.state==="connected"?this._addMIDIDevice(t):t.state==="disconnected"&&this.removeDevice(t.id))}_addMIDIDevice(e){const t=new jf(e);this.devices.set(t.id,t),this._emit("deviceadded",t)}async requestStreamDeck(){try{return await this.streamDeckManager.requestDevice()}catch(e){throw console.error("Failed to request Stream Deck:",e),e}}async autoReconnectStreamDecks(){try{const e=await this.streamDeckManager.autoReconnect();return console.log(`Auto-reconnected ${e.length} Stream Deck(s)`),e}catch(e){return console.error("Failed to auto-reconnect Stream Decks:",e),[]}}async requestHIDDevice(e=[]){if(!navigator.hid)return console.warn("WebHID not supported"),null;try{const t=await navigator.hid.requestDevice({filters:e});for(const n of t){if(Vf(n))return await this.streamDeckManager.connectDevice(n);if(!n.opened)try{await n.open()}catch(a){throw console.error("Failed to open HID device:",a),new Error(`Cannot open device. Make sure it's not being used by another application. Error: ${a.message}`)}const i=new Gf(n);return this.devices.set(i.id,i),this._emit("deviceadded",i),i}}catch(t){throw console.error("Failed to request HID device:",t),t}return null}enableKeyboard(){return this.keyboardDevice||(this.keyboardDevice=new $f,this.devices.set(this.keyboardDevice.id,this.keyboardDevice),this._emit("deviceadded",this.keyboardDevice)),this.keyboardDevice}createVirtual(e){const t=new Kf(e);return this.devices.set(t.id,t),this._emit("deviceadded",t),t}removeDevice(e){const t=this.devices.get(e);t&&(t.disconnect(),this.devices.delete(e),this._emit("deviceremoved",t))}getDevice(e){return this.devices.get(e)}getAllDevices(){return Array.from(this.devices.values())}getInputDevices(){return this.getAllDevices()}getInputDevice(e){return this.getDevice(e)}on(e,t){this.listeners.has(e)||this.listeners.set(e,[]),this.listeners.get(e).push(t)}off(e,t){if(!this.listeners.has(e))return;const n=this.listeners.get(e),i=n.indexOf(t);i!==-1&&n.splice(i,1)}_emit(e,t){if(!this.listeners.has(e))return;const n=this.listeners.get(e);for(const i of n)i(t)}disconnectAll(){for(const e of this.devices.values())e.disconnect();this.devices.clear()}}class Hf{constructor(e,t,n){this.inputDeviceManager=new Uf,this.mappingLibrary=e||new wl,this.customPropertyManager=t||new Sl,this.triggerManager=n||new bl,this.listeners=new Map,this._setupInputListeners()}async initialize(){this.customPropertyManager.initialize(),this.inputDeviceManager.on("deviceadded",e=>{this._setupDeviceListeners(e),this._emit("deviceadded",e)}),this.inputDeviceManager.on("deviceremoved",e=>{this._emit("deviceremoved",e)}),await this.inputDeviceManager.initMIDI(),await this.inputDeviceManager.autoReconnectStreamDecks(),this.inputDeviceManager.enableKeyboard()}_setupInputListeners(){}_setupDeviceListeners(e){e.on("trigger",({controlId:t,velocity:n})=>{this._handleTrigger(e.id,t,n)}),e.on("release",({controlId:t})=>{this._handleRelease(e.id,t)}),e.on("change",({controlId:t,value:n})=>{this._handleValueChange(e.id,t,n)})}_generateClassName(e,t){return`${e.replace(/[^a-zA-Z0-9]/g,"_").toLowerCase()}_${t}`}_handleTrigger(e,t,n){const i=this.mappingLibrary.getByInput(e,t);if(i.length>0){const a=this._generateClassName(t,"down");this.triggerManager.addRawClass(a);const o=this._generateClassName(t,"up");this.triggerManager.removeRawClass(o);for(const c of i)c.mode==="trigger"&&(this.triggerManager.trigger(c),this._emit("trigger",{mapping:c,velocity:n}))}}_handleRelease(e,t){const n=this.mappingLibrary.getByInput(e,t);if(n.length>0){const i=this._generateClassName(t,"down");this.triggerManager.removeRawClass(i);const a=this._generateClassName(t,"up");this.triggerManager.addRawClass(a);for(const o of n)o.mode==="trigger"&&o.triggerType!=="always"&&(this.triggerManager.release(o),this._emit("release",{mapping:o}))}}_handleValueChange(e,t,n){const i=this.mappingLibrary.getByInput(e,t),a=i.find(o=>o.mode==="input");if(a&&a.name){const o=a.name.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""),c=Math.round(n*100);this.customPropertyManager.setProperty(o,`${c}%`)}for(const o of i)if(o.mode==="direct"){const c=o.getPropertyName(),l=o.mapValue(n);this.customPropertyManager.setProperty(c,l),this._emit("valuechange",{mapping:o,value:n,propertyValue:l})}}async requestStreamDeck(){return await this.inputDeviceManager.requestStreamDeck()}async requestHIDDevice(e=[]){return await this.inputDeviceManager.requestHIDDevice(e)}getInputDevices(){return this.inputDeviceManager.getAllDevices()}getInputDevice(e){return this.inputDeviceManager.getDevice(e)}createVirtualDevice(e){return this.inputDeviceManager.createVirtual(e)}setTriggerContainer(e){this.triggerManager.setContainer(e)}on(e,t){this.listeners.has(e)||this.listeners.set(e,[]),this.listeners.get(e).push(t)}off(e,t){if(!this.listeners.has(e))return;const n=this.listeners.get(e),i=n.indexOf(t);i!==-1&&n.splice(i,1)}_emit(e,t){if(!this.listeners.has(e))return;const n=this.listeners.get(e);for(const i of n)i(t)}destroy(){this.inputDeviceManager.disconnectAll(),this.customPropertyManager.destroy(),this.triggerManager.clearAll(),this.listeners.clear()}}jc();var zf=cl("<title> </title>"),qf=cl("<svg><!><!></svg>");function Nt(r,e){const t=Ws(e,["children","$$slots","$$events","$$legacy"]),n=Ws(t,["data","viewBox","size","width","height","color","stroke","fill","title"]);yt(e,!1);const i=Vo();let a=pe(e,"data",8,""),o=pe(e,"viewBox",24,()=>h(a())),c=pe(e,"size",8,"20px"),l=pe(e,"width",24,c),u=pe(e,"height",24,c),f=pe(e,"color",8,"currentColor"),d=pe(e,"stroke",24,f),g=pe(e,"fill",24,f),m=pe(e,"title",8,"");function h(L){const I=/viewBox="([\d\- \.]+)"/.exec(L);return I?I[1]:"0 0 20 20"}ou(()=>sl(a()),()=>{C(i,a().replace(/<svg[ \n]([^>]*)>/,"").replace("</svg>",""))}),lu(),ju();var y=qf();Ou(y,()=>({xmlns:"http://www.w3.org/2000/svg",width:l(),height:u(),viewBox:o(),stroke:d(),fill:g(),...n}));var v=_(y);{var x=L=>{var F=zf(),I=_(F);Z(()=>ne(I,m())),S(L,F)};ce(v,L=>{m()&&L(x)})}var M=w(v);un(M,()=>s(i),!0),S(r,y),wt()}const Wf=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30">
    <path fill="#2196f3" d="M 17 2 A 1 1 0 0 0 16.123047 2.5214844 L 8.1738281 15.433594 L 8.1738281 15.435547 A 1 1 0 0 0 8 16 A 1 1 0 0 0 9 17 L 14.5 17 L 13.019531 26.800781 A 1 1 0 0 0 13 27 A 1 1 0 0 0 14 28 A 1 1 0 0 0 14.882812 27.466797 L 14.884766 27.466797 L 22.806641 14.589844 L 22.796875 14.572266 C 22.915239 14.407976 23 14.217804 23 14 C 23 13.448 22.552 13 22 13 L 16.5 13 L 17.955078 3.2949219 A 1 1 0 0 0 18 3 A 1 1 0 0 0 17 2 z"></path>
</svg>
`,Yf=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48">
    <path fill="#9C27B0" d="M21 4H26.001V43H21z" transform="rotate(45.001 23.5 23.5)"></path>
    <path fill="#9C27B0" d="M21 4H26.001V43H21z" transform="rotate(134.999 23.5 23.5)"></path>
</svg>
`,Xf=`<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="48" height="48" viewBox="0 0 48 48">
<path fill="#9C27B0" d="M21 6H26V41H21z"></path><path fill="#9C27B0" d="M6 21H41V26H6z"></path>
</svg>`,Jf='<svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 48 48" width="48px" height="48px"><path fill="#2196F3" d="M16 15c0 1.104-.896 2-2 2H8c-1.104 0-2-.896-2-2v-4c0-1.104.896-2 2-2h6c1.104 0 2 .896 2 2V15zM29 15c0 1.104-.896 2-2 2h-6c-1.104 0-2-.896-2-2v-4c0-1.104.896-2 2-2h6c1.104 0 2 .896 2 2V15zM42 15c0 1.104-.896 2-2 2h-6c-1.104 0-2-.896-2-2v-4c0-1.104.896-2 2-2h6c1.104 0 2 .896 2 2V15zM16 26c0 1.104-.896 2-2 2H8c-1.104 0-2-.896-2-2v-4c0-1.104.896-2 2-2h6c1.104 0 2 .896 2 2V26zM29 26c0 1.104-.896 2-2 2h-6c-1.104 0-2-.896-2-2v-4c0-1.104.896-2 2-2h6c1.104 0 2 .896 2 2V26zM42 26c0 1.104-.896 2-2 2h-6c-1.104 0-2-.896-2-2v-4c0-1.104.896-2 2-2h6c1.104 0 2 .896 2 2V26zM16 37c0 1.104-.896 2-2 2H8c-1.104 0-2-.896-2-2v-4c0-1.104.896-2 2-2h6c1.104 0 2 .896 2 2V37zM29 37c0 1.104-.896 2-2 2h-6c-1.104 0-2-.896-2-2v-4c0-1.104.896-2 2-2h6c1.104 0 2 .896 2 2V37zM42 37c0 1.104-.896 2-2 2h-6c-1.104 0-2-.896-2-2v-4c0-1.104.896-2 2-2h6c1.104 0 2 .896 2 2V37z"/></svg>',Zf='<svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 48 48" width="48px" height="48px"><path fill="#f44336" d="M16,13c0,0,0,23.988,0,24h3V21.583L36,16v17h3V6L16,13z"/><path fill="#f44336" d="M13 31A6 6 0 1 0 13 43 6 6 0 1 0 13 31zM33 27A6 6 0 1 0 33 39 6 6 0 1 0 33 27z"/></svg>';var Qf=O('<div class="dialog-header svelte-pz05fu"><h2 class="svelte-pz05fu"> </h2></div>'),ev=O('<div class="dialog-footer svelte-pz05fu"><div class="dialog-footer-tools svelte-pz05fu"><!></div> <div class="dialog-footer-buttons svelte-pz05fu"><!></div></div>'),tv=O('<dialog><!> <div class="dialog-body svelte-pz05fu"><!></div> <!></dialog>');function Cr(r,e){yt(e,!0);let t=pe(e,"title",3,null),n=pe(e,"onclose",3,null),i=pe(e,"dialogRef",15,null),a=pe(e,"anchored",3,!1),o=pe(e,"anchorId",3,null),c=pe(e,"showArrow",3,!0),l=pe(e,"lightDismiss",3,!0);function u(){var L;(L=i())==null||L.close(),n()&&n()()}function f(L){a()&&l()&&L.target===i()&&u()}var d=tv();let g;d.__click=f;var m=_(d);{var h=L=>{var F=Qf(),I=_(F),P=_(I);Z(()=>ne(P,t())),S(L,F)};ce(m,L=>{t()&&L(h)})}var y=w(m,2),v=_(y);Wi(v,()=>e.children);var x=w(y,2);{var M=L=>{var F=ev(),I=_(F),P=_(I);{var j=re=>{var le=it(),ye=he(le);Wi(ye,()=>e.tools),S(re,le)};ce(P,re=>{e.tools&&re(j)})}var Y=w(I,2),oe=_(Y);{var ue=re=>{var le=it(),ye=he(le);Wi(ye,()=>e.buttons),S(re,le)};ce(oe,re=>{e.buttons&&re(ue)})}S(L,F)};ce(x,L=>{(e.tools||e.buttons)&&L(M)})}dn(d,L=>i(L),()=>i()),Z(()=>{g=St(d,1,"dialog svelte-pz05fu",null,g,{anchored:a(),"show-arrow":c()&&a()}),Rt(d,a()&&o()?`position-anchor: --${o()}`:"")}),S(r,d),wt()}Pt(["click"]);var rv=O('<button id="start" class="svelte-4b3o1e"><!> Connect DMX controller</button>'),nv=O('<button id="stop" class="svelte-4b3o1e"><!> Disconnect</button>'),iv=O('<div class="device-item svelte-4b3o1e"><span class="device-name svelte-4b3o1e"> </span></div>'),av=O('<div class="device-list svelte-4b3o1e"></div>'),sv=O('<div class="device-item svelte-4b3o1e"><span class="device-name svelte-4b3o1e"> </span></div>'),ov=O('<div class="device-list svelte-4b3o1e"></div>'),lv=O('<div class="device-section svelte-4b3o1e"><button class="connect-device-btn svelte-4b3o1e"><!> Connect Stream Deck</button> <!></div> <div class="device-section svelte-4b3o1e"><button class="connect-device-btn svelte-4b3o1e"><!> Connect MIDI Device</button> <!></div>',1),cv=O('<header class="svelte-4b3o1e"><!> <button id="devices-button" style="anchor-name: --devices-button" title="Connect input devices" class="svelte-4b3o1e"><!></button></header> <!>',1);function uv(r,e){yt(e,!0);let t=z(null),n=z(null),i=z(Ae([])),a=ge(()=>s(i).filter(I=>I.type==="hid"&&I.id!=="keyboard")),o=ge(()=>s(i).filter(I=>I.type==="midi")),c=ge(()=>s(o).length>0);function l(){e.inputController&&C(i,e.inputController.getInputDevices(),!0),requestAnimationFrame(()=>{var I;(I=s(t))==null||I.showModal()})}function u(){var I;(I=s(t))==null||I.close()}async function f(){var I,P;try{await((I=e.inputController)==null?void 0:I.requestStreamDeck()),C(i,((P=e.inputController)==null?void 0:P.getInputDevices())||[],!0)}catch(j){alert(`Failed to connect Stream Deck: ${j.message}

Please close the Elgato Stream Deck software and try again.`)}}async function d(){var I,P,j;try{await((P=(I=e.inputController)==null?void 0:I.inputDeviceManager)==null?void 0:P.initMIDI()),C(i,((j=e.inputController)==null?void 0:j.getInputDevices())||[],!0)}catch(Y){alert(`Failed to connect MIDI: ${Y.message}`)}}var g=cv(),m=he(g),h=_(m);{var y=I=>{var P=rv();P.__click=function(...Y){var oe;(oe=e.onconnect)==null||oe.apply(this,Y)};var j=_(P);Nt(j,{get data(){return Wf}}),S(I,P)},v=I=>{var P=nv();P.__click=function(...Y){var oe;(oe=e.ondisconnect)==null||oe.apply(this,Y)};var j=_(P);Nt(j,{get data(){return Yf}}),S(I,P)};ce(h,I=>{e.connected?I(v,!1):I(y)})}var x=w(h,2);x.__click=l;var M=_(x);Nt(M,{get data(){return Xf}}),dn(x,I=>C(n,I),()=>s(n));var L=w(m,2);{var F=I=>{Cr(I,{anchored:!0,anchorId:"devices-button",showArrow:!0,lightDismiss:!0,onclose:u,get dialogRef(){return s(t)},set dialogRef(P){C(t,P,!0)},children:(P,j)=>{var Y=lv(),oe=he(Y),ue=_(oe);ue.__click=f;var re=_(ue);Nt(re,{get data(){return Jf}});var le=w(ue,2);{var ye=G=>{var b=av();Pe(b,21,()=>s(a),D=>D.id,(D,A)=>{var T=iv(),N=_(T),k=_(N);Z(()=>ne(k,s(A).name)),S(D,T)}),S(G,b)};ce(le,G=>{s(a).length>0&&G(ye)})}var _e=w(oe,2),de=_(_e);de.__click=d;var ke=_(de);Nt(ke,{get data(){return Zf}});var Q=w(de,2);{var V=G=>{var b=ov();Pe(b,21,()=>s(o),D=>D.id,(D,A)=>{var T=sv(),N=_(T),k=_(N);Z(()=>ne(k,s(A).name)),S(D,T)}),S(G,b)};ce(Q,G=>{s(o).length>0&&G(V)})}Z(()=>de.disabled=s(c)),S(P,Y)},$$slots:{default:!0}})};ce(L,I=>{s(n)&&I(F)})}S(r,g),wt()}Pt(["click"]);const dv='<svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 48 48" width="48px" height="48px"><path fill="#3F51B5" d="M17.8 18.1L10.4 25.4 6.2 21.3 4 23.5 10.4 29.9 20 20.3zM17.8 5.1L10.4 12.4 6.2 8.3 4 10.5 10.4 16.9 20 7.3zM17.8 31.1L10.4 38.4 6.2 34.3 4 36.5 10.4 42.9 20 33.3z"/><g><path fill="#90CAF9" d="M24 22H44V26H24zM24 9H44V13H24zM24 35H44V39H24z"/></g></svg>',fv='<svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 48 48" width="48px" height="48px" baseProfile="basic"><path fill="#64b5f6" d="M24,44C12.972,44,4,35.028,4,24S12.972,4,24,4s20,8.972,20,20S35.028,44,24,44z M24,6	C14.075,6,6,14.075,6,24s8.075,18,18,18s18-8.075,18-18S33.925,6,24,6z"/><path fill="#64b5f6" d="M24,37c-7.168,0-13-5.832-13-13s5.832-13,13-13s13,5.832,13,13S31.168,37,24,37z M24,13	c-6.065,0-11,4.935-11,11s4.935,11,11,11s11-4.935,11-11S30.065,13,24,13z"/><path fill="#64b5f6" d="M24,31c-3.86,0-7-3.14-7-7s3.14-7,7-7s7,3.14,7,7S27.86,31,24,31z M24,19c-2.757,0-5,2.243-5,5	s2.243,5,5,5s5-2.243,5-5S26.757,19,24,19z"/><circle cx="40" cy="14" r="2" fill="#0d47a1"/><circle cx="12" cy="39" r="3" fill="#5e35b1"/><circle cx="33" cy="32" r="3" fill="#0d47a1"/><circle cx="14" cy="8" r="2" fill="#5e35b1"/><circle cx="12" cy="25" r="2" fill="#0d47a1"/><circle cx="24" cy="24" r="3.094" fill="#ffe082"/></svg>',vv=`<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="48" height="48" viewBox="0 0 48 48">
<path fill="none" stroke="#02abc0" stroke-miterlimit="10" stroke-width="4" d="M8 21L8 10 19 10"></path><path fill="none" stroke="#02abc0" stroke-miterlimit="10" stroke-width="4" d="M8,10c5.763,6.146,13,15,20,15 c8.505,0,13-6.102,13-9.748C41,11.932,39.013,9,35.007,9C28.52,9,23.02,16.775,23.346,23.808C23.769,33.967,31.596,41,40,41"></path>
</svg>`,hv=`<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="48" height="48" viewBox="0 0 48 48">
<path fill="#2196F3" d="M11 5A7 7 0 1 0 11 19A7 7 0 1 0 11 5Z"></path><path fill="#FFA726" d="M23.082 28.861c.713 1.412 2.483 1.967 3.934 1.232 1.454-.734 2.059-2.488 1.346-3.899l-3.186-6.319c-.712-1.41-2.482-1.966-3.934-1.23-1.453.733-2.059 2.486-1.347 3.898L23.082 28.861zM28.39 26.234c.713 1.41 2.483 1.967 3.937 1.232 1.453-.733 2.057-2.488 1.344-3.9l-3.186-6.318c-.713-1.41-2.48-1.967-3.934-1.231-1.453.732-2.059 2.485-1.348 3.898L28.39 26.234zM33.7 23.607c.712 1.413 2.481 1.966 3.935 1.234 1.452-.734 2.058-2.49 1.344-3.9l-3.187-6.32c-.712-1.412-2.479-1.965-3.933-1.232-1.453.734-2.059 2.489-1.348 3.9L33.7 23.607zM40.215 23.421c-.307-.608.047.093.381.755C40.752 24.488 40.496 23.978 40.215 23.421z"></path><path fill="#FFA726" d="M20.815,22.174c-0.486,0.246-1.081,0.053-1.324-0.436l-5.78-11.459c-0.493-0.976-2.209-2.19-3.969-1.301c-1.76,0.89-1.757,3.085-1.313,3.967c0.243,0.482,3.405,6.754,6.226,12.342c2.339,4.635,4.438,8.803,4.438,8.803l-5.523-1.625c-1.83-0.603-3.687,0.198-4.15,2.302c-0.465,1.767,0.762,3.524,2.392,4.056l7.5,2.462c3.865,1.269,7.878,0.809,11.523-1.04l0.545-0.275l0.762-0.305l4.807-2.43l1.27-0.785c3.546-2.574,4.857-7.359,2.819-11.397c0,0-0.216-0.43-0.44-0.876c-0.175-0.344-0.857-1.696-2.6-5.153L20.815,22.174z"></path><g><path fill="#FFCDD2" d="M9.359 12.6c-.511-1.038-.135-2.27.846-2.751.976-.479 2.186-.024 2.692 1.011C13.409 11.898 9.869 13.635 9.359 12.6M11.882 37.605c-1.178-.316-1.874-1.527-1.561-2.707.319-1.178 1.531-1.875 2.707-1.559C14.207 33.657 13.061 37.924 11.882 37.605"></path></g>
</svg>`,pv=`<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="48" height="48" viewBox="0 0 48 48">
<path fill="#FFC107" d="M33 22L23.6 22 30 5 19 5 13 26 21.6 26 17 45z"></path>
</svg>`,mv=`<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="48" height="48" viewBox="0 0 48 48">
<path fill="#3F51B5" d="M36 34L33 31.5 39.8 24 33 16.5 36 14 45 24zM13 34L4 24 13 14 16 16.5 9.1 24 16 31.5z"></path><path fill="#2196F3" d="M21 39L17.2 37.7 27 9 30.8 10.3z"></path>
</svg>`;var _v=O('<div class="clear-universe svelte-1f8dwwb"><button class="svelte-1f8dwwb">Clear</button></div>'),gv=O('<div class="tabs-container svelte-1f8dwwb"><nav class="svelte-1f8dwwb"><label class="svelte-1f8dwwb"><input type="radio" name="view" class="svelte-1f8dwwb"/> <!> Devices</label> <label class="svelte-1f8dwwb"><input type="radio" name="view" class="svelte-1f8dwwb"/> <!> Animations</label> <label class="svelte-1f8dwwb"><input type="radio" name="view" class="svelte-1f8dwwb"/> <!> Inputs</label> <label class="svelte-1f8dwwb"><input type="radio" name="view" class="svelte-1f8dwwb"/> <!> Triggers</label> <label class="svelte-1f8dwwb"><input type="radio" name="view" class="svelte-1f8dwwb"/> <!> CSS</label> <label class="svelte-1f8dwwb"><input type="radio" name="view" class="svelte-1f8dwwb"/> <!> Universe</label></nav> <!></div>');function yv(r,e){yt(e,!0);const t=[];let n=pe(e,"view",15),i=pe(e,"onClearUniverse",3,null);var a=gv(),o=_(a),c=_(o),l=_(c);l.value=l.__value="devices";var u=w(l,2);Nt(u,{get data(){return dv}});var f=w(c,2),d=_(f);d.value=d.__value="animations";var g=w(d,2);Nt(g,{get data(){return vv}});var m=w(f,2),h=_(m);h.value=h.__value="inputs";var y=w(h,2);Nt(y,{get data(){return hv}});var v=w(m,2),x=_(v);x.value=x.__value="triggers";var M=w(x,2);Nt(M,{get data(){return pv}});var L=w(v,2),F=_(L);F.value=F.__value="css";var I=w(F,2);Nt(I,{get data(){return mv}});var P=w(L,2),j=_(P);j.value=j.__value="universe";var Y=w(j,2);Nt(Y,{get data(){return fv}});var oe=w(o,2);{var ue=re=>{var le=_v(),ye=_(le);ye.__click=function(..._e){var de;(de=i())==null||de.apply(this,_e)},S(re,le)};ce(oe,re=>{n()==="universe"&&i()&&re(ue)})}yn(t,[],l,n,n),yn(t,[],d,n,n),yn(t,[],h,n,n),yn(t,[],x,n,n),yn(t,[],F,n,n),yn(t,[],j,n,n),S(r,a),wt()}Pt(["click"]);var wv=O('<div class="channel svelte-134r4z3"><label class="svelte-134r4z3"></label> <input type="number" min="0" max="255" class="svelte-134r4z3"/></div>'),bv=O('<div class="universe-container svelte-134r4z3"><div class="channels-grid svelte-134r4z3"></div></div>');function Sv(r,e){yt(e,!0);let t=z(Ae(new Array(512).fill(0))),n;function i(){e.dmxController&&C(t,Array.from(e.dmxController.getUniverse()),!0)}Hn(()=>{n=setInterval(i,100)}),Ca(()=>{n&&clearInterval(n)});function a(l,u){const f=parseInt(u.target.value)||0;e.dmxController&&e.dmxController.setChannel(l,f),s(t)[l]=f}var o=bv(),c=_(o);Pe(c,21,()=>s(t),qe,(l,u,f)=>{var d=wv(),g=_(d);Ft(g,"for",`ch-${f}`),g.textContent=f+1;var m=w(g,2);Ft(m,"id",`ch-${f}`),m.__change=h=>a(f,h),Z(()=>Gt(m,s(u))),S(l,d)}),S(r,o),wt()}Pt(["change"]);function ja(r,e){var a,o;const t=(a=Me[r])==null?void 0:a.controls,n=(o=Me[e])==null?void 0:o.controls;if(!t||!n)return{};const i={};for(const c of t)for(const l of n)if(c.name===l.name&&c.type===l.type){i[c.name]=l.name;break}return i}function Cv(r,e){const t=ja(r,e);return Object.keys(t).length>0}function vs(r,e){const t=Me[r],n=t.controls.find(a=>a.name===e);if(!n)return[];const i=[];for(const a of Object.values(n.components)){const o=t.components[a].channel;i.push(o)}return i}function ho(r,e,t,n,i=null,a=!1){const o=ja(r,e),c=[...n];for(const[l,u]of Object.entries(o)){if(i!==null&&!i.includes(l))continue;const f=vs(r,l),d=vs(e,u);for(let g=0;g<Math.min(f.length,d.length);g++){let m=t[f[g]];a&&l==="Pan/Tilt"&&g===0&&(m=255-m),c[d[g]]=m}}return c}function Dv(r,e,t=null){const n=ja(r,e),i=[];for(const[a,o]of Object.entries(n)){if(t!==null&&!t.includes(a))continue;const c=vs(e,o);i.push(...c)}return i}function xv(r,e){const t=ja(r,e),n=Me[r].controls,i=Me[e].controls,a=[];for(const[o,c]of Object.entries(t)){const l=n.find(f=>f.name===o),u=i.find(f=>f.name===c);a.push({controlName:o,sourceControl:l,targetControl:u})}return a}var Ev=O('<div class="xy-pad svelte-wbxrfb" role="slider" aria-label="Pan and Tilt Control" tabindex="0"><div class="grid-line vertical svelte-wbxrfb" style="left: 25%"></div> <div class="grid-line vertical svelte-wbxrfb" style="left: 50%"></div> <div class="grid-line vertical svelte-wbxrfb" style="left: 75%"></div> <div class="grid-line horizontal svelte-wbxrfb" style="top: 25%"></div> <div class="grid-line horizontal svelte-wbxrfb" style="top: 50%"></div> <div class="grid-line horizontal svelte-wbxrfb" style="top: 75%"></div> <div></div></div>');function Iv(r,e){yt(e,!0);let t=pe(e,"panValue",15,127),n=pe(e,"tiltValue",15,127),i=pe(e,"onUpdate",3,null),a=z(null),o=z(!1);function c(y,v){if(!s(a))return;const x=s(a).getBoundingClientRect();let M=(y-x.left)/x.width,L=(v-x.top)/x.height;M=Math.max(0,Math.min(1,M)),L=Math.max(0,Math.min(1,L)),t(Math.round(M*255)),n(Math.round((1-L)*255)),i()&&i()(t(),n())}function l(y){C(o,!0),c(y.clientX,y.clientY),y.preventDefault()}function u(y){s(o)&&c(y.clientX,y.clientY)}xr(()=>{const y=()=>{C(o,!1)};return window.addEventListener("mouseup",y),()=>window.removeEventListener("mouseup",y)});let f=ge(()=>t()/255*100),d=ge(()=>(1-n()/255)*100);var g=Ev();g.__mousedown=l,g.__mousemove=u;var m=w(_(g),12);let h;dn(g,y=>C(a,y),()=>s(a)),Z(()=>{h=St(m,1,"crosshair svelte-wbxrfb",null,h,{active:s(o)}),Rt(m,`left: ${s(f)??""}%; top: ${s(d)??""}%`)}),S(r,g),wt()}Pt(["mousedown","mousemove"]);var kv=O('<button type="button" role="switch"><span class="toggle-slider svelte-1fjc2jm"></span></button>');function Pv(r,e){yt(e,!0);let t=pe(e,"checked",15,!1),n=pe(e,"disabled",3,!1),i=pe(e,"onchange",3,null),a=pe(e,"label",3,null);function o(){n()||(t(!t()),i()&&i()(t()))}var c=kv();let l;c.__click=o,Z(()=>{l=St(c,1,"toggle-switch svelte-1fjc2jm",null,l,{on:t()}),c.disabled=n(),Ft(c,"aria-checked",t()),Ft(c,"aria-label",a())}),S(r,c),wt()}Pt(["click"]);var Mv=O('<div class="control-xypad svelte-xb2oul"><label class="svelte-xb2oul"> </label> <div><!></div> <div class="xypad-inputs svelte-xb2oul"><input type="text" class="value-input svelte-xb2oul" title="X" maxlength="3"/> <input type="text" class="value-input svelte-xb2oul" title="Y" maxlength="3"/></div></div>'),Lv=O('<div class="control-group-label svelte-xb2oul"><label class="svelte-xb2oul"> </label></div>  <div class="control svelte-xb2oul"><label class="svelte-xb2oul"> </label> <div class="slider-wrapper svelte-xb2oul"><input type="range" min="0" max="255" class="color-slider svelte-xb2oul"/></div> <input type="text" class="value-input svelte-xb2oul" maxlength="3"/></div>  <div class="control svelte-xb2oul"><label class="svelte-xb2oul"> </label> <div class="slider-wrapper svelte-xb2oul"><input type="range" min="0" max="255" class="color-slider svelte-xb2oul"/></div> <input type="text" class="value-input svelte-xb2oul" maxlength="3"/></div>  <div class="control svelte-xb2oul"><label class="svelte-xb2oul"> </label> <div class="slider-wrapper svelte-xb2oul"><input type="range" min="0" max="255" class="color-slider svelte-xb2oul"/></div> <input type="text" class="value-input svelte-xb2oul" maxlength="3"/></div>',1),Av=O('<div class="control svelte-xb2oul"><label class="svelte-xb2oul"> </label> <div class="toggle-wrapper svelte-xb2oul"><!></div> <input type="text" class="value-input svelte-xb2oul" maxlength="3"/></div>'),Tv=O('<div class="control svelte-xb2oul"><label class="svelte-xb2oul"> </label> <div class="slider-wrapper svelte-xb2oul"><input type="range" min="0" max="255" class="color-slider svelte-xb2oul"/></div> <input type="text" class="value-input svelte-xb2oul" maxlength="3"/></div>'),Nv=O('<div class="controls svelte-xb2oul"></div>');function aa(r,e){yt(e,!0);let t=pe(e,"values",31,()=>Ae([])),n=pe(e,"onChange",3,null),i=pe(e,"disabledChannels",19,()=>[]);function a(y,v){t(t()[y]=v,!0),n()&&n()(y,v)}function o(y,v,x,M){t(t()[y]=x,!0),t(t()[v]=M,!0),n()&&(n()(y,x),n()(v,M))}function c(y,v){const M=t()[y]===v.onValue?v.offValue:v.onValue;a(y,M)}function l(y,v,x){const M=parseInt(v);!isNaN(M)&&M>=0&&M<=255?a(y,M):v===""?x.target.value="":x.target.value=t()[y]}function u(y){y.target.value=y.target.value.replace(/[^0-9]/g,"")}function f(y){return i().includes(y)}function d(y){return e.components[y].channel}function g(y){switch(y){case"Red":return"linear-gradient(to right, rgb(0,0,0) 0%, rgb(255,0,0) 100%)";case"Green":return"linear-gradient(to right, rgb(0,0,0) 0%, rgb(0,255,0) 100%)";case"Blue":return"linear-gradient(to right, rgb(0,0,0) 0%, rgb(0,0,255) 100%)";case"Amber":return"linear-gradient(to right, rgb(0,0,0) 0%, rgb(255,191,0) 100%)";case"White":return"linear-gradient(to right, rgb(0,0,0) 0%, rgb(255,255,255) 100%)";case"Dimmer":case"Intensity":return"linear-gradient(to right, rgb(0,0,0) 0%, rgb(255,255,255) 100%)";case"Output":return"linear-gradient(to right, rgb(0,0,0) 0%, rgb(200,200,200) 100%)";default:return"linear-gradient(to right, rgb(0,0,0) 0%, rgb(128,128,128) 100%)"}}function m(y,v){switch(y){case"Red":return`rgb(${v}, 0, 0)`;case"Green":return`rgb(0, ${v}, 0)`;case"Blue":return`rgb(0, 0, ${v})`;case"Amber":return`rgb(${v}, ${Math.round(v*.749)}, 0)`;case"White":return`rgb(${v}, ${v}, ${v})`;case"Dimmer":case"Intensity":return`rgb(${v}, ${v}, ${v})`;case"Output":return`rgb(${Math.round(v*.784)}, ${Math.round(v*.784)}, ${Math.round(v*.784)})`;default:return`rgb(${Math.round(v*.5)}, ${Math.round(v*.5)}, ${Math.round(v*.5)})`}}var h=Nv();Pe(h,21,()=>e.controls,qe,(y,v)=>{var x=it(),M=he(x);{var L=I=>{const P=ge(()=>d(s(v).components.x)),j=ge(()=>d(s(v).components.y)),Y=ge(()=>f(s(P))),oe=ge(()=>f(s(j))),ue=ge(()=>s(Y)&&s(oe));var re=Mv(),le=_(re),ye=_(le),_e=w(le,2);let de;var ke=_(_e);Iv(ke,{get panValue(){return t()[s(P)]},get tiltValue(){return t()[s(j)]},onUpdate:(b,D)=>!s(ue)&&o(s(P),s(j),b,D)});var Q=w(_e,2),V=_(Q);V.__input=u,V.__change=b=>!s(Y)&&l(s(P),b.target.value,b);var G=w(V,2);G.__input=u,G.__change=b=>!s(oe)&&l(s(j),b.target.value,b),Z(()=>{ne(ye,s(v).name),de=St(_e,1,"xypad-wrapper svelte-xb2oul",null,de,{disabled:s(ue)}),Gt(V,t()[s(P)]),V.disabled=s(Y),Gt(G,t()[s(j)]),G.disabled=s(oe)}),S(I,re)},F=I=>{var P=it(),j=he(P);{var Y=ue=>{const re=ge(()=>d(s(v).components.r)),le=ge(()=>d(s(v).components.g)),ye=ge(()=>d(s(v).components.b)),_e=ge(()=>f(s(re))),de=ge(()=>f(s(le))),ke=ge(()=>f(s(ye)));var Q=Lv(),V=he(Q),G=_(V),b=_(G),D=w(V,2),A=_(D),T=_(A),N=w(A,2),k=_(N);k.__input=Ee=>!s(_e)&&a(s(re),parseInt(Ee.target.value));var $=w(N,2);$.__input=u,$.__change=Ee=>!s(_e)&&l(s(re),Ee.target.value,Ee);var K=w(D,2),X=_(K),E=_(X),R=w(X,2),te=_(R);te.__input=Ee=>!s(de)&&a(s(le),parseInt(Ee.target.value));var H=w(R,2);H.__input=u,H.__change=Ee=>!s(de)&&l(s(le),Ee.target.value,Ee);var ee=w(K,2),ie=_(ee),we=_(ie),xe=w(ie,2),je=_(xe);je.__input=Ee=>!s(ke)&&a(s(ye),parseInt(Ee.target.value));var Ve=w(xe,2);Ve.__input=u,Ve.__change=Ee=>!s(ke)&&l(s(ye),Ee.target.value,Ee),Z((Ee,Ye,Dt,Vt,kr,Pr)=>{ne(b,s(v).name),ne(T,e.components[s(v).components.r].name),Gt(k,t()[s(re)]),Rt(k,`--slider-gradient: ${Ee??""}; --thumb-color: ${Ye??""}`),k.disabled=s(_e),Gt($,t()[s(re)]),$.disabled=s(_e),ne(E,e.components[s(v).components.g].name),Gt(te,t()[s(le)]),Rt(te,`--slider-gradient: ${Dt??""}; --thumb-color: ${Vt??""}`),te.disabled=s(de),Gt(H,t()[s(le)]),H.disabled=s(de),ne(we,e.components[s(v).components.b].name),Gt(je,t()[s(ye)]),Rt(je,`--slider-gradient: ${kr??""}; --thumb-color: ${Pr??""}`),je.disabled=s(ke),Gt(Ve,t()[s(ye)]),Ve.disabled=s(ke)},[()=>g("Red"),()=>m("Red",t()[s(re)]),()=>g("Green"),()=>m("Green",t()[s(le)]),()=>g("Blue"),()=>m("Blue",t()[s(ye)])]),S(ue,Q)},oe=ue=>{var re=it(),le=he(re);{var ye=de=>{const ke=ge(()=>d(s(v).components.value)),Q=ge(()=>f(s(ke))),V=ge(()=>t()[s(ke)]===s(v).onValue);var G=Av(),b=_(G),D=_(b),A=w(b,2),T=_(A);Pv(T,{get checked(){return s(V)},get disabled(){return s(Q)},onchange:()=>c(s(ke),s(v)),get label(){return s(v).name}});var N=w(A,2);N.__input=u,N.__change=k=>!s(Q)&&l(s(ke),k.target.value,k),Z(()=>{ne(D,s(v).name),Gt(N,t()[s(ke)]),N.disabled=s(Q)}),S(de,G)},_e=de=>{var ke=it(),Q=he(ke);{var V=G=>{const b=ge(()=>d(s(v).components.value)),D=ge(()=>f(s(b)));var A=Tv(),T=_(A),N=_(T),k=w(T,2),$=_(k);$.__input=X=>!s(D)&&a(s(b),parseInt(X.target.value));var K=w(k,2);K.__input=u,K.__change=X=>!s(D)&&l(s(b),X.target.value,X),Z((X,E)=>{ne(N,s(v).name),Gt($,t()[s(b)]),Rt($,`--slider-gradient: ${X??""}; --thumb-color: ${E??""}`),$.disabled=s(D),Gt(K,t()[s(b)]),K.disabled=s(D)},[()=>g(e.components[s(v).components.value].name),()=>m(e.components[s(v).components.value].name,t()[s(b)])]),S(G,A)};ce(Q,G=>{s(v).type==="slider"&&G(V)},!0)}S(de,ke)};ce(le,de=>{s(v).type==="toggle"?de(ye):de(_e,!1)},!0)}S(ue,re)};ce(j,ue=>{s(v).type==="rgb"?ue(Y):ue(oe,!1)},!0)}S(I,P)};ce(M,I=>{s(v).type==="xypad"?I(L):I(F,!1)})}S(y,x)}),S(r,h),wt()}Pt(["input","change"]);var Rv=O("<button><!></button>");function ze(r,e){let t=pe(e,"variant",3,"primary"),n=pe(e,"disabled",3,!1),i=pe(e,"onclick",3,null),a=pe(e,"type",3,"button"),o=pe(e,"form",3,null),c=pe(e,"pulsating",3,!1);var l=Rv();l.__click=function(...f){var d;(d=i())==null||d.apply(this,f)};var u=_(l);Wi(u,()=>e.children),Z(()=>{St(l,1,`button ${t()??""} ${c()?"pulsating":""}`,"svelte-18f749u"),l.disabled=n(),Ft(l,"type",a()),Ft(l,"form",o()||void 0)}),S(r,l)}Pt(["click"]);var Ov=O("<button><!></button>");function Ls(r,e){let t=pe(e,"onclick",3,null),n=pe(e,"disabled",3,!1),i=pe(e,"size",3,"medium");var a=Ov();a.__click=function(...c){var l;(l=t())==null||l.apply(this,c)};var o=_(a);Nt(o,{get data(){return e.icon}}),Z(()=>{St(a,1,`icon-button ${i()??""}`,"svelte-cwtv5f"),a.disabled=n(),Ft(a,"aria-label",e.label),Ft(a,"title",e.label)}),S(r,a)}Pt(["click"]);const Ga=`<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="30" height="30" viewBox="0 0 30 30">
    <path d="M 22.828125 3 C 22.316375 3 21.804562 3.1954375 21.414062 3.5859375 L 19 6 L 24 11 L 26.414062 8.5859375 C 27.195062 7.8049375 27.195062 6.5388125 26.414062 5.7578125 L 24.242188 3.5859375 C 23.851688 3.1954375 23.339875 3 22.828125 3 z M 17 8 L 5.2597656 19.740234 C 5.2597656 19.740234 6.1775313 19.658 6.5195312 20 C 6.8615312 20.342 6.58 22.58 7 23 C 7.42 23.42 9.6438906 23.124359 9.9628906 23.443359 C 10.281891 23.762359 10.259766 24.740234 10.259766 24.740234 L 22 13 L 17 8 z M 4 23 L 3.0566406 25.671875 A 1 1 0 0 0 3 26 A 1 1 0 0 0 4 27 A 1 1 0 0 0 4.328125 26.943359 A 1 1 0 0 0 4.3378906 26.939453 L 4.3632812 26.931641 A 1 1 0 0 0 4.3691406 26.927734 L 7 26 L 5.5 24.5 L 4 23 z"></path>
</svg>`,Fv=`<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="48" height="48" viewBox="0 0 48 48">
<path fill="#1976D2" d="M38 14h-3c-5.514 0-10 4.486-10 10s4.486 10 10 10h3c5.514 0 10-4.486 10-10S43.514 14 38 14M38 30h-3c-3.309 0-6-2.691-6-6s2.691-6 6-6h3c3.309 0 6 2.691 6 6S41.309 30 38 30M13 14h-3C4.486 14 0 18.486 0 24s4.486 10 10 10h3c5.514 0 10-4.486 10-10S18.514 14 13 14M13 30h-3c-3.309 0-6-2.691-6-6s2.691-6 6-6h3c3.309 0 6 2.691 6 6S16.309 30 13 30"></path><path fill="#42A5F5" d="M33,22H15c-1.104,0-2,0.896-2,2s0.896,2,2,2h18c1.104,0,2-0.896,2-2S34.104,22,33,22"></path>
</svg>`,Li=`<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="48" height="48" viewBox="0 0 48 48">
<path fill="#b39ddb" d="M30.6,44H17.4c-2,0-3.7-1.4-4-3.4L9,11h30l-4.5,29.6C34.2,42.6,32.5,44,30.6,44z"></path><path fill="#9575cd" d="M28 6L20 6 14 12 34 12z"></path><path fill="#7e57c2" d="M10,8h28c1.1,0,2,0.9,2,2v2H8v-2C8,8.9,8.9,8,10,8z"></path>
</svg>`;var Vv=O("<option> </option>"),Bv=O('<div class="empty-state svelte-25wvt7"><p>No devices added yet. Add a device to get started!</p></div>'),jv=O('<div class="device-card svelte-25wvt7"><div class="device-header svelte-25wvt7"><div class="color-preview svelte-25wvt7"></div> <h3 class="svelte-25wvt7"> </h3> <!> <!></div> <!></div>'),Gv=O("<!> Delete",1),$v=O("<!> <!>",1),Kv=O("<option> </option>"),Uv=O(`<select id="link-select" class="svelte-25wvt7"><option>None</option><!></select> <small class="link-help svelte-25wvt7">Link this device to follow another device's values</small>`,1),Hv=O('<p class="no-devices svelte-25wvt7">No compatible devices available to link</p>'),zv=O('<label class="sync-control-item svelte-25wvt7"><input type="checkbox" class="svelte-25wvt7"/> <span class="svelte-25wvt7"> </span></label>'),qv=O('<div class="dialog-input-group svelte-25wvt7"><label class="checkbox-label svelte-25wvt7"><input type="checkbox" class="svelte-25wvt7"/> <span class="svelte-25wvt7">Mirror pan (invert pan values)</span></label> <small class="link-help svelte-25wvt7">Useful for moving heads facing each other</small></div>'),Wv=O('<div class="dialog-input-group svelte-25wvt7"><label>Sync controls:</label> <div class="sync-controls-list svelte-25wvt7"></div> <small class="link-help svelte-25wvt7">Select which controls to sync from the linked device</small></div> <!>',1),Yv=O('<form id="device-settings-form" method="dialog"><div class="dialog-input-group svelte-25wvt7"><label for="name-input">Name:</label> <input id="name-input" type="text" placeholder="Device name" class="svelte-25wvt7"/> <small class="css-id-preview svelte-25wvt7"> </small></div> <div class="dialog-input-group svelte-25wvt7"><label for="channel-input">Starting channel (1-512):</label> <input id="channel-input" type="number" min="1" max="512"/> <small class="channel-range svelte-25wvt7"> </small></div> <div class="dialog-input-group svelte-25wvt7"><label for="link-select">Link to device:</label> <!></div> <!></form>'),Xv=O('<div class="devices-container svelte-25wvt7"><div class="add-device-section svelte-25wvt7"><select class="svelte-25wvt7"></select> <!></div> <div class="devices-list svelte-25wvt7"><!> <!></div> <!></div>');function Jv(r,e){yt(e,!0);let t=pe(e,"devices",31,()=>Ae([])),n=z("RGB"),i=null,a=z(null),o=z(""),c=z(1),l=z(null),u=z(null),f=z(!1);function d(E){C(a,E,!0),C(o,E.name,!0),C(c,E.startChannel+1),C(l,E.linkedTo||null,!0),C(u,E.syncedControls||null,!0),C(f,E.mirrorPan||!1,!0),requestAnimationFrame(()=>{i==null||i.showModal()})}function g(){i==null||i.close(),C(a,null),C(o,""),C(l,null),C(u,null),C(f,!1)}function m(){s(a)&&confirm(`Are you sure you want to remove "${s(a).name}"?`)&&(Y(s(a).id),g())}function h(){var R;return(s(o).trim()||((R=s(a))==null?void 0:R.name)||"").toLowerCase().replace(/[^a-z0-9]/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,"")}function y(){if(!s(a)||!v(s(a),s(c)-1))return;const E=Math.max(0,Math.min(511,s(c)-1)),R=s(o).trim()||s(a).name,te=R===s(a).name?s(a).cssId:null,H=new Qn(s(a).id,s(a).type,E,R,s(l),te,s(l)!==null?s(u):null,s(l)!==null?s(f):!1);if(H.defaultValues=[...s(a).defaultValues],s(l)!==null){const ee=t().find(ie=>ie.id===s(l));if(ee){const ie=ho(ee.type,H.type,ee.defaultValues,H.defaultValues,s(u),s(f));H.defaultValues=ie}}e.dmxController&&H.defaultValues.forEach((ee,ie)=>{const we=H.startChannel+ie;e.dmxController.setChannel(we,ee)}),t(t().map(ee=>ee.id===s(a).id?H:ee)),g()}function v(E,R){const te=Me[E.type].channels,H=R+te;if(H>512||R<0)return!1;for(let ee of t()){if(ee.id===E.id)continue;const ie=Me[ee.type].channels,we=ee.startChannel,xe=we+ie;if(R<xe&&H>we)return!1}return!0}function x(){try{const E=localStorage.getItem("dmx-devices");if(E){const R=JSON.parse(E);return{devices:R.devices.map(H=>{const ee=new Qn(H.id,H.type,H.startChannel,H.name,H.linkedTo,H.cssId,H.syncedControls||null,H.mirrorPan||!1);return ee.defaultValues=H.defaultValues||new Array(Me[H.type].channels).fill(0),ee}),nextId:R.nextId||1}}}catch(E){console.error("Failed to load from localStorage:",E)}return{devices:[],nextId:1}}const M=t().length===0?x():{devices:t(),nextId:null};t().length===0&&t(M.devices);const L=t().length>0?Math.max(...t().map(E=>E.id)):0;let F=z(Ae(Math.max(L+1,M.nextId||1)));xr(()=>{try{const E={devices:t().map(R=>({id:R.id,name:R.name,type:R.type,startChannel:R.startChannel,defaultValues:R.defaultValues,linkedTo:R.linkedTo,cssId:R.cssId,syncedControls:R.syncedControls,mirrorPan:R.mirrorPan})),nextId:s(F)};localStorage.setItem("dmx-devices",JSON.stringify(E))}catch(E){console.error("Failed to save to localStorage:",E)}});function I(){if(t().length===0)return 0;let E=0;return t().forEach(R=>{const te=R.startChannel+Me[R.type].channels;te>E&&(E=te)}),E>=512?0:E}function P(E=s(n)){const R=I(),te=new Qn(Zi(F),E,R);t([...t(),te])}function j(){t(t().map(E=>(E.defaultValues=E.defaultValues.map(()=>0),E)))}function Y(E){t(t().map(R=>(R.linkedTo===E&&(R.linkedTo=null),R)).filter(R=>R.id!==E))}function oe(E,R,te){const H=new Qn(E.id,E.type,E.startChannel,E.name,E.linkedTo,E.cssId,E.syncedControls,E.mirrorPan);H.defaultValues=[...E.defaultValues],H.defaultValues[R]=te,t(t().map(ee=>ee.id===E.id?H:ee)),ue(H),re(H)}function ue(E){e.dmxController&&E.defaultValues.forEach((R,te)=>{const H=E.startChannel+te;e.dmxController.setChannel(H,R)})}function re(E){t(t().map(R=>{if(R.linkedTo===E.id){const te=new Qn(R.id,R.type,R.startChannel,R.name,R.linkedTo,R.cssId,R.syncedControls,R.mirrorPan),H=ho(E.type,R.type,E.defaultValues,R.defaultValues,R.syncedControls,R.mirrorPan);return te.defaultValues=H,ue(te),te}return R}))}function le(E){return t().filter(R=>R.id!==E.id&&!R.isLinked()&&Cv(E.type,R.type)&&R.linkedTo!==E.id)}function ye(E){if(!E.linkedTo)return[];const R=t().find(te=>te.id===E.linkedTo);return R?Dv(R.type,E.type,E.syncedControls):[]}function _e(){if(!s(l)||!s(a))return[];const E=t().find(R=>R.id===s(l));return E?xv(E.type,s(a).type):[]}function de(E){if(s(u)===null){const R=_e();C(u,R.map(te=>te.controlName).filter(te=>te!==E),!0)}else s(u).includes(E)?C(u,s(u).filter(R=>R!==E),!0):C(u,[...s(u),E],!0)}function ke(E){return s(u)===null?!0:s(u).includes(E)}function Q(){return _e().some(R=>R.controlName==="Pan/Tilt")}xr(()=>{e.dmxController&&t().forEach(E=>{ue(E)})});var V={addDevice:P,clearAllDeviceValues:j},G=Xv(),b=_(G),D=_(b);Pe(D,21,()=>Object.entries(Me),qe,(E,R)=>{var te=ge(()=>vc(s(R),2));let H=()=>s(te)[0],ee=()=>s(te)[1];var ie=Vv(),we=_(ie),xe={};Z(()=>{ne(we,ee().name),xe!==(xe=H())&&(ie.value=(ie.__value=H())??"")}),S(E,ie)});var A=w(D,2);ze(A,{onclick:()=>P(s(n)),variant:"secondary",children:(E,R)=>{var te=rt("Add Device");S(E,te)},$$slots:{default:!0}});var T=w(b,2),N=_(T);{var k=E=>{var R=Bv();S(E,R)};ce(N,E=>{t().length===0&&E(k)})}var $=w(N,2);Pe($,17,t,E=>E.id,(E,R)=>{var te=jv(),H=_(te),ee=_(H),ie=w(ee,2),we=_(ie),xe=w(ie,2);{var je=Ye=>{Nt(Ye,{get data(){return Fv}})};ce(xe,Ye=>{s(R).isLinked()&&Ye(je)})}var Ve=w(xe,2);Ls(Ve,{get icon(){return Ga},onclick:()=>d(s(R)),title:"Device settings",size:"small"});var Ee=w(H,2);{let Ye=ge(()=>ye(s(R)));aa(Ee,{get controls(){return Me[s(R).type].controls},get components(){return Me[s(R).type].components},get values(){return s(R).defaultValues},onChange:(Dt,Vt)=>oe(s(R),Dt,Vt),get disabledChannels(){return s(Ye)}})}Z(Ye=>{Rt(ee,`background-color: ${Ye??""}`),ne(we,s(R).name)},[()=>fn(s(R).type,s(R).defaultValues)]),S(E,te)});var K=w(T,2);{var X=E=>{Cr(E,{title:"Device",onclose:g,get dialogRef(){return i},set dialogRef(H){i=H},tools:H=>{ze(H,{onclick:m,variant:"secondary",children:(ee,ie)=>{var we=Gv(),xe=he(we);un(xe,()=>Li),S(ee,we)},$$slots:{default:!0}})},buttons:H=>{var ee=$v(),ie=he(ee);ze(ie,{onclick:g,variant:"secondary",children:(xe,je)=>{var Ve=rt("Cancel");S(xe,Ve)},$$slots:{default:!0}});var we=w(ie,2);{let xe=ge(()=>!v(s(a),s(c)-1));ze(we,{type:"submit",form:"device-settings-form",variant:"primary",get disabled(){return s(xe)},children:(je,Ve)=>{var Ee=rt("Save");S(je,Ee)},$$slots:{default:!0}})}S(H,ee)},children:(H,ee)=>{var ie=Yv(),we=_(ie),xe=w(_(we),2),je=w(xe,2),Ve=_(je),Ee=w(we,2),Ye=w(_(Ee),2);let Dt;var Vt=w(Ye,2),kr=_(Vt),Pr=w(Ee,2),Wn=w(_(Pr),2);{var B=se=>{var J=Uv(),Te=he(J),Ne=_(Te);Ne.value=(Ne.__value=null)??"";var Be=w(Ne);Pe(Be,17,()=>le(s(a)),qe,(Ge,Oe)=>{var Ue=Kv(),Qe=_(Ue),et={};Z(()=>{ne(Qe,`${s(Oe).name??""} (${Me[s(Oe).type].name??""})`),et!==(et=s(Oe).id)&&(Ue.value=(Ue.__value=s(Oe).id)??"")}),S(Ge,Ue)}),tt(Te,()=>s(l),Ge=>C(l,Ge)),S(se,J)},q=se=>{var J=Hv();S(se,J)};ce(Wn,se=>{le(s(a)).length>0||s(a).isLinked()?se(B):se(q,!1)})}var ve=w(Pr,2);{var ae=se=>{var J=Wv(),Te=he(J),Ne=w(_(Te),2);Pe(Ne,21,_e,qe,(Oe,Ue)=>{var Qe=zv(),et=_(Qe);et.__change=()=>de(s(Ue).controlName);var vt=w(et,2),Bt=_(vt);Z(jt=>{Tu(et,jt),ne(Bt,s(Ue).controlName)},[()=>ke(s(Ue).controlName)]),S(Oe,Qe)});var Be=w(Te,2);{var Ge=Oe=>{var Ue=qv(),Qe=_(Ue),et=_(Qe);ni(et,()=>s(f),vt=>C(f,vt)),S(Oe,Ue)};ce(Be,Oe=>{Q()&&Oe(Ge)})}S(se,J)};ce(ve,se=>{s(l)!==null&&se(ae)})}Z((se,J)=>{ne(Ve,`#${se??""}`),Dt=St(Ye,1,"svelte-25wvt7",null,Dt,J),ne(kr,`Device uses ${Me[s(a).type].channels??""} channels:
                ${s(c)??""}-${s(c)+Me[s(a).type].channels-1}`)},[h,()=>({valid:v(s(a),s(c)-1),invalid:!v(s(a),s(c)-1)})]),on("submit",ie,se=>{se.preventDefault(),y()}),br(xe,()=>s(o),se=>C(o,se)),br(Ye,()=>s(c),se=>C(c,se)),S(H,ie)},$$slots:{tools:!0,buttons:!0,default:!0}})};ce(K,E=>{s(a)&&E(X)})}return tt(D,()=>s(n),E=>C(n,E)),S(r,G),wt(V)}Pt(["change"]);var Zv=O('<div class="gradient-segment svelte-ctef3a"></div>'),Qv=O('<div><div class="keyframe-time svelte-ctef3a"> </div></div>'),eh=O("<!> Delete",1),th=O('<div class="timeline-container svelte-ctef3a"><div class="timeline svelte-ctef3a"><!> <!></div></div> <!>',1);function rh(r,e){yt(e,!0);let t=pe(e,"animation",7),n=pe(e,"animationVersion",3,0),i=pe(e,"onUpdate",3,null),a=z(Ae([0,0,0])),o=z(null),c=z(null),l=z(null),u=z(null),f=z(800),d=z(null),g=z(0),m=z(0),h=z(!1),y=ge(()=>(n(),t()?t().keyframes:[])),v=ge(()=>{if(n(),!t()||t().keyframes.length<2)return[];const V=[],G=t().keyframes,b=G[0];if(b.time>0){const A=t().getKeyframeColor(b);V.push({left:0,width:b.time*s(f),gradient:A})}for(let A=0;A<G.length-1;A++){const T=G[A],N=G[A+1],k=t().getKeyframeColor(T),$=t().getKeyframeColor(N),K=T.time*s(f),X=(N.time-T.time)*s(f);V.push({left:K,width:X,gradient:`linear-gradient(to right, ${k}, ${$})`})}const D=G[G.length-1];if(D.time<1){const A=t().getKeyframeColor(D),T=D.time*s(f),N=(1-D.time)*s(f);V.push({left:T,width:N,gradient:A})}return V});function x(V){return n(),V.time*s(f)}function M(V,G=null){if(!t())return;C(o,V,!0);const b=t().keyframes[V];C(a,[...b.values],!0),C(l,G,!0),requestAnimationFrame(()=>{var D;(D=s(c))==null||D.showModal()})}function L(){var V;(V=s(c))==null||V.close(),C(o,null),C(l,null)}function F(){if(!t()||s(o)===null)return;const V=t().keyframes[s(o)];V.values=[...s(a)],e.animationLibrary.save(),i()&&i()()}function I(){if(!(!t()||s(o)===null)){if(t().keyframes.length<=2){alert("Animation must have at least 2 keyframes");return}confirm(`Delete keyframe at ${(t().keyframes[s(o)].time*100).toFixed(0)}%?`)&&(P(s(o)),L())}}function P(V){if(!t()||t().keyframes.length<=2){alert("Animation must have at least 2 keyframes");return}t().keyframes=t().keyframes.filter((G,b)=>b!==V),e.animationLibrary.save(),i()&&i()(),C(o,null)}function j(V){if(!t()||V.target.classList.contains("timeline-keyframe-marker")||V.target.classList.contains("keyframe-time")||V.target.closest(".timeline-keyframe-marker"))return;const b=V.currentTarget.getBoundingClientRect(),D=V.clientX-b.left,A=Math.max(0,Math.min(1,D/s(f))),T=Math.round(A*20)/20;if(t().keyframes.some(K=>Math.abs(K.time-T)<.001))return;const k=t().getValuesAtTime(T);t().addKeyframe(T,k),e.animationLibrary.save(),i()&&i()();const $=t().keyframes.findIndex(K=>Math.abs(K.time-T)<.001);$!==-1&&requestAnimationFrame(()=>{requestAnimationFrame(()=>{const K=document.getElementById(`keyframe-${t().name}-${$}`);K&&M($,K)})})}function Y(V,G,b){V.preventDefault(),V.stopPropagation(),C(d,{keyframe:G,index:b},!0),C(g,V.clientX,!0),C(m,G.time,!0),C(h,!1),document.addEventListener("mousemove",oe),document.addEventListener("mouseup",ue)}function oe(V){if(!s(d)||!t())return;const G=V.clientX-s(g),b=G/s(f);let D=s(m)+b;D=Math.max(0,Math.min(1,D)),D=Math.round(D*100)/100;const A=t().keyframes[0],T=t().keyframes[t().keyframes.length-1];s(d).index!==0&&D===0&&A.time===0||s(d).index!==t().keyframes.length-1&&D===1&&T.time===1||(s(d).keyframe.time=D,t().keyframes.sort((N,k)=>N.time-k.time),s(d).index=t().keyframes.indexOf(s(d).keyframe),Math.abs(G)>3&&C(h,!0),i()&&i()())}function ue(){s(d)&&t()&&e.animationLibrary.save(),C(d,null),document.removeEventListener("mousemove",oe),document.removeEventListener("mouseup",ue),setTimeout(()=>{C(h,!1)},10)}var re=th(),le=he(re),ye=_(le);ye.__click=j;var _e=_(ye);Pe(_e,17,()=>s(v),qe,(V,G)=>{var b=Zv();Z(()=>Rt(b,`left: ${s(G).left??""}px; width: ${s(G).width??""}px; background: ${s(G).gradient??""}`)),S(V,b)});var de=w(_e,2);Pe(de,19,()=>s(y),(V,G)=>V.time+"-"+G+"-"+n(),(V,G,b)=>{var D=Qv();let A;D.__mousedown=k=>Y(k,s(G),s(b)),D.__click=k=>{k.stopPropagation(),s(h)||M(s(b),k.currentTarget)};var T=_(D),N=_(T);Z((k,$,K,X)=>{var E;Ft(D,"id",`keyframe-${t().name??""}-${s(b)??""}`),A=St(D,1,"timeline-keyframe-marker svelte-ctef3a",null,A,{dragging:((E=s(d))==null?void 0:E.keyframe)===s(G)}),Rt(D,`left: ${k??""}px; --keyframe-color: ${$??""}; anchor-name: --keyframe-${t().name??""}-${s(b)??""}`),Ft(D,"title",`${K??""}%`),ne(N,`${X??""}%`)},[()=>x(s(G)),()=>t().getKeyframeColor(s(G)),()=>(s(G).time*100).toFixed(0),()=>(s(G).time*100).toFixed(0)]),S(V,D)}),dn(ye,V=>C(u,V),()=>s(u));var ke=w(le,2);{var Q=V=>{{const G=A=>{{let T=ge(()=>t().keyframes.length<=2);ze(A,{onclick:I,variant:"secondary",get disabled(){return s(T)},children:(N,k)=>{var $=eh(),K=he($);un(K,()=>Li),S(N,$)},$$slots:{default:!0}})}};let b=ge(()=>`keyframe-${t().name}-${s(o)}`),D=ge(()=>(t().keyframes[s(o)].time*100).toFixed(0));Cr(V,{anchored:!0,get anchorId(){return s(b)},showArrow:!0,lightDismiss:!0,onclose:L,get title(){return`Keyframe at ${s(D)??""}%`},get dialogRef(){return s(c)},set dialogRef(A){C(c,A,!0)},tools:G,children:(A,T)=>{{let N=ge(()=>t().getControlsForRendering());aa(A,Uu(()=>s(N),{onChange:F,get values(){return s(a)},set values(k){C(a,k,!0)}}))}},$$slots:{tools:!0,default:!0}})}};ce(ke,V=>{s(l)&&t()&&s(o)!==null&&V(Q)})}Bu(ye,"clientWidth",V=>C(f,V)),S(r,re),wt()}Pt(["click","mousedown"]);var nh=O('<div class="empty-state svelte-nhkann"><p class="svelte-nhkann">No animations yet. Create one to get started!</p></div>'),ih=O('<div class="animation-card svelte-nhkann"><div class="animation-header svelte-nhkann"><div class="animation-info svelte-nhkann"><h3 class="svelte-nhkann"> </h3> <div class="badges svelte-nhkann"><div class="target-badge svelte-nhkann"> </div></div></div> <!></div> <!></div>'),ah=O("<!> <!>",1),sh=O("<option disabled>ââââââââââ</option>"),oh=O("<option> </option>"),lh=O('<form id="new-animation-form" method="dialog"><div class="dialog-input-group"><label for="animation-name">Animation Name:</label> <input id="animation-name" type="text" placeholder="e.g., rainbow, pulse, sweep"/> <small class="css-preview"> </small></div> <div class="dialog-input-group"><label for="animation-target">Target:</label> <select id="animation-target" class="animation-target-select"></select> <small class="help-text svelte-nhkann">Select a specific control or entire device type</small></div></form>'),ch=O("<!> Delete",1),uh=O("<!> <!>",1),dh=O('<form id="edit-animation-form" method="dialog"><div class="dialog-input-group"><label for="edit-animation-name">Name:</label> <input id="edit-animation-name" type="text" placeholder="Animation name"/> <small class="css-preview"> </small></div></form>'),fh=O('<div class="animations-view svelte-nhkann"><div class="add-animation-section svelte-nhkann"><!></div> <div class="animations-list svelte-nhkann"><!></div></div> <!> <!>',1);function vh(r,e){yt(e,!0),pe(e,"devices",19,()=>[]);let t=z(Ae([])),n=null,i=z(""),a=z("RGB|all"),o=null,c=z(null),l=z(""),u=z(0);function f(){if(C(t,e.animationLibrary.getAll(),!0),s(c)){const Q=s(t).find(V=>V.name===s(c).name);Q?C(c,Q,!0):C(c,null)}}Hn(()=>{f()});function d(){C(i,""),C(a,"control|Color"),n==null||n.showModal()}function g(){const Q=[],V=new Set;for(const b of Object.values(Me))for(const D of b.controls)V.add(D.name);const G=Array.from(V).sort();for(const b of G)Q.push({type:"control",value:`control|${b}`,label:b});Q.push({type:"separator"});for(const[b,D]of Object.entries(Me))Q.push({type:"device",value:`device|${b}`,label:D.name});return Q}function m(Q){const V=Q.split("|"),G=V[0];if(G==="control"){const b=V[1];return{controls:[b],displayName:b}}else if(G==="device"){const b=V[1],D=Me[b];return{controls:D.controls.map(T=>T.name),displayName:D.name}}return{controls:["Color"],displayName:"Color"}}function h(){if(!s(i).trim())return;const Q=m(s(a)),{controls:V,displayName:G}=Q,b=new Da(s(i).trim(),null,[],null,V,G),D=b.getNumChannels(),A=new Array(D).fill(0);b.addKeyframe(0,[...A]),b.addKeyframe(1,[...A]),e.animationLibrary.add(b),f(),n==null||n.close()}function y(Q){C(c,Q,!0),C(l,Q.name,!0),requestAnimationFrame(()=>{o==null||o.showModal()})}function v(){o==null||o.close(),C(c,null),C(l,"")}function x(){!s(c)||!s(l).trim()||(s(c).name,s(c).name=s(l).trim(),s(c).updateCSSName(),e.animationLibrary.save(),f(),v())}function M(){return s(i).trim()?s(i).toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""):""}function L(){return s(l).trim()?s(l).toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""):""}function F(){s(c)&&confirm(`Are you sure you want to delete "${s(c).name}"?`)&&(e.animationLibrary.remove(s(c).name),f(),v())}function I(){Zi(u)}var P=fh(),j=he(P),Y=_(j),oe=_(Y);ze(oe,{onclick:d,variant:"secondary",children:(Q,V)=>{var G=rt("Add Animation");S(Q,G)},$$slots:{default:!0}});var ue=w(Y,2),re=_(ue);{var le=Q=>{var V=nh();S(Q,V)},ye=Q=>{var V=it(),G=he(V);Pe(G,17,()=>s(t),b=>b.name,(b,D)=>{var A=ih(),T=_(A),N=_(T),k=_(N),$=_(k),K=w(k,2),X=_(K),E=_(X),R=w(N,2);Ls(R,{get icon(){return Ga},onclick:()=>y(s(D)),title:"Edit animation",size:"small"});var te=w(T,2);rh(te,{get animation(){return s(D)},get animationLibrary(){return e.animationLibrary},get animationVersion(){return s(u)},onUpdate:I}),Z(H=>{ne($,s(D).name),ne(E,H)},[()=>s(D).getDisplayName()]),S(b,A)}),S(Q,V)};ce(re,Q=>{s(t).length===0?Q(le):Q(ye,!1)})}var _e=w(j,2);Cr(_e,{title:"Create New Animation",onclose:()=>n==null?void 0:n.close(),get dialogRef(){return n},set dialogRef(V){n=V},buttons:V=>{var G=ah(),b=he(G);ze(b,{type:"button",onclick:()=>n==null?void 0:n.close(),variant:"secondary",children:(A,T)=>{var N=rt("Cancel");S(A,N)},$$slots:{default:!0}});var D=w(b,2);ze(D,{type:"submit",form:"new-animation-form",variant:"primary",children:(A,T)=>{var N=rt("Create");S(A,N)},$$slots:{default:!0}}),S(V,G)},children:(V,G)=>{var b=lh(),D=_(b),A=w(_(D),2);Qi(A,!0);var T=w(A,2),N=_(T),k=w(D,2),$=w(_(k),2);Pe($,21,g,qe,(K,X)=>{var E=it(),R=he(E);{var te=ee=>{var ie=sh();S(ee,ie)},H=ee=>{var ie=oh(),we=_(ie),xe={};Z(()=>{ne(we,s(X).label),xe!==(xe=s(X).value)&&(ie.value=(ie.__value=s(X).value)??"")}),S(ee,ie)};ce(R,ee=>{s(X).type==="separator"?ee(te):ee(H,!1)})}S(K,E)}),Z(K=>ne(N,`@keyframes ${K??""}`),[M]),on("submit",b,K=>{K.preventDefault(),h()}),br(A,()=>s(i),K=>C(i,K)),tt($,()=>s(a),K=>C(a,K)),S(V,b)},$$slots:{buttons:!0,default:!0}});var de=w(_e,2);{var ke=Q=>{Cr(Q,{title:"Animation",onclose:v,get dialogRef(){return o},set dialogRef(b){o=b},tools:b=>{ze(b,{onclick:F,variant:"secondary",children:(D,A)=>{var T=ch(),N=he(T);un(N,()=>Li),S(D,T)},$$slots:{default:!0}})},buttons:b=>{var D=uh(),A=he(D);ze(A,{onclick:v,variant:"secondary",children:(N,k)=>{var $=rt("Cancel");S(N,$)},$$slots:{default:!0}});var T=w(A,2);ze(T,{type:"submit",form:"edit-animation-form",variant:"primary",children:(N,k)=>{var $=rt("Save");S(N,$)},$$slots:{default:!0}}),S(b,D)},children:(b,D)=>{var A=dh(),T=_(A),N=w(_(T),2);Qi(N,!0);var k=w(N,2),$=_(k);Z(K=>ne($,`@keyframes ${K??""}`),[L]),on("submit",A,K=>{K.preventDefault(),x()}),br(N,()=>s(l),K=>C(l,K)),S(b,A)},$$slots:{tools:!0,buttons:!0,default:!0}})};ce(de,Q=>{s(c)&&Q(ke)})}S(r,P),wt()}var hh=O('<div class="empty-state svelte-an69h5"><p class="svelte-an69h5">No inputs detected yet. Start listening to detect inputs!</p></div>'),ph=O('<div class="input-color-badge svelte-an69h5"></div>'),mh=O('<div class="input-card svelte-an69h5"><!> <div class="input-header svelte-an69h5"><div class="input-name svelte-an69h5"> </div> <div class="input-device-name svelte-an69h5"> </div></div> <div class="input-actions svelte-an69h5"><button class="edit-button svelte-an69h5" title="Rename input"><!></button></div></div>'),_h=O("<!> Delete",1),gh=O("<!> <!>",1),yh=O('<code class="css-id svelte-an69h5"> </code> <code class="css-id svelte-an69h5"> </code>',1),wh=O('<code class="css-id svelte-an69h5"> </code>'),bh=O('<form id="edit-input-form"><div class="dialog-input-group svelte-an69h5"><label for="input-name">Name:</label> <input id="input-name" type="text" placeholder="Input name" class="svelte-an69h5"/> <div class="css-identifiers svelte-an69h5"><!></div></div></form>'),Sh=O('<div class="inputs-view svelte-an69h5"><div class="listen-section svelte-an69h5"><!></div> <div class="inputs-grid svelte-an69h5"><!></div></div> <!>',1);function Ch(r,e){yt(e,!0);let t=z(!1),n=z(Ae([])),i=z(null),a=z(""),o=null,c=[];function l(){C(t,!0);const b=e.inputController.getInputDevices();for(const D of b){const A=T=>{u({deviceId:D.id,controlId:T.controlId,type:T.velocity!==void 0?"trigger":"change",device:D})};D.on("trigger",A),D.on("change",A),c.push({device:D,event:"trigger",handler:A}),c.push({device:D,event:"change",handler:A})}e.inputController.on("deviceadded",f)}function u(b){if(!s(t))return;const{deviceId:D,controlId:A,device:T}=b;if(!s(n).find(k=>k.inputDeviceId===D&&k.inputControlId===A)){const k=g((T==null?void 0:T.name)||D,A),$=(T==null?void 0:T.type)==="hid"&&T.id!=="keyboard",K=new Bn({name:k,mode:"input",inputDeviceId:D,inputControlId:A,inputDeviceName:(T==null?void 0:T.name)||D,color:$?void 0:null});if(e.mappingLibrary.add(K),P(),$&&A.startsWith("button-")){const X=parseInt(A.replace("button-",""));if(!isNaN(X)&&X>=0){const E=e.inputController.inputDeviceManager.streamDeckManager,R=D;E.setButtonColor(R,X,K.color).catch(te=>{console.warn(`Could not set button ${X} color:`,te)})}}}}function f(b){if(!s(t))return;const D=A=>{u({deviceId:b.id,controlId:A.controlId,type:A.velocity!==void 0?"trigger":"change",device:b})};b.on("trigger",D),b.on("change",D),c.push({device:b,event:"trigger",handler:D}),c.push({device:b,event:"change",handler:D})}function d(){C(t,!1);for(const{device:b,event:D,handler:A}of c)b.off(D,A);c=[],e.inputController.off("deviceadded",f)}function g(b,D){if(D.startsWith("note-")){const A=D.replace("note-","");return`${b} Note ${A}`}else if(D.startsWith("control-")||D.startsWith("cc-")){const A=D.replace("control-","").replace("cc-","");return`${b} Control ${A}`}else if(D.startsWith("button-")){const A=D.replace("button-","");return`${b} Button ${A}`}else if(D.startsWith("key-")){const A=D.replace("key-","");return`Keyboard ${A.replace("Key","").replace("Digit","")||A}`}else return`${b} ${D}`}function m(b){C(i,b,!0),C(a,b.name,!0),requestAnimationFrame(()=>{o==null||o.showModal()})}function h(){if(!s(i)||!s(a).trim())return;const b=e.mappingLibrary.get(s(i).id);b&&(b.name=s(a).trim(),b.updateCSSIdentifiers(),e.mappingLibrary.update(b),P()),v()}function y(){v()}function v(){o==null||o.close(),C(i,null),C(a,"")}function x(){return s(a).trim()?`--${s(a).toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")}`:"--"}function M(){return s(a).trim()?`${s(a).toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,"")}_down`:""}function L(){return s(a).trim()?`${s(a).toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,"")}_up`:""}async function F(){s(i)&&confirm(`Are you sure you want to delete "${s(i).name}"?`)&&(await I(s(i).id),v())}async function I(b){const D=e.mappingLibrary.get(b);if(!D)return;const A=e.inputController.getInputDevice(D.inputDeviceId);if((A==null?void 0:A.type)==="hid"&&A.id!=="keyboard"&&D.inputControlId.startsWith("button-")){const T=parseInt(D.inputControlId.replace("button-",""));if(!isNaN(T)&&T>=0){const N=e.inputController.inputDeviceManager.streamDeckManager,k=D.inputDeviceId;await N.clearButtonColor(k,T)}}e.mappingLibrary.remove(b),P()}function P(){C(n,e.mappingLibrary.getAll().filter(b=>b.mode==="input"),!0)}async function j(){const b=e.inputController.inputDeviceManager.streamDeckManager;if(b.getConnectedDevices().length!==0)for(const A of s(n)){const T=e.inputController.getInputDevice(A.inputDeviceId);if((T==null?void 0:T.type)==="hid"&&T.id!=="keyboard"&&A.inputControlId.startsWith("button-")){const N=parseInt(A.inputControlId.replace("button-",""));if(!isNaN(N)&&N>=0){const k=A.inputDeviceId;await b.setButtonColor(k,N,A.color)}}}}Hn(()=>{P(),e.inputController.on("deviceadded",b=>{b.type==="hid"&&setTimeout(()=>j(),500)}),setTimeout(()=>j(),1e3)}),Ca(()=>{d()});var Y=Sh(),oe=he(Y),ue=_(oe),re=_(ue);{var le=b=>{ze(b,{onclick:d,variant:"primary",pulsating:!0,children:(D,A)=>{var T=rt("Stop Listening");S(D,T)},$$slots:{default:!0}})},ye=b=>{ze(b,{onclick:l,variant:"secondary",children:(D,A)=>{var T=rt("Start Listening");S(D,T)},$$slots:{default:!0}})};ce(re,b=>{s(t)?b(le):b(ye,!1)})}var _e=w(ue,2),de=_(_e);{var ke=b=>{var D=hh();S(b,D)},Q=b=>{var D=it(),A=he(D);Pe(A,17,()=>s(n),T=>T.id,(T,N)=>{var k=mh(),$=_(k);{var K=xe=>{var je=ph();Z(()=>Rt(je,`background-color: ${s(N).color??""}`)),S(xe,je)};ce($,xe=>{s(N).color&&xe(K)})}var X=w($,2),E=_(X),R=_(E),te=w(E,2),H=_(te),ee=w(X,2),ie=_(ee);ie.__click=()=>m(s(N));var we=_(ie);un(we,()=>Ga),Z(()=>{ne(R,s(N).name),ne(H,s(N).inputDeviceName||s(N).inputDeviceId)}),S(T,k)}),S(b,D)};ce(de,b=>{s(n).length===0?b(ke):b(Q,!1)})}var V=w(oe,2);{var G=b=>{Cr(b,{title:"Input",onclose:v,get dialogRef(){return o},set dialogRef(T){o=T},tools:T=>{ze(T,{onclick:F,variant:"secondary",children:(N,k)=>{var $=_h(),K=he($);un(K,()=>Li),S(N,$)},$$slots:{default:!0}})},buttons:T=>{var N=gh(),k=he(N);ze(k,{onclick:y,variant:"secondary",children:(K,X)=>{var E=rt("Cancel");S(K,E)},$$slots:{default:!0}});var $=w(k,2);ze($,{type:"submit",form:"edit-input-form",variant:"primary",children:(K,X)=>{var E=rt("Save");S(K,E)},$$slots:{default:!0}}),S(T,N)},children:(T,N)=>{var k=bh(),$=_(k),K=w(_($),2);K.__keydown=H=>{H.key==="Enter"&&h(),H.key==="Escape"&&y()},Qi(K,!0);var X=w(K,2),E=_(X);{var R=H=>{var ee=yh(),ie=he(ee),we=_(ie),xe=w(ie,2),je=_(xe);Z((Ve,Ee)=>{ne(we,`.${Ve??""}`),ne(je,`.${Ee??""}`)},[M,L]),S(H,ee)},te=H=>{var ee=wh(),ie=_(ee);Z(we=>ne(ie,we),[x]),S(H,ee)};ce(E,H=>{s(i).isButtonInput()?H(R):H(te,!1)})}on("submit",k,H=>{H.preventDefault(),h()}),br(K,()=>s(a),H=>C(a,H)),S(T,k)},$$slots:{tools:!0,buttons:!0,default:!0}})};ce(V,b=>{s(i)&&b(G)})}S(r,Y),wt()}Pt(["click","keydown"]);var Dh=O('<p class="svelte-17ww3d9">No inputs available. Go to the Inputs tab to detect and save inputs first.</p>'),xh=O('<p class="svelte-17ww3d9">No animations available. Go to the Animations tab to create animations first.</p>'),Eh=O('<p class="svelte-17ww3d9">No devices available. Go to the Devices tab to add devices first.</p>'),Ih=O('<div class="empty-state svelte-17ww3d9"><!> <!> <!></div>'),kh=O('<div class="empty-state svelte-17ww3d9"><p class="svelte-17ww3d9">No triggers created yet. Click Add Trigger to create one!</p></div>'),Ph=O('<div class="trigger-card svelte-17ww3d9"><div class="trigger-content svelte-17ww3d9"><span class="trigger-text svelte-17ww3d9"> </span> <!></div></div>'),Mh=O("<!> <!>",1),Lh=O("<option> </option>"),Ah=O("<option> </option>"),Th=O("<option> </option>"),Nh=O("<option> </option>"),Rh=O("<option> </option>"),Oh=O("<option> </option>"),Fh=O('<div class="dialog-input-group"><label for="trigger-animation">Animation:</label> <select id="trigger-animation"></select></div> <div class="dialog-input-group"><label for="trigger-duration">Duration (ms):</label> <div class="duration-with-loop svelte-17ww3d9"><input id="trigger-duration" type="number" min="100" step="100" class="svelte-17ww3d9"/> <div class="checkbox-field svelte-17ww3d9"><label class="svelte-17ww3d9"><input type="checkbox" class="svelte-17ww3d9"/> Loop</label></div></div></div> <div class="dialog-input-group"><label for="trigger-easing">Easing:</label> <select id="trigger-easing"></select></div>',1),Vh=O('<div class="dialog-input-group"><label>Set Channel Values:</label> <!></div>'),Bh=O('<form id="manual-trigger-form" method="dialog"><div class="trigger-columns svelte-17ww3d9"><div class="trigger-column svelte-17ww3d9"><div class="dialog-input-group"><label for="trigger-input">Input:</label> <select id="trigger-input"></select></div> <div class="dialog-input-group"><label for="trigger-type">Type:</label> <select id="trigger-type"></select></div></div> <div class="trigger-column svelte-17ww3d9"><div class="dialog-input-group"><label for="trigger-action-type">Action:</label> <select id="trigger-action-type"></select></div> <div class="dialog-input-group"><label for="trigger-device">Device:</label> <select id="trigger-device"></select></div></div> <div class="trigger-column svelte-17ww3d9"><!></div></div></form>'),jh=O("<!> <!>",1),Gh=O("<option> </option>"),$h=O("<option> </option>"),Kh=O("<option> </option>"),Uh=O('<form id="automatic-trigger-form" method="dialog"><div class="trigger-columns svelte-17ww3d9"><div class="trigger-column svelte-17ww3d9"><div class="dialog-input-group"><label for="auto-trigger-device">Device:</label> <select id="auto-trigger-device"></select></div></div> <div class="trigger-column svelte-17ww3d9"><div class="dialog-input-group"><label for="auto-trigger-animation">Animation:</label> <select id="auto-trigger-animation"></select></div> <div class="dialog-input-group"><label for="auto-trigger-duration">Duration (ms):</label> <div class="duration-with-loop svelte-17ww3d9"><input id="auto-trigger-duration" type="number" min="100" step="100" class="svelte-17ww3d9"/> <div class="checkbox-field svelte-17ww3d9"><label class="svelte-17ww3d9"><input type="checkbox" class="svelte-17ww3d9"/> Loop</label></div></div></div> <div class="dialog-input-group"><label for="auto-trigger-easing">Easing:</label> <select id="auto-trigger-easing"></select></div></div></div></form>'),Hh=O("<!> Delete",1),zh=O("<!> <!>",1),qh=O("<option> </option>"),Wh=O("<option> </option>"),Yh=O("<option> </option>"),Xh=O("<option> </option>"),Jh=O("<option> </option>"),Zh=O('<div class="dialog-input-group"><label for="edit-trigger-animation">Animation:</label> <select id="edit-trigger-animation"></select></div> <div class="dialog-input-group"><label for="edit-trigger-duration">Duration (ms):</label> <div class="duration-with-loop svelte-17ww3d9"><input id="edit-trigger-duration" type="number" min="100" step="100" class="svelte-17ww3d9"/> <div class="checkbox-field svelte-17ww3d9"><label class="svelte-17ww3d9"><input type="checkbox" class="svelte-17ww3d9"/> Loop</label></div></div></div> <div class="dialog-input-group"><label for="edit-trigger-easing">Easing:</label> <select id="edit-trigger-easing"></select></div>',1),Qh=O('<div class="dialog-input-group"><label>Set Channel Values:</label> <!></div>'),ep=O('<div class="trigger-column svelte-17ww3d9"><div class="dialog-input-group"><label for="edit-trigger-type">Type:</label> <select id="edit-trigger-type"></select></div></div> <div class="trigger-column svelte-17ww3d9"><div class="dialog-input-group"><label for="edit-trigger-action-type">Action:</label> <select id="edit-trigger-action-type"></select></div> <div class="dialog-input-group"><label for="edit-trigger-device">Device:</label> <select id="edit-trigger-device"></select></div></div> <div class="trigger-column svelte-17ww3d9"><!></div>',1),tp=O("<option> </option>"),rp=O("<option> </option>"),np=O("<option> </option>"),ip=O('<div class="trigger-column svelte-17ww3d9"><div class="dialog-input-group"><label for="edit-trigger-device">Device:</label> <select id="edit-trigger-device"></select></div></div> <div class="trigger-column svelte-17ww3d9"><div class="dialog-input-group"><label for="edit-trigger-animation">Animation:</label> <select id="edit-trigger-animation"></select></div> <div class="dialog-input-group"><label for="edit-trigger-duration">Duration (ms):</label> <div class="duration-with-loop svelte-17ww3d9"><input id="edit-trigger-duration" type="number" min="100" step="100" class="svelte-17ww3d9"/> <div class="checkbox-field svelte-17ww3d9"><label class="svelte-17ww3d9"><input type="checkbox" class="svelte-17ww3d9"/> Loop</label></div></div></div> <div class="dialog-input-group"><label for="edit-trigger-easing">Easing:</label> <select id="edit-trigger-easing"></select></div></div>',1),ap=O('<form id="edit-trigger-form" method="dialog"><div class="trigger-columns svelte-17ww3d9"><!></div></form>'),sp=O('<div class="triggers-view svelte-17ww3d9"><div class="add-trigger-section svelte-17ww3d9"><!> <!></div> <div class="triggers-list svelte-17ww3d9"><!></div></div> <!> <!> <!>',1);function op(r,e){yt(e,!0);let t=pe(e,"devices",19,()=>[]),n=z(Ae([])),i=z(Ae([])),a=z(Ae([])),o=z(null),c=z(null),l=z(null),u=z("pressed"),f=z("animation"),d=z(null),g=z(null),m=z(1e3),h=z(!1),y=z("linear"),v=z(Ae({})),x=z(null),M=z(null),L=z(null),F=z("pressed"),I=z("animation"),P=z(null),j=z(null),Y=z(1e3),oe=z(!1),ue=z("linear"),re=z(Ae({}));const le=[{value:"pressed",label:"Pressed"},{value:"not-pressed",label:"Not Pressed"}],ye=[{value:"animation",label:"Run Animation"},{value:"setValue",label:"Set values"}],_e=["linear","ease","ease-in","ease-out","ease-in-out","cubic-bezier(0.4, 0.0, 0.2, 1)","cubic-bezier(0.68, -0.55, 0.265, 1.55)"];function de(){C(n,e.mappingLibrary.getAll().filter(B=>B.mode==="input"),!0),C(i,e.animationLibrary.getAll(),!0),C(a,e.mappingLibrary.getAll().filter(B=>B.mode==="trigger"),!0)}function ke(){de()}function Q(){var B,q,ve,ae;C(l,((B=s(n)[0])==null?void 0:B.id)||null,!0),C(u,"pressed"),C(f,"animation"),C(d,((q=t()[0])==null?void 0:q.id)||null,!0),C(g,((ve=s(i)[0])==null?void 0:ve.name)||null,!0),C(m,1e3),C(h,!1),C(y,"linear"),C(v,{},!0),(ae=s(o))==null||ae.showModal()}function V(){var B,q;C(d,((B=t()[0])==null?void 0:B.id)||null,!0),C(g,((q=s(i)[0])==null?void 0:q.name)||null,!0),C(m,1e3),C(h,!1),C(y,"linear"),requestAnimationFrame(()=>{var ve;(ve=s(c))==null||ve.showModal()})}function G(){var Te;if(!s(l)||!s(d)||s(f)==="animation"&&!s(g))return;const B=e.mappingLibrary.get(s(l));if(!B)return;const q=B.name.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""),ve=s(u)==="pressed"?"down":"up",ae=`${q}-${ve}`,se=s(f)==="animation"?`${B.name}_${s(u)}_${s(g)}`:`${B.name}_${s(u)}_setValue`,J=new Bn({name:se,mode:"trigger",triggerType:s(u),actionType:s(f),inputDeviceId:B.inputDeviceId,inputControlId:B.inputControlId,animationName:s(f)==="animation"?s(g):null,targetDeviceIds:s(f)==="animation"?[s(d)]:[],duration:s(m),easing:s(y),iterations:s(h)?"infinite":1,setValueDeviceId:s(f)==="setValue"?s(d):null,channelValues:s(f)==="setValue"?{...s(v)}:{},cssClassName:ae});e.mappingLibrary.add(J),de(),(Te=s(o))==null||Te.close()}function b(){var q;if(!s(d)||!s(g))return;const B=new Bn({name:`always_${s(g)}`,mode:"trigger",triggerType:"always",inputDeviceId:null,inputControlId:null,animationName:s(g),targetDeviceIds:[s(d)],duration:s(m),easing:s(y),iterations:s(h)?"infinite":1,cssClassName:"always"});e.mappingLibrary.add(B),de(),(q=s(c))==null||q.close()}function D(B){C(M,B,!0),C(L,B.inputDeviceId+"_"+B.inputControlId),C(F,B.triggerType,!0),C(I,B.actionType||"animation",!0),B.actionType==="setValue"?(C(P,B.setValueDeviceId,!0),C(re,{...B.channelValues},!0)):(C(P,B.targetDeviceIds[0],!0),C(j,B.animationName,!0)),C(Y,B.duration,!0),C(oe,B.iterations==="infinite"),C(ue,B.easing,!0),requestAnimationFrame(()=>{var q;(q=s(x))==null||q.showModal()})}function A(){var B;(B=s(x))==null||B.close(),C(M,null)}function T(){if(s(M)){if(s(M).triggerType==="always")s(M).targetDeviceIds=[s(P)],s(M).animationName=s(j),s(M).duration=s(Y),s(M).easing=s(ue),s(M).iterations=s(oe)?"infinite":1,s(M).name=`always_${s(j)}`;else{const B=s(n).find(se=>se.inputDeviceId===s(M).inputDeviceId&&se.inputControlId===s(M).inputControlId);if(!B)return;const q=B.name.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""),ve=s(F)==="pressed"?"down":"up",ae=`${q}-${ve}`;s(M).triggerType=s(F),s(M).actionType=s(I),s(I)==="animation"?(s(M).animationName=s(j),s(M).targetDeviceIds=[s(P)],s(M).setValueDeviceId=null,s(M).channelValues={},s(M).name=`${B.name}_${s(F)}_${s(j)}`):(s(M).setValueDeviceId=s(P),s(M).channelValues={...s(re)},s(M).animationName=null,s(M).targetDeviceIds=[],s(M).name=`${B.name}_${s(F)}_setValue`),s(M).duration=s(Y),s(M).easing=s(ue),s(M).iterations=s(oe)?"infinite":1,s(M).cssClassName=ae}e.mappingLibrary.save(),de(),A()}}function N(){s(M)&&confirm("Are you sure you want to delete this trigger?")&&(e.mappingLibrary.remove(s(M).id),de(),A())}function k(B,q){const ve=s(n).find(ae=>ae.inputDeviceId===B&&ae.inputControlId===q);return(ve==null?void 0:ve.name)||`${B}_${q}`}function $(B){const q=t().find(ve=>ve.id===B);return(q==null?void 0:q.name)||B}function K(B){const q=s(i).find(ve=>ve.cssName===B);return(q==null?void 0:q.name)||B}function X(B){const q=B.actionType||"animation";if(B.triggerType==="always"){const se=$(B.targetDeviceIds[0]);return`Always â ${K(B.animationName)} â ${se}`}const ve=k(B.inputDeviceId,B.inputControlId),ae=B.triggerType==="pressed"?"Pressed":"Not Pressed";if(q==="animation"){const se=$(B.targetDeviceIds[0]),J=K(B.animationName);return`${ve} â ${ae} â ${J} â ${se}`}else{const se=$(B.setValueDeviceId),J=Object.keys(B.channelValues||{}).length;return`${ve} â ${ae} â Set ${J} channel(s) â ${se}`}}function E(B,q,ve){const ae={...B};return ve===""||ve===null||ve===void 0?delete ae[q]:ae[q]=Math.max(0,Math.min(255,parseInt(ve)||0)),ae}function R(B,q){const ve=t().find(J=>J.id===B);if(!ve)return[];const ae=Me[ve.type].channels,se=new Array(ae).fill(0);for(let J=0;J<ae;J++)q[J]!==void 0&&(se[J]=q[J]);return se}function te(B,q){C(v,E(s(v),B,q),!0)}function H(B,q){C(re,E(s(re),B,q),!0)}Hn(()=>{de(),e.mappingLibrary.on("changed",ke)}),Ca(()=>{e.mappingLibrary.off("changed",ke)});var ee=sp(),ie=he(ee),we=_(ie),xe=_(we);{let B=ge(()=>s(n).length===0||s(i).length===0||t().length===0);ze(xe,{onclick:Q,variant:"secondary",get disabled(){return s(B)},children:(q,ve)=>{var ae=rt("Add Manual Trigger");S(q,ae)},$$slots:{default:!0}})}var je=w(xe,2);{let B=ge(()=>s(i).length===0||t().length===0);ze(je,{onclick:V,variant:"secondary",get disabled(){return s(B)},children:(q,ve)=>{var ae=rt("Add Automatic Trigger");S(q,ae)},$$slots:{default:!0}})}var Ve=w(we,2),Ee=_(Ve);{var Ye=B=>{var q=Ih(),ve=_(q);{var ae=Be=>{var Ge=Dh();S(Be,Ge)};ce(ve,Be=>{s(n).length===0&&Be(ae)})}var se=w(ve,2);{var J=Be=>{var Ge=xh();S(Be,Ge)};ce(se,Be=>{s(i).length===0&&Be(J)})}var Te=w(se,2);{var Ne=Be=>{var Ge=Eh();S(Be,Ge)};ce(Te,Be=>{t().length===0&&Be(Ne)})}S(B,q)},Dt=B=>{var q=it(),ve=he(q);{var ae=J=>{var Te=kh();S(J,Te)},se=J=>{var Te=it(),Ne=he(Te);Pe(Ne,17,()=>s(a),Be=>Be.id,(Be,Ge)=>{var Oe=Ph(),Ue=_(Oe),Qe=_(Ue),et=_(Qe),vt=w(Qe,2);Ls(vt,{get icon(){return Ga},onclick:()=>D(s(Ge)),title:"Edit trigger",size:"small"}),Z(Bt=>ne(et,Bt),[()=>X(s(Ge))]),S(Be,Oe)}),S(J,Te)};ce(ve,J=>{s(a).length===0?J(ae):J(se,!1)},!0)}S(B,q)};ce(Ee,B=>{s(n).length===0||s(i).length===0||t().length===0?B(Ye):B(Dt,!1)})}var Vt=w(ie,2);Cr(Vt,{title:"Create Manual Trigger",onclose:()=>{var q;return(q=s(o))==null?void 0:q.close()},get dialogRef(){return s(o)},set dialogRef(q){C(o,q,!0)},buttons:q=>{var ve=Mh(),ae=he(ve);ze(ae,{type:"button",onclick:()=>{var J;return(J=s(o))==null?void 0:J.close()},variant:"secondary",children:(J,Te)=>{var Ne=rt("Cancel");S(J,Ne)},$$slots:{default:!0}});var se=w(ae,2);ze(se,{type:"submit",form:"manual-trigger-form",variant:"primary",children:(J,Te)=>{var Ne=rt("Create");S(J,Ne)},$$slots:{default:!0}}),S(q,ve)},children:(q,ve)=>{var ae=Bh(),se=_(ae),J=_(se),Te=_(J),Ne=w(_(Te),2);Pe(Ne,21,()=>s(n),qe,(fe,be)=>{var me=Lh(),Xe=_(me),Le={};Z(()=>{ne(Xe,s(be).name),Le!==(Le=s(be).id)&&(me.value=(me.__value=s(be).id)??"")}),S(fe,me)});var Be=w(Te,2),Ge=w(_(Be),2);Pe(Ge,21,()=>le,qe,(fe,be)=>{var me=Ah(),Xe=_(me),Le={};Z(()=>{ne(Xe,s(be).label),Le!==(Le=s(be).value)&&(me.value=(me.__value=s(be).value)??"")}),S(fe,me)});var Oe=w(J,2),Ue=_(Oe),Qe=w(_(Ue),2);Pe(Qe,21,()=>ye,qe,(fe,be)=>{var me=Th(),Xe=_(me),Le={};Z(()=>{ne(Xe,s(be).label),Le!==(Le=s(be).value)&&(me.value=(me.__value=s(be).value)??"")}),S(fe,me)});var et=w(Ue,2),vt=w(_(et),2);Pe(vt,21,t,qe,(fe,be)=>{var me=Nh(),Xe=_(me),Le={};Z(()=>{ne(Xe,s(be).name),Le!==(Le=s(be).id)&&(me.value=(me.__value=s(be).id)??"")}),S(fe,me)});var Bt=w(Oe,2),jt=_(Bt);{var pr=fe=>{var be=Fh(),me=he(be),Xe=w(_(me),2);Pe(Xe,21,()=>s(i),qe,(ot,Yt)=>{var nt=Rh(),Mr=_(nt),Xt={};Z(()=>{ne(Mr,s(Yt).name),Xt!==(Xt=s(Yt).cssName)&&(nt.value=(nt.__value=s(Yt).cssName)??"")}),S(ot,nt)});var Le=w(me,2),$e=w(_(Le),2),Fe=_($e),Se=w(Fe,2),Ke=_(Se),Ce=_(Ke),ht=w(Le,2),Ze=w(_(ht),2);Pe(Ze,21,()=>_e,qe,(ot,Yt)=>{var nt=Oh(),Mr=_(nt),Xt={};Z(()=>{ne(Mr,s(Yt)),Xt!==(Xt=s(Yt))&&(nt.value=(nt.__value=s(Yt))??"")}),S(ot,nt)}),Z(()=>{Fe.disabled=!s(g),Ce.disabled=!s(g),Ze.disabled=!s(g)}),tt(Xe,()=>s(g),ot=>C(g,ot)),br(Fe,()=>s(m),ot=>C(m,ot)),ni(Ce,()=>s(h),ot=>C(h,ot)),tt(Ze,()=>s(y),ot=>C(y,ot)),S(fe,be)},tr=fe=>{var be=it(),me=he(be);{var Xe=Le=>{const $e=ge(()=>t().find(Ce=>Ce.id===s(d)));var Fe=it(),Se=he(Fe);{var Ke=Ce=>{var ht=Vh(),Ze=w(_(ht),2);{let ot=ge(()=>R(s(d),s(v)));aa(Ze,{get controls(){return Me[s($e).type].controls},get components(){return Me[s($e).type].components},get values(){return s(ot)},onChange:te})}S(Ce,ht)};ce(Se,Ce=>{s($e)&&Ce(Ke)})}S(Le,Fe)};ce(me,Le=>{s(f)==="setValue"&&s(d)&&Le(Xe)},!0)}S(fe,be)};ce(jt,fe=>{s(f)==="animation"?fe(pr):fe(tr,!1)})}on("submit",ae,fe=>{fe.preventDefault(),G()}),tt(Ne,()=>s(l),fe=>C(l,fe)),tt(Ge,()=>s(u),fe=>C(u,fe)),tt(Qe,()=>s(f),fe=>C(f,fe)),tt(vt,()=>s(d),fe=>C(d,fe)),S(q,ae)},$$slots:{buttons:!0,default:!0}});var kr=w(Vt,2);Cr(kr,{title:"Create Automatic Trigger",onclose:()=>{var q;return(q=s(c))==null?void 0:q.close()},get dialogRef(){return s(c)},set dialogRef(q){C(c,q,!0)},buttons:q=>{var ve=jh(),ae=he(ve);ze(ae,{type:"button",onclick:()=>{var J;return(J=s(c))==null?void 0:J.close()},variant:"secondary",children:(J,Te)=>{var Ne=rt("Cancel");S(J,Ne)},$$slots:{default:!0}});var se=w(ae,2);ze(se,{type:"submit",form:"automatic-trigger-form",variant:"primary",children:(J,Te)=>{var Ne=rt("Create");S(J,Ne)},$$slots:{default:!0}}),S(q,ve)},children:(q,ve)=>{var ae=Uh(),se=_(ae),J=_(se),Te=_(J),Ne=w(_(Te),2);Pe(Ne,21,t,qe,(fe,be)=>{var me=Gh(),Xe=_(me),Le={};Z(()=>{ne(Xe,s(be).name),Le!==(Le=s(be).id)&&(me.value=(me.__value=s(be).id)??"")}),S(fe,me)});var Be=w(J,2),Ge=_(Be),Oe=w(_(Ge),2);Pe(Oe,21,()=>s(i),qe,(fe,be)=>{var me=$h(),Xe=_(me),Le={};Z(()=>{ne(Xe,s(be).name),Le!==(Le=s(be).cssName)&&(me.value=(me.__value=s(be).cssName)??"")}),S(fe,me)});var Ue=w(Ge,2),Qe=w(_(Ue),2),et=_(Qe),vt=w(et,2),Bt=_(vt),jt=_(Bt),pr=w(Ue,2),tr=w(_(pr),2);Pe(tr,21,()=>_e,qe,(fe,be)=>{var me=Kh(),Xe=_(me),Le={};Z(()=>{ne(Xe,s(be)),Le!==(Le=s(be))&&(me.value=(me.__value=s(be))??"")}),S(fe,me)}),Z(()=>{et.disabled=!s(g),jt.disabled=!s(g),tr.disabled=!s(g)}),on("submit",ae,fe=>{fe.preventDefault(),b()}),tt(Ne,()=>s(d),fe=>C(d,fe)),tt(Oe,()=>s(g),fe=>C(g,fe)),br(et,()=>s(m),fe=>C(m,fe)),ni(jt,()=>s(h),fe=>C(h,fe)),tt(tr,()=>s(y),fe=>C(y,fe)),S(q,ae)},$$slots:{buttons:!0,default:!0}});var Pr=w(kr,2);{var Wn=B=>{Cr(B,{title:"Trigger",onclose:A,get dialogRef(){return s(x)},set dialogRef(ae){C(x,ae,!0)},tools:ae=>{ze(ae,{onclick:N,variant:"secondary",children:(se,J)=>{var Te=Hh(),Ne=he(Te);un(Ne,()=>Li),S(se,Te)},$$slots:{default:!0}})},buttons:ae=>{var se=zh(),J=he(se);ze(J,{onclick:A,variant:"secondary",children:(Ne,Be)=>{var Ge=rt("Cancel");S(Ne,Ge)},$$slots:{default:!0}});var Te=w(J,2);ze(Te,{type:"submit",form:"edit-trigger-form",variant:"primary",children:(Ne,Be)=>{var Ge=rt("Save");S(Ne,Ge)},$$slots:{default:!0}}),S(ae,se)},children:(ae,se)=>{var J=ap(),Te=_(J),Ne=_(Te);{var Be=Oe=>{var Ue=ep(),Qe=he(Ue),et=_(Qe),vt=w(_(et),2);Pe(vt,21,()=>le,qe,($e,Fe)=>{var Se=qh(),Ke=_(Se),Ce={};Z(()=>{ne(Ke,s(Fe).label),Ce!==(Ce=s(Fe).value)&&(Se.value=(Se.__value=s(Fe).value)??"")}),S($e,Se)});var Bt=w(Qe,2),jt=_(Bt),pr=w(_(jt),2);Pe(pr,21,()=>ye,qe,($e,Fe)=>{var Se=Wh(),Ke=_(Se),Ce={};Z(()=>{ne(Ke,s(Fe).label),Ce!==(Ce=s(Fe).value)&&(Se.value=(Se.__value=s(Fe).value)??"")}),S($e,Se)});var tr=w(jt,2),fe=w(_(tr),2);Pe(fe,21,t,qe,($e,Fe)=>{var Se=Yh(),Ke=_(Se),Ce={};Z(()=>{ne(Ke,s(Fe).name),Ce!==(Ce=s(Fe).id)&&(Se.value=(Se.__value=s(Fe).id)??"")}),S($e,Se)});var be=w(Bt,2),me=_(be);{var Xe=$e=>{var Fe=Zh(),Se=he(Fe),Ke=w(_(Se),2);Pe(Ke,21,()=>s(i),qe,(Mt,zr)=>{var mr=Xh(),$a=_(mr),Yn={};Z(()=>{ne($a,s(zr).name),Yn!==(Yn=s(zr).cssName)&&(mr.value=(mr.__value=s(zr).cssName)??"")}),S(Mt,mr)});var Ce=w(Se,2),ht=w(_(Ce),2),Ze=_(ht),ot=w(Ze,2),Yt=_(ot),nt=_(Yt),Mr=w(Ce,2),Xt=w(_(Mr),2);Pe(Xt,21,()=>_e,qe,(Mt,zr)=>{var mr=Jh(),$a=_(mr),Yn={};Z(()=>{ne($a,s(zr)),Yn!==(Yn=s(zr))&&(mr.value=(mr.__value=s(zr))??"")}),S(Mt,mr)}),Z(()=>{Ze.disabled=!s(j),nt.disabled=!s(j),Xt.disabled=!s(j)}),tt(Ke,()=>s(j),Mt=>C(j,Mt)),br(Ze,()=>s(Y),Mt=>C(Y,Mt)),ni(nt,()=>s(oe),Mt=>C(oe,Mt)),tt(Xt,()=>s(ue),Mt=>C(ue,Mt)),S($e,Fe)},Le=$e=>{var Fe=it(),Se=he(Fe);{var Ke=Ce=>{const ht=ge(()=>t().find(nt=>nt.id===s(P)));var Ze=it(),ot=he(Ze);{var Yt=nt=>{var Mr=Qh(),Xt=w(_(Mr),2);{let Mt=ge(()=>R(s(P),s(re)));aa(Xt,{get controls(){return Me[s(ht).type].controls},get components(){return Me[s(ht).type].components},get values(){return s(Mt)},onChange:H})}S(nt,Mr)};ce(ot,nt=>{s(ht)&&nt(Yt)})}S(Ce,Ze)};ce(Se,Ce=>{s(I)==="setValue"&&s(P)&&Ce(Ke)},!0)}S($e,Fe)};ce(me,$e=>{s(I)==="animation"?$e(Xe):$e(Le,!1)})}tt(vt,()=>s(F),$e=>C(F,$e)),tt(pr,()=>s(I),$e=>C(I,$e)),tt(fe,()=>s(P),$e=>C(P,$e)),S(Oe,Ue)},Ge=Oe=>{var Ue=ip(),Qe=he(Ue),et=_(Qe),vt=w(_(et),2);Pe(vt,21,t,qe,(Se,Ke)=>{var Ce=tp(),ht=_(Ce),Ze={};Z(()=>{ne(ht,s(Ke).name),Ze!==(Ze=s(Ke).id)&&(Ce.value=(Ce.__value=s(Ke).id)??"")}),S(Se,Ce)});var Bt=w(Qe,2),jt=_(Bt),pr=w(_(jt),2);Pe(pr,21,()=>s(i),qe,(Se,Ke)=>{var Ce=rp(),ht=_(Ce),Ze={};Z(()=>{ne(ht,s(Ke).name),Ze!==(Ze=s(Ke).cssName)&&(Ce.value=(Ce.__value=s(Ke).cssName)??"")}),S(Se,Ce)});var tr=w(jt,2),fe=w(_(tr),2),be=_(fe),me=w(be,2),Xe=_(me),Le=_(Xe),$e=w(tr,2),Fe=w(_($e),2);Pe(Fe,21,()=>_e,qe,(Se,Ke)=>{var Ce=np(),ht=_(Ce),Ze={};Z(()=>{ne(ht,s(Ke)),Ze!==(Ze=s(Ke))&&(Ce.value=(Ce.__value=s(Ke))??"")}),S(Se,Ce)}),Z(()=>{be.disabled=!s(j),Le.disabled=!s(j),Fe.disabled=!s(j)}),tt(vt,()=>s(P),Se=>C(P,Se)),tt(pr,()=>s(j),Se=>C(j,Se)),br(be,()=>s(Y),Se=>C(Y,Se)),ni(Le,()=>s(oe),Se=>C(oe,Se)),tt(Fe,()=>s(ue),Se=>C(ue,Se)),S(Oe,Ue)};ce(Ne,Oe=>{s(M).triggerType!=="always"?Oe(Be):Oe(Ge,!1)})}on("submit",J,Oe=>{Oe.preventDefault(),T()}),S(ae,J)},$$slots:{tools:!0,buttons:!0,default:!0}})};ce(Pr,B=>{s(M)&&B(Wn)})}S(r,ee),wt()}var lp=O('<div class="pan-tilt-indicator svelte-kr8awf"></div>'),cp=O('<div class="device-preview-item svelte-kr8awf"><div class="device-preview svelte-kr8awf"><!></div> <code class="device-id svelte-kr8awf"> </code></div>'),up=O('<div class="reference-section svelte-kr8awf"><h4 class="svelte-kr8awf">Devices</h4> <div class="device-previews svelte-kr8awf"></div></div>'),dp=O('<div class="reference-item svelte-kr8awf"><code class="svelte-kr8awf"> </code></div>'),fp=O('<div class="reference-section svelte-kr8awf"><h4 class="svelte-kr8awf">Animations</h4> <div class="reference-list svelte-kr8awf"></div></div>'),vp=O('<div class="reference-item svelte-kr8awf"><code class="svelte-kr8awf"> </code></div> <div class="reference-item svelte-kr8awf"><code class="svelte-kr8awf"> </code></div>',1),hp=O('<div class="reference-item svelte-kr8awf"><code class="svelte-kr8awf"> </code></div>'),pp=O('<div class="reference-item svelte-kr8awf"><code class="svelte-kr8awf"> </code></div>'),mp=O('<div class="reference-section svelte-kr8awf"><h4 class="svelte-kr8awf">Inputs</h4> <div class="reference-list svelte-kr8awf"></div></div>'),_p=O('<div class="css-view svelte-kr8awf"><div class="left-column svelte-kr8awf"><div class="reference-card svelte-kr8awf"><!> <!> <!></div> <div class="animation-targets svelte-kr8awf"></div></div> <div class="right-column svelte-kr8awf"><div class="css-scroll-container svelte-kr8awf"><pre class="css-editor readonly svelte-kr8awf"> </pre> <pre class="css-editor editable svelte-kr8awf" contenteditable="true" spellcheck="false"></pre></div></div></div>');function gp(r,e){yt(e,!0);let t=pe(e,"devices",19,()=>[]),n=pe(e,"isActive",3,!1),i=z(""),a=z("");function o(){return localStorage.getItem("dmx-custom-css")||`/* Add your custom CSS here to override device defaults and apply animations */
`}function c(){C(i,e.cssGenerator.generate(t()),!0)}let l,u=Ae({}),f=Ae({}),d=Ae({}),g=ge(()=>e.animationLibrary?e.animationLibrary.getAll():[]),m=z(Ae([])),h,y,v,x;function M(N,k){switch(N){case"RGB":return[k.Red||0,k.Green||0,k.Blue||0];case"RGBA":return[k.Red||0,k.Green||0,k.Blue||0,k.Amber||0];case"RGBW":return[k.Red||0,k.Green||0,k.Blue||0,k.White||0];case"DIMMER":return[k.Intensity||0];case"SMOKE":return[k.Output||0];case"MOVING_HEAD":return[k.Pan||127,k.Tilt||127,k.Dimmer||0,k.Red||0,k.Green||0,k.Blue||0,k.White||0];case"FLAMETHROWER":return[k.Safety||0,k.Fuel||0];default:return console.warn(`Unknown device type: ${N}`),[]}}function L(){if(!e.cssSampler)return;const N=e.cssSampler.sampleAll(t());t().forEach(k=>{const $=N.get(k.id);if(!$)return;const K=M(k.type,$);if($.Red!==void 0&&$.Green!==void 0&&$.Blue!==void 0){const X=$.White!==void 0?$.White:255,E=`rgba(${$.Red}, ${$.Green}, ${$.Blue}, ${X/255})`;u[k.id]=E}else if($.Intensity!==void 0){const X=$.Intensity/255;f[k.id]=X}k.type==="MOVING_HEAD"&&$.Pan!==void 0&&$.Tilt!==void 0&&(d[k.id]={pan:$.Pan,tilt:$.Tilt}),e.dmxController&&n()&&F(k,K)}),l=requestAnimationFrame(L)}function F(N,k){if(e.dmxController)for(let $=0;$<k.length;$++){const K=N.startChannel+$;e.dmxController.setChannel(K,k[$])}}function I(N){const k=N.target.textContent;C(a,k,!0),localStorage.setItem("dmx-custom-css",k),P()}function P(){if(h){const N=s(i)+`

`+s(a);h.textContent=`@scope (.animation-targets) {
${N}
}`}}function j(){C(m,e.mappingLibrary.getAll(),!0),c(),P()}function Y(){c(),P()}Hn(()=>{const N=document.createElement("style");N.id="css-property-definitions",N.textContent=`
/* CSS Custom Property Definitions */
@property --safety {
  syntax: "none | probably";
  inherits: false;
  initial-value: none;
}

@property --fuel {
  syntax: "<percentage>";
  inherits: false;
  initial-value: 0%;
}

@property --smoke {
  syntax: "<percentage>";
  inherits: false;
  initial-value: 0%;
}

@property --pan {
  syntax: "<percentage>";
  inherits: false;
  initial-value: 0%;
}

@property --tilt {
  syntax: "<percentage>";
  inherits: false;
  initial-value: 0%;
}

@property --amber {
  syntax: "<percentage>";
  inherits: false;
  initial-value: 0%;
}
`,document.head.appendChild(N),h=document.createElement("style"),h.id="css-animation-styles",document.head.appendChild(h),y&&(v=document.createElement("div"),v.className="trigger-classes",y.appendChild(v)),e.cssSampler&&v&&(e.cssSampler.initialize(v),e.cssSampler.updateDevices(t())),e.triggerManager&&v&&e.triggerManager.setContainer(v),e.mappingLibrary.on("changed",j),e.animationLibrary.on("changed",Y),C(m,e.mappingLibrary.getAll(),!0),C(a,o(),!0),c(),x&&(x.textContent=s(a)),P(),t().forEach(k=>{u[k.id]=fn(k.type,k.defaultValues),f[k.id]=1,k.type==="MOVING_HEAD"&&(d[k.id]={pan:k.defaultValues[0]||127,tilt:k.defaultValues[1]||127})}),l||L()}),xr(()=>{e.cssSampler&&t()&&(e.cssSampler.updateDevices(t()),c(),P())}),Ca(()=>{l&&(cancelAnimationFrame(l),l=null),h&&h.parentNode&&h.parentNode.removeChild(h);const N=document.getElementById("css-property-definitions");N&&N.parentNode&&N.parentNode.removeChild(N),e.mappingLibrary.off("changed",j),e.animationLibrary.off("changed",Y)});var oe=_p(),ue=_(oe),re=_(ue),le=_(re);{var ye=N=>{var k=up(),$=w(_(k),2);Pe($,21,t,K=>K.id,(K,X)=>{var E=cp(),R=_(E),te=_(R);{var H=we=>{const xe=ge(()=>d[s(X).id]),je=ge(()=>s(xe).pan/255*100),Ve=ge(()=>(1-s(xe).tilt/255)*100);var Ee=lp();Z(()=>Rt(Ee,`left: ${s(je)??""}%; top: ${s(Ve)??""}%`)),S(we,Ee)};ce(te,we=>{s(X).type==="MOVING_HEAD"&&d[s(X).id]&&we(H)})}var ee=w(R,2),ie=_(ee);Z(we=>{Rt(R,`background-color: ${we??""}; opacity: ${(f[s(X).id]||1)??""}`),Ft(R,"title",s(X).name),ne(ie,`#${s(X).cssId??""}`)},[()=>u[s(X).id]||fn(s(X).type,s(X).defaultValues)]),S(K,E)}),S(N,k)};ce(le,N=>{t().length>0&&N(ye)})}var _e=w(le,2);{var de=N=>{var k=fp(),$=w(_(k),2);Pe($,21,()=>s(g),K=>K.name,(K,X)=>{var E=dp(),R=_(E),te=_(R);Z(()=>ne(te,s(X).cssName)),S(K,E)}),S(N,k)};ce(_e,N=>{s(g).length>0&&N(de)})}var ke=w(_e,2);{var Q=N=>{var k=mp(),$=w(_(k),2);Pe($,21,()=>s(m),K=>K.id,(K,X)=>{var E=it(),R=he(E);{var te=ee=>{var ie=it(),we=he(ie);{var xe=Ve=>{var Ee=vp(),Ye=he(Ee),Dt=_(Ye),Vt=_(Dt),kr=w(Ye,2),Pr=_(kr),Wn=_(Pr);Z((B,q)=>{ne(Vt,`.${B??""}`),ne(Wn,`.${q??""}`)},[()=>s(X).getButtonDownClass(),()=>s(X).getButtonUpClass()]),S(Ve,Ee)},je=Ve=>{var Ee=hp(),Ye=_(Ee),Dt=_(Ye);Z(Vt=>ne(Dt,Vt),[()=>s(X).getInputPropertyName()]),S(Ve,Ee)};ce(we,Ve=>{s(X).isButtonInput()?Ve(xe):Ve(je,!1)})}S(ee,ie)},H=ee=>{var ie=it(),we=he(ie);{var xe=je=>{var Ve=pp(),Ee=_(Ve),Ye=_(Ee);Z(Dt=>ne(Ye,Dt),[()=>s(X).getPropertyName()]),S(je,Ve)};ce(we,je=>{s(X).mode==="direct"&&je(xe)},!0)}S(ee,ie)};ce(R,ee=>{s(X).mode==="input"?ee(te):ee(H,!1)})}S(K,E)}),S(N,k)};ce(ke,N=>{s(m).length>0&&N(Q)})}var V=w(re,2);dn(V,N=>y=N,()=>y);var G=w(ue,2),b=_(G),D=_(b),A=_(D),T=w(D,2);T.__input=I,dn(T,N=>x=N,()=>x),Z(()=>ne(A,s(i))),S(r,oe),wt()}Pt(["input"]);var yp=O("<!> <main><!> <div><!></div> <div><!></div> <div><!></div> <div><!></div> <div><!></div> <div><!></div></main>",1);function wp(r,e){yt(e,!0);let t=z("devices"),n=z(!1),i=Ae(new Ju),a=z(null),o=z(Ae([])),c=Ae(new ed),l=Ae(new wl),u=Ae(new bl),f=Ae(new Sl),d=Ae(new rd),g=Ae(new td(c,l)),m=Ae(new Hf(l,f,u));xr(()=>{m.initialize()}),xr(()=>{u.setSetValueCallback((T,N)=>{const k=s(o).find($=>$.id===T);if(!(!k||!i)){for(const[$,K]of Object.entries(N)){const X=parseInt($);X>=0&&X<k.defaultValues.length&&(k.defaultValues[X]=K,i.setChannel(k.startChannel+X,K))}C(o,[...s(o)],!0)}})});async function h(){try{await i.connect(),C(n,!0)}catch(T){alert("Failed to connect: "+T.message)}}function y(){i.disconnect(),C(n,!1)}function v(){var T;i&&i.clearUniverse(),(T=s(a))!=null&&T.clearAllDeviceValues&&s(a).clearAllDeviceValues()}var x=yp(),M=he(x);uv(M,{onconnect:h,ondisconnect:y,get connected(){return s(n)},get inputController(){return m}});var L=w(M,2),F=_(L);yv(F,{onClearUniverse:v,get view(){return s(t)},set view(T){C(t,T,!0)}});var I=w(F,2);let P;var j=_(I);dn(Jv(j,{get dmxController(){return i},get devices(){return s(o)},set devices(T){C(o,T,!0)}}),T=>C(a,T,!0),()=>s(a));var Y=w(I,2);let oe;var ue=_(Y);Sv(ue,{get dmxController(){return i}});var re=w(Y,2);let le;var ye=_(re);vh(ye,{get animationLibrary(){return c},get cssGenerator(){return g},get devices(){return s(o)}});var _e=w(re,2);let de;var ke=_(_e);Ch(ke,{get inputController(){return m},get mappingLibrary(){return l}});var Q=w(_e,2);let V;var G=_(Q);op(G,{get mappingLibrary(){return l},get animationLibrary(){return c},get devices(){return s(o)}});var b=w(Q,2);let D;var A=_(b);{let T=ge(()=>s(t)==="css");gp(A,{get dmxController(){return i},get devices(){return s(o)},get animationLibrary(){return c},get mappingLibrary(){return l},get cssGenerator(){return g},get cssSampler(){return d},get triggerManager(){return u},get customPropertyManager(){return f},get isActive(){return s(T)}})}Z(()=>{P=St(I,1,"view-container svelte-1n46o8q",null,P,{hidden:s(t)!=="devices"}),oe=St(Y,1,"view-container svelte-1n46o8q",null,oe,{hidden:s(t)!=="universe"}),le=St(re,1,"view-container svelte-1n46o8q",null,le,{hidden:s(t)!=="animations"}),de=St(_e,1,"view-container svelte-1n46o8q",null,de,{hidden:s(t)!=="inputs"}),V=St(Q,1,"view-container svelte-1n46o8q",null,V,{hidden:s(t)!=="triggers"}),D=St(b,1,"view-container svelte-1n46o8q",null,D,{hidden:s(t)!=="css"})}),S(r,x),wt()}Cu(wp,{target:document.getElementById("app")});
