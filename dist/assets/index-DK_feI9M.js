var Vl=Object.defineProperty;var cs=r=>{throw TypeError(r)};var jl=(r,e,t)=>e in r?Vl(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var Re=(r,e,t)=>jl(r,typeof e!="symbol"?e+"":e,t),ga=(r,e,t)=>e.has(r)||cs("Cannot "+t);var p=(r,e,t)=>(ga(r,e,"read from private field"),t?t.call(r):e.get(r)),H=(r,e,t)=>e.has(r)?cs("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),G=(r,e,t,n)=>(ga(r,e,"write to private field"),n?n.call(r,t):e.set(r,t),t),Me=(r,e,t)=>(ga(r,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();const qs=!1;var Ka=Array.isArray,Gl=Array.prototype.indexOf,Ua=Array.from,$l=Object.defineProperty,Qr=Object.getOwnPropertyDescriptor,Ws=Object.getOwnPropertyDescriptors,Kl=Object.prototype,Ul=Array.prototype,Ha=Object.getPrototypeOf,us=Object.isExtensible;function Hl(r){return r()}function Ma(r){for(var e=0;e<r.length;e++)r[e]()}function Ys(){var r,e,t=new Promise((n,i)=>{r=n,e=i});return{promise:t,resolve:r,reject:e}}function Xs(r,e){if(Array.isArray(r))return r;if(!(Symbol.iterator in r))return Array.from(r);const t=[];for(const n of r)if(t.push(n),t.length===e)break;return t}const et=2,Ui=4,Hi=8,sr=16,or=32,$r=64,zi=128,He=1024,ht=2048,qt=4096,yt=8192,er=16384,za=32768,Br=65536,ds=1<<17,Js=1<<18,bn=1<<19,Zs=1<<20,It=256,xi=512,ki=32768,Pa=1<<21,qa=1<<22,pr=1<<23,tr=Symbol("$state"),zl=Symbol("legacy props"),ql=Symbol(""),Zr=new class extends Error{constructor(){super(...arguments);Re(this,"name","StaleReactionError");Re(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function Qs(r){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Wl(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Yl(r){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Xl(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Jl(r){throw new Error("https://svelte.dev/e/effect_orphan")}function Zl(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Ql(r){throw new Error("https://svelte.dev/e/props_invalid_value")}function ec(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function tc(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function rc(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function nc(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const qi=1,Wi=2,eo=4,ic=8,ac=16,sc=1,oc=2,to=4,lc=8,cc=16,uc=1,dc=2,Ke=Symbol(),fc="http://www.w3.org/1999/xhtml",vc="@attach";function hc(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function pc(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}let _c=!1;function ro(r){return r===this.v}function gc(r,e){return r!=r?e==e:r!==e||r!==null&&typeof r=="object"||typeof r=="function"}function no(r){return!gc(r,this.v)}let Sn=!1,mc=!1;function yc(){Sn=!0}let Le=null;function hn(r){Le=r}function tt(r,e=!1,t){Le={p:Le,i:!1,c:null,e:null,s:r,x:null,l:Sn&&!e?{s:null,u:null,$:[]}:null}}function rt(r){var e=Le,t=e.e;if(t!==null){e.e=null;for(var n of t)Eo(n)}return r!==void 0&&(e.x=r),e.i=!0,Le=e.p,r??{}}function ei(){return!Sn||Le!==null&&Le.l===null}let Cr=[];function io(){var r=Cr;Cr=[],Ma(r)}function nr(r){if(Cr.length===0&&!On){var e=Cr;queueMicrotask(()=>{e===Cr&&io()})}Cr.push(r)}function wc(){for(;Cr.length>0;)io()}function ao(r){var e=de;if(e===null)return fe.f|=pr,r;if(e.f&za)pn(r,e);else{if(!(e.f&zi))throw r;e.b.error(r)}}function pn(r,e){for(;e!==null;){if(e.f&zi)try{e.b.error(r);return}catch(t){r=t}e=e.parent}throw r}const ui=new Set;let be=null,Tn=null,Ue=null,Kt=[],Yi=null,La=!1,On=!1;var rn,nn,Ir,xr,Gn,an,sn,Qe,Aa,Er,so,oo;const Fi=class Fi{constructor(){H(this,Qe);Re(this,"committed",!1);Re(this,"current",new Map);Re(this,"previous",new Map);H(this,rn,new Set);H(this,nn,new Set);H(this,Ir,0);H(this,xr,0);H(this,Gn,null);H(this,an,[]);H(this,sn,[]);Re(this,"skipped_effects",new Set);Re(this,"is_fork",!1)}process(e){var n;Kt=[],Tn=null,this.apply();var t={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const i of e)Me(this,Qe,Aa).call(this,i,t);this.is_fork||Me(this,Qe,so).call(this),p(this,xr)>0||this.is_fork?(Me(this,Qe,Er).call(this,t.effects),Me(this,Qe,Er).call(this,t.render_effects),Me(this,Qe,Er).call(this,t.block_effects)):(Tn=this,be=null,fs(t.render_effects),fs(t.effects),Tn=null,(n=p(this,Gn))==null||n.resolve()),Ue=null}capture(e,t){this.previous.has(e)||this.previous.set(e,t),e.f&pr||(this.current.set(e,e.v),Ue==null||Ue.set(e,e.v))}activate(){be=this,this.apply()}deactivate(){be=null,Ue=null}flush(){if(this.activate(),Kt.length>0){if(lo(),be!==null&&be!==this)return}else p(this,Ir)===0&&this.process([]);this.deactivate()}discard(){for(const e of p(this,nn))e(this);p(this,nn).clear()}increment(e){G(this,Ir,p(this,Ir)+1),e&&G(this,xr,p(this,xr)+1)}decrement(e){G(this,Ir,p(this,Ir)-1),e&&G(this,xr,p(this,xr)-1),this.revive()}revive(){for(const e of p(this,an))ze(e,ht),Vr(e);for(const e of p(this,sn))ze(e,qt),Vr(e);G(this,an,[]),G(this,sn,[]),this.flush()}oncommit(e){p(this,rn).add(e)}ondiscard(e){p(this,nn).add(e)}settled(){return(p(this,Gn)??G(this,Gn,Ys())).promise}static ensure(){if(be===null){const e=be=new Fi;ui.add(be),On||Fi.enqueue(()=>{be===e&&e.flush()})}return be}static enqueue(e){nr(e)}apply(){}};rn=new WeakMap,nn=new WeakMap,Ir=new WeakMap,xr=new WeakMap,Gn=new WeakMap,an=new WeakMap,sn=new WeakMap,Qe=new WeakSet,Aa=function(e,t){var f;e.f^=He;for(var n=e.first;n!==null;){var i=n.f,a=(i&(or|$r))!==0,s=a&&(i&He)!==0,l=s||(i&yt)!==0||this.skipped_effects.has(n);if(n.f&zi&&((f=n.b)!=null&&f.is_pending())&&(t={parent:t,effect:n,effects:[],render_effects:[],block_effects:[]}),!l&&n.fn!==null){a?n.f^=He:i&Ui?t.effects.push(n):En(n)&&(n.f&sr&&t.block_effects.push(n),gn(n));var c=n.first;if(c!==null){n=c;continue}}var u=n.parent;for(n=n.next;n===null&&u!==null;)u===t.effect&&(Me(this,Qe,Er).call(this,t.effects),Me(this,Qe,Er).call(this,t.render_effects),Me(this,Qe,Er).call(this,t.block_effects),t=t.parent),n=u.next,u=u.parent}},Er=function(e){for(const t of e)(t.f&ht?p(this,an):p(this,sn)).push(t),ze(t,He)},so=function(){if(p(this,xr)===0){for(const e of p(this,rn))e();p(this,rn).clear()}p(this,Ir)===0&&Me(this,Qe,oo).call(this)},oo=function(){var i;if(ui.size>1){this.previous.clear();var e=Ue,t=!0,n={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const a of ui){if(a===this){t=!1;continue}const s=[];for(const[c,u]of this.current){if(a.current.has(c))if(t&&u!==a.current.get(c))a.current.set(c,u);else continue;s.push(c)}if(s.length===0)continue;const l=[...a.current.keys()].filter(c=>!this.current.has(c));if(l.length>0){const c=new Set,u=new Map;for(const f of s)co(f,l,c,u);if(Kt.length>0){be=a,a.apply();for(const f of Kt)Me(i=a,Qe,Aa).call(i,f,n);Kt=[],a.deactivate()}}}be=null,Ue=e}this.committed=!0,ui.delete(this)};let Qt=Fi;function bc(r){var e=On;On=!0;try{for(var t;;){if(wc(),Kt.length===0&&(be==null||be.flush(),Kt.length===0))return Yi=null,t;lo()}}finally{On=e}}function lo(){var r=tn;La=!0;try{var e=0;for(_s(!0);Kt.length>0;){var t=Qt.ensure();if(e++>1e3){var n,i;Sc()}t.process(Kt),_r.clear()}}finally{La=!1,_s(r),Yi=null}}function Sc(){try{Zl()}catch(r){pn(r,Yi)}}let Lt=null;function fs(r){var e=r.length;if(e!==0){for(var t=0;t<e;){var n=r[t++];if(!(n.f&(er|yt))&&En(n)&&(Lt=new Set,gn(n),n.deps===null&&n.first===null&&n.nodes_start===null&&(n.teardown===null&&n.ac===null?ko(n):n.fn=null),(Lt==null?void 0:Lt.size)>0)){_r.clear();for(const i of Lt){if(i.f&(er|yt))continue;const a=[i];let s=i.parent;for(;s!==null;)Lt.has(s)&&(Lt.delete(s),a.push(s)),s=s.parent;for(let l=a.length-1;l>=0;l--){const c=a[l];c.f&(er|yt)||gn(c)}}Lt.clear()}}Lt=null}}function co(r,e,t,n){if(!t.has(r)&&(t.add(r),r.reactions!==null))for(const i of r.reactions){const a=i.f;a&et?co(i,e,t,n):a&(qa|sr)&&!(a&ht)&&uo(i,e,n)&&(ze(i,ht),Vr(i))}}function uo(r,e,t){const n=t.get(r);if(n!==void 0)return n;if(r.deps!==null)for(const i of r.deps){if(e.includes(i))return!0;if(i.f&et&&uo(i,e,t))return t.set(i,!0),!0}return t.set(r,!1),!1}function Vr(r){for(var e=Yi=r;e.parent!==null;){e=e.parent;var t=e.f;if(La&&e===de&&t&sr&&!(t&Js))return;if(t&($r|or)){if(!(t&He))return;e.f^=He}}Kt.push(e)}function Dc(r){let e=0,t=mr(0),n;return()=>{Fc()&&(o(t),Kr(()=>(e===0&&(n=Yt(()=>r(()=>Nn(t)))),e+=1,()=>{nr(()=>{e-=1,e===0&&(n==null||n(),n=void 0,Nn(t))})})))}}var Ec=Br|bn|zi;function Cc(r,e,t){new Ic(r,e,t)}var Dt,Et,$a,Bt,kr,Vt,Ct,dt,jt,Xt,cr,Mr,ur,Pr,dr,Bi,$e,xc,kc,Ra,Ei,Ci,Ta;class Ic{constructor(e,t,n){H(this,$e);Re(this,"parent");H(this,Dt,!1);H(this,Et);H(this,$a,null);H(this,Bt);H(this,kr);H(this,Vt);H(this,Ct,null);H(this,dt,null);H(this,jt,null);H(this,Xt,null);H(this,cr,null);H(this,Mr,0);H(this,ur,0);H(this,Pr,!1);H(this,dr,null);H(this,Bi,Dc(()=>(G(this,dr,mr(p(this,Mr))),()=>{G(this,dr,null)})));G(this,Et,e),G(this,Bt,t),G(this,kr,n),this.parent=de.b,G(this,Dt,!!p(this,Bt).pending),G(this,Vt,Dn(()=>{de.b=this;{var i=Me(this,$e,Ra).call(this);try{G(this,Ct,gt(()=>n(i)))}catch(a){this.error(a)}p(this,ur)>0?Me(this,$e,Ci).call(this):G(this,Dt,!1)}return()=>{var a;(a=p(this,cr))==null||a.remove()}},Ec))}is_pending(){return p(this,Dt)||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!p(this,Bt).pending}update_pending_count(e){Me(this,$e,Ta).call(this,e),G(this,Mr,p(this,Mr)+e),p(this,dr)&&_n(p(this,dr),p(this,Mr))}get_effect_pending(){return p(this,Bi).call(this),o(p(this,dr))}error(e){var t=p(this,Bt).onerror;let n=p(this,Bt).failed;if(p(this,Pr)||!t&&!n)throw e;p(this,Ct)&&(Ge(p(this,Ct)),G(this,Ct,null)),p(this,dt)&&(Ge(p(this,dt)),G(this,dt,null)),p(this,jt)&&(Ge(p(this,jt)),G(this,jt,null));var i=!1,a=!1;const s=()=>{if(i){pc();return}i=!0,a&&nc(),Qt.ensure(),G(this,Mr,0),p(this,jt)!==null&&en(p(this,jt),()=>{G(this,jt,null)}),G(this,Dt,this.has_pending_snippet()),G(this,Ct,Me(this,$e,Ei).call(this,()=>(G(this,Pr,!1),gt(()=>p(this,kr).call(this,p(this,Et)))))),p(this,ur)>0?Me(this,$e,Ci).call(this):G(this,Dt,!1)};var l=fe;try{ft(null),a=!0,t==null||t(e,s),a=!1}catch(c){pn(c,p(this,Vt)&&p(this,Vt).parent)}finally{ft(l)}n&&nr(()=>{G(this,jt,Me(this,$e,Ei).call(this,()=>{Qt.ensure(),G(this,Pr,!0);try{return gt(()=>{n(p(this,Et),()=>e,()=>s)})}catch(c){return pn(c,p(this,Vt).parent),null}finally{G(this,Pr,!1)}}))})}}Dt=new WeakMap,Et=new WeakMap,$a=new WeakMap,Bt=new WeakMap,kr=new WeakMap,Vt=new WeakMap,Ct=new WeakMap,dt=new WeakMap,jt=new WeakMap,Xt=new WeakMap,cr=new WeakMap,Mr=new WeakMap,ur=new WeakMap,Pr=new WeakMap,dr=new WeakMap,Bi=new WeakMap,$e=new WeakSet,xc=function(){try{G(this,Ct,gt(()=>p(this,kr).call(this,p(this,Et))))}catch(e){this.error(e)}G(this,Dt,!1)},kc=function(){const e=p(this,Bt).pending;e&&(G(this,dt,gt(()=>e(p(this,Et)))),Qt.enqueue(()=>{var t=Me(this,$e,Ra).call(this);G(this,Ct,Me(this,$e,Ei).call(this,()=>(Qt.ensure(),gt(()=>p(this,kr).call(this,t))))),p(this,ur)>0?Me(this,$e,Ci).call(this):(en(p(this,dt),()=>{G(this,dt,null)}),G(this,Dt,!1))}))},Ra=function(){var e=p(this,Et);return p(this,Dt)&&(G(this,cr,yr()),p(this,Et).before(p(this,cr)),e=p(this,cr)),e},Ei=function(e){var t=de,n=fe,i=Le;xt(p(this,Vt)),ft(p(this,Vt)),hn(p(this,Vt).ctx);try{return e()}catch(a){return ao(a),null}finally{xt(t),ft(n),hn(i)}},Ci=function(){const e=p(this,Bt).pending;p(this,Ct)!==null&&(G(this,Xt,document.createDocumentFragment()),p(this,Xt).append(p(this,cr)),Lo(p(this,Ct),p(this,Xt))),p(this,dt)===null&&G(this,dt,gt(()=>e(p(this,Et))))},Ta=function(e){var t;if(!this.has_pending_snippet()){this.parent&&Me(t=this.parent,$e,Ta).call(t,e);return}G(this,ur,p(this,ur)+e),p(this,ur)===0&&(G(this,Dt,!1),p(this,dt)&&en(p(this,dt),()=>{G(this,dt,null)}),p(this,Xt)&&(p(this,Et).before(p(this,Xt)),G(this,Xt,null)))};function fo(r,e,t,n){const i=ei()?ti:Wa;if(t.length===0&&r.length===0){n(e.map(i));return}var a=be,s=de,l=Mc();function c(){Promise.all(t.map(u=>Pc(u))).then(u=>{l();try{n([...e.map(i),...u])}catch(f){s.f&er||pn(f,s)}a==null||a.deactivate(),Mi()}).catch(u=>{pn(u,s)})}r.length>0?Promise.all(r).then(()=>{l();try{return c()}finally{a==null||a.deactivate(),Mi()}}):c()}function Mc(){var r=de,e=fe,t=Le,n=be;return function(a=!0){xt(r),ft(e),hn(t),a&&(n==null||n.activate())}}function Mi(){xt(null),ft(null),hn(null)}function ti(r){var e=et|ht,t=fe!==null&&fe.f&et?fe:null;return de===null||t!==null&&t.f&It?e|=It:de.f|=bn,{ctx:Le,deps:null,effects:null,equals:ro,f:e,fn:r,reactions:null,rv:0,v:Ke,wv:0,parent:t??de,ac:null}}function Pc(r,e){let t=de;t===null&&Wl();var n=t.b,i=void 0,a=mr(Ke),s=!fe,l=new Map;return $c(()=>{var m;var c=Ys();i=c.promise;try{Promise.resolve(r()).then(c.resolve,c.reject).then(()=>{u===be&&u.committed&&u.deactivate(),Mi()})}catch(_){c.reject(_),Mi()}var u=be;if(s){var f=!n.is_pending();n.update_pending_count(1),u.increment(f),(m=l.get(u))==null||m.reject(Zr),l.delete(u),l.set(u,c)}const d=(_,h=void 0)=>{if(u.activate(),h)h!==Zr&&(a.f|=pr,_n(a,h));else{a.f&pr&&(a.f^=pr),_n(a,_);for(const[g,v]of l){if(l.delete(g),g===u)break;v.reject(Zr)}}s&&(n.update_pending_count(-1),u.decrement(f))};c.promise.then(d,_=>d(null,_||"unknown"))}),Zi(()=>{for(const c of l.values())c.reject(Zr)}),new Promise(c=>{function u(f){function d(){f===i?c(a):u(i)}f.then(d,d)}u(i)})}function De(r){const e=ti(r);return Ao(e),e}function Wa(r){const e=ti(r);return e.equals=no,e}function vo(r){var e=r.effects;if(e!==null){r.effects=null;for(var t=0;t<e.length;t+=1)Ge(e[t])}}function Lc(r){for(var e=r.parent;e!==null;){if(!(e.f&et))return e;e=e.parent}return null}function Ya(r){var e,t=de;xt(Lc(r));try{r.f&=~ki,vo(r),e=No(r)}finally{xt(t)}return e}function ho(r){var e=Ya(r);if(r.equals(e)||(r.v=e,r.wv=To()),!Ur)if(Ue!==null)Ue.set(r,r.v);else{var t=(hr||r.f&It)&&r.deps!==null?qt:He;ze(r,t)}}let Oa=new Set;const _r=new Map;let po=!1;function mr(r,e){var t={f:0,v:r,reactions:null,equals:ro,rv:0,wv:0};return t}function $(r,e){const t=mr(r);return Ao(t),t}function _o(r,e=!1,t=!0){var i;const n=mr(r);return e||(n.equals=no),Sn&&t&&Le!==null&&Le.l!==null&&((i=Le.l).s??(i.s=[])).push(n),n}function x(r,e,t=!1){fe!==null&&(!Tt||fe.f&ds)&&ei()&&fe.f&(et|sr|qa|ds)&&!(ot!=null&&ot.includes(r))&&rc();let n=t?Se(e):e;return _n(r,n)}function _n(r,e){if(!r.equals(e)){var t=r.v;Ur?_r.set(r,e):_r.set(r,t),r.v=e;var n=Qt.ensure();n.capture(r,t),r.f&et&&(r.f&ht&&Ya(r),ze(r,r.f&It?qt:He)),r.wv=To(),go(r,ht),ei()&&de!==null&&de.f&He&&!(de.f&(or|$r))&&(St===null?Uc([r]):St.push(r)),!n.is_fork&&Oa.size>0&&!po&&Ac()}return e}function Ac(){po=!1;const r=Array.from(Oa);for(const e of r)e.f&He&&ze(e,qt),En(e)&&gn(e);Oa.clear()}function Pi(r,e=1){var t=o(r),n=e===1?t++:t--;return x(r,t),n}function Nn(r){x(r,r.v+1)}function go(r,e){var t=r.reactions;if(t!==null)for(var n=ei(),i=t.length,a=0;a<i;a++){var s=t[a],l=s.f;if(!(!n&&s===de)){var c=(l&ht)===0;c&&ze(s,e),l&et?l&ki||(s.f|=ki,go(s,qt)):c&&(l&sr&&Lt!==null&&Lt.add(s),Vr(s))}}}function Se(r){if(typeof r!="object"||r===null||tr in r)return r;const e=Ha(r);if(e!==Kl&&e!==Ul)return r;var t=new Map,n=Ka(r),i=$(0),a=Nr,s=l=>{if(Nr===a)return l();var c=fe,u=Nr;ft(null),ms(a);var f=l();return ft(c),ms(u),f};return n&&t.set("length",$(r.length)),new Proxy(r,{defineProperty(l,c,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&ec();var f=t.get(c);return f===void 0?f=s(()=>{var d=$(u.value);return t.set(c,d),d}):x(f,u.value,!0),!0},deleteProperty(l,c){var u=t.get(c);if(u===void 0){if(c in l){const f=s(()=>$(Ke));t.set(c,f),Nn(i)}}else x(u,Ke),Nn(i);return!0},get(l,c,u){var _;if(c===tr)return r;var f=t.get(c),d=c in l;if(f===void 0&&(!d||(_=Qr(l,c))!=null&&_.writable)&&(f=s(()=>{var h=Se(d?l[c]:Ke),g=$(h);return g}),t.set(c,f)),f!==void 0){var m=o(f);return m===Ke?void 0:m}return Reflect.get(l,c,u)},getOwnPropertyDescriptor(l,c){var u=Reflect.getOwnPropertyDescriptor(l,c);if(u&&"value"in u){var f=t.get(c);f&&(u.value=o(f))}else if(u===void 0){var d=t.get(c),m=d==null?void 0:d.v;if(d!==void 0&&m!==Ke)return{enumerable:!0,configurable:!0,value:m,writable:!0}}return u},has(l,c){var m;if(c===tr)return!0;var u=t.get(c),f=u!==void 0&&u.v!==Ke||Reflect.has(l,c);if(u!==void 0||de!==null&&(!f||(m=Qr(l,c))!=null&&m.writable)){u===void 0&&(u=s(()=>{var _=f?Se(l[c]):Ke,h=$(_);return h}),t.set(c,u));var d=o(u);if(d===Ke)return!1}return f},set(l,c,u,f){var I;var d=t.get(c),m=c in l;if(n&&c==="length")for(var _=u;_<d.v;_+=1){var h=t.get(_+"");h!==void 0?x(h,Ke):_ in l&&(h=s(()=>$(Ke)),t.set(_+"",h))}if(d===void 0)(!m||(I=Qr(l,c))!=null&&I.writable)&&(d=s(()=>$(void 0)),x(d,Se(u)),t.set(c,d));else{m=d.v!==Ke;var g=s(()=>Se(u));x(d,g)}var v=Reflect.getOwnPropertyDescriptor(l,c);if(v!=null&&v.set&&v.set.call(f,u),!m){if(n&&typeof c=="string"){var S=t.get("length"),N=Number(c);Number.isInteger(N)&&N>=S.v&&x(S,N+1)}Nn(i)}return!0},ownKeys(l){o(i);var c=Reflect.ownKeys(l).filter(d=>{var m=t.get(d);return m===void 0||m.v!==Ke});for(var[u,f]of t)f.v!==Ke&&!(u in l)&&c.push(u);return c},setPrototypeOf(){tc()}})}function vs(r){try{if(r!==null&&typeof r=="object"&&tr in r)return r[tr]}catch{}return r}function mo(r,e){return Object.is(vs(r),vs(e))}var hs,yo,wo,bo;function Rc(){if(hs===void 0){hs=window,yo=/Firefox/.test(navigator.userAgent);var r=Element.prototype,e=Node.prototype,t=Text.prototype;wo=Qr(e,"firstChild").get,bo=Qr(e,"nextSibling").get,us(r)&&(r.__click=void 0,r.__className=void 0,r.__attributes=null,r.__style=void 0,r.__e=void 0),us(t)&&(t.__t=void 0)}}function yr(r=""){return document.createTextNode(r)}function Ut(r){return wo.call(r)}function ri(r){return bo.call(r)}function y(r,e){return Ut(r)}function Ce(r,e=!1){{var t=Ut(r);return t instanceof Comment&&t.data===""?ri(t):t}}function C(r,e=1,t=!1){let n=r;for(;e--;)n=ri(n);return n}function Tc(r){r.textContent=""}function So(){return!1}function Li(r,e){if(e){const t=document.body;r.autofocus=!0,nr(()=>{document.activeElement===t&&r.focus()})}}let ps=!1;function Oc(){ps||(ps=!0,document.addEventListener("reset",r=>{Promise.resolve().then(()=>{var e;if(!r.defaultPrevented)for(const t of r.target.elements)(e=t.__on_r)==null||e.call(t)})},{capture:!0}))}function Xi(r){var e=fe,t=de;ft(null),xt(null);try{return r()}finally{ft(e),xt(t)}}function Ji(r,e,t,n=t){r.addEventListener(e,()=>Xi(t));const i=r.__on_r;i?r.__on_r=()=>{i(),n(!0)}:r.__on_r=()=>n(!0),Oc()}function Do(r){de===null&&fe===null&&Jl(),fe!==null&&fe.f&It&&de===null&&Xl(),Ur&&Yl()}function Nc(r,e){var t=e.last;t===null?e.last=e.first=r:(t.next=r,r.prev=t,e.last=r)}function Wt(r,e,t,n=!0){var i=de;i!==null&&i.f&yt&&(r|=yt);var a={ctx:Le,deps:null,nodes_start:null,nodes_end:null,f:r|ht,first:null,fn:e,last:null,next:null,parent:i,b:i&&i.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(t)try{gn(a),a.f|=za}catch(c){throw Ge(a),c}else e!==null&&Vr(a);if(n){var s=a;if(t&&s.deps===null&&s.teardown===null&&s.nodes_start===null&&s.first===s.last&&!(s.f&bn)&&(s=s.first,r&sr&&r&Br&&s!==null&&(s.f|=Br)),s!==null&&(s.parent=i,i!==null&&Nc(s,i),fe!==null&&fe.f&et&&!(r&$r))){var l=fe;(l.effects??(l.effects=[])).push(s)}}return a}function Fc(){return fe!==null&&!Tt}function Zi(r){const e=Wt(Hi,null,!1);return ze(e,He),e.teardown=r,e}function ir(r){Do();var e=de.f,t=!fe&&(e&or)!==0&&(e&za)===0;if(t){var n=Le;(n.e??(n.e=[])).push(r)}else return Eo(r)}function Eo(r){return Wt(Ui|Zs,r,!1)}function Bc(r){return Do(),Wt(Hi|Zs,r,!0)}function Vc(r){Qt.ensure();const e=Wt($r|bn,r,!0);return(t={})=>new Promise(n=>{t.outro?en(e,()=>{Ge(e),n(void 0)}):(Ge(e),n(void 0))})}function ni(r){return Wt(Ui,r,!1)}function jc(r,e){var t=Le,n={effect:null,ran:!1,deps:r};t.l.$.push(n),n.effect=Kr(()=>{r(),!n.ran&&(n.ran=!0,Yt(e))})}function Gc(){var r=Le;Kr(()=>{for(var e of r.l.$){e.deps();var t=e.effect;t.f&He&&ze(t,qt),En(t)&&gn(t),e.ran=!1}})}function $c(r){return Wt(qa|bn,r,!0)}function Kr(r,e=0){return Wt(Hi|e,r,!0)}function re(r,e=[],t=[],n=[],i=!1){fo(n,e,t,a=>{Wt(i?Ui:Hi,()=>r(...a.map(o)),!0)})}function Dn(r,e=0){var t=Wt(sr|e,r,!0);return t}function gt(r,e=!0){return Wt(or|bn,r,!0,e)}function Co(r){var e=r.teardown;if(e!==null){const t=Ur,n=fe;gs(!0),ft(null);try{e.call(null)}finally{gs(t),ft(n)}}}function Io(r,e=!1){var t=r.first;for(r.first=r.last=null;t!==null;){const i=t.ac;i!==null&&Xi(()=>{i.abort(Zr)});var n=t.next;t.f&$r?t.parent=null:Ge(t,e),t=n}}function Kc(r){for(var e=r.first;e!==null;){var t=e.next;e.f&or||Ge(e),e=t}}function Ge(r,e=!0){var t=!1;(e||r.f&Js)&&r.nodes_start!==null&&r.nodes_end!==null&&(xo(r.nodes_start,r.nodes_end),t=!0),Io(r,e&&!t),Ai(r,0),ze(r,er);var n=r.transitions;if(n!==null)for(const a of n)a.stop();Co(r);var i=r.parent;i!==null&&i.first!==null&&ko(r),r.next=r.prev=r.teardown=r.ctx=r.deps=r.fn=r.nodes_start=r.nodes_end=r.ac=null}function xo(r,e){for(;r!==null;){var t=r===e?null:ri(r);r.remove(),r=t}}function ko(r){var e=r.parent,t=r.prev,n=r.next;t!==null&&(t.next=n),n!==null&&(n.prev=t),e!==null&&(e.first===r&&(e.first=n),e.last===r&&(e.last=t))}function en(r,e,t=!0){var n=[];Xa(r,n,!0),Mo(n,()=>{t&&Ge(r),e&&e()})}function Mo(r,e){var t=r.length;if(t>0){var n=()=>--t||e();for(var i of r)i.out(n)}else e()}function Xa(r,e,t){if(!(r.f&yt)){if(r.f^=yt,r.transitions!==null)for(const s of r.transitions)(s.is_global||t)&&e.push(s);for(var n=r.first;n!==null;){var i=n.next,a=(n.f&Br)!==0||(n.f&or)!==0&&(r.f&sr)!==0;Xa(n,e,a?t:!1),n=i}}}function Ja(r){Po(r,!0)}function Po(r,e){if(r.f&yt){r.f^=yt,r.f&He||(ze(r,ht),Vr(r));for(var t=r.first;t!==null;){var n=t.next,i=(t.f&Br)!==0||(t.f&or)!==0;Po(t,i?e:!1),t=n}if(r.transitions!==null)for(const a of r.transitions)(a.is_global||e)&&a.in()}}function Lo(r,e){for(var t=r.nodes_start,n=r.nodes_end;t!==null;){var i=t===n?null:ri(t);e.append(t),t=i}}let tn=!1;function _s(r){tn=r}let Ur=!1;function gs(r){Ur=r}let fe=null,Tt=!1;function ft(r){fe=r}let de=null;function xt(r){de=r}let ot=null;function Ao(r){fe!==null&&(ot===null?ot=[r]:ot.push(r))}let at=null,pt=0,St=null;function Uc(r){St=r}let Ro=1,Bn=0,Nr=Bn;function ms(r){Nr=r}let hr=!1;function To(){return++Ro}function En(r){var d;var e=r.f;if(e&ht)return!0;if(e&qt){var t=r.deps,n=(e&It)!==0;if(e&et&&(r.f&=~ki),t!==null){var i,a,s=(e&xi)!==0,l=n&&de!==null&&!hr,c=t.length;if((s||l)&&(de===null||!(de.f&er))){var u=r,f=u.parent;for(i=0;i<c;i++)a=t[i],(s||!((d=a==null?void 0:a.reactions)!=null&&d.includes(u)))&&(a.reactions??(a.reactions=[])).push(u);s&&(u.f^=xi),l&&f!==null&&!(f.f&It)&&(u.f^=It)}for(i=0;i<c;i++)if(a=t[i],En(a)&&ho(a),a.wv>r.wv)return!0}(!n||de!==null&&!hr)&&ze(r,He)}return!1}function Oo(r,e,t=!0){var n=r.reactions;if(n!==null&&!(ot!=null&&ot.includes(r)))for(var i=0;i<n.length;i++){var a=n[i];a.f&et?Oo(a,e,!1):e===a&&(t?ze(a,ht):a.f&He&&ze(a,qt),Vr(a))}}function No(r){var g;var e=at,t=pt,n=St,i=fe,a=hr,s=ot,l=Le,c=Tt,u=Nr,f=r.f;at=null,pt=0,St=null,hr=(f&It)!==0&&(Tt||!tn||fe===null),fe=f&(or|$r)?null:r,ot=null,hn(r.ctx),Tt=!1,Nr=++Bn,r.ac!==null&&(Xi(()=>{r.ac.abort(Zr)}),r.ac=null);try{r.f|=Pa;var d=r.fn,m=d(),_=r.deps;if(at!==null){var h;if(Ai(r,pt),_!==null&&pt>0)for(_.length=pt+at.length,h=0;h<at.length;h++)_[pt+h]=at[h];else r.deps=_=at;if(!hr||f&et&&r.reactions!==null)for(h=pt;h<_.length;h++)((g=_[h]).reactions??(g.reactions=[])).push(r)}else _!==null&&pt<_.length&&(Ai(r,pt),_.length=pt);if(ei()&&St!==null&&!Tt&&_!==null&&!(r.f&(et|qt|ht)))for(h=0;h<St.length;h++)Oo(St[h],r);return i!==null&&i!==r&&(Bn++,St!==null&&(n===null?n=St:n.push(...St))),r.f&pr&&(r.f^=pr),m}catch(v){return ao(v)}finally{r.f^=Pa,at=e,pt=t,St=n,fe=i,hr=a,ot=s,hn(l),Tt=c,Nr=u}}function Hc(r,e){let t=e.reactions;if(t!==null){var n=Gl.call(t,r);if(n!==-1){var i=t.length-1;i===0?t=e.reactions=null:(t[n]=t[i],t.pop())}}t===null&&e.f&et&&(at===null||!at.includes(e))&&(ze(e,qt),e.f&(It|xi)||(e.f^=xi),vo(e),Ai(e,0))}function Ai(r,e){var t=r.deps;if(t!==null)for(var n=e;n<t.length;n++)Hc(r,t[n])}function gn(r){var e=r.f;if(!(e&er)){ze(r,He);var t=de,n=tn;de=r,tn=!0;try{e&sr?Kc(r):Io(r),Co(r);var i=No(r);r.teardown=typeof i=="function"?i:null,r.wv=Ro;var a;qs&&mc&&r.f&ht&&r.deps}finally{tn=n,de=t}}}async function zc(){await Promise.resolve(),bc()}function o(r){var e=r.f,t=(e&et)!==0;if(fe!==null&&!Tt){var n=de!==null&&(de.f&er)!==0;if(!n&&!(ot!=null&&ot.includes(r))){var i=fe.deps;if(fe.f&Pa)r.rv<Bn&&(r.rv=Bn,at===null&&i!==null&&i[pt]===r?pt++:at===null?at=[r]:(!hr||!at.includes(r))&&at.push(r));else{(fe.deps??(fe.deps=[])).push(r);var a=r.reactions;a===null?r.reactions=[fe]:a.includes(fe)||a.push(fe)}}}else if(t&&r.deps===null&&r.effects===null){var s=r,l=s.parent;l!==null&&!(l.f&It)&&(s.f^=It)}if(Ur){if(_r.has(r))return _r.get(r);if(t){s=r;var c=s.v;return(!(s.f&He)&&s.reactions!==null||Fo(s))&&(c=Ya(s)),_r.set(s,c),c}}else if(t){if(s=r,Ue!=null&&Ue.has(s))return Ue.get(s);En(s)&&ho(s)}if(Ue!=null&&Ue.has(r))return Ue.get(r);if(r.f&pr)throw r.v;return r.v}function Fo(r){if(r.v===Ke)return!0;if(r.deps===null)return!1;for(const e of r.deps)if(_r.has(e)||e.f&et&&Fo(e))return!0;return!1}function Yt(r){var e=Tt;try{return Tt=!0,r()}finally{Tt=e}}const qc=-7169;function ze(r,e){r.f=r.f&qc|e}function Bo(r){if(!(typeof r!="object"||!r||r instanceof EventTarget)){if(tr in r)Na(r);else if(!Array.isArray(r))for(let e in r){const t=r[e];typeof t=="object"&&t&&tr in t&&Na(t)}}}function Na(r,e=new Set){if(typeof r=="object"&&r!==null&&!(r instanceof EventTarget)&&!e.has(r)){e.add(r),r instanceof Date&&r.getTime();for(let n in r)try{Na(r[n],e)}catch{}const t=Ha(r);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const n=Ws(t);for(let i in n){const a=n[i].get;if(a)try{a.call(r)}catch{}}}}}function Wc(r){return r.endsWith("capture")&&r!=="gotpointercapture"&&r!=="lostpointercapture"}const Yc=["beforeinput","click","change","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"];function Xc(r){return Yc.includes(r)}const Jc={formnovalidate:"formNoValidate",ismap:"isMap",nomodule:"noModule",playsinline:"playsInline",readonly:"readOnly",defaultvalue:"defaultValue",defaultchecked:"defaultChecked",srcobject:"srcObject",novalidate:"noValidate",allowfullscreen:"allowFullscreen",disablepictureinpicture:"disablePictureInPicture",disableremoteplayback:"disableRemotePlayback"};function Zc(r){return r=r.toLowerCase(),Jc[r]??r}const Qc=["touchstart","touchmove"];function eu(r){return Qc.includes(r)}const Vo=new Set,Fa=new Set;function jo(r,e,t,n={}){function i(a){if(n.capture||Rn.call(e,a),!a.cancelBubble)return Xi(()=>t==null?void 0:t.call(this,a))}return r.startsWith("pointer")||r.startsWith("touch")||r==="wheel"?nr(()=>{e.addEventListener(r,i,n)}):e.addEventListener(r,i,n),i}function Fr(r,e,t,n,i){var a={capture:n,passive:i},s=jo(r,e,t,a);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&Zi(()=>{e.removeEventListener(r,s,a)})}function wt(r){for(var e=0;e<r.length;e++)Vo.add(r[e]);for(var t of Fa)t(r)}let ys=null;function Rn(r){var v;var e=this,t=e.ownerDocument,n=r.type,i=((v=r.composedPath)==null?void 0:v.call(r))||[],a=i[0]||r.target;ys=r;var s=0,l=ys===r&&r.__root;if(l){var c=i.indexOf(l);if(c!==-1&&(e===document||e===window)){r.__root=e;return}var u=i.indexOf(e);if(u===-1)return;c<=u&&(s=c)}if(a=i[s]||r.target,a!==e){$l(r,"currentTarget",{configurable:!0,get(){return a||t}});var f=fe,d=de;ft(null),xt(null);try{for(var m,_=[];a!==null;){var h=a.assignedSlot||a.parentNode||a.host||null;try{var g=a["__"+n];g!=null&&(!a.disabled||r.target===a)&&g.call(a,r)}catch(S){m?_.push(S):m=S}if(r.cancelBubble||h===e||h===null)break;a=h}if(m){for(let S of _)queueMicrotask(()=>{throw S});throw m}}finally{r.__root=e,delete r.currentTarget,ft(f),xt(d)}}}function Za(r){var e=document.createElement("template");return e.innerHTML=r.replaceAll("<!>","<!---->"),e.content}function mn(r,e){var t=de;t.nodes_start===null&&(t.nodes_start=r,t.nodes_end=e)}function F(r,e){var t=(e&uc)!==0,n=(e&dc)!==0,i,a=!r.startsWith("<!>");return()=>{i===void 0&&(i=Za(a?r:"<!>"+r),t||(i=Ut(i)));var s=n||yo?document.importNode(i,!0):i.cloneNode(!0);if(t){var l=Ut(s),c=s.lastChild;mn(l,c)}else mn(s,s);return s}}function tu(r,e,t="svg"){var n=!r.startsWith("<!>"),i=`<${t}>${n?r:"<!>"+r}</${t}>`,a;return()=>{if(!a){var s=Za(i),l=Ut(s);a=Ut(l)}var c=a.cloneNode(!0);return mn(c,c),c}}function Go(r,e){return tu(r,e,"svg")}function Ne(r=""){{var e=yr(r+"");return mn(e,e),e}}function ar(){var r=document.createDocumentFragment(),e=document.createComment(""),t=yr();return r.append(e,t),mn(e,t),r}function M(r,e){r!==null&&r.before(e)}function ve(r,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(r.__t??(r.__t=r.nodeValue))&&(r.__t=t,r.nodeValue=t+"")}function ru(r,e){return nu(r,e)}const Yr=new Map;function nu(r,{target:e,anchor:t,props:n={},events:i,context:a,intro:s=!0}){Rc();var l=new Set,c=d=>{for(var m=0;m<d.length;m++){var _=d[m];if(!l.has(_)){l.add(_);var h=eu(_);e.addEventListener(_,Rn,{passive:h});var g=Yr.get(_);g===void 0?(document.addEventListener(_,Rn,{passive:h}),Yr.set(_,1)):Yr.set(_,g+1)}}};c(Ua(Vo)),Fa.add(c);var u=void 0,f=Vc(()=>{var d=t??e.appendChild(yr());return Cc(d,{pending:()=>{}},m=>{if(a){tt({});var _=Le;_.c=a}i&&(n.$$events=i),u=r(m,n)||{},a&&rt()}),()=>{var h;for(var m of l){e.removeEventListener(m,Rn);var _=Yr.get(m);--_===0?(document.removeEventListener(m,Rn),Yr.delete(m)):Yr.set(m,_)}Fa.delete(c),d!==t&&((h=d.parentNode)==null||h.removeChild(d))}});return iu.set(u,f),u}let iu=new WeakMap;var At,Gt,_t,$n,Kn,Vi;class $o{constructor(e,t=!0){Re(this,"anchor");H(this,At,new Map);H(this,Gt,new Map);H(this,_t,new Map);H(this,$n,!0);H(this,Kn,()=>{var e=be;if(p(this,At).has(e)){var t=p(this,At).get(e),n=p(this,Gt).get(t);if(n)Ja(n);else{var i=p(this,_t).get(t);i&&(p(this,Gt).set(t,i.effect),p(this,_t).delete(t),i.fragment.lastChild.remove(),this.anchor.before(i.fragment),n=i.effect)}for(const[a,s]of p(this,At)){if(p(this,At).delete(a),a===e)break;const l=p(this,_t).get(s);l&&(Ge(l.effect),p(this,_t).delete(s))}for(const[a,s]of p(this,Gt)){if(a===t)continue;const l=()=>{if(Array.from(p(this,At).values()).includes(a)){var u=document.createDocumentFragment();Lo(s,u),u.append(yr()),p(this,_t).set(a,{effect:s,fragment:u})}else Ge(s);p(this,Gt).delete(a)};p(this,$n)||!n?en(s,l,!1):l()}}});H(this,Vi,e=>{p(this,At).delete(e);const t=Array.from(p(this,At).values());for(const[n,i]of p(this,_t))t.includes(n)||(Ge(i.effect),p(this,_t).delete(n))});this.anchor=e,G(this,$n,t)}ensure(e,t){var n=be,i=So();if(t&&!p(this,Gt).has(e)&&!p(this,_t).has(e))if(i){var a=document.createDocumentFragment(),s=yr();a.append(s),p(this,_t).set(e,{effect:gt(()=>t(s)),fragment:a})}else p(this,Gt).set(e,gt(()=>t(this.anchor)));if(p(this,At).set(n,e),i){for(const[l,c]of p(this,Gt))l===e?n.skipped_effects.delete(c):n.skipped_effects.add(c);for(const[l,c]of p(this,_t))l===e?n.skipped_effects.delete(c.effect):n.skipped_effects.add(c.effect);n.oncommit(p(this,Kn)),n.ondiscard(p(this,Vi))}else p(this,Kn).call(this)}}At=new WeakMap,Gt=new WeakMap,_t=new WeakMap,$n=new WeakMap,Kn=new WeakMap,Vi=new WeakMap;function pe(r,e,t=!1){var n=new $o(r),i=t?Br:0;function a(s,l){n.ensure(s,l)}Dn(()=>{var s=!1;e((l,c=!0)=>{s=!0,a(c,l)}),s||a(!1,null)},i)}function je(r,e){return e}function au(r,e,t){for(var n=r.items,i=[],a=e.length,s=0;s<a;s++)Xa(e[s].e,i,!0);var l=a>0&&i.length===0&&t!==null;if(l){var c=t.parentNode;Tc(c),c.append(t),n.clear(),Ft(r,e[0].prev,e[a-1].next)}Mo(i,()=>{for(var u=0;u<a;u++){var f=e[u];l||(n.delete(f.k),Ft(r,f.prev,f.next)),Ge(f.e,!l)}})}function Ee(r,e,t,n,i,a=null){var s=r,l={flags:e,items:new Map,first:null},c=(e&eo)!==0;if(c){var u=r;s=u.appendChild(yr())}var f=null,d=!1,m=new Map,_=Wa(()=>{var S=t();return Ka(S)?S:S==null?[]:Ua(S)}),h,g;function v(){su(g,h,l,m,s,i,e,n,t),a!==null&&(h.length===0?f?Ja(f):f=gt(()=>a(s)):f!==null&&en(f,()=>{f=null}))}Dn(()=>{g??(g=de),h=o(_);var S=h.length;if(!(d&&S===0)){d=S===0;var N,I,O,D;if(So()){var R=new Set,j=be;for(I=0;I<S;I+=1){O=h[I],D=n(O,I);var q=l.items.get(D)??m.get(D);q?e&(qi|Wi)&&Ko(q,O,I,e):(N=Uo(null,l,null,null,O,D,I,i,e,t,!0),m.set(D,N)),R.add(D)}for(const[te,ae]of l.items)R.has(te)||j.skipped_effects.add(ae.e);j.oncommit(v)}else v();o(_)}})}function su(r,e,t,n,i,a,s,l,c){var k,L,B,W;var u=(s&ic)!==0,f=(s&(qi|Wi))!==0,d=e.length,m=t.items,_=t.first,h=_,g,v=null,S,N=[],I=[],O,D,R,j;if(u)for(j=0;j<d;j+=1)O=e[j],D=l(O,j),R=m.get(D),R!==void 0&&((k=R.a)==null||k.measure(),(S??(S=new Set)).add(R));for(j=0;j<d;j+=1){if(O=e[j],D=l(O,j),R=m.get(D),R===void 0){var q=n.get(D);if(q!==void 0){n.delete(D),m.set(D,q);var te=v?v.next:h;Ft(t,v,q),Ft(t,q,te),ma(q,te,i),v=q}else{var ae=h?h.e.nodes_start:i;v=Uo(ae,t,v,v===null?t.first:v.next,O,D,j,a,s,c)}m.set(D,v),N=[],I=[],h=v.next;continue}if(f&&Ko(R,O,j,s),R.e.f&yt&&(Ja(R.e),u&&((L=R.a)==null||L.unfix(),(S??(S=new Set)).delete(R))),R!==h){if(g!==void 0&&g.has(R)){if(N.length<I.length){var Z=I[0],X;v=Z.prev;var K=N[0],Y=N[N.length-1];for(X=0;X<N.length;X+=1)ma(N[X],Z,i);for(X=0;X<I.length;X+=1)g.delete(I[X]);Ft(t,K.prev,Y.next),Ft(t,v,K),Ft(t,Y,Z),h=Z,v=Y,j-=1,N=[],I=[]}else g.delete(R),ma(R,h,i),Ft(t,R.prev,R.next),Ft(t,R,v===null?t.first:v.next),Ft(t,v,R),v=R;continue}for(N=[],I=[];h!==null&&h.k!==D;)h.e.f&yt||(g??(g=new Set)).add(h),I.push(h),h=h.next;if(h===null)continue;R=h}N.push(R),v=R,h=R.next}if(h!==null||g!==void 0){for(var J=g===void 0?[]:Ua(g);h!==null;)h.e.f&yt||J.push(h),h=h.next;var Q=J.length;if(Q>0){var T=s&eo&&d===0?i:null;if(u){for(j=0;j<Q;j+=1)(B=J[j].a)==null||B.measure();for(j=0;j<Q;j+=1)(W=J[j].a)==null||W.fix()}au(t,J,T)}}u&&nr(()=>{var w;if(S!==void 0)for(R of S)(w=R.a)==null||w.apply()}),r.first=t.first&&t.first.e,r.last=v&&v.e;for(var b of n.values())Ge(b.e);n.clear()}function Ko(r,e,t,n){n&qi&&_n(r.v,e),n&Wi?_n(r.i,t):r.i=t}function Uo(r,e,t,n,i,a,s,l,c,u,f){var d=(c&qi)!==0,m=(c&ac)===0,_=d?m?_o(i,!1,!1):mr(i):i,h=c&Wi?mr(s):s,g={i:h,v:_,k:a,a:null,e:null,prev:t,next:n};try{if(r===null){var v=document.createDocumentFragment();v.append(r=yr())}return g.e=gt(()=>l(r,_,h,u),_c),g.e.prev=t&&t.e,g.e.next=n&&n.e,t===null?f||(e.first=g):(t.next=g,t.e.next=g.e),n!==null&&(n.prev=g,n.e.prev=g.e),g}finally{}}function ma(r,e,t){for(var n=r.next?r.next.e.nodes_start:t,i=e?e.e.nodes_start:t,a=r.e.nodes_start;a!==null&&a!==n;){var s=ri(a);i.before(a),a=s}}function Ft(r,e,t){e===null?r.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function jr(r,e,t=!1,n=!1,i=!1){var a=r,s="";re(()=>{var l=de;if(s!==(s=e()??"")&&(l.nodes_start!==null&&(xo(l.nodes_start,l.nodes_end),l.nodes_start=l.nodes_end=null),s!=="")){var c=s+"";t?c=`<svg>${c}</svg>`:n&&(c=`<math>${c}</math>`);var u=Za(c);if((t||n)&&(u=Ut(u)),mn(Ut(u),u.lastChild),t||n)for(;Ut(u);)a.before(Ut(u));else a.before(u)}})}function Ii(r,e,...t){var n=new $o(r);Dn(()=>{const i=e()??null;n.ensure(i,i&&(a=>i(a,...t)))},Br)}function ou(r,e){var t=void 0,n;Dn(()=>{t!==(t=e())&&(n&&(Ge(n),n=null),t&&(n=gt(()=>{ni(()=>t(r))})))})}function Ho(r){var e,t,n="";if(typeof r=="string"||typeof r=="number")n+=r;else if(typeof r=="object")if(Array.isArray(r)){var i=r.length;for(e=0;e<i;e++)r[e]&&(t=Ho(r[e]))&&(n&&(n+=" "),n+=t)}else for(t in r)r[t]&&(n&&(n+=" "),n+=t);return n}function lu(){for(var r,e,t=0,n="",i=arguments.length;t<i;t++)(r=arguments[t])&&(e=Ho(r))&&(n&&(n+=" "),n+=e);return n}function cu(r){return typeof r=="object"?lu(r):r??""}const ws=[...` 	
\r\fÂ \v\uFEFF`];function uu(r,e,t){var n=r==null?"":""+r;if(e&&(n=n?n+" "+e:e),t){for(var i in t)if(t[i])n=n?n+" "+i:i;else if(n.length)for(var a=i.length,s=0;(s=n.indexOf(i,s))>=0;){var l=s+a;(s===0||ws.includes(n[s-1]))&&(l===n.length||ws.includes(n[l]))?n=(s===0?"":n.substring(0,s))+n.substring(l+1):s=l}}return n===""?null:n}function bs(r,e=!1){var t=e?" !important;":";",n="";for(var i in r){var a=r[i];a!=null&&a!==""&&(n+=" "+i+": "+a+t)}return n}function ya(r){return r[0]!=="-"||r[1]!=="-"?r.toLowerCase():r}function du(r,e){if(e){var t="",n,i;if(Array.isArray(e)?(n=e[0],i=e[1]):n=e,r){r=String(r).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var a=!1,s=0,l=!1,c=[];n&&c.push(...Object.keys(n).map(ya)),i&&c.push(...Object.keys(i).map(ya));var u=0,f=-1;const g=r.length;for(var d=0;d<g;d++){var m=r[d];if(l?m==="/"&&r[d-1]==="*"&&(l=!1):a?a===m&&(a=!1):m==="/"&&r[d+1]==="*"?l=!0:m==='"'||m==="'"?a=m:m==="("?s++:m===")"&&s--,!l&&a===!1&&s===0){if(m===":"&&f===-1)f=d;else if(m===";"||d===g-1){if(f!==-1){var _=ya(r.substring(u,f).trim());if(!c.includes(_)){m!==";"&&d++;var h=r.substring(u,d).trim();t+=" "+h+";"}}u=d+1,f=-1}}}}return n&&(t+=bs(n)),i&&(t+=bs(i,!0)),t=t.trim(),t===""?null:t}return r==null?null:String(r)}function st(r,e,t,n,i,a){var s=r.__className;if(s!==t||s===void 0){var l=uu(t,n,a);l==null?r.removeAttribute("class"):e?r.className=l:r.setAttribute("class",l),r.__className=t}else if(a&&i!==a)for(var c in a){var u=!!a[c];(i==null||u!==!!i[c])&&r.classList.toggle(c,u)}return a}function wa(r,e={},t,n){for(var i in t){var a=t[i];e[i]!==a&&(t[i]==null?r.style.removeProperty(i):r.style.setProperty(i,a,n))}}function Ht(r,e,t,n){var i=r.__style;if(i!==e){var a=du(e,n);a==null?r.removeAttribute("style"):r.style.cssText=a,r.__style=e}else n&&(Array.isArray(n)?(wa(r,t==null?void 0:t[0],n[0]),wa(r,t==null?void 0:t[1],n[1],"important")):wa(r,t,n));return n}function Ri(r,e,t=!1){if(r.multiple){if(e==null)return;if(!Ka(e))return hc();for(var n of r.options)n.selected=e.includes(Fn(n));return}for(n of r.options){var i=Fn(n);if(mo(i,e)){n.selected=!0;return}}(!t||e!==void 0)&&(r.selectedIndex=-1)}function zo(r){var e=new MutationObserver(()=>{Ri(r,r.__value)});e.observe(r,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Zi(()=>{e.disconnect()})}function it(r,e,t=e){var n=new WeakSet,i=!0;Ji(r,"change",a=>{var s=a?"[selected]":":checked",l;if(r.multiple)l=[].map.call(r.querySelectorAll(s),Fn);else{var c=r.querySelector(s)??r.querySelector("option:not([disabled])");l=c&&Fn(c)}t(l),be!==null&&n.add(be)}),ni(()=>{var a=e();if(r===document.activeElement){var s=Tn??be;if(n.has(s))return}if(Ri(r,a,i),i&&a===void 0){var l=r.querySelector(":checked");l!==null&&(a=Fn(l),t(a))}r.__value=a,i=!1}),zo(r)}function Fn(r){return"__value"in r?r.__value:r.value}const kn=Symbol("class"),Mn=Symbol("style"),qo=Symbol("is custom element"),Wo=Symbol("is html");function Jr(r,e){var t=Qa(r);t.value===(t.value=e??void 0)||r.value===e&&(e!==0||r.nodeName!=="PROGRESS")||(r.value=e??"")}function fu(r,e){e?r.hasAttribute("selected")||r.setAttribute("selected",""):r.removeAttribute("selected")}function kt(r,e,t,n){var i=Qa(r);i[e]!==(i[e]=t)&&(e==="loading"&&(r[ql]=t),t==null?r.removeAttribute(e):typeof t!="string"&&Yo(r).includes(e)?r[e]=t:r.setAttribute(e,t))}function vu(r,e,t,n,i=!1,a=!1){var s=Qa(r),l=s[qo],c=!s[Wo],u=e||{},f=r.tagName==="OPTION";for(var d in e)d in t||(t[d]=null);t.class?t.class=cu(t.class):t[kn]&&(t.class=null),t[Mn]&&(t.style??(t.style=null));var m=Yo(r);for(const O in t){let D=t[O];if(f&&O==="value"&&D==null){r.value=r.__value="",u[O]=D;continue}if(O==="class"){var _=r.namespaceURI==="http://www.w3.org/1999/xhtml";st(r,_,D,n,e==null?void 0:e[kn],t[kn]),u[O]=D,u[kn]=t[kn];continue}if(O==="style"){Ht(r,D,e==null?void 0:e[Mn],t[Mn]),u[O]=D,u[Mn]=t[Mn];continue}var h=u[O];if(!(D===h&&!(D===void 0&&r.hasAttribute(O)))){u[O]=D;var g=O[0]+O[1];if(g!=="$$")if(g==="on"){const R={},j="$$"+O;let q=O.slice(2);var v=Xc(q);if(Wc(q)&&(q=q.slice(0,-7),R.capture=!0),!v&&h){if(D!=null)continue;r.removeEventListener(q,u[j],R),u[j]=null}if(D!=null)if(v)r[`__${q}`]=D,wt([q]);else{let te=function(ae){u[O].call(this,ae)};var I=te;u[j]=jo(q,r,te,R)}else v&&(r[`__${q}`]=void 0)}else if(O==="style")kt(r,O,D);else if(O==="autofocus")Li(r,!!D);else if(!l&&(O==="__value"||O==="value"&&D!=null))r.value=r.__value=D;else if(O==="selected"&&f)fu(r,D);else{var S=O;c||(S=Zc(S));var N=S==="defaultValue"||S==="defaultChecked";if(D==null&&!l&&!N)if(s[O]=null,S==="value"||S==="checked"){let R=r;const j=e===void 0;if(S==="value"){let q=R.defaultValue;R.removeAttribute(S),R.defaultValue=q,R.value=R.__value=j?q:null}else{let q=R.defaultChecked;R.removeAttribute(S),R.defaultChecked=q,R.checked=j?q:!1}}else r.removeAttribute(O);else N||m.includes(S)&&(l||typeof D!="string")?(r[S]=D,S in s&&(s[S]=Ke)):typeof D!="function"&&kt(r,S,D)}}}return u}function hu(r,e,t=[],n=[],i=[],a,s=!1,l=!1){fo(i,t,n,c=>{var u=void 0,f={},d=r.nodeName==="SELECT",m=!1;if(Dn(()=>{var h=e(...c.map(o)),g=vu(r,u,h,a,s,l);m&&d&&"value"in h&&Ri(r,h.value);for(let S of Object.getOwnPropertySymbols(f))h[S]||Ge(f[S]);for(let S of Object.getOwnPropertySymbols(h)){var v=h[S];S.description===vc&&(!u||v!==u[S])&&(f[S]&&Ge(f[S]),f[S]=gt(()=>ou(r,()=>v))),g[S]=v}u=g}),d){var _=r;ni(()=>{Ri(_,u.value,!0),zo(_)})}m=!0})}function Qa(r){return r.__attributes??(r.__attributes={[qo]:r.nodeName.includes("-"),[Wo]:r.namespaceURI===fc})}var Ss=new Map;function Yo(r){var e=r.getAttribute("is")||r.nodeName,t=Ss.get(e);if(t)return t;Ss.set(e,t=[]);for(var n,i=r,a=Element.prototype;a!==i;){n=Ws(i);for(var s in n)n[s].set&&t.push(s);i=Ha(i)}return t}function gr(r,e,t=e){var n=new WeakSet;Ji(r,"input",async i=>{var a=i?r.defaultValue:r.value;if(a=Da(r)?Ea(a):a,t(a),be!==null&&n.add(be),await zc(),a!==(a=e())){var s=r.selectionStart,l=r.selectionEnd,c=r.value.length;if(r.value=a??"",l!==null){var u=r.value.length;s===l&&l===c&&u>c?(r.selectionStart=u,r.selectionEnd=u):(r.selectionStart=s,r.selectionEnd=Math.min(l,u))}}}),Yt(e)==null&&r.value&&(t(Da(r)?Ea(r.value):r.value),be!==null&&n.add(be)),Kr(()=>{var i=e();if(r===document.activeElement){var a=Tn??be;if(n.has(a))return}Da(r)&&i===Ea(r.value)||r.type==="date"&&!i&&!r.value||i!==r.value&&(r.value=i??"")})}const ba=new Set;function Xr(r,e,t,n,i=n){var a=t.getAttribute("type")==="checkbox",s=r;if(e!==null)for(var l of e)s=s[l]??(s[l]=[]);s.push(t),Ji(t,"change",()=>{var c=t.__value;a&&(c=pu(s,c,t.checked)),i(c)},()=>i(a?[]:null)),Kr(()=>{var c=n();a?(c=c||[],t.checked=c.includes(t.__value)):t.checked=mo(t.__value,c)}),Zi(()=>{var c=s.indexOf(t);c!==-1&&s.splice(c,1)}),ba.has(s)||(ba.add(s),nr(()=>{s.sort((c,u)=>c.compareDocumentPosition(u)===4?-1:1),ba.delete(s)})),nr(()=>{})}function Sa(r,e,t=e){Ji(r,"change",n=>{var i=n?r.defaultChecked:r.checked;t(i)}),Yt(e)==null&&t(r.checked),Kr(()=>{var n=e();r.checked=!!n})}function pu(r,e,t){for(var n=new Set,i=0;i<r.length;i+=1)r[i].checked&&n.add(r[i].__value);return t||n.delete(e),Array.from(n)}function Da(r){var e=r.type;return e==="number"||e==="range"}function Ea(r){return r===""?null:+r}var fr,on,Un,ji,Xo;const Gi=class Gi{constructor(e){H(this,ji);H(this,fr,new WeakMap);H(this,on);H(this,Un);G(this,Un,e)}observe(e,t){var n=p(this,fr).get(e)||new Set;return n.add(t),p(this,fr).set(e,n),Me(this,ji,Xo).call(this).observe(e,p(this,Un)),()=>{var i=p(this,fr).get(e);i.delete(t),i.size===0&&(p(this,fr).delete(e),p(this,on).unobserve(e))}}};fr=new WeakMap,on=new WeakMap,Un=new WeakMap,ji=new WeakSet,Xo=function(){return p(this,on)??G(this,on,new ResizeObserver(e=>{for(var t of e){Gi.entries.set(t.target,t);for(var n of p(this,fr).get(t.target)||[])n(t)}}))},Re(Gi,"entries",new WeakMap);let Ba=Gi;var _u=new Ba({box:"border-box"});function gu(r,e,t){var n=_u.observe(r,()=>t(r[e]));ni(()=>(Yt(()=>t(r[e])),n))}function Ds(r,e){return r===e||(r==null?void 0:r[tr])===e}function Gr(r={},e,t,n){return ni(()=>{var i,a;return Kr(()=>{i=a,a=[],Yt(()=>{r!==t(...a)&&(e(r,...a),i&&Ds(t(...i),r)&&e(null,...i))})}),()=>{nr(()=>{a&&Ds(t(...a),r)&&e(null,...a)})}}),r}function mu(r=!1){const e=Le,t=e.l.u;if(!t)return;let n=()=>Bo(e.s);if(r){let i=0,a={};const s=ti(()=>{let l=!1;const c=e.s;for(const u in c)c[u]!==a[u]&&(a[u]=c[u],l=!0);return l&&i++,i});n=()=>o(s)}t.b.length&&Bc(()=>{Es(e,n),Ma(t.b)}),ir(()=>{const i=Yt(()=>t.m.map(Hl));return()=>{for(const a of i)typeof a=="function"&&a()}}),t.a.length&&ir(()=>{Es(e,n),Ma(t.a)})}function Es(r,e){if(r.l.s)for(const t of r.l.s)o(t);e()}let di=!1;function yu(r){var e=di;try{return di=!1,[r(),di]}finally{di=e}}const wu={get(r,e){if(!r.exclude.includes(e))return o(r.version),e in r.special?r.special[e]():r.props[e]},set(r,e,t){if(!(e in r.special)){var n=de;try{xt(r.parent_effect),r.special[e]=ie({get[e](){return r.props[e]}},e,to)}finally{xt(n)}}return r.special[e](t),Pi(r.version),!0},getOwnPropertyDescriptor(r,e){if(!r.exclude.includes(e)&&e in r.props)return{enumerable:!0,configurable:!0,value:r.props[e]}},deleteProperty(r,e){return r.exclude.includes(e)||(r.exclude.push(e),Pi(r.version)),!0},has(r,e){return r.exclude.includes(e)?!1:e in r.props},ownKeys(r){return Reflect.ownKeys(r.props).filter(e=>!r.exclude.includes(e))}};function Cs(r,e){return new Proxy({props:r,exclude:e,special:{},version:mr(0),parent_effect:de},wu)}function ie(r,e,t,n){var I;var i=!Sn||(t&oc)!==0,a=(t&lc)!==0,s=(t&cc)!==0,l=n,c=!0,u=()=>(c&&(c=!1,l=s?Yt(n):n),l),f;if(a){var d=tr in r||zl in r;f=((I=Qr(r,e))==null?void 0:I.set)??(d&&e in r?O=>r[e]=O:void 0)}var m,_=!1;a?[m,_]=yu(()=>r[e]):m=r[e],m===void 0&&n!==void 0&&(m=u(),f&&(i&&Ql(),f(m)));var h;if(i?h=()=>{var O=r[e];return O===void 0?u():(c=!0,O)}:h=()=>{var O=r[e];return O!==void 0&&(l=void 0),O===void 0?l:O},i&&!(t&to))return h;if(f){var g=r.$$legacy;return function(O,D){return arguments.length>0?((!i||!D||g||_)&&f(D?h():O),O):h()}}var v=!1,S=(t&sc?ti:Wa)(()=>(v=!1,h()));a&&o(S);var N=de;return function(O,D){if(arguments.length>0){const R=D?o(S):i&&a?Se(O):O;return x(S,R),v=!0,l!==void 0&&(l=R),O}return Ur&&v||N.f&er?S.v:o(S)}}function Cn(r){Le===null&&Qs(),Sn&&Le.l!==null?bu(Le).m.push(r):ir(()=>{const e=Yt(r);if(typeof e=="function")return e})}function Qi(r){Le===null&&Qs(),Cn(()=>()=>Yt(r))}function bu(r){var e=r.l;return e.u??(e.u={a:[],b:[],m:[]})}const Su="5";var zs;typeof window<"u"&&((zs=window.__svelte??(window.__svelte={})).v??(zs.v=new Set)).add(Su);const Du=0,Eu=126,Cu=231,Iu=6;class xu{constructor(){this.universe=new Uint8Array(512).fill(0),this.device=null,this.interval=null,this.updateRate=1e3/60,this.connected=!1}async connect(){if(!("usb"in navigator))throw new Error("WebUSB is not supported in this browser");try{return this.device=await navigator.usb.requestDevice({filters:[{vendorId:1027}]}),await this.device.open(),await this.device.claimInterface(0),await this.device.controlTransferOut({requestType:"class",recipient:"interface",request:34,value:1,index:0}),this.connected=!0,this.interval=setInterval(()=>{this.sendUniverse()},this.updateRate),!0}catch(e){throw console.error("Failed to connect:",e),e}}disconnect(){this.interval&&(clearInterval(this.interval),this.interval=null),this.device&&(this.device.close(),this.device=null),this.connected=!1}setChannel(e,t){e>=0&&e<512&&(this.universe[e]=Math.max(0,Math.min(255,t)))}getChannel(e){return this.universe[e]||0}setChannels(e,t){t.forEach((n,i)=>{this.setChannel(e+i,n)})}getUniverse(){return this.universe}clearUniverse(){this.universe.fill(0)}sendUniverse(){if(!this.device||!this.connected)return;const e=Uint8Array.from([Du,...this.universe]),t=Uint8Array.from([Eu,Iu,e.length&255,e.length>>8&255,...e,Cu]);this.device.transferOut(2,t).catch(n=>{console.error("Failed to send DMX data:",n)})}}const Ze={RGB:{name:"RGB Light",channels:3,controls:[{name:"Red",type:"slider",color:"#b83838"},{name:"Green",type:"slider",color:"#4a964a"},{name:"Blue",type:"slider",color:"#365fb4"}]},RGBA:{name:"RGBA Light",channels:4,controls:[{name:"Red",type:"slider",color:"#b83838"},{name:"Green",type:"slider",color:"#4a964a"},{name:"Blue",type:"slider",color:"#365fb4"},{name:"Amber",type:"slider",color:"#a68522"}]},RGBW:{name:"RGBW Light",channels:4,controls:[{name:"Red",type:"slider",color:"#b83838"},{name:"Green",type:"slider",color:"#4a964a"},{name:"Blue",type:"slider",color:"#365fb4"},{name:"White",type:"slider",color:"#808080"}]},DIMMER:{name:"Dimmer",channels:1,controls:[{name:"Intensity",type:"slider",color:"#888888"}]},SMOKE:{name:"Smoke Machine",channels:1,controls:[{name:"Output",type:"slider",color:"#666666"}]},MOVING_HEAD:{name:"Moving Head (Basic)",channels:7,controls:[{name:"Pan/Tilt",type:"xypad",panIndex:0,tiltIndex:1},{name:"Dimmer",type:"slider",color:"#888888"},{name:"Red",type:"slider",color:"#b83838"},{name:"Green",type:"slider",color:"#4a964a"},{name:"Blue",type:"slider",color:"#365fb4"},{name:"White",type:"slider",color:"#808080"}]},FLAMETHROWER:{name:"Flamethrower",channels:2,controls:[{name:"Safety",type:"toggle",offValue:0,onValue:125},{name:"Fuel",type:"slider",color:"#ff5722"}]}};class Pn{constructor(e,t,n,i="",a=null,s=null){this.id=e,this.type=t,this.startChannel=n,this.name=i||`${Ze[t].name} ${e}`,this.defaultValues=new Array(Ze[t].channels).fill(0),this.linkedTo=a,this.cssId=s||this.generateCssId(this.name)}generateCssId(e){return e.toLowerCase().replace(/[^a-z0-9]/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,"")}updateCssId(){this.cssId=this.generateCssId(this.name)}setValue(e,t){this.defaultValues[e]=Math.max(0,Math.min(255,t))}getValue(e){return this.defaultValues[e]}getChannelValues(){return this.defaultValues}isLinked(){return this.linkedTo!==null}}function Vn(r,e){if(!e||e.length===0)return"#000000";switch(r){case"RGB":{const[t,n,i]=e;return`rgb(${t}, ${n}, ${i})`}case"RGBA":{const[t,n,i,a]=e,s=255,l=191,c=0,u=Math.min(255,t+s*a/255),f=Math.min(255,n+l*a/255),d=Math.min(255,i+c*a/255);return`rgb(${Math.round(u)}, ${Math.round(f)}, ${Math.round(d)})`}case"RGBW":{const[t,n,i,a]=e,s=Math.min(255,t+a),l=Math.min(255,n+a),c=Math.min(255,i+a);return`rgb(${Math.round(s)}, ${Math.round(l)}, ${Math.round(c)})`}case"MOVING_HEAD":{const t=e[2]||0,n=e[3]||0,i=e[4]||0,a=e[5]||0,s=e[6]||0;let l=Math.min(255,n+s),c=Math.min(255,i+s),u=Math.min(255,a+s);return l=Math.round(l*t/255),c=Math.round(c*t/255),u=Math.round(u*t/255),`rgb(${l}, ${c}, ${u})`}case"DIMMER":{const t=e[0]||0;return`rgb(${t}, ${t}, ${t})`}case"SMOKE":{const t=e[0]||0,n=Math.round(t*.7);return`rgb(${Math.round(t*.5)}, ${Math.round(t*.5)}, ${n})`}default:return"#000000"}}class ku{constructor(e=0,t="RGB",n=[0,0,0]){this.time=e,this.deviceType=t,this.values=[...n]}getProperties(){const e=Vn(this.deviceType,this.values);if(this.deviceType==="MOVING_HEAD"){const t=this.values[0]||0,n=this.values[1]||0,i=t/255*100-50,a=n/255*100-50;return{color:e,transform:`translate(${i}%, ${a}%)`}}return{color:e}}toCSS(){const e=this.getProperties(),t=Object.entries(e).map(([i,a])=>`${i}: ${a}`).join("; ");return`${Math.round(this.time*100)}% { ${t}; }`}}class ea{constructor(e="animation",t="RGB",n=[]){this.name=e,this.deviceType=t,this.keyframes=n}addKeyframe(e,t){const n=new ku(e,this.deviceType,t);return this.keyframes=[...this.keyframes,n].sort((i,a)=>i.time-a.time),n}removeKeyframe(e){const t=this.keyframes.indexOf(e);t!==-1&&this.keyframes.splice(t,1)}toCSS(){if(this.keyframes.length===0)return"";const e=this.keyframes.map(t=>t.toCSS()).join(`
  `);return`@keyframes ${this.name} {
  ${e}
}`}getKeyframeColor(e){return Vn(this.deviceType,e.values)}getValuesAtTime(e){if(this.keyframes.length===0){const n=this.deviceType==="RGB"?3:4;return new Array(n).fill(0)}const t=[...this.keyframes].sort((n,i)=>n.time-i.time);if(e<=t[0].time)return[...t[0].values];if(e>=t[t.length-1].time)return[...t[t.length-1].values];for(let n=0;n<t.length-1;n++){const i=t[n],a=t[n+1];if(e>=i.time&&e<=a.time){const s=(e-i.time)/(a.time-i.time),l=[];for(let c=0;c<i.values.length;c++){const u=i.values[c],f=a.values[c];l.push(Math.round(u+(f-u)*s))}return l}}return[...t[0].values]}getGradientSegments(e=1e3){if(this.keyframes.length===0)return[{left:0,width:e,gradient:"#000000"}];const t=[],n=[...this.keyframes].sort((a,s)=>a.time-s.time);if(n[0].time>0){const a=this.getKeyframeColor(n[0]);t.push({left:0,width:n[0].time*e,gradient:`linear-gradient(to right, #000000, ${a})`})}for(let a=0;a<n.length-1;a++){const s=n[a],l=n[a+1],c=this.getKeyframeColor(s),u=this.getKeyframeColor(l);t.push({left:s.time*e,width:(l.time-s.time)*e,gradient:`linear-gradient(to right, ${c}, ${u})`})}const i=n[n.length-1];if(i.time<1){const a=this.getKeyframeColor(i);t.push({left:i.time*e,width:(1-i.time)*e,gradient:`linear-gradient(to right, ${a}, #000000)`})}return t}toJSON(){return{name:this.name,deviceType:this.deviceType,keyframes:this.keyframes.map(e=>({time:e.time,deviceType:e.deviceType,values:e.values}))}}static fromJSON(e){const t=e.deviceType||"RGB",n=new ea(e.name,t);for(const i of e.keyframes)if(i.values)n.addKeyframe(i.time,i.values);else if(i.properties){const a=new Array(n.deviceType==="RGB"?3:4).fill(0);n.addKeyframe(i.time,a)}return n}}class Mu{constructor(){this.animations=new Map,this.listeners=new Map,this.load()}on(e,t){this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e).add(t)}off(e,t){this.listeners.has(e)&&this.listeners.get(e).delete(t)}_emit(e,t){if(!this.listeners.has(e))return;const n=this.listeners.get(e);for(const i of n)i(t)}add(e){this.animations.set(e.name,e),this.save(),this._emit("changed",{type:"add",animation:e})}remove(e){const t=this.animations.get(e);this.animations.delete(e),this.save(),this._emit("changed",{type:"remove",animation:t,name:e})}get(e){return this.animations.get(e)}getAll(){return Array.from(this.animations.values())}has(e){return this.animations.has(e)}rename(e,t){const n=this.animations.get(e);return n?(n.name=t,this.animations.delete(e),this.animations.set(t,n),this.save(),!0):!1}toCSS(){return this.getAll().map(e=>e.toCSS()).filter(e=>e).join(`

`)}save(){const e=this.getAll().map(t=>t.toJSON());localStorage.setItem("dmx-animations",JSON.stringify(e))}load(){const e=localStorage.getItem("dmx-animations");if(e)try{const t=JSON.parse(e);for(const n of t){const i=ea.fromJSON(n);this.animations.set(i.name,i)}}catch(t){console.error("Failed to load animations:",t)}}clear(){this.animations.clear(),this.save()}}class yn{constructor(e={}){this.id=e.id||`mapping-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,this.name=e.name||"Untitled Mapping",this.mode=e.mode||"trigger",this.inputDeviceId=e.inputDeviceId||null,this.inputControlId=e.inputControlId||null,this.inputDeviceName=e.inputDeviceName||null,this.color="color"in e?e.color:this._generateRandomColor(),this.triggerType=e.triggerType||"pressed",this.animationName=e.animationName||null,this.duration=e.duration||1e3,this.easing=e.easing||"linear",this.iterations=e.iterations||1,this.targetDeviceIds=e.targetDeviceIds||[],this.propertyName=e.propertyName||"--value",this.propertyType=e.propertyType||"percentage",this.range=e.range||[0,100],this.cssClassName=e.cssClassName||this._generateClassName()}_generateRandomColor(){const e=Math.floor(Math.random()*360),t=70+Math.floor(Math.random()*30),n=50+Math.floor(Math.random()*20);return`hsl(${e}, ${t}%, ${n}%)`}_generateClassName(){if(!this.inputDeviceId||!this.inputControlId)return`mapping-${this.id}`;const e=this.inputControlId.replace(/[^a-zA-Z0-9]/g,"_").toLowerCase(),t=this.triggerType==="pressed"?"down":this.triggerType==="not-pressed"?"up":"always";return`${e}_${t}`}updateClassName(){this.cssClassName=this._generateClassName()}toCSS(e=[]){return this.mode==="trigger"?this._generateTriggerCSS(e):""}_generateTriggerCSS(e=[]){if(!this.animationName)return"";const t=this.targetDeviceIds.map(a=>{const s=e.find(l=>l.id===a);return s?`#${s.cssId}`:null}).filter(a=>a!==null).join(", ");if(!t)return"";const n=this.iterations==="infinite"?"infinite":this.iterations,i=(this.duration/1e3).toFixed(3);return`.${this.cssClassName} ${t} {
  animation: ${this.animationName} ${i}s ${this.easing} ${n};
}`}getPropertyName(){return this.propertyName.startsWith("--")?this.propertyName:`--${this.propertyName}`}mapValue(e){const[t,n]=this.range,i=t+(n-t)*e;switch(this.propertyType){case"percentage":return`${i.toFixed(1)}%`;case"degrees":return`${i.toFixed(1)}deg`;case"number":return i.toFixed(2);default:return i.toString()}}toJSON(){return{id:this.id,name:this.name,mode:this.mode,inputDeviceId:this.inputDeviceId,inputControlId:this.inputControlId,inputDeviceName:this.inputDeviceName,color:this.color,triggerType:this.triggerType,animationName:this.animationName,duration:this.duration,easing:this.easing,iterations:this.iterations,targetDeviceIds:this.targetDeviceIds,propertyName:this.propertyName,propertyType:this.propertyType,range:this.range,cssClassName:this.cssClassName}}static fromJSON(e){return new yn(e)}}class Jo{constructor(){this.mappings=new Map,this.listeners=new Map,this.load()}on(e,t){this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e).add(t)}off(e,t){this.listeners.has(e)&&this.listeners.get(e).delete(t)}_emit(e,t){if(!this.listeners.has(e))return;const n=this.listeners.get(e);for(const i of n)i(t)}add(e){return this.mappings.set(e.id,e),this.save(),this._emit("changed",{type:"add",mapping:e}),e}update(e){this.mappings.has(e.id)&&(this.mappings.set(e.id,e),this.save(),this._emit("changed",{type:"update",mapping:e}))}remove(e){const t=this.mappings.get(e);this.mappings.delete(e),this.save(),this._emit("changed",{type:"remove",mapping:t,id:e})}get(e){return this.mappings.get(e)}getAll(){return Array.from(this.mappings.values())}getByInput(e,t){return this.getAll().filter(n=>n.inputDeviceId===e&&n.inputControlId===t)}getTriggerMappings(){return this.getAll().filter(e=>e.mode==="trigger")}getDirectMappings(){return this.getAll().filter(e=>e.mode==="direct")}toCSS(e=[]){return this.getTriggerMappings().map(t=>t.toCSS(e)).filter(t=>t).join(`

`)}save(){const e=this.getAll().map(t=>t.toJSON());localStorage.setItem("dmx-mappings",JSON.stringify(e))}load(){const e=localStorage.getItem("dmx-mappings");if(e)try{const t=JSON.parse(e);for(const n of t){const i=yn.fromJSON(n);this.mappings.set(i.id,i)}}catch(t){console.error("Failed to load mappings:",t)}}clear(){this.mappings.clear(),this.save()}}class Zo{constructor(){this.activeClasses=new Set,this.notPressedClasses=new Set,this.alwaysClasses=new Set,this.container=null}setContainer(e){this.container=e;for(const t of this.notPressedClasses)e.classList.add(t);for(const t of this.alwaysClasses)e.classList.add(t)}register(e){e.mode==="trigger"&&(e.triggerType==="not-pressed"?(this.notPressedClasses.add(e.cssClassName),this.container&&this.container.classList.add(e.cssClassName)):e.triggerType==="always"&&(this.alwaysClasses.add(e.cssClassName),this.container&&this.container.classList.add(e.cssClassName)))}unregister(e){e.mode==="trigger"&&(this.notPressedClasses.delete(e.cssClassName),this.alwaysClasses.delete(e.cssClassName),this.container&&this.container.classList.remove(e.cssClassName))}trigger(e){if(!this.container||e.mode!=="trigger")return;const t=e.cssClassName;e.triggerType==="pressed"?(this.container.classList.add(t),this.activeClasses.add(t)):e.triggerType==="not-pressed"&&this.container.classList.remove(t)}release(e){if(!this.container||e.mode!=="trigger")return;const t=e.cssClassName;e.triggerType==="pressed"?(this.container.classList.remove(t),this.activeClasses.delete(t)):e.triggerType==="not-pressed"&&this.container.classList.add(t)}addRawClass(e){this.container&&this.container.classList.add(e)}removeRawClass(e){this.container&&this.container.classList.remove(e)}clearAll(){if(this.container){for(const e of this.activeClasses)this.container.classList.remove(e);this.activeClasses.clear()}}}class Pu{constructor(e,t){this.animationLibrary=e,this.mappingLibrary=t}generate(e=[]){const t=[];if(t.push("/* DMX Controller - Generated CSS */"),t.push("/* This stylesheet is auto-generated from your animations and input mappings */"),t.push("/* You can edit this CSS and the changes will be reflected in the interface */"),t.push(`/* Note: @property definitions are in a separate, non-editable include */
`),e.length>0){t.push("/* === Default Device Values === */"),t.push("/* These selectors set the default state for each device */");for(const s of e){const l=this._generateDeviceDefaults(s);l&&t.push(l)}t.push("")}const n=this.animationLibrary.toCSS();n&&(t.push("/* === Animations === */"),t.push(n),t.push(""));const i=this.mappingLibrary.toCSS(e);i&&(t.push("/* === Triggers === */"),t.push(i),t.push(""));const a=this.mappingLibrary.getDirectMappings();if(a.length>0){t.push("/* === Custom Properties (Direct Control) === */"),t.push("/* These properties are updated live via JavaScript */"),t.push(":root {");for(const s of a){const l=s.getPropertyName(),c=s.mapValue(0);t.push(`  ${l}: ${c}; /* ${s.name} */`)}t.push(`}
`)}return t.push("/* === Custom Styles === */"),t.push("/* Add your custom CSS below to override device defaults and apply animations */"),t.push(""),t.join(`
`)}_generateDeviceDefaults(e){if(!Ze[e.type]||e.isLinked&&e.isLinked())return null;const n=[],i=e.defaultValues||[];switch(e.type){case"RGB":const[a,s,l]=i;n.push(`  color: rgb(${a||0}, ${s||0}, ${l||0});`);break;case"RGBA":const[c,u,f,d]=i;n.push(`  color: rgb(${c||0}, ${u||0}, ${f||0});`);const m=Math.round((d||0)/255*100);n.push(`  --amber: ${m}%;`);break;case"RGBW":const[_,h,g,v]=i;n.push(`  color: rgb(${_||0}, ${h||0}, ${g||0});`),n.push(`  /* White channel: ${v||0} */`);break;case"DIMMER":const S=i[0]||0;n.push(`  opacity: ${(S/255).toFixed(2)};`);break;case"SMOKE":const N=i[0]||0,I=Math.round(N/255*100);n.push(`  --smoke: ${I}%;`);break;case"MOVING_HEAD":const[O,D,R,j,q,te,ae]=i,Z=O!==void 0?Math.round(O/255*100-50):0,X=D!==void 0?Math.round(D/255*100):0;n.push(`  --pan: ${Z}%;`),n.push(`  --tilt: ${X}%;`),n.push(`  opacity: ${R!==void 0?(R/255).toFixed(2):"1"};`),n.push(`  color: rgb(${j||0}, ${q||0}, ${te||0});`),ae!==void 0&&n.push(`  /* White channel: ${ae} */`);break;case"FLAMETHROWER":const[K,Y]=i,J=K>=125?"probably":"none",Q=Math.round(Y/255*100);n.push(`  --safety: ${J};`),n.push(`  --fuel: ${Q}%;`);break;default:return null}return n.length===0?null:`#${e.cssId} {
${n.join(`
`)}
}`}}class Lu{constructor(){this.deviceElements=new Map,this.container=null,this.previousValues=new Map}initialize(e){this.container=e}updateDevices(e){if(this.container){for(const[t,n]of this.deviceElements)e.find(i=>i.id===t)||(n.remove(),this.deviceElements.delete(t));for(const t of e){let n=this.deviceElements.get(t.id);const i=t.cssId;n?n.id!==i&&(n.id=i):(n=document.createElement("div"),n.id=i,n.className="dmx-device",n.dataset.deviceType=t.type,this.container.appendChild(n),this.deviceElements.set(t.id,n)),n.dataset.deviceName=t.name,n.dataset.deviceType=t.type}}}sampleDevice(e){const t=this.deviceElements.get(e.id);if(!t)return console.warn(`[CSSSampler] No element found for device ${e.id}`),null;t.offsetHeight;const n=window.getComputedStyle(t),i={};switch(e.type){case"RGB":Object.assign(i,this._sampleRGB(n));break;case"RGBA":Object.assign(i,this._sampleRGBA(n));break;case"RGBW":Object.assign(i,this._sampleRGBW(n));break;case"DIMMER":Object.assign(i,this._sampleDimmer(n));break;case"SMOKE":Object.assign(i,this._sampleSmoke(n));break;case"MOVING_HEAD":Object.assign(i,this._sampleMovingHead(n));break;case"FLAMETHROWER":Object.assign(i,this._sampleFlamethrower(n));break}return this.previousValues.set(e.id,{...i}),i}sampleAll(e){const t=new Map;for(const n of e){const i=this.sampleDevice(n);i&&t.set(n.id,i)}return t}_sampleRGB(e){const t=this._parseComputedColor(e.color);return{Red:t.r,Green:t.g,Blue:t.b}}_sampleRGBA(e){const t=this._parseComputedColor(e.color),i=(e.getPropertyValue("--amber")||"0%").match(/(\d+(?:\.\d+)?)/),a=i?parseFloat(i[1]):0,s=Math.round(Math.max(0,Math.min(100,a))*255/100);return{Red:t.r,Green:t.g,Blue:t.b,Amber:s}}_sampleRGBW(e){const t=this._parseComputedColor(e.color),n=Math.min(t.r,t.g,t.b);return{Red:t.r,Green:t.g,Blue:t.b,White:n}}_sampleDimmer(e){const t=parseFloat(e.opacity)||1;return{Intensity:Math.round(t*255)}}_sampleSmoke(e){const n=(e.getPropertyValue("--smoke")||"0%").match(/(\d+(?:\.\d+)?)/),i=n?parseFloat(n[1]):0;return{Output:Math.round(Math.max(0,Math.min(100,i))*255/100)}}_sampleMovingHead(e){const t=this._parseComputedColor(e.color),n=parseFloat(e.opacity)||1,i=e.getPropertyValue("--pan")||"0%",a=e.getPropertyValue("--tilt")||"0%",s=i.match(/(-?\d+(?:\.\d+)?)/),l=s?parseFloat(s[1]):0,c=Math.round((Math.max(-50,Math.min(50,l))+50)/100*255),u=a.match(/(\d+(?:\.\d+)?)/),f=u?parseFloat(u[1]):0,d=Math.round(Math.max(0,Math.min(100,f))*255/100);return{Pan:c,Tilt:d,Dimmer:Math.round(n*255),Red:t.r,Green:t.g,Blue:t.b,White:Math.min(t.r,t.g,t.b)}}_sampleFlamethrower(e){const t=e.getPropertyValue("--safety")||"none",n=e.getPropertyValue("--fuel")||"0%",i=t.trim()==="probably"?125:0,a=n.match(/(\d+(?:\.\d+)?)/),s=a?parseFloat(a[1]):0,l=Math.round(Math.max(0,Math.min(100,s))*255/100);return{Safety:i,Fuel:l}}_parseComputedColor(e){const t=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([\d.]+))?\)/);return t?{r:parseInt(t[1]),g:parseInt(t[2]),b:parseInt(t[3]),a:t[4]?parseFloat(t[4]):1}:{r:0,g:0,b:0,a:1}}_parseTranslate(e){if(!e||e==="none")return{x:127,y:127};const t=e.match(/translate\(([^,)]+)(?:,?\s+([^)]+))?\)/);if(t){const n=this._parsePercentage(t[1]),i=t[2]?this._parsePercentage(t[2]):n;return{x:Math.round(n*255/100),y:Math.round(i*255/100)}}return{x:127,y:127}}_parsePercentage(e){const t=parseFloat(e);return e.includes("%")?Math.max(0,Math.min(100,t)):Math.max(0,Math.min(100,t/255*100))}getElement(e){return this.deviceElements.get(e)}clear(){for(const e of this.deviceElements.values())e.remove();this.deviceElements.clear()}}class Qo{constructor(){this.properties=new Map,this.styleElement=null}initialize(){this.styleElement=document.createElement("style"),this.styleElement.id="dmx-custom-properties",document.head.appendChild(this.styleElement),this._updateStyle()}setProperty(e,t){e.startsWith("--")||(e=`--${e}`),this.properties.set(e,t),this._updateStyle()}getProperty(e){return e.startsWith("--")||(e=`--${e}`),this.properties.get(e)}_updateStyle(){if(!this.styleElement)return;const e=Array.from(this.properties.entries()).map(([t,n])=>`  ${t}: ${n};`).join(`
`);this.styleElement.textContent=`:root {
${e}
}`}getAll(){return Array.from(this.properties.entries()).map(([e,t])=>({name:e,value:t}))}clear(){this.properties.clear(),this._updateStyle()}destroy(){this.styleElement&&(this.styleElement.remove(),this.styleElement=null),this.properties.clear()}}function Au(r){if(r.__esModule)return r;var e=r.default;if(typeof e=="function"){var t=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(n){var i=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:function(){return r[n]}})}),t}var Va={},Ca={},ja=function(r,e){return ja=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},ja(r,e)};function el(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");ja(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Ti=function(){return Ti=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},Ti.apply(this,arguments)};function tl(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t}function rl(r,e,t,n){var i=arguments.length,a=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(r,e,t,n);else for(var l=r.length-1;l>=0;l--)(s=r[l])&&(a=(i<3?s(a):i>3?s(e,t,a):s(e,t))||a);return i>3&&a&&Object.defineProperty(e,t,a),a}function nl(r,e){return function(t,n){e(t,n,r)}}function il(r,e,t,n,i,a){function s(S){if(S!==void 0&&typeof S!="function")throw new TypeError("Function expected");return S}for(var l=n.kind,c=l==="getter"?"get":l==="setter"?"set":"value",u=!e&&r?n.static?r:r.prototype:null,f=e||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),d,m=!1,_=t.length-1;_>=0;_--){var h={};for(var g in n)h[g]=g==="access"?{}:n[g];for(var g in n.access)h.access[g]=n.access[g];h.addInitializer=function(S){if(m)throw new TypeError("Cannot add initializers after decoration has completed");a.push(s(S||null))};var v=(0,t[_])(l==="accessor"?{get:f.get,set:f.set}:f[c],h);if(l==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(d=s(v.get))&&(f.get=d),(d=s(v.set))&&(f.set=d),(d=s(v.init))&&i.unshift(d)}else(d=s(v))&&(l==="field"?i.unshift(d):f[c]=d)}u&&Object.defineProperty(u,n.name,f),m=!0}function al(r,e,t){for(var n=arguments.length>2,i=0;i<e.length;i++)t=n?e[i].call(r,t):e[i].call(r);return n?t:void 0}function sl(r){return typeof r=="symbol"?r:"".concat(r)}function ol(r,e,t){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(r,"name",{configurable:!0,value:t?"".concat(t," ",e):e})}function ll(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function cl(r,e,t,n){function i(a){return a instanceof t?a:new t(function(s){s(a)})}return new(t||(t=Promise))(function(a,s){function l(f){try{u(n.next(f))}catch(d){s(d)}}function c(f){try{u(n.throw(f))}catch(d){s(d)}}function u(f){f.done?a(f.value):i(f.value).then(l,c)}u((n=n.apply(r,e||[])).next())})}function ul(r,e){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,s=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return s.next=l(0),s.throw=l(1),s.return=l(2),typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function l(u){return function(f){return c([u,f])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,u[0]&&(t=0)),t;)try{if(n=1,i&&(a=u[0]&2?i.return:u[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,u[1])).done)return a;switch(i=0,a&&(u=[u[0]&2,a.value]),u[0]){case 0:case 1:a=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!a||u[1]>a[0]&&u[1]<a[3])){t.label=u[1];break}if(u[0]===6&&t.label<a[1]){t.label=a[1],a=u;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(u);break}a[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(r,t)}catch(f){u=[6,f],i=0}finally{n=a=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}var ta=Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]};function dl(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&ta(e,r,t)}function Oi(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function es(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),i,a=[],s;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(l){s={error:l}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(s)throw s.error}}return a}function fl(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(es(arguments[e]));return r}function vl(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var n=Array(r),i=0,e=0;e<t;e++)for(var a=arguments[e],s=0,l=a.length;s<l;s++,i++)n[i]=a[s];return n}function hl(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,a;n<i;n++)(a||!(n in e))&&(a||(a=Array.prototype.slice.call(e,0,n)),a[n]=e[n]);return r.concat(a||Array.prototype.slice.call(e))}function wn(r){return this instanceof wn?(this.v=r,this):new wn(r)}function pl(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),i,a=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",s),i[Symbol.asyncIterator]=function(){return this},i;function s(_){return function(h){return Promise.resolve(h).then(_,d)}}function l(_,h){n[_]&&(i[_]=function(g){return new Promise(function(v,S){a.push([_,g,v,S])>1||c(_,g)})},h&&(i[_]=h(i[_])))}function c(_,h){try{u(n[_](h))}catch(g){m(a[0][3],g)}}function u(_){_.value instanceof wn?Promise.resolve(_.value.v).then(f,d):m(a[0][2],_)}function f(_){c("next",_)}function d(_){c("throw",_)}function m(_,h){_(h),a.shift(),a.length&&c(a[0][0],a[0][1])}}function _l(r){var e,t;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,a){e[i]=r[i]?function(s){return(t=!t)?{value:wn(r[i](s)),done:!1}:a?a(s):s}:a}}function gl(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof Oi=="function"?Oi(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(a){t[a]=r[a]&&function(s){return new Promise(function(l,c){s=r[a](s),i(l,c,s.done,s.value)})}}function i(a,s,l,c){Promise.resolve(c).then(function(u){a({value:u,done:l})},s)}}function ml(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}var Ru=Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e},Ga=function(r){return Ga=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},Ga(r)};function yl(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t=Ga(r),n=0;n<t.length;n++)t[n]!=="default"&&ta(e,r,t[n]);return Ru(e,r),e}function wl(r){return r&&r.__esModule?r:{default:r}}function bl(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)}function Sl(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t}function Dl(r,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof r=="function"?e===r:r.has(e)}function El(r,e,t){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var n,i;if(t){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=e[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=e[Symbol.dispose],t&&(i=n)}if(typeof n!="function")throw new TypeError("Object not disposable.");i&&(n=function(){try{i.call(this)}catch(a){return Promise.reject(a)}}),r.stack.push({value:e,dispose:n,async:t})}else t&&r.stack.push({async:!0});return e}var Tu=typeof SuppressedError=="function"?SuppressedError:function(r,e,t){var n=new Error(t);return n.name="SuppressedError",n.error=r,n.suppressed=e,n};function Cl(r){function e(a){r.error=r.hasError?new Tu(a,r.error,"An error was suppressed during disposal."):a,r.hasError=!0}var t,n=0;function i(){for(;t=r.stack.pop();)try{if(!t.async&&n===1)return n=0,r.stack.push(t),Promise.resolve().then(i);if(t.dispose){var a=t.dispose.call(t.value);if(t.async)return n|=2,Promise.resolve(a).then(i,function(s){return e(s),i()})}else n|=1}catch(s){e(s)}if(n===1)return r.hasError?Promise.reject(r.error):Promise.resolve();if(r.hasError)throw r.error}return i()}function Il(r,e){return typeof r=="string"&&/^\.\.?\//.test(r)?r.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(t,n,i,a,s){return n?e?".jsx":".js":i&&(!a||!s)?t:i+a+"."+s.toLowerCase()+"js"}):r}const Ou={__extends:el,__assign:Ti,__rest:tl,__decorate:rl,__param:nl,__esDecorate:il,__runInitializers:al,__propKey:sl,__setFunctionName:ol,__metadata:ll,__awaiter:cl,__generator:ul,__createBinding:ta,__exportStar:dl,__values:Oi,__read:es,__spread:fl,__spreadArrays:vl,__spreadArray:hl,__await:wn,__asyncGenerator:pl,__asyncDelegator:_l,__asyncValues:gl,__makeTemplateObject:ml,__importStar:yl,__importDefault:wl,__classPrivateFieldGet:bl,__classPrivateFieldSet:Sl,__classPrivateFieldIn:Dl,__addDisposableResource:El,__disposeResources:Cl,__rewriteRelativeImportExtension:Il},Nu=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:El,get __assign(){return Ti},__asyncDelegator:_l,__asyncGenerator:pl,__asyncValues:gl,__await:wn,__awaiter:cl,__classPrivateFieldGet:bl,__classPrivateFieldIn:Dl,__classPrivateFieldSet:Sl,__createBinding:ta,__decorate:rl,__disposeResources:Cl,__esDecorate:il,__exportStar:dl,__extends:el,__generator:ul,__importDefault:wl,__importStar:yl,__makeTemplateObject:ml,__metadata:ll,__param:nl,__propKey:sl,__read:es,__rest:tl,__rewriteRelativeImportExtension:Il,__runInitializers:al,__setFunctionName:ol,__spread:fl,__spreadArray:hl,__spreadArrays:vl,__values:Oi,default:Ou},Symbol.toStringTag,{value:"Module"})),Fu=Au(Nu);var qe={};Object.defineProperty(qe,"__esModule",{value:!0});qe.MODEL_NAMES=qe.DeviceModelId=void 0;var Xe;(function(r){r.ORIGINAL="original",r.ORIGINALV2="originalv2",r.ORIGINALMK2="original-mk2",r.ORIGINALMK2SCISSOR="original-mk2-scissor",r.MINI="mini",r.XL="xl",r.PEDAL="pedal",r.PLUS="plus",r.NEO="neo",r.STUDIO="studio",r.MODULE6="6-module",r.MODULE15="15-module",r.MODULE32="32-module",r.NETWORK_DOCK="network-dock"})(Xe||(qe.DeviceModelId=Xe={}));qe.MODEL_NAMES={[Xe.ORIGINAL]:"Stream Deck",[Xe.MINI]:"Stream Deck Mini",[Xe.XL]:"Stream Deck XL",[Xe.ORIGINALV2]:"Stream Deck",[Xe.ORIGINALMK2]:"Stream Deck MK.2",[Xe.ORIGINALMK2SCISSOR]:"Stream Deck MK.2 (Scissor)",[Xe.PLUS]:"Stream Deck +",[Xe.PEDAL]:"Stream Deck Pedal",[Xe.NEO]:"Stream Deck Neo",[Xe.STUDIO]:"Stream Deck Studio",[Xe.MODULE6]:"Stream Deck 6 Module",[Xe.MODULE15]:"Stream Deck 15 Module",[Xe.MODULE32]:"Stream Deck 32 Module",[Xe.NETWORK_DOCK]:"Stream Deck Network Dock"};var fi={},vi={},Ln={},xl={exports:{}};(function(r){var e=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function i(c,u,f){this.fn=c,this.context=u,this.once=f||!1}function a(c,u,f,d,m){if(typeof f!="function")throw new TypeError("The listener must be a function");var _=new i(f,d||c,m),h=t?t+u:u;return c._events[h]?c._events[h].fn?c._events[h]=[c._events[h],_]:c._events[h].push(_):(c._events[h]=_,c._eventsCount++),c}function s(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],f,d;if(this._eventsCount===0)return u;for(d in f=this._events)e.call(f,d)&&u.push(t?d.slice(1):d);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(f)):u},l.prototype.listeners=function(u){var f=t?t+u:u,d=this._events[f];if(!d)return[];if(d.fn)return[d.fn];for(var m=0,_=d.length,h=new Array(_);m<_;m++)h[m]=d[m].fn;return h},l.prototype.listenerCount=function(u){var f=t?t+u:u,d=this._events[f];return d?d.fn?1:d.length:0},l.prototype.emit=function(u,f,d,m,_,h){var g=t?t+u:u;if(!this._events[g])return!1;var v=this._events[g],S=arguments.length,N,I;if(v.fn){switch(v.once&&this.removeListener(u,v.fn,void 0,!0),S){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,f),!0;case 3:return v.fn.call(v.context,f,d),!0;case 4:return v.fn.call(v.context,f,d,m),!0;case 5:return v.fn.call(v.context,f,d,m,_),!0;case 6:return v.fn.call(v.context,f,d,m,_,h),!0}for(I=1,N=new Array(S-1);I<S;I++)N[I-1]=arguments[I];v.fn.apply(v.context,N)}else{var O=v.length,D;for(I=0;I<O;I++)switch(v[I].once&&this.removeListener(u,v[I].fn,void 0,!0),S){case 1:v[I].fn.call(v[I].context);break;case 2:v[I].fn.call(v[I].context,f);break;case 3:v[I].fn.call(v[I].context,f,d);break;case 4:v[I].fn.call(v[I].context,f,d,m);break;default:if(!N)for(D=1,N=new Array(S-1);D<S;D++)N[D-1]=arguments[D];v[I].fn.apply(v[I].context,N)}}return!0},l.prototype.on=function(u,f,d){return a(this,u,f,d,!1)},l.prototype.once=function(u,f,d){return a(this,u,f,d,!0)},l.prototype.removeListener=function(u,f,d,m){var _=t?t+u:u;if(!this._events[_])return this;if(!f)return s(this,_),this;var h=this._events[_];if(h.fn)h.fn===f&&(!m||h.once)&&(!d||h.context===d)&&s(this,_);else{for(var g=0,v=[],S=h.length;g<S;g++)(h[g].fn!==f||m&&!h[g].once||d&&h[g].context!==d)&&v.push(h[g]);v.length?this._events[_]=v.length===1?v[0]:v:s(this,_)}return this},l.prototype.removeAllListeners=function(u){var f;return u?(f=t?t+u:u,this._events[f]&&s(this,f)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=t,l.EventEmitter=l,r.exports=l})(xl);var kl=xl.exports,In={};Object.defineProperty(In,"__esModule",{value:!0});In.wrapBufferToPreparedBuffer=Bu;In.unwrapPreparedBufferToBuffer=Vu;function Bu(r,e,t,n){let i=t;return n&&(typeof Buffer<"u"?i=t.map(a=>Buffer.from(a).toString("base64")):i=t.map(a=>btoa(String.fromCharCode(...a)))),{if_you_change_this_you_will_break_everything:"This is a encoded form of the buffer, exactly as the Stream Deck expects it. Do not touch this object, or you can crash your stream deck",modelId:r,type:e,do_not_touch:i}}function Vu(r,e){const t=e;if(t.modelId!==r)throw new Error("Prepared buffer is for a different model!");return t.do_not_touch.map(n=>{if(typeof n=="string")return typeof Buffer<"u"?Buffer.from(n,"base64"):new Uint8Array(atob(n).split("").map(i=>i.charCodeAt(0)));if(n instanceof Uint8Array)return n;throw new Error("Prepared buffer is not a string or Uint8Array!")})}var Is;function br(){var i,a,s,l,c;if(Is)return Ln;Is=1,Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.StreamDeckBase=void 0;const r=kl,e=Ni(),t=In;class n extends r.EventEmitter{constructor(d,m,_){var h;super();Re(this,"device");Re(this,"deviceProperties");H(this,i);H(this,a);H(this,s);H(this,l);H(this,c);this.device=d,this.deviceProperties=_.deviceProperties,G(this,i,_.properties),G(this,a,_.buttonsLcd),G(this,s,_.lcdSegmentDisplay),G(this,l,_.inputService),G(this,c,_.encoderLed),(h=_.events)==null||h.listen((g,...v)=>this.emit(g,...v)),this.device.on("input",g=>p(this,l).handleInput(g)),this.device.on("error",g=>{this.emit("error",g)})}get CONTROLS(){return this.deviceProperties.CONTROLS}get MODEL(){return this.deviceProperties.MODEL}get PRODUCT_NAME(){return this.deviceProperties.PRODUCT_NAME}get HAS_NFC_READER(){return this.deviceProperties.HAS_NFC_READER}checkValidKeyIndex(d,m){const _=this.deviceProperties.CONTROLS.find(h=>h.type==="button"&&h.index===d);if(!_)throw new TypeError("Expected a valid keyIndex");if(m&&_.feedbackType!==m)throw new TypeError("Expected a keyIndex with expected feedbackType")}calculateFillPanelDimensions(d){return p(this,a).calculateFillPanelDimensions(d)}async close(){return this.device.close()}async getHidDeviceInfo(){return this.device.getDeviceInfo()}async setBrightness(d){return p(this,i).setBrightness(d)}async resetToLogo(){return p(this,i).resetToLogo()}async getFirmwareVersion(){return p(this,i).getFirmwareVersion()}async getAllFirmwareVersions(){return p(this,i).getAllFirmwareVersions()}async getSerialNumber(){return p(this,i).getSerialNumber()}async sendPreparedBuffer(d){const m=(0,t.unwrapPreparedBufferToBuffer)(this.deviceProperties.MODEL,d);await this.device.sendReports(m)}async fillKeyColor(d,m,_,h){this.checkValidKeyIndex(d,null),await p(this,a).fillKeyColor(d,m,_,h)}async fillKeyBuffer(d,m,_){this.checkValidKeyIndex(d,"lcd"),await p(this,a).fillKeyBuffer(d,m,_)}async prepareFillKeyBuffer(d,m,_,h){return p(this,a).prepareFillKeyBuffer(d,m,_,h)}async fillPanelBuffer(d,m){await p(this,a).fillPanelBuffer(d,m)}async prepareFillPanelBuffer(d,m,_){return p(this,a).prepareFillPanelBuffer(d,m,_)}async clearKey(d){this.checkValidKeyIndex(d,null),await p(this,a).clearKey(d)}async clearPanel(){const d=[];d.push(p(this,a).clearPanel()),p(this,s)&&d.push(p(this,s).clearAllLcdSegments()),await Promise.all(d)}async fillLcd(...d){if(!p(this,s))throw new Error("Not supported for this model");return p(this,s).fillLcd(...d)}async fillLcdRegion(...d){if(!p(this,s))throw new Error("Not supported for this model");return p(this,s).fillLcdRegion(...d)}async prepareFillLcdRegion(...d){if(!p(this,s))throw new Error("Not supported for this model");return p(this,s).prepareFillLcdRegion(...d)}async clearLcdSegment(...d){if(!p(this,s))throw new Error("Not supported for this model");return p(this,s).clearLcdSegment(...d)}async setEncoderColor(...d){if(!p(this,c))throw new Error("Not supported for this model");return p(this,c).setEncoderColor(...d)}async setEncoderRingSingleColor(...d){if(!p(this,c))throw new Error("Not supported for this model");return p(this,c).setEncoderRingSingleColor(...d)}async setEncoderRingColors(...d){if(!p(this,c))throw new Error("Not supported for this model");return p(this,c).setEncoderRingColors(...d)}async getChildDeviceInfo(){const d=await this.device.getChildDeviceInfo();if(!d||d.vendorId!==e.VENDOR_ID)return null;const m=e.DEVICE_MODELS.find(_=>_.productIds.includes(d.productId));return m?{...d,model:m.id}:null}}return i=new WeakMap,a=new WeakMap,s=new WeakMap,l=new WeakMap,c=new WeakMap,Ln.StreamDeckBase=n,Ln}var ra={};Object.defineProperty(ra,"__esModule",{value:!0});ra.Gen1PropertiesService=void 0;var $t;class ju{constructor(e){H(this,$t);G(this,$t,e)}async setBrightness(e){if(e<0||e>100)throw new RangeError("Expected brightness percentage to be between 0 and 100");const t=new Uint8Array([5,85,170,209,1,e,0,0,0,0,0,0,0,0,0,0,0]);await p(this,$t).sendFeatureReport(t)}async resetToLogo(){const e=new Uint8Array([11,99,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);await p(this,$t).sendFeatureReport(e)}async getFirmwareVersion(){let e;try{e=await p(this,$t).getFeatureReport(4,32)}catch{e=await p(this,$t).getFeatureReport(4,17)}const t=e.indexOf(0,5);return new TextDecoder("ascii").decode(e.subarray(5,t===-1?void 0:t))}async getAllFirmwareVersions(){return{}}async getSerialNumber(){let e;try{e=await p(this,$t).getFeatureReport(3,32)}catch{e=await p(this,$t).getFeatureReport(3,17)}return new TextDecoder("ascii").decode(e.subarray(5,17))}}$t=new WeakMap;ra.Gen1PropertiesService=ju;var ii={};Object.defineProperty(ii,"__esModule",{value:!0});ii.DefaultButtonsLcdService=void 0;const xs=In;var Hn,zn,Jt,Je;class Gu{constructor(e,t,n,i){H(this,Hn);H(this,zn);H(this,Jt);H(this,Je);G(this,Hn,e),G(this,zn,t),G(this,Jt,n),G(this,Je,i)}getLcdButtonControls(){return p(this,Je).CONTROLS.filter(e=>e.type==="button"&&e.feedbackType==="lcd")}calculateLcdGridSpan(e){if(e.length===0)return null;const t=e.map(i=>i.row),n=e.map(i=>i.column);return{minRow:Math.min(...t),maxRow:Math.max(...t),minCol:Math.min(...n),maxCol:Math.max(...n)}}calculateDimensionsFromGridSpan(e,t,n){if(n)throw new Error("Not implemented");{const i=e.maxRow-e.minRow+1;return{width:(e.maxCol-e.minCol+1)*t.width,height:i*t.height}}}calculateFillPanelDimensions(e){const t=this.getLcdButtonControls(),n=this.calculateLcdGridSpan(t);return!n||t.length===0?null:this.calculateDimensionsFromGridSpan(n,t[0].pixelSize,e==null?void 0:e.withPadding)}async clearPanel(){const e=[];if(p(this,Je).FULLSCREEN_PANELS>0)for(let t=0;t<p(this,Je).FULLSCREEN_PANELS;t++)e.push(p(this,Jt).sendFeatureReport(new Uint8Array([3,5,t,0,0,0])));else for(const t of p(this,Je).CONTROLS)if(t.type==="button")switch(t.feedbackType){case"rgb":e.push(this.sendKeyRgb(t.hidIndex,0,0,0));break;case"lcd":if(p(this,Je).SUPPORTS_RGB_KEY_FILL)e.push(this.sendKeyRgb(t.hidIndex,0,0,0));else{const n=new Uint8Array(t.pixelSize.width*t.pixelSize.height*3);e.push(this.fillImageRangeControl(t,n,{format:"rgb",offset:0,stride:t.pixelSize.width*3}))}break}await Promise.all(e)}async clearKey(e){const t=p(this,Je).CONTROLS.find(n=>n.type==="button"&&n.index===e);if(!t||t.feedbackType==="none")throw new TypeError("Expected a valid keyIndex");if(p(this,Je).SUPPORTS_RGB_KEY_FILL||t.feedbackType==="rgb")await this.sendKeyRgb(e,0,0,0);else{const n=new Uint8Array(t.pixelSize.width*t.pixelSize.height*3);await this.fillImageRangeControl(t,n,{format:"rgb",offset:0,stride:t.pixelSize.width*3})}}async fillKeyColor(e,t,n,i){this.checkRGBValue(t),this.checkRGBValue(n),this.checkRGBValue(i);const a=p(this,Je).CONTROLS.find(s=>s.type==="button"&&s.index===e);if(!a||a.feedbackType==="none")throw new TypeError("Expected a valid keyIndex");if(p(this,Je).SUPPORTS_RGB_KEY_FILL||a.feedbackType==="rgb")await this.sendKeyRgb(e,t,n,i);else{const s=a.pixelSize.width*a.pixelSize.height,l=new Uint8Array(s*4),c=new DataView(l.buffer,l.byteOffset,l.byteLength);c.setUint8(0,t),c.setUint8(1,n),c.setUint8(2,i),c.setUint8(3,255);const u=c.getUint32(0);for(let f=1;f<s;f++)c.setUint32(f*4,u);await this.fillImageRangeControl(a,l,{format:"rgba",offset:0,stride:a.pixelSize.width*4})}}async fillKeyBuffer(e,t,n){const i=await this.prepareFillKeyBufferInner(e,t,n);await p(this,Jt).sendReports(i)}async prepareFillKeyBufferInner(e,t,n){const i=(n==null?void 0:n.format)??"rgb";this.checkSourceFormat(i);const a=p(this,Je).CONTROLS.find(l=>l.type==="button"&&l.index===e);if(!a||a.feedbackType==="none")throw new TypeError("Expected a valid keyIndex");if(a.feedbackType!=="lcd")throw new TypeError(`keyIndex ${a.index} does not support lcd feedback`);const s=a.pixelSize.width*a.pixelSize.height*i.length;if(t.length!==s)throw new RangeError(`Expected image buffer of length ${s}, got length ${t.length}`);return this.prepareFillImageRangeControl(a,t,{format:i,offset:0,stride:a.pixelSize.width*i.length})}async prepareFillKeyBuffer(e,t,n,i){const a=await this.prepareFillKeyBufferInner(e,t,n);return(0,xs.wrapBufferToPreparedBuffer)(p(this,Je).MODEL,"fill-key",a,i??!1)}async fillPanelBuffer(e,t){const n=await this.prepareFillPanelBufferInner(e,t);await p(this,Jt).sendReports(n)}async prepareFillPanelBufferInner(e,t){const n=(t==null?void 0:t.format)??"rgb";this.checkSourceFormat(n);const i=this.getLcdButtonControls(),a=this.calculateLcdGridSpan(i);if(!a||i.length===0)throw new Error("Panel does not support being filled");const s=this.calculateDimensionsFromGridSpan(a,i[0].pixelSize,t==null?void 0:t.withPadding),l=n.length*s.width*s.height;if(e.length!==l)throw new RangeError(`Expected image buffer of length ${l}, got length ${e.length}`);const c=s.width*n.length,u=[];for(const d of i){const m=d.row-a.minRow,_=d.column-a.minCol,h=d.pixelSize.width*n.length,g=c*m*d.pixelSize.height,v=_*h;u.push(this.prepareFillImageRangeControl(d,e,{format:n,offset:g+v,stride:c}))}return(await Promise.all(u)).flat()}async prepareFillPanelBuffer(e,t,n){const i=await this.prepareFillPanelBufferInner(e,t);return(0,xs.wrapBufferToPreparedBuffer)(p(this,Je).MODEL,"fill-panel",i,n??!1)}async sendKeyRgb(e,t,n,i){await p(this,Jt).sendFeatureReport(new Uint8Array([3,6,e,t,n,i]))}async fillImageRangeControl(e,t,n){const i=await this.prepareFillImageRangeControl(e,t,n);await p(this,Jt).sendReports(i)}async prepareFillImageRangeControl(e,t,n){if(e.feedbackType!=="lcd")throw new TypeError(`keyIndex ${e.index} does not support lcd feedback`);const i=await p(this,zn).convertPixelBuffer(t,n,e.pixelSize);return p(this,Hn).generateFillImageWrites({keyIndex:e.hidIndex},i)}checkRGBValue(e){if(e<0||e>255)throw new TypeError("Expected a valid color RGB value 0 - 255")}checkSourceFormat(e){switch(e){case"rgb":case"rgba":case"bgr":case"bgra":break;default:{const t=e;throw new TypeError(`Expected a known color format not "${t}"`)}}}}Hn=new WeakMap,zn=new WeakMap,Jt=new WeakMap,Je=new WeakMap;ii.DefaultButtonsLcdService=Gu;var na={},lr={},ks;function Sr(){if(ks)return lr;ks=1,Object.defineProperty(lr,"__esModule",{value:!0}),lr.BMP_HEADER_LENGTH=void 0,lr.transformImageBuffer=r,lr.writeBMPHeader=e,lr.uint8ArrayToDataView=t;function r(n,i,a,s,l,c){const u=t(n),f=new Uint8Array(s+l*c*a.colorMode.length),d=t(f),m=i.format.substring(0,3)!==a.colorMode.substring(0,3);for(let _=0;_<c;_++){const h=s+l*a.colorMode.length*_;for(let g=0;g<l;g++){let v=a.xFlip?l-g-1:g,S=a.yFlip?c-_-1:_;if(a.rotate){const j=v;v=S,S=j}const N=S*i.stride+i.offset+v*i.format.length,I=u.getUint8(N),O=u.getUint8(N+1),D=u.getUint8(N+2),R=h+g*a.colorMode.length;m?(d.setUint8(R,D),d.setUint8(R+1,O),d.setUint8(R+2,I)):(d.setUint8(R,I),d.setUint8(R+1,O),d.setUint8(R+2,D)),a.colorMode.length===4&&d.setUint8(R+3,255)}}return f}lr.BMP_HEADER_LENGTH=54;function e(n,i,a,s,l){const c=t(n);c.setUint8(0,66),c.setUint8(1,77),c.setUint32(2,s+54,!0),c.setInt16(6,0,!0),c.setInt16(8,0,!0),c.setUint32(10,54,!0),c.setUint32(14,40,!0),c.setInt32(18,i,!0),c.setInt32(22,a,!0),c.setInt16(26,1,!0),c.setInt16(28,24,!0),c.setInt32(30,0,!0),c.setInt32(34,s,!0),c.setInt32(38,l,!0),c.setInt32(42,l,!0),c.setInt32(46,0,!0),c.setInt32(50,0,!0)}function t(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}return lr}Object.defineProperty(na,"__esModule",{value:!0});na.BitmapButtonLcdImagePacker=void 0;const hi=Sr();var qn,Wn;class $u{constructor(e,t){H(this,qn);H(this,Wn);G(this,qn,e),G(this,Wn,t)}async convertPixelBuffer(e,t,n){const i=(0,hi.transformImageBuffer)(e,t,p(this,qn),hi.BMP_HEADER_LENGTH,n.width,n.height);return(0,hi.writeBMPHeader)(i,n.width,n.height,i.length-hi.BMP_HEADER_LENGTH,p(this,Wn)),i}}qn=new WeakMap,Wn=new WeakMap;na.BitmapButtonLcdImagePacker=$u;var Hr={};Object.defineProperty(Hr,"__esModule",{value:!0});Hr.CallbackHook=void 0;var ln;class Ku{constructor(){H(this,ln,null)}emit(e,...t){if(!p(this,ln))throw new Error("No listener setup");p(this,ln).call(this,e,...t)}listen(e){G(this,ln,e)}}ln=new WeakMap;Hr.CallbackHook=Ku;var xn={};Object.defineProperty(xn,"__esModule",{value:!0});xn.ButtonOnlyInputService=void 0;var cn,un;class Uu{constructor(e,t){Re(this,"deviceProperties");H(this,cn);H(this,un);this.deviceProperties=e,G(this,un,t);const n=this.deviceProperties.CONTROLS.filter(i=>i.type==="button").map(i=>i.index);G(this,cn,new Array(Math.max(-1,...n)+1).fill(!1))}handleInput(e){const t=this.deviceProperties.KEY_DATA_OFFSET||0;for(const n of this.deviceProperties.CONTROLS){if(n.type!=="button")continue;const i=!!e[t+n.hidIndex];i!==p(this,cn)[n.index]&&(p(this,cn)[n.index]=i,i?p(this,un).emit("down",n):p(this,un).emit("up",n))}}}cn=new WeakMap,un=new WeakMap;xn.ButtonOnlyInputService=Uu;var Ms;function Ml(){if(Ms)return vi;Ms=1,Object.defineProperty(vi,"__esModule",{value:!0}),vi.StreamDeckGen1Factory=l;const r=br(),e=ra,t=ii,n=na,i=Hr,a=xn;function s(c){return{...c,KEY_DATA_OFFSET:0,HAS_NFC_READER:!1,SUPPORTS_CHILD_DEVICES:!1}}function l(c,u,f,d,m,_){const h=s(f),g=new i.CallbackHook;return new r.StreamDeckBase(c,u,{deviceProperties:h,events:g,properties:new e.Gen1PropertiesService(c),buttonsLcd:new t.DefaultButtonsLcdService(d,new n.BitmapButtonLcdImagePacker(m,_),c,h),lcdSegmentDisplay:null,inputService:new a.ButtonOnlyInputService(h,g),encoderLed:null})}return vi}var zt={},vt={};Object.defineProperty(vt,"__esModule",{value:!0});vt.StreamdeckNeoLcdImageHeaderGenerator=vt.StreamdeckPlusLcdImageHeaderGenerator=vt.StreamdeckGen2ImageHeaderGenerator=vt.StreamdeckGen1ImageHeaderGenerator=void 0;const ia=Sr();class Hu{getFillImageCommandHeaderLength(){return 16}writeFillImageCommandHeader(e,t,n,i,a){const s=(0,ia.uint8ArrayToDataView)(e);s.setUint8(0,2),s.setUint8(1,1),s.setUint16(2,n,!0),s.setUint8(4,i?1:0),s.setUint8(5,t.keyIndex+1)}}vt.StreamdeckGen1ImageHeaderGenerator=Hu;class zu{getFillImageCommandHeaderLength(){return 8}writeFillImageCommandHeader(e,t,n,i,a){const s=(0,ia.uint8ArrayToDataView)(e);s.setUint8(0,2),s.setUint8(1,7),s.setUint8(2,t.keyIndex),s.setUint8(3,i?1:0),s.setUint16(4,a,!0),s.setUint16(6,n++,!0)}}vt.StreamdeckGen2ImageHeaderGenerator=zu;class qu{getFillImageCommandHeaderLength(){return 16}writeFillImageCommandHeader(e,t,n,i,a){const s=(0,ia.uint8ArrayToDataView)(e);s.setUint8(0,2),s.setUint8(1,12),s.setUint16(2,t.x,!0),s.setUint16(4,t.y,!0),s.setUint16(6,t.width,!0),s.setUint16(8,t.height,!0),s.setUint8(10,i?1:0),s.setUint16(11,n,!0),s.setUint16(13,a,!0)}}vt.StreamdeckPlusLcdImageHeaderGenerator=qu;class Wu{getFillImageCommandHeaderLength(){return 8}writeFillImageCommandHeader(e,t,n,i,a){const s=(0,ia.uint8ArrayToDataView)(e);s.setUint8(0,2),s.setUint8(1,11),s.setUint8(2,0),s.setUint8(3,i?1:0),s.setUint16(4,a,!0),s.setUint16(6,n,!0)}}vt.StreamdeckNeoLcdImageHeaderGenerator=Wu;Object.defineProperty(zt,"__esModule",{value:!0});zt.StreamdeckDefaultImageWriter=zt.StreamdeckOriginalImageWriter=void 0;const Yu=vt;class Xu{constructor(){Re(this,"headerGenerator",new Yu.StreamdeckGen1ImageHeaderGenerator)}generateFillImageWrites(e,t){const i=this.headerGenerator.getFillImageCommandHeaderLength(),a=t.length/2,s=new Uint8Array(8191);this.headerGenerator.writeFillImageCommandHeader(s,e,1,!1,a),s.set(t.subarray(0,a),i);const l=new Uint8Array(8191);return this.headerGenerator.writeFillImageCommandHeader(l,e,2,!0,a),l.set(t.subarray(a),i),[s,l]}}zt.StreamdeckOriginalImageWriter=Xu;class Ju{constructor(e){Re(this,"headerGenerator");this.headerGenerator=e}generateFillImageWrites(e,t){const i=this.headerGenerator.getFillImageCommandHeaderLength(),a=1024-i,s=[];let l=t.length;for(let c=0;l>0;c++){const u=new Uint8Array(1024),f=Math.min(l,a);this.headerGenerator.writeFillImageCommandHeader(u,e,c,l<=a,f);const d=t.length-l;l-=f,u.set(t.subarray(d,d+f),i),s.push(u)}return s}}zt.StreamdeckDefaultImageWriter=Ju;var Mt={};Object.defineProperty(Mt,"__esModule",{value:!0});Mt.generateButtonsGrid=Zu;Mt.freezeDefinitions=ed;function Zu(r,e,t,n=!1,i=0){const a=[];for(let s=0;s<e;s++)for(let l=0;l<r;l++){const c=s*r+l,u=n?Qu(r,c):c;a.push({type:"button",row:s,column:l+i,index:c,hidIndex:u,feedbackType:"lcd",pixelSize:t})}return a}function Qu(r,e){const t=(r-1)/2,n=(e%r-t)*-t;return e+n}function ed(r){return Object.freeze(r.map(e=>Object.freeze(e)))}var Ps;function td(){if(Ps)return fi;Ps=1,Object.defineProperty(fi,"__esModule",{value:!0}),fi.StreamDeckOriginalFactory=a;const r=Ml(),e=qe,t=zt,n=Mt,i={MODEL:e.DeviceModelId.ORIGINAL,PRODUCT_NAME:e.MODEL_NAMES[e.DeviceModelId.ORIGINAL],SUPPORTS_RGB_KEY_FILL:!1,CONTROLS:(0,n.freezeDefinitions)((0,n.generateButtonsGrid)(5,3,{width:72,height:72},!0)),KEY_SPACING_HORIZONTAL:25,KEY_SPACING_VERTICAL:25,FULLSCREEN_PANELS:0};function a(s,l){return(0,r.StreamDeckGen1Factory)(s,l,i,new t.StreamdeckOriginalImageWriter,{colorMode:"bgr",xFlip:!0},3780)}return fi}var pi={},Ls;function rd(){if(Ls)return pi;Ls=1,Object.defineProperty(pi,"__esModule",{value:!0}),pi.StreamDeck6KeyFactory=s;const r=Ml(),e=qe,t=Mt,n=zt,i=vt,a={SUPPORTS_RGB_KEY_FILL:!1,CONTROLS:(0,t.freezeDefinitions)((0,t.generateButtonsGrid)(3,2,{width:80,height:80})),KEY_SPACING_HORIZONTAL:28,KEY_SPACING_VERTICAL:28,FULLSCREEN_PANELS:0};function s(l,c,u,f){const d={...a,MODEL:l,PRODUCT_NAME:e.MODEL_NAMES[l]};return(0,r.StreamDeckGen1Factory)(c,u,d,new n.StreamdeckDefaultImageWriter(new i.StreamdeckGen1ImageHeaderGenerator),{colorMode:"bgr",rotate:!0,yFlip:!0},2835)}return pi}var _i={},zr={},ai={};Object.defineProperty(ai,"__esModule",{value:!0});ai.Gen2PropertiesService=void 0;class nd{constructor(e){Re(this,"device");this.device=e}async setBrightness(e){if(e<0||e>100)throw new RangeError("Expected brightness percentage to be between 0 and 100");const t=new Uint8Array([3,8,e,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);await this.device.sendFeatureReport(t)}async resetToLogo(){const e=new Uint8Array([3,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);await this.device.sendFeatureReport(e)}async getFirmwareVersion(){const e=await this.device.getFeatureReport(5,32),t=e[1]+2;return new TextDecoder("ascii").decode(e.subarray(6,t))}async getAllFirmwareVersions(){return{AP2:await this.getFirmwareVersion()}}async getSerialNumber(){const e=await this.device.getFeatureReport(6,32),t=e[1]+2;return new TextDecoder("ascii").decode(e.subarray(2,t))}}ai.Gen2PropertiesService=nd;var aa={};Object.defineProperty(aa,"__esModule",{value:!0});aa.JpegButtonLcdImagePacker=void 0;const id=Sr();var Yn,dn;class ad{constructor(e,t){H(this,Yn);H(this,dn);G(this,Yn,e),G(this,dn,t)}async convertPixelBuffer(e,t,n){const i=(0,id.transformImageBuffer)(e,t,{colorMode:"rgba",xFlip:p(this,dn),yFlip:p(this,dn)},0,n.width,n.height);return p(this,Yn).call(this,i,n.width,n.height)}}Yn=new WeakMap,dn=new WeakMap;aa.JpegButtonLcdImagePacker=ad;var sa={};Object.defineProperty(sa,"__esModule",{value:!0});sa.Gen2InputService=void 0;const sd=xn,od=Sr();var Rt,Lr,fn,Xn,wr,Pl,Ll,Al;class ld extends sd.ButtonOnlyInputService{constructor(t,n){super(t,n);H(this,wr);H(this,Rt);H(this,Lr);H(this,fn);H(this,Xn);G(this,Rt,n),G(this,Lr,t.CONTROLS.filter(a=>a.type==="encoder"));const i=Math.max(-1,...p(this,Lr).map(a=>a.index));G(this,fn,new Array(i+1).fill(!1)),G(this,Xn,t.CONTROLS.filter(a=>a.type==="lcd-segment"))}handleInput(t){switch(t[0]){case 0:super.handleInput(t);break;case 2:Me(this,wr,Pl).call(this,t);break;case 3:Me(this,wr,Ll).call(this,t);break;case 4:Me(this,wr,Al).call(this,t);break}}}Rt=new WeakMap,Lr=new WeakMap,fn=new WeakMap,Xn=new WeakMap,wr=new WeakSet,Pl=function(t){const n=p(this,Xn).find(s=>s.id===0);if(!n)return;const i=(0,od.uint8ArrayToDataView)(t),a={x:i.getUint16(5,!0),y:i.getUint16(7,!0)};switch(t[3]){case 1:p(this,Rt).emit("lcdShortPress",n,a);break;case 2:p(this,Rt).emit("lcdLongPress",n,a);break;case 3:{const s={x:i.getUint16(9,!0),y:i.getUint16(11,!0)};p(this,Rt).emit("lcdSwipe",n,a,s);break}}},Ll=function(t){switch(t[3]){case 0:for(const n of p(this,Lr)){const i=!!t[4+n.hidIndex];i!==p(this,fn)[n.index]&&(p(this,fn)[n.index]=i,i?p(this,Rt).emit("down",n):p(this,Rt).emit("up",n))}break;case 1:for(const n of p(this,Lr)){const a=new Int8Array(t.buffer,t.byteOffset,t.byteLength)[4+n.hidIndex];a!==0&&p(this,Rt).emit("rotate",n,a)}break}},Al=function(t){if(!this.deviceProperties.HAS_NFC_READER)return;const n=t[1]+t[2]*256,i=new TextDecoder("ascii").decode(t.subarray(3,3+n));p(this,Rt).emit("nfcRead",i)};sa.Gen2InputService=ld;var oa={};Object.defineProperty(oa,"__esModule",{value:!0});oa.EncoderLedService=void 0;var Ar,vr;class cd{constructor(e,t){H(this,Ar);H(this,vr);G(this,Ar,e),G(this,vr,t.filter(n=>n.type==="encoder"))}async clearAll(){const e=[];for(const t of p(this,vr))t.hasLed&&e.push(this.setEncoderColor(t.index,0,0,0)),t.ledRingSteps>0&&e.push(this.setEncoderRingSingleColor(t.index,0,0,0));await Promise.all(e)}async setEncoderColor(e,t,n,i){const a=p(this,vr).find(l=>l.index===e);if(!a)throw new Error(`Invalid encoder index ${e}`);if(!a.hasLed)throw new Error("Encoder does not have an LED");const s=new Uint8Array(1024);s[0]=2,s[1]=16,s[2]=e,s[3]=t,s[4]=n,s[5]=i,await p(this,Ar).sendReports([s])}async setEncoderRingSingleColor(e,t,n,i){const a=p(this,vr).find(l=>l.index===e);if(!a)throw new Error(`Invalid encoder index ${e}`);if(a.ledRingSteps<=0)throw new Error("Encoder does not have an LED ring");const s=new Uint8Array(1024);s[0]=2,s[1]=15,s[2]=e;for(let l=0;l<a.ledRingSteps;l++){const c=3+l*3;s[c]=t,s[c+1]=n,s[c+2]=i}await p(this,Ar).sendReports([s])}async setEncoderRingColors(e,t){const n=p(this,vr).find(s=>s.index===e);if(!n)throw new Error(`Invalid encoder index ${e}`);if(n.ledRingSteps<=0)throw new Error("Encoder does not have an LED ring");if(t.length!==n.ledRingSteps*3)throw new Error("Invalid colors length");let i=t instanceof Uint8Array?t:new Uint8Array(t);if(n.lcdRingOffset){const s=i;i=new Uint8Array(s.length),i.set(s.slice(n.lcdRingOffset*3),0),i.set(s.slice(0,n.lcdRingOffset*3),n.lcdRingOffset*3)}const a=new Uint8Array(1024);a[0]=2,a[1]=15,a[2]=e,a.set(i,3),await p(this,Ar).sendReports([a])}}Ar=new WeakMap,vr=new WeakMap;oa.EncoderLedService=cd;Object.defineProperty(zr,"__esModule",{value:!0});zr.createBaseGen2Properties=yd;const ud=zt,dd=vt,fd=ii,vd=Hr,hd=ai,pd=aa,_d=sa,gd=oa;function md(r){return{...r,KEY_DATA_OFFSET:3}}function yd(r,e,t,n,i){const a=md(t),s=new vd.CallbackHook;return{deviceProperties:a,events:s,properties:n??new hd.Gen2PropertiesService(r),buttonsLcd:new fd.DefaultButtonsLcdService(new ud.StreamdeckDefaultImageWriter(new dd.StreamdeckGen2ImageHeaderGenerator),new pd.JpegButtonLcdImagePacker(e.encodeJPEG,!i),r,a),lcdSegmentDisplay:null,inputService:new _d.Gen2InputService(a,s),encoderLed:new gd.EncoderLedService(r,t.CONTROLS)}}var As;function wd(){if(As)return _i;As=1,Object.defineProperty(_i,"__esModule",{value:!0}),_i.StreamDeck32KeyFactory=a;const r=br(),e=zr,t=qe,n=Mt,i={SUPPORTS_RGB_KEY_FILL:!1,CONTROLS:(0,n.freezeDefinitions)((0,n.generateButtonsGrid)(8,4,{width:96,height:96})),KEY_SPACING_HORIZONTAL:32,KEY_SPACING_VERTICAL:39,FULLSCREEN_PANELS:0,HAS_NFC_READER:!1,SUPPORTS_CHILD_DEVICES:!1};function a(s,l,c,u){const f={...i,MODEL:s,PRODUCT_NAME:t.MODEL_NAMES[s]},d=(0,e.createBaseGen2Properties)(l,c,f,null);return new r.StreamDeckBase(l,c,d)}return _i}var gi={},Rs;function bd(){if(Rs)return gi;Rs=1,Object.defineProperty(gi,"__esModule",{value:!0}),gi.StreamDeck15KeyFactory=a;const r=br(),e=zr,t=qe,n=Mt,i={SUPPORTS_RGB_KEY_FILL:!1,CONTROLS:(0,n.freezeDefinitions)((0,n.generateButtonsGrid)(5,3,{width:72,height:72})),KEY_SPACING_HORIZONTAL:25,KEY_SPACING_VERTICAL:25,FULLSCREEN_PANELS:0,HAS_NFC_READER:!1,SUPPORTS_CHILD_DEVICES:!1};function a(s,l,c,u){const f={...i,MODEL:s,PRODUCT_NAME:t.MODEL_NAMES[s]},d=(0,e.createBaseGen2Properties)(l,c,f,null);return new r.StreamDeckBase(l,c,d)}return gi}var mi={},la={};Object.defineProperty(la,"__esModule",{value:!0});la.StreamDeckPlusLcdService=void 0;const Sd=vt,Dd=zt,Ed=Sr(),Cd=In,Id=qe;var Jn,Rr,Zt,$i;class xd{constructor(e,t,n){H(this,Jn);H(this,Rr);H(this,Zt);H(this,$i,new Dd.StreamdeckDefaultImageWriter(new Sd.StreamdeckPlusLcdImageHeaderGenerator));G(this,Jn,e),G(this,Rr,t),G(this,Zt,n)}async fillLcd(e,t,n){const i=p(this,Zt).find(s=>s.id===e);if(!i)throw new Error(`Invalid lcd segment index ${e}`);const a=await this.prepareFillControlRegion(i,0,0,t,{format:n.format,width:i.pixelSize.width,height:i.pixelSize.height});await p(this,Rr).sendReports(a)}async fillLcdRegion(e,t,n,i,a){const s=p(this,Zt).find(c=>c.id===e);if(!s)throw new Error(`Invalid lcd segment index ${e}`);const l=await this.prepareFillControlRegion(s,t,n,i,a);await p(this,Rr).sendReports(l)}async prepareFillLcdRegion(e,t,n,i,a,s){const l=p(this,Zt).find(u=>u.id===e);if(!l)throw new Error(`Invalid lcd segment index ${e}`);const c=await this.prepareFillControlRegion(l,t,n,i,a);return(0,Cd.wrapBufferToPreparedBuffer)(Id.DeviceModelId.PLUS,"fill-lcd-region",c,s??!1)}async clearLcdSegment(e){const t=p(this,Zt).find(a=>a.id===e);if(!t)throw new Error(`Invalid lcd segment index ${e}`);const n=new Uint8Array(t.pixelSize.width*t.pixelSize.height*4),i=await this.prepareFillControlRegion(t,0,0,n,{format:"rgba",width:t.pixelSize.width,height:t.pixelSize.height});await p(this,Rr).sendReports(i)}async clearAllLcdSegments(){const e=[];for(const t of p(this,Zt))e.push(this.clearLcdSegment(t.id));await Promise.all(e)}async prepareFillControlRegion(e,t,n,i,a){const s=e.pixelSize;if(t<0||t+a.width>s.width)throw new TypeError("Image will not fit within the lcd segment");if(n<0||n+a.height>s.height)throw new TypeError("Image will not fit within the lcd segment");const l=a.width*a.height*a.format.length;if(i.length!==l)throw new RangeError(`Expected image buffer of length ${l}, got length ${i.length}`);const c=await this.convertFillLcdBuffer(i,a);return p(this,$i).generateFillImageWrites({...a,x:t,y:n},c)}async convertFillLcdBuffer(e,t){const n={format:t.format,offset:0,stride:t.width*t.format.length},i=(0,Ed.transformImageBuffer)(e,n,{colorMode:"rgba"},0,t.width,t.height);return p(this,Jn).call(this,i,t.width,t.height)}}Jn=new WeakMap,Rr=new WeakMap,Zt=new WeakMap,$i=new WeakMap;la.StreamDeckPlusLcdService=xd;var Ts;function kd(){if(Ts)return mi;Ts=1,Object.defineProperty(mi,"__esModule",{value:!0}),mi.StreamDeckPlusFactory=c;const r=br(),e=zr,t=qe,n=Mt,i=la,a=(0,n.generateButtonsGrid)(4,2,{width:120,height:120});a.push({type:"lcd-segment",row:2,column:0,columnSpan:4,rowSpan:1,id:0,pixelSize:Object.freeze({width:800,height:100}),drawRegions:!0},{type:"encoder",row:3,column:0,index:0,hidIndex:0,hasLed:!1,ledRingSteps:0},{type:"encoder",row:3,column:1,index:1,hidIndex:1,hasLed:!1,ledRingSteps:0},{type:"encoder",row:3,column:2,index:2,hidIndex:2,hasLed:!1,ledRingSteps:0},{type:"encoder",row:3,column:3,index:3,hidIndex:3,hasLed:!1,ledRingSteps:0});const s={MODEL:t.DeviceModelId.PLUS,PRODUCT_NAME:t.MODEL_NAMES[t.DeviceModelId.PLUS],SUPPORTS_RGB_KEY_FILL:!0,CONTROLS:(0,n.freezeDefinitions)(a),KEY_SPACING_HORIZONTAL:99,KEY_SPACING_VERTICAL:40,FULLSCREEN_PANELS:0,HAS_NFC_READER:!1,SUPPORTS_CHILD_DEVICES:!1},l=s.CONTROLS.filter(u=>u.type==="lcd-segment");function c(u,f){const d=(0,e.createBaseGen2Properties)(u,f,s,null,!0);return d.lcdSegmentDisplay=new i.StreamDeckPlusLcdService(f.encodeJPEG,u,l),new r.StreamDeckBase(u,f,d)}return mi}var yi={},ca={};Object.defineProperty(ca,"__esModule",{value:!0});ca.PedalPropertiesService=void 0;var vn;class Md{constructor(e){H(this,vn);G(this,vn,e)}async setBrightness(e){}async resetToLogo(){}async getFirmwareVersion(){const e=await p(this,vn).getFeatureReport(5,32),t=e.indexOf(0,6);return new TextDecoder("ascii").decode(e.subarray(6,t===-1?void 0:t))}async getAllFirmwareVersions(){return{AP2:await this.getFirmwareVersion()}}async getSerialNumber(){const e=await p(this,vn).getFeatureReport(6,32);return new TextDecoder("ascii").decode(e.subarray(2,14))}}vn=new WeakMap;ca.PedalPropertiesService=Md;var si={};Object.defineProperty(si,"__esModule",{value:!0});si.FakeLcdService=void 0;class Pd{calculateFillPanelDimensions(e){return null}async clearKey(e){}async clearPanel(){}async fillKeyColor(e,t,n,i){}async fillKeyBuffer(e,t,n){}async prepareFillKeyBuffer(e,t,n,i){throw new Error("Not supported")}async fillPanelBuffer(e,t){}async prepareFillPanelBuffer(e,t,n){throw new Error("Not supported")}}si.FakeLcdService=Pd;var Os;function Ld(){if(Os)return yi;Os=1,Object.defineProperty(yi,"__esModule",{value:!0}),yi.StreamDeckPedalFactory=u;const r=br(),e=qe,t=Mt,n=ca,i=si,a=Hr,s=xn,l=[{type:"button",row:0,column:0,index:0,hidIndex:0,feedbackType:"none"},{type:"button",row:0,column:1,index:1,hidIndex:1,feedbackType:"none"},{type:"button",row:0,column:2,index:2,hidIndex:2,feedbackType:"none"}],c={MODEL:e.DeviceModelId.PEDAL,PRODUCT_NAME:e.MODEL_NAMES[e.DeviceModelId.PEDAL],KEY_DATA_OFFSET:3,SUPPORTS_RGB_KEY_FILL:!1,CONTROLS:(0,t.freezeDefinitions)(l),KEY_SPACING_HORIZONTAL:0,KEY_SPACING_VERTICAL:0,FULLSCREEN_PANELS:0,HAS_NFC_READER:!1,SUPPORTS_CHILD_DEVICES:!1};function u(f,d){const m=new a.CallbackHook;return new r.StreamDeckBase(f,d,{deviceProperties:c,events:m,properties:new n.PedalPropertiesService(f),buttonsLcd:new i.FakeLcdService,lcdSegmentDisplay:null,inputService:new s.ButtonOnlyInputService(c,m),encoderLed:null})}return yi}var wi={},ua={};Object.defineProperty(ua,"__esModule",{value:!0});ua.StreamDeckNeoLcdService=void 0;const Ad=vt,Rd=zt,Td=Sr();var Zn,Qn,Tr,Ki;class Od{constructor(e,t,n){H(this,Zn);H(this,Qn);H(this,Tr);H(this,Ki,new Rd.StreamdeckDefaultImageWriter(new Ad.StreamdeckNeoLcdImageHeaderGenerator));G(this,Zn,e),G(this,Qn,t),G(this,Tr,n)}async fillLcdRegion(e,t,n,i,a){throw new Error("Not supported for this model")}async prepareFillLcdRegion(e,t,n,i,a,s){throw new Error("Not supported for this model")}async fillLcd(e,t,n){const i=p(this,Tr).find(c=>c.id===e);if(!i)throw new Error(`Invalid lcd segment index ${e}`);const a=i.pixelSize.width*i.pixelSize.height*n.format.length;if(t.length!==a)throw new RangeError(`Expected image buffer of length ${a}, got length ${t.length}`);const s=await this.convertFillLcdBuffer(t,i.pixelSize,n),l=p(this,Ki).generateFillImageWrites(null,s);await p(this,Qn).sendReports(l)}async clearLcdSegment(e){const t=p(this,Tr).find(i=>i.id===e);if(!t)throw new Error(`Invalid lcd segment index ${e}`);const n=new Uint8Array(t.pixelSize.width*t.pixelSize.height*4);await this.fillLcd(e,n,{format:"rgba"})}async clearAllLcdSegments(){const e=[];for(const t of p(this,Tr))e.push(this.clearLcdSegment(t.id));await Promise.all(e)}async convertFillLcdBuffer(e,t,n){const i={format:n.format,offset:0,stride:t.width*n.format.length},a=(0,Td.transformImageBuffer)(e,i,{colorMode:"rgba",xFlip:!0,yFlip:!0},0,t.width,t.height);return p(this,Zn).call(this,a,t.width,t.height)}}Zn=new WeakMap,Qn=new WeakMap,Tr=new WeakMap,Ki=new WeakMap;ua.StreamDeckNeoLcdService=Od;var Ns;function Nd(){if(Ns)return wi;Ns=1,Object.defineProperty(wi,"__esModule",{value:!0}),wi.StreamDeckNeoFactory=c;const r=br(),e=qe,t=zr,n=Mt,i=ua,a=(0,n.generateButtonsGrid)(4,2,{width:96,height:96});a.push({type:"button",row:2,column:0,index:8,hidIndex:8,feedbackType:"rgb"},{type:"lcd-segment",row:2,column:1,columnSpan:2,rowSpan:1,id:0,pixelSize:{width:248,height:58},drawRegions:!1},{type:"button",row:2,column:3,index:9,hidIndex:9,feedbackType:"rgb"});const s={MODEL:e.DeviceModelId.NEO,PRODUCT_NAME:e.MODEL_NAMES[e.DeviceModelId.NEO],CONTROLS:(0,n.freezeDefinitions)(a),KEY_SPACING_HORIZONTAL:30,KEY_SPACING_VERTICAL:30,FULLSCREEN_PANELS:0,HAS_NFC_READER:!1,SUPPORTS_CHILD_DEVICES:!1,SUPPORTS_RGB_KEY_FILL:!0},l=s.CONTROLS.filter(u=>u.type==="lcd-segment");function c(u,f){const d=(0,t.createBaseGen2Properties)(u,f,s,null);return d.lcdSegmentDisplay=new i.StreamDeckNeoLcdService(f.encodeJPEG,u,l),new r.StreamDeckBase(u,f,d)}return wi}var Ia={},da={},bi={},Fs;function ts(){if(Fs)return bi;Fs=1,Object.defineProperty(bi,"__esModule",{value:!0}),bi.parseAllFirmwareVersionsHelper=e;const r=Sr();async function e(t){const n=new TextDecoder("ascii"),i={};if(t.ap2){const a=(0,r.uint8ArrayToDataView)(t.ap2);i.AP2=n.decode(t.ap2.subarray(6,14)),i.AP2_CHECKSUM=a.getUint32(2,!1).toString(16)}if(t.encoderLd&&(t.encoderLd[0]===24||t.encoderLd[1]===24)){const a=(0,r.uint8ArrayToDataView)(t.encoderLd);i.ENCODER_LD=n.decode(t.encoderLd.subarray(2,10)),i.ENCODER_LD_CHECKSUM=a.getUint32(10,!1).toString(16)}if(t.encoderAp2&&(t.encoderAp2[0]===24||t.encoderAp2[1]===24)){const a=(0,r.uint8ArrayToDataView)(t.encoderAp2);i.ENCODER_AP2=n.decode(t.encoderAp2.subarray(2,10)),i.ENCODER_AP2_CHECKSUM=a.getUint32(10,!1).toString(16)}return i}return bi}Object.defineProperty(da,"__esModule",{value:!0});da.StudioPropertiesService=void 0;const Fd=ts(),Bd=ai;class Vd extends Bd.Gen2PropertiesService{async getAllFirmwareVersions(){const[e,t,n]=await Promise.all([this.device.getFeatureReport(5,32),this.device.getFeatureReport(17,32),this.device.getFeatureReport(19,32)]);return(0,Fd.parseAllFirmwareVersionsHelper)({ap2:e,encoderAp2:t,encoderLd:n})}}da.StudioPropertiesService=Vd;var Bs;function jd(){return Bs||(Bs=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.studioProperties=void 0,r.StreamDeckStudioFactory=l;const e=br(),t=zr,n=qe,i=Mt,a=da,s=[{type:"encoder",row:0,column:0,index:0,hidIndex:0,hasLed:!0,ledRingSteps:24},...(0,i.generateButtonsGrid)(16,2,{width:144,height:112},!1,1),{type:"encoder",row:0,column:17,index:1,hidIndex:1,hasLed:!0,ledRingSteps:24,lcdRingOffset:12}];r.studioProperties={MODEL:n.DeviceModelId.STUDIO,PRODUCT_NAME:n.MODEL_NAMES[n.DeviceModelId.STUDIO],SUPPORTS_RGB_KEY_FILL:!0,CONTROLS:(0,i.freezeDefinitions)(s),KEY_SPACING_HORIZONTAL:0,KEY_SPACING_VERTICAL:0,FULLSCREEN_PANELS:2,HAS_NFC_READER:!0,SUPPORTS_CHILD_DEVICES:!0};function l(c,u,f){const d=(0,t.createBaseGen2Properties)(c,u,r.studioProperties,f??new a.StudioPropertiesService(c),!0);return new e.StreamDeckBase(c,u,d)}}(Ia)),Ia}var Si={},fa={};Object.defineProperty(fa,"__esModule",{value:!0});fa.FakeInputService=void 0;class Gd{handleInput(e){}}fa.FakeInputService=Gd;var va={};Object.defineProperty(va,"__esModule",{value:!0});va.NetworkDockPropertiesService=void 0;const $d=ts();var Or;class Kd{constructor(e){H(this,Or);G(this,Or,e)}async setBrightness(e){}async resetToLogo(){}async getFirmwareVersion(){const e=await p(this,Or).getFeatureReport(131,-1);return new TextDecoder("ascii").decode(e.subarray(8,16))}async getAllFirmwareVersions(){const[e]=await Promise.all([p(this,Or).getFeatureReport(131,-1)]);return(0,$d.parseAllFirmwareVersionsHelper)({ap2:e.slice(2),encoderAp2:null,encoderLd:null})}async getSerialNumber(){const e=await p(this,Or).getFeatureReport(132,-1),t=e[3];return new TextDecoder("ascii").decode(e.subarray(4,4+t))}}Or=new WeakMap;va.NetworkDockPropertiesService=Kd;var Vs;function Ud(){if(Vs)return Si;Vs=1,Object.defineProperty(Si,"__esModule",{value:!0}),Si.NetworkDockFactory=c;const r=br(),e=qe,t=Mt,n=Hr,i=si,a=fa,s=va,l={MODEL:e.DeviceModelId.NETWORK_DOCK,PRODUCT_NAME:e.MODEL_NAMES[e.DeviceModelId.NETWORK_DOCK],KEY_DATA_OFFSET:0,SUPPORTS_RGB_KEY_FILL:!1,CONTROLS:(0,t.freezeDefinitions)([]),KEY_SPACING_HORIZONTAL:0,KEY_SPACING_VERTICAL:0,FULLSCREEN_PANELS:0,HAS_NFC_READER:!1,SUPPORTS_CHILD_DEVICES:!0};function c(u,f,d){const m=new n.CallbackHook;return new r.StreamDeckBase(u,f,{deviceProperties:l,events:m,properties:new s.NetworkDockPropertiesService(u),buttonsLcd:new i.FakeLcdService,lcdSegmentDisplay:null,inputService:new a.FakeInputService,encoderLed:null})}return Si}var xa={},js;function Hd(){return js||(js=1,Object.defineProperty(xa,"__esModule",{value:!0})),xa}var ka={},Gs;function zd(){return Gs||(Gs=1,Object.defineProperty(ka,"__esModule",{value:!0})),ka}var An={},$s;function qd(){if($s)return An;$s=1,Object.defineProperty(An,"__esModule",{value:!0}),An.StreamDeckProxy=void 0;class r{constructor(t){Re(this,"device");this.device=t}get CONTROLS(){return this.device.CONTROLS}get MODEL(){return this.device.MODEL}get PRODUCT_NAME(){return this.device.PRODUCT_NAME}get HAS_NFC_READER(){return this.device.HAS_NFC_READER}calculateFillPanelDimensions(...t){return this.device.calculateFillPanelDimensions(...t)}async close(){return this.device.close()}async getHidDeviceInfo(...t){return this.device.getHidDeviceInfo(...t)}async sendPreparedBuffer(...t){return this.device.sendPreparedBuffer(...t)}async fillKeyColor(...t){return this.device.fillKeyColor(...t)}async fillKeyBuffer(...t){return this.device.fillKeyBuffer(...t)}async prepareFillKeyBuffer(...t){return this.device.prepareFillKeyBuffer(...t)}async fillPanelBuffer(...t){return this.device.fillPanelBuffer(...t)}async prepareFillPanelBuffer(...t){return this.device.prepareFillPanelBuffer(...t)}async clearKey(...t){return this.device.clearKey(...t)}async clearPanel(...t){return this.device.clearPanel(...t)}async setBrightness(...t){return this.device.setBrightness(...t)}async resetToLogo(...t){return this.device.resetToLogo(...t)}async getFirmwareVersion(){return this.device.getFirmwareVersion()}async getAllFirmwareVersions(){return this.device.getAllFirmwareVersions()}async getSerialNumber(){return this.device.getSerialNumber()}async fillLcd(...t){return this.device.fillLcd(...t)}async setEncoderColor(...t){return this.device.setEncoderColor(...t)}async setEncoderRingSingleColor(...t){return this.device.setEncoderRingSingleColor(...t)}async setEncoderRingColors(...t){return this.device.setEncoderRingColors(...t)}async fillLcdRegion(...t){return this.device.fillLcdRegion(...t)}async prepareFillLcdRegion(...t){return this.device.prepareFillLcdRegion(...t)}async clearLcdSegment(...t){return this.device.clearLcdSegment(...t)}async getChildDeviceInfo(...t){return this.device.getChildDeviceInfo(...t)}eventNames(){return this.device.eventNames()}listeners(t){return this.device.listeners(t)}listenerCount(t){return this.device.listenerCount(t)}emit(t,...n){return this.device.emit(t,...n)}on(t,n,i){return this.device.on(t,n,i),this}addListener(t,n,i){return this.device.addListener(t,n,i),this}once(t,n,i){return this.device.once(t,n,i),this}removeListener(t,n,i,a){return this.device.removeListener(t,n,i,a),this}off(t,n,i,a){return this.device.off(t,n,i,a),this}removeAllListeners(t){return this.device.removeAllListeners(t),this}}return An.StreamDeckProxy=r,An}var Ks;function Ni(){return Ks||(Ks=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.DEVICE_MODELS=r.DEVICE_MODELS2=r.DeviceModelType=r.VENDOR_ID=r.parseAllFirmwareVersionsHelper=r.uint8ArrayToDataView=r.StreamDeckProxy=void 0;const e=Fu,t=qe,n=td(),i=rd(),a=wd(),s=bd(),l=kd(),c=Ld(),u=Nd(),f=jd(),d=Ud();e.__exportStar(Hd(),r),e.__exportStar(qe,r),e.__exportStar(zd(),r);var m=qd();Object.defineProperty(r,"StreamDeckProxy",{enumerable:!0,get:function(){return m.StreamDeckProxy}});var _=Sr();Object.defineProperty(r,"uint8ArrayToDataView",{enumerable:!0,get:function(){return _.uint8ArrayToDataView}});var h=ts();Object.defineProperty(r,"parseAllFirmwareVersionsHelper",{enumerable:!0,get:function(){return h.parseAllFirmwareVersionsHelper}}),r.VENDOR_ID=4057;var g;(function(v){v.STREAMDECK="streamdeck",v.PEDAL="pedal",v.NETWORK_DOCK="network-dock"})(g||(r.DeviceModelType=g={})),r.DEVICE_MODELS2={[t.DeviceModelId.ORIGINAL]:{type:g.STREAMDECK,productIds:[96],factory:n.StreamDeckOriginalFactory,hasNativeTcp:!1},[t.DeviceModelId.MINI]:{type:g.STREAMDECK,productIds:[99,144],factory:(...v)=>(0,i.StreamDeck6KeyFactory)(t.DeviceModelId.MINI,...v),hasNativeTcp:!1},[t.DeviceModelId.XL]:{type:g.STREAMDECK,productIds:[108,143],factory:(...v)=>(0,a.StreamDeck32KeyFactory)(t.DeviceModelId.XL,...v),hasNativeTcp:!1},[t.DeviceModelId.ORIGINALV2]:{type:g.STREAMDECK,productIds:[109],factory:(...v)=>(0,s.StreamDeck15KeyFactory)(t.DeviceModelId.ORIGINALV2,...v),hasNativeTcp:!1},[t.DeviceModelId.ORIGINALMK2]:{type:g.STREAMDECK,productIds:[128],factory:(...v)=>(0,s.StreamDeck15KeyFactory)(t.DeviceModelId.ORIGINALMK2,...v),hasNativeTcp:!1},[t.DeviceModelId.ORIGINALMK2SCISSOR]:{type:g.STREAMDECK,productIds:[165],factory:(...v)=>(0,s.StreamDeck15KeyFactory)(t.DeviceModelId.ORIGINALMK2SCISSOR,...v),hasNativeTcp:!1},[t.DeviceModelId.PLUS]:{type:g.STREAMDECK,productIds:[132],factory:l.StreamDeckPlusFactory,hasNativeTcp:!1},[t.DeviceModelId.PEDAL]:{type:g.PEDAL,productIds:[134],factory:c.StreamDeckPedalFactory,hasNativeTcp:!1},[t.DeviceModelId.NEO]:{type:g.STREAMDECK,productIds:[154],factory:u.StreamDeckNeoFactory,hasNativeTcp:!1},[t.DeviceModelId.STUDIO]:{type:g.STREAMDECK,productIds:[170],factory:f.StreamDeckStudioFactory,hasNativeTcp:!0},[t.DeviceModelId.MODULE6]:{type:g.STREAMDECK,productIds:[184],factory:(...v)=>(0,i.StreamDeck6KeyFactory)(t.DeviceModelId.MODULE6,...v),hasNativeTcp:!1},[t.DeviceModelId.MODULE15]:{type:g.STREAMDECK,productIds:[185],factory:(...v)=>(0,s.StreamDeck15KeyFactory)(t.DeviceModelId.MODULE15,...v),hasNativeTcp:!1},[t.DeviceModelId.MODULE32]:{type:g.STREAMDECK,productIds:[186],factory:(...v)=>(0,a.StreamDeck32KeyFactory)(t.DeviceModelId.MODULE32,...v),hasNativeTcp:!1},[t.DeviceModelId.NETWORK_DOCK]:{type:g.NETWORK_DOCK,productIds:[65535],factory:d.NetworkDockFactory,hasNativeTcp:!0}},r.DEVICE_MODELS=Object.entries(r.DEVICE_MODELS2).map(([v,S])=>{const N=v;return{id:N,productName:t.MODEL_NAMES[N],...S}})}(Ca)),Ca}var ha={},rs={},Rl={exports:{}};(function(r){var e=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function i(c,u,f){this.fn=c,this.context=u,this.once=f||!1}function a(c,u,f,d,m){if(typeof f!="function")throw new TypeError("The listener must be a function");var _=new i(f,d||c,m),h=t?t+u:u;return c._events[h]?c._events[h].fn?c._events[h]=[c._events[h],_]:c._events[h].push(_):(c._events[h]=_,c._eventsCount++),c}function s(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],f,d;if(this._eventsCount===0)return u;for(d in f=this._events)e.call(f,d)&&u.push(t?d.slice(1):d);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(f)):u},l.prototype.listeners=function(u){var f=t?t+u:u,d=this._events[f];if(!d)return[];if(d.fn)return[d.fn];for(var m=0,_=d.length,h=new Array(_);m<_;m++)h[m]=d[m].fn;return h},l.prototype.listenerCount=function(u){var f=t?t+u:u,d=this._events[f];return d?d.fn?1:d.length:0},l.prototype.emit=function(u,f,d,m,_,h){var g=t?t+u:u;if(!this._events[g])return!1;var v=this._events[g],S=arguments.length,N,I;if(v.fn){switch(v.once&&this.removeListener(u,v.fn,void 0,!0),S){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,f),!0;case 3:return v.fn.call(v.context,f,d),!0;case 4:return v.fn.call(v.context,f,d,m),!0;case 5:return v.fn.call(v.context,f,d,m,_),!0;case 6:return v.fn.call(v.context,f,d,m,_,h),!0}for(I=1,N=new Array(S-1);I<S;I++)N[I-1]=arguments[I];v.fn.apply(v.context,N)}else{var O=v.length,D;for(I=0;I<O;I++)switch(v[I].once&&this.removeListener(u,v[I].fn,void 0,!0),S){case 1:v[I].fn.call(v[I].context);break;case 2:v[I].fn.call(v[I].context,f);break;case 3:v[I].fn.call(v[I].context,f,d);break;case 4:v[I].fn.call(v[I].context,f,d,m);break;default:if(!N)for(D=1,N=new Array(S-1);D<S;D++)N[D-1]=arguments[D];v[I].fn.apply(v[I].context,N)}}return!0},l.prototype.on=function(u,f,d){return a(this,u,f,d,!1)},l.prototype.once=function(u,f,d){return a(this,u,f,d,!0)},l.prototype.removeListener=function(u,f,d,m){var _=t?t+u:u;if(!this._events[_])return this;if(!f)return s(this,_),this;var h=this._events[_];if(h.fn)h.fn===f&&(!m||h.once)&&(!d||h.context===d)&&s(this,_);else{for(var g=0,v=[],S=h.length;g<S;g++)(h[g].fn!==f||m&&!h[g].once||d&&h[g].context!==d)&&v.push(h[g]);v.length?this._events[_]=v.length===1?v[0]:v:s(this,_)}return this},l.prototype.removeAllListeners=function(u){var f;return u?(f=t?t+u:u,this._events[f]&&s(this,f)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=t,l.EventEmitter=l,r.exports=l})(Rl);var Wd=Rl.exports,pa={exports:{}},Yd=(r,e)=>(e=e||(()=>{}),r.then(t=>new Promise(n=>{n(e())}).then(()=>t),t=>new Promise(n=>{n(e())}).then(()=>{throw t})));const Xd=Yd;class Tl extends Error{constructor(e){super(e),this.name="TimeoutError"}}const Ol=(r,e,t)=>new Promise((n,i)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){n(r);return}const a=setTimeout(()=>{if(typeof t=="function"){try{n(t())}catch(c){i(c)}return}const s=typeof t=="string"?t:`Promise timed out after ${e} milliseconds`,l=t instanceof Error?t:new Tl(s);typeof r.cancel=="function"&&r.cancel(),i(l)},e);Xd(r.then(n,i),()=>{clearTimeout(a)})});pa.exports=Ol;pa.exports.default=Ol;pa.exports.TimeoutError=Tl;var Jd=pa.exports,ns={},is={};Object.defineProperty(is,"__esModule",{value:!0});function Zd(r,e,t){let n=0,i=r.length;for(;i>0;){const a=i/2|0;let s=n+a;t(r[s],e)<=0?(n=++s,i-=a+1):i=a}return n}is.default=Zd;Object.defineProperty(ns,"__esModule",{value:!0});const Qd=is;class ef{constructor(){this._queue=[]}enqueue(e,t){t=Object.assign({priority:0},t);const n={priority:t.priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority){this._queue.push(n);return}const i=Qd.default(this._queue,n,(a,s)=>s.priority-a.priority);this._queue.splice(i,0,n)}dequeue(){const e=this._queue.shift();return e==null?void 0:e.run}filter(e){return this._queue.filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return this._queue.length}}ns.default=ef;Object.defineProperty(rs,"__esModule",{value:!0});const tf=Wd,Nl=Jd,rf=ns,Di=()=>{},nf=new Nl.TimeoutError;class af extends tf{constructor(e){var t,n,i,a;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=Di,this._resolveIdle=Di,e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:rf.default},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(n=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(a=(i=e.interval)===null||i===void 0?void 0:i.toString())!==null&&a!==void 0?a:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||e.interval===0,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=e.throwOnTimeout===!0,this._isPaused=e.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=Di,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=Di,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const e=Date.now();if(this._intervalId===void 0){const t=this._intervalEnd-e;if(t<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},t)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const t=this._queue.dequeue();return t?(this.emit("active"),t(),e&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,t={}){return new Promise((n,i)=>{const a=async()=>{this._pendingCount++,this._intervalCount++;try{const s=this._timeout===void 0&&t.timeout===void 0?e():Nl.default(Promise.resolve(e()),t.timeout===void 0?this._timeout:t.timeout,()=>{(t.throwOnTimeout===void 0?this._throwOnTimeout:t.throwOnTimeout)&&i(nf)});n(await s)}catch(s){i(s)}this._next()};this._queue.enqueue(a,t),this._tryToStartAnother(),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async n=>this.add(n,t)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(e=>{const t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(e=>{const t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}}rs.default=af;Object.defineProperty(ha,"__esModule",{value:!0});ha.WebHIDDevice=void 0;const sf=kl,of=rs;class lf extends sf.EventEmitter{constructor(t){super();Re(this,"device");Re(this,"reportQueue",new of.default({concurrency:1}));this.device=t,this.device.addEventListener("inputreport",n=>{if(n.reportId===1){const i=new Uint8Array(n.data.buffer,n.data.byteOffset,n.data.byteLength);this.emit("input",i)}})}async close(){return this.device.close()}async forget(){return this.device.forget()}async sendFeatureReport(t){return this.device.sendFeatureReport(t[0],t.subarray(1))}async getFeatureReport(t,n){const i=await this.device.receiveFeatureReport(t);return new Uint8Array(i.buffer,i.byteOffset,i.byteLength)}async sendReports(t){return this.reportQueue.add(async()=>{for(const n of t)await this.device.sendReport(n[0],n.subarray(1))})}async getDeviceInfo(){return{path:void 0,productId:this.device.productId,vendorId:this.device.vendorId}}async getChildDeviceInfo(){return null}}ha.WebHIDDevice=lf;var as={};Object.defineProperty(as,"__esModule",{value:!0});as.encodeJPEG=cf;async function cf(r,e,t){const n=await new Promise((i,a)=>{const s=document.createElement("canvas");s.width=e,s.height=t;const l=s.getContext("2d");if(l){const c=l.createImageData(e,t);c.data.set(r),l.putImageData(c,0,0),s.toBlob(u=>{u?i(u):a(new Error("No image generated"))},"image/jpeg",.9)}else a(new Error("Failed to get canvas context"))});return new Uint8Array(await n.arrayBuffer())}var jn={};Object.defineProperty(jn,"__esModule",{value:!0});jn.StreamDeckWeb=void 0;const uf=Ni();class df extends uf.StreamDeckProxy{constructor(t,n){super(t);Re(this,"hid");this.hid=n}async forget(){await this.hid.forget()}async fillKeyCanvas(t,n){const i=n.getContext("2d");if(!i)throw new Error("Failed to get canvas context");const a=this.CONTROLS.find(l=>l.type==="button"&&l.index===t);if(!a||a.feedbackType==="none")throw new TypeError("Expected a valid keyIndex");if(a.feedbackType!=="lcd")throw new TypeError(`keyIndex ${a.index} does not support lcd feedback`);const s=i.getImageData(0,0,a.pixelSize.width,a.pixelSize.height);return this.device.fillKeyBuffer(t,s.data,{format:"rgba"})}async fillPanelCanvas(t){const n=t.getContext("2d");if(!n)throw new Error("Failed to get canvas context");const i=this.device.calculateFillPanelDimensions();if(!i)throw new Error("Panel does not support filling");const a=n.getImageData(0,0,i.width,i.height);return this.device.fillPanelBuffer(a.data,{format:"rgba"})}}jn.StreamDeckWeb=df;(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.StreamDeckWeb=r.StreamDeckProxy=r.DeviceModelId=r.VENDOR_ID=void 0,r.requestStreamDecks=l,r.getStreamDecks=c,r.openDevice=u;const e=Ni(),t=ha,n=as,i=jn;var a=Ni();Object.defineProperty(r,"VENDOR_ID",{enumerable:!0,get:function(){return a.VENDOR_ID}}),Object.defineProperty(r,"DeviceModelId",{enumerable:!0,get:function(){return a.DeviceModelId}}),Object.defineProperty(r,"StreamDeckProxy",{enumerable:!0,get:function(){return a.StreamDeckProxy}});var s=jn;Object.defineProperty(r,"StreamDeckWeb",{enumerable:!0,get:function(){return s.StreamDeckWeb}});async function l(f){const d=await navigator.hid.requestDevice({filters:[{vendorId:e.VENDOR_ID}]});return Promise.all(d.map(async m=>u(m,f)))}async function c(f){const m=(await navigator.hid.getDevices()).filter(h=>h.vendorId===e.VENDOR_ID);return(await Promise.all(m.map(async h=>u(h,f).catch(g=>null)))).filter(h=>!!h)}async function u(f,d){const m=e.DEVICE_MODELS.find(_=>f.vendorId===e.VENDOR_ID&&_.productIds.includes(f.productId));if(!m)throw new Error("Stream Deck is of unexpected type.");await f.open();try{const _={encodeJPEG:n.encodeJPEG,...d},h=new t.WebHIDDevice(f),g=m.factory(h,_||{});return new i.StreamDeckWeb(g,h)}catch(_){throw await f.close().catch(()=>null),_}}})(Va);const ff={VENDOR_ID:4057};function vf(r){return r.vendorId===ff.VENDOR_ID}class hf{constructor(){this.connectedDevices=new Map,this.listeners=new Map,this.buttonStates=new Map}on(e,t){this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e).add(t)}off(e,t){this.listeners.has(e)&&this.listeners.get(e).delete(t)}_emit(e,t){if(!this.listeners.has(e))return;const n=this.listeners.get(e);for(const i of n)i(t)}async requestDevice(){if(!navigator.hid)throw new Error("WebHID not supported in this browser");try{const e=await Va.requestStreamDecks();for(const t of e)await this._setupStreamDeck(t);return e[0]||null}catch(e){throw e.name==="NotAllowedError"?new Error("Failed to open Stream Deck. Please close the Elgato Stream Deck software and try again."):e}}async autoReconnect(){if(!navigator.hid)return console.warn("WebHID not supported"),[];try{const e=await Va.getStreamDecks(),t=[];for(const n of e)try{await this._setupStreamDeck(n),t.push(n)}catch(i){console.warn("Failed to reconnect to Stream Deck:",i)}return t}catch(e){return console.error("Failed to auto-reconnect Stream Deck devices:",e),[]}}async _setupStreamDeck(e){try{const t=e.serialNumber||e.SERIAL_NUMBER||`${e.PRODUCT_NAME||"StreamDeck"}-${e.MODEL||e.PRODUCT_ID||"unknown"}`.replace(/\s+/g,"-").toLowerCase();return console.log("Stream Deck serial number:",t,"Product:",e.PRODUCT_NAME,"Model:",e.MODEL),this.buttonStates.set(t,new Map),e.on("down",n=>{let i;if(typeof n=="number"?i=n:typeof n=="object"&&n!==null?i=n.index:typeof n=="string"&&(i=parseInt(n)),typeof i!="number"||isNaN(i)){console.warn("Could not extract button index from Stream Deck event:",n);return}const a=this.buttonStates.get(t);a&&typeof i=="number"&&a.set(i,!0),this._emit("buttondown",{device:e,serialNumber:t,button:i,model:e.PRODUCT_NAME||"Stream Deck"})}),e.on("up",n=>{let i;if(typeof n=="number"?i=n:typeof n=="object"&&n!==null?i=n.index:typeof n=="string"&&(i=parseInt(n)),typeof i!="number"||isNaN(i))return;const a=this.buttonStates.get(t);a&&typeof i=="number"&&a.set(i,!1),this._emit("buttonup",{device:e,serialNumber:t,button:i,model:e.PRODUCT_NAME||"Stream Deck"})}),await e.setBrightness(100),await e.clearPanel(),this.connectedDevices.set(t,e),this._emit("connected",{device:e,serialNumber:t,model:e.PRODUCT_NAME||"Stream Deck",buttonCount:e.NUM_KEYS}),e}catch(t){throw console.error("Failed to setup Stream Deck:",t),t}}async disconnectDevice(e){const t=this.connectedDevices.get(e);t&&(await t.close(),this.connectedDevices.delete(e),this.buttonStates.delete(e),this._emit("disconnected",{serialNumber:e}))}async setButtonColor(e,t,n){const i=this.connectedDevices.get(e);if(!i)return!1;const a=i.NUM_KEYS||15;if(t<0||t>=a)return!1;try{const s=this._parseColor(n);return s?(await i.fillKeyColor(t,s.r,s.g,s.b),!0):!1}catch(s){return console.error(`Failed to set button ${t} color on ${e}:`,s),!1}}async clearButtonColor(e,t){return await this.setButtonColor(e,t,"#000000")}_parseColor(e){const t=document.createElement("div");t.style.color=e,document.body.appendChild(t);const n=window.getComputedStyle(t).color;document.body.removeChild(t);const i=n.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/);return i?{r:parseInt(i[1]),g:parseInt(i[2]),b:parseInt(i[3])}:null}getConnectedDevices(){return Array.from(this.connectedDevices.values())}async disconnectAll(){const e=Array.from(this.connectedDevices.keys());for(const t of e)await this.disconnectDevice(t)}}class oi{constructor(e,t,n){this.id=e,this.name=t,this.type=n,this.controls=new Map,this.listeners=new Map}getValue(e){const t=this.controls.get(e);return t?t.value:0}_setValue(e,t,n=0,i=1){this.controls.has(e)||this.controls.set(e,{type:"value",value:0,min:n,max:i});const a=this.controls.get(e);a.value=t,a.min=n,a.max=i,this._emit("change",{controlId:e,value:t,control:a})}_trigger(e,t=1){this._emit("trigger",{controlId:e,velocity:t})}on(e,t){this.listeners.has(e)||this.listeners.set(e,[]),this.listeners.get(e).push(t)}off(e,t){if(!this.listeners.has(e))return;const n=this.listeners.get(e),i=n.indexOf(t);i!==-1&&n.splice(i,1)}_emit(e,t){if(!this.listeners.has(e))return;const n=this.listeners.get(e);for(const i of n)i(t)}disconnect(){}getControlIds(){return Array.from(this.controls.keys())}}class pf extends oi{constructor(e){super(e.id,e.name||"MIDI Device","midi"),this.midiInput=e,this.midiInput.onmidimessage=this._handleMIDIMessage.bind(this)}_handleMIDIMessage(e){const[t,n,i]=e.data;switch(t&240){case 144:if(i>0){const u=`note-${n}`;this._trigger(u,i/127)}else{const u=`note-${n}`;this._emit("release",{controlId:u})}break;case 128:const s=`note-${n}`;this._emit("release",{controlId:s});break;case 176:const l=`cc-${n}`;this._setValue(l,i/127,0,1);break;case 224:const c=(i<<7|n)-8192;this._setValue("pitchbend",c/8192,-1,1);break}}disconnect(){this.midiInput&&(this.midiInput.onmidimessage=null)}}class _f extends oi{constructor(e,t={}){super(e.productId.toString(),t.name||"HID Device","hid"),this.hidDevice=e,this.config=t,this.buttonStates=new Map,this.hidDevice.oninputreport=this._handleInputReport.bind(this)}_handleInputReport(e){const{data:t,reportId:n}=e,i=new Uint8Array(t.buffer);for(let a=0;a<i.length;a++){const s=i[a];for(let l=0;l<8;l++){const c=a*8+l,u=s>>l&1,f=`button-${c}`,d=this.buttonStates.get(f)||!1;u&&!d?(this.buttonStates.set(f,!0),this._trigger(f,127)):!u&&d&&(this.buttonStates.set(f,!1),this._emit("release",{controlId:f}))}}}async sendOutput(e,t){this.hidDevice&&this.hidDevice.opened&&await this.hidDevice.sendReport(e,t)}disconnect(){this.hidDevice&&(this.hidDevice.oninputreport=null,this.hidDevice.close()),this.buttonStates.clear()}}class gf extends oi{constructor(){super("keyboard","Keyboard","keyboard"),this.pressedKeys=new Set,this._boundKeyDown=this._handleKeyDown.bind(this),this._boundKeyUp=this._handleKeyUp.bind(this),window.addEventListener("keydown",this._boundKeyDown),window.addEventListener("keyup",this._boundKeyUp)}_handleKeyDown(e){if(e.target.matches("input, textarea"))return;const t=`key-${e.code}`;this.pressedKeys.has(e.code)||(this.pressedKeys.add(e.code),this._trigger(t),this._setValue(t,1,0,1))}_handleKeyUp(e){const t=`key-${e.code}`;this.pressedKeys.has(e.code)&&(this.pressedKeys.delete(e.code),this._emit("release",{controlId:t}),this._setValue(t,0,0,1))}disconnect(){window.removeEventListener("keydown",this._boundKeyDown),window.removeEventListener("keyup",this._boundKeyUp),this.pressedKeys.clear()}}class mf extends oi{constructor(e="Virtual"){super(`virtual-${Date.now()}`,e,"virtual")}trigger(e,t=1){this._trigger(e,t)}setValue(e,t){this._setValue(e,t,0,1)}addButton(e,t){this.controls.set(e,{type:"button",value:0,label:t})}addKnob(e,t,n=0){this.controls.set(e,{type:"knob",value:n,label:t,min:0,max:1})}}class yf{constructor(){Re(this,"listeners",new Map);this.devices=new Map,this.midiAccess=null,this.keyboardDevice=null,this.streamDeckManager=new hf,this._setupStreamDeckListeners()}_setupStreamDeckListeners(){this.streamDeckManager.on("connected",({device:e,model:t,serialNumber:n})=>{console.log(`Stream Deck connected: ${t}`);const i=n,a=new oi(i,t||"Stream Deck","hid");a.streamDeck=e,this.devices.set(i,a),this._emit("deviceadded",a)}),this.streamDeckManager.on("buttondown",({device:e,button:t,model:n,serialNumber:i})=>{const a=i,s=this.devices.get(a);if(s){const l=`button-${t}`;s._trigger(l,127)}}),this.streamDeckManager.on("buttonup",({serialNumber:e,button:t})=>{const n=e,i=this.devices.get(n);if(i){const a=`button-${t}`;i._emit("release",{controlId:a})}}),this.streamDeckManager.on("disconnected",({serialNumber:e})=>{console.log("Stream Deck disconnected"),this.removeDevice(e)})}async initMIDI(){if(!navigator.requestMIDIAccess)return console.warn("WebMIDI not supported"),!1;try{this.midiAccess=await navigator.requestMIDIAccess(),this.midiAccess.onstatechange=this._handleMIDIStateChange.bind(this);for(const e of this.midiAccess.inputs.values())this._addMIDIDevice(e);return!0}catch(e){return console.error("Failed to initialize MIDI:",e),!1}}_handleMIDIStateChange(e){const t=e.port;t.type==="input"&&(t.state==="connected"?this._addMIDIDevice(t):t.state==="disconnected"&&this.removeDevice(t.id))}_addMIDIDevice(e){const t=new pf(e);this.devices.set(t.id,t),this._emit("deviceadded",t)}async requestStreamDeck(){try{return await this.streamDeckManager.requestDevice()}catch(e){throw console.error("Failed to request Stream Deck:",e),e}}async autoReconnectStreamDecks(){try{const e=await this.streamDeckManager.autoReconnect();return console.log(`Auto-reconnected ${e.length} Stream Deck(s)`),e}catch(e){return console.error("Failed to auto-reconnect Stream Decks:",e),[]}}async requestHIDDevice(e=[]){if(!navigator.hid)return console.warn("WebHID not supported"),null;try{const t=await navigator.hid.requestDevice({filters:e});for(const n of t){if(vf(n))return await this.streamDeckManager.connectDevice(n);if(!n.opened)try{await n.open()}catch(a){throw console.error("Failed to open HID device:",a),new Error(`Cannot open device. Make sure it's not being used by another application. Error: ${a.message}`)}const i=new _f(n);return this.devices.set(i.id,i),this._emit("deviceadded",i),i}}catch(t){throw console.error("Failed to request HID device:",t),t}return null}enableKeyboard(){return this.keyboardDevice||(this.keyboardDevice=new gf,this.devices.set(this.keyboardDevice.id,this.keyboardDevice),this._emit("deviceadded",this.keyboardDevice)),this.keyboardDevice}createVirtual(e){const t=new mf(e);return this.devices.set(t.id,t),this._emit("deviceadded",t),t}removeDevice(e){const t=this.devices.get(e);t&&(t.disconnect(),this.devices.delete(e),this._emit("deviceremoved",t))}getDevice(e){return this.devices.get(e)}getAllDevices(){return Array.from(this.devices.values())}getInputDevices(){return this.getAllDevices()}getInputDevice(e){return this.getDevice(e)}on(e,t){this.listeners.has(e)||this.listeners.set(e,[]),this.listeners.get(e).push(t)}off(e,t){if(!this.listeners.has(e))return;const n=this.listeners.get(e),i=n.indexOf(t);i!==-1&&n.splice(i,1)}_emit(e,t){if(!this.listeners.has(e))return;const n=this.listeners.get(e);for(const i of n)i(t)}disconnectAll(){for(const e of this.devices.values())e.disconnect();this.devices.clear()}}class wf{constructor(e,t,n){this.inputDeviceManager=new yf,this.mappingLibrary=e||new Jo,this.customPropertyManager=t||new Qo,this.triggerManager=n||new Zo,this.listeners=new Map,this._setupInputListeners()}async initialize(){this.customPropertyManager.initialize(),this.inputDeviceManager.on("deviceadded",e=>{this._setupDeviceListeners(e),this._emit("deviceadded",e)}),this.inputDeviceManager.on("deviceremoved",e=>{this._emit("deviceremoved",e)}),await this.inputDeviceManager.initMIDI(),await this.inputDeviceManager.autoReconnectStreamDecks(),this.inputDeviceManager.enableKeyboard()}_setupInputListeners(){}_setupDeviceListeners(e){e.on("trigger",({controlId:t,velocity:n})=>{this._handleTrigger(e.id,t,n)}),e.on("release",({controlId:t})=>{this._handleRelease(e.id,t)}),e.on("change",({controlId:t,value:n})=>{this._handleValueChange(e.id,t,n)})}_generateClassName(e,t){return`${e.replace(/[^a-zA-Z0-9]/g,"_").toLowerCase()}_${t}`}_handleTrigger(e,t,n){const i=this.mappingLibrary.getByInput(e,t);if(i.length>0){const a=this._generateClassName(t,"down");this.triggerManager.addRawClass(a);const s=this._generateClassName(t,"up");this.triggerManager.removeRawClass(s);for(const l of i)l.mode==="trigger"&&(this.triggerManager.trigger(l),this._emit("trigger",{mapping:l,velocity:n}))}}_handleRelease(e,t){const n=this.mappingLibrary.getByInput(e,t);if(n.length>0){const i=this._generateClassName(t,"down");this.triggerManager.removeRawClass(i);const a=this._generateClassName(t,"up");this.triggerManager.addRawClass(a);for(const s of n)s.mode==="trigger"&&s.triggerType!=="always"&&(this.triggerManager.release(s),this._emit("release",{mapping:s}))}}_handleValueChange(e,t,n){const i=this.mappingLibrary.getByInput(e,t),a=i.find(s=>s.mode==="input");if(a&&a.name){const s=a.name.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""),l=Math.round(n*100);this.customPropertyManager.setProperty(s,`${l}%`)}for(const s of i)if(s.mode==="direct"){const l=s.getPropertyName(),c=s.mapValue(n);this.customPropertyManager.setProperty(l,c),this._emit("valuechange",{mapping:s,value:n,propertyValue:c})}}async requestStreamDeck(){return await this.inputDeviceManager.requestStreamDeck()}async requestHIDDevice(e=[]){return await this.inputDeviceManager.requestHIDDevice(e)}getInputDevices(){return this.inputDeviceManager.getAllDevices()}getInputDevice(e){return this.inputDeviceManager.getDevice(e)}createVirtualDevice(e){return this.inputDeviceManager.createVirtual(e)}setTriggerContainer(e){this.triggerManager.setContainer(e)}on(e,t){this.listeners.has(e)||this.listeners.set(e,[]),this.listeners.get(e).push(t)}off(e,t){if(!this.listeners.has(e))return;const n=this.listeners.get(e),i=n.indexOf(t);i!==-1&&n.splice(i,1)}_emit(e,t){if(!this.listeners.has(e))return;const n=this.listeners.get(e);for(const i of n)i(t)}destroy(){this.inputDeviceManager.disconnectAll(),this.customPropertyManager.destroy(),this.triggerManager.clearAll(),this.listeners.clear()}}yc();var bf=Go("<title> </title>"),Sf=Go("<svg><!><!></svg>");function mt(r,e){const t=Cs(e,["children","$$slots","$$events","$$legacy"]),n=Cs(t,["data","viewBox","size","width","height","color","stroke","fill","title"]);tt(e,!1);const i=_o();let a=ie(e,"data",8,""),s=ie(e,"viewBox",24,()=>h(a())),l=ie(e,"size",8,"20px"),c=ie(e,"width",24,l),u=ie(e,"height",24,l),f=ie(e,"color",8,"currentColor"),d=ie(e,"stroke",24,f),m=ie(e,"fill",24,f),_=ie(e,"title",8,"");function h(I){const D=/viewBox="([\d\- \.]+)"/.exec(I);return D?D[1]:"0 0 20 20"}jc(()=>Bo(a()),()=>{x(i,a().replace(/<svg[ \n]([^>]*)>/,"").replace("</svg>",""))}),Gc(),mu();var g=Sf();hu(g,()=>({xmlns:"http://www.w3.org/2000/svg",width:c(),height:u(),viewBox:s(),stroke:d(),fill:m(),...n}));var v=y(g);{var S=I=>{var O=bf(),D=y(O);re(()=>ve(D,_())),M(I,O)};pe(v,I=>{_()&&I(S)})}var N=C(v);jr(N,()=>o(i),!0),M(r,g),rt()}const Df=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30">
    <path fill="#2196f3" d="M 17 2 A 1 1 0 0 0 16.123047 2.5214844 L 8.1738281 15.433594 L 8.1738281 15.435547 A 1 1 0 0 0 8 16 A 1 1 0 0 0 9 17 L 14.5 17 L 13.019531 26.800781 A 1 1 0 0 0 13 27 A 1 1 0 0 0 14 28 A 1 1 0 0 0 14.882812 27.466797 L 14.884766 27.466797 L 22.806641 14.589844 L 22.796875 14.572266 C 22.915239 14.407976 23 14.217804 23 14 C 23 13.448 22.552 13 22 13 L 16.5 13 L 17.955078 3.2949219 A 1 1 0 0 0 18 3 A 1 1 0 0 0 17 2 z"></path>
</svg>
`,Ef=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48">
    <path fill="#9C27B0" d="M21 4H26.001V43H21z" transform="rotate(45.001 23.5 23.5)"></path>
    <path fill="#9C27B0" d="M21 4H26.001V43H21z" transform="rotate(134.999 23.5 23.5)"></path>
</svg>
`,Cf=`<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="48" height="48" viewBox="0 0 48 48">
<path fill="#9C27B0" d="M21 6H26V41H21z"></path><path fill="#9C27B0" d="M6 21H41V26H6z"></path>
</svg>`,If='<svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 48 48" width="48px" height="48px"><path fill="#2196F3" d="M16 15c0 1.104-.896 2-2 2H8c-1.104 0-2-.896-2-2v-4c0-1.104.896-2 2-2h6c1.104 0 2 .896 2 2V15zM29 15c0 1.104-.896 2-2 2h-6c-1.104 0-2-.896-2-2v-4c0-1.104.896-2 2-2h6c1.104 0 2 .896 2 2V15zM42 15c0 1.104-.896 2-2 2h-6c-1.104 0-2-.896-2-2v-4c0-1.104.896-2 2-2h6c1.104 0 2 .896 2 2V15zM16 26c0 1.104-.896 2-2 2H8c-1.104 0-2-.896-2-2v-4c0-1.104.896-2 2-2h6c1.104 0 2 .896 2 2V26zM29 26c0 1.104-.896 2-2 2h-6c-1.104 0-2-.896-2-2v-4c0-1.104.896-2 2-2h6c1.104 0 2 .896 2 2V26zM42 26c0 1.104-.896 2-2 2h-6c-1.104 0-2-.896-2-2v-4c0-1.104.896-2 2-2h6c1.104 0 2 .896 2 2V26zM16 37c0 1.104-.896 2-2 2H8c-1.104 0-2-.896-2-2v-4c0-1.104.896-2 2-2h6c1.104 0 2 .896 2 2V37zM29 37c0 1.104-.896 2-2 2h-6c-1.104 0-2-.896-2-2v-4c0-1.104.896-2 2-2h6c1.104 0 2 .896 2 2V37zM42 37c0 1.104-.896 2-2 2h-6c-1.104 0-2-.896-2-2v-4c0-1.104.896-2 2-2h6c1.104 0 2 .896 2 2V37z"/></svg>',xf='<svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 48 48" width="48px" height="48px"><path fill="#f44336" d="M16,13c0,0,0,23.988,0,24h3V21.583L36,16v17h3V6L16,13z"/><path fill="#f44336" d="M13 31A6 6 0 1 0 13 43 6 6 0 1 0 13 31zM33 27A6 6 0 1 0 33 39 6 6 0 1 0 33 27z"/></svg>';var kf=F('<div class="dialog-header svelte-pz05fu"><h2 class="svelte-pz05fu"> </h2></div>'),Mf=F('<div class="dialog-footer svelte-pz05fu"><div class="dialog-footer-tools svelte-pz05fu"><!></div> <div class="dialog-footer-buttons svelte-pz05fu"><!></div></div>'),Pf=F('<dialog><!> <div class="dialog-body svelte-pz05fu"><!></div> <!></dialog>');function rr(r,e){tt(e,!0);let t=ie(e,"title",3,null),n=ie(e,"onclose",3,null),i=ie(e,"dialogRef",15,null),a=ie(e,"anchored",3,!1),s=ie(e,"anchorId",3,null),l=ie(e,"showArrow",3,!0),c=ie(e,"lightDismiss",3,!0);function u(){var I;(I=i())==null||I.close(),n()&&n()()}function f(I){a()&&c()&&I.target===i()&&u()}var d=Pf();let m;d.__click=f;var _=y(d);{var h=I=>{var O=kf(),D=y(O),R=y(D);re(()=>ve(R,t())),M(I,O)};pe(_,I=>{t()&&I(h)})}var g=C(_,2),v=y(g);Ii(v,()=>e.children);var S=C(g,2);{var N=I=>{var O=Mf(),D=y(O),R=y(D);{var j=Z=>{var X=ar(),K=Ce(X);Ii(K,()=>e.tools),M(Z,X)};pe(R,Z=>{e.tools&&Z(j)})}var q=C(D,2),te=y(q);{var ae=Z=>{var X=ar(),K=Ce(X);Ii(K,()=>e.buttons),M(Z,X)};pe(te,Z=>{e.buttons&&Z(ae)})}M(I,O)};pe(S,I=>{(e.tools||e.buttons)&&I(N)})}Gr(d,I=>i(I),()=>i()),re(()=>{m=st(d,1,"dialog svelte-pz05fu",null,m,{anchored:a(),"show-arrow":l()&&a()}),Ht(d,a()&&s()?`position-anchor: --${s()}`:"")}),M(r,d),rt()}wt(["click"]);var Lf=F('<button id="start" class="svelte-4b3o1e"><!> Connect DMX controller</button>'),Af=F('<button id="stop" class="svelte-4b3o1e"><!> Disconnect</button>'),Rf=F('<div class="device-item svelte-4b3o1e"><span class="device-name svelte-4b3o1e"> </span></div>'),Tf=F('<div class="device-list svelte-4b3o1e"></div>'),Of=F('<div class="device-item svelte-4b3o1e"><span class="device-name svelte-4b3o1e"> </span></div>'),Nf=F('<div class="device-list svelte-4b3o1e"></div>'),Ff=F('<div class="device-section svelte-4b3o1e"><button class="connect-device-btn svelte-4b3o1e"><!> Connect Stream Deck</button> <!></div> <div class="device-section svelte-4b3o1e"><button class="connect-device-btn svelte-4b3o1e"><!> Connect MIDI Device</button> <!></div>',1),Bf=F('<header class="svelte-4b3o1e"><!> <button id="devices-button" style="anchor-name: --devices-button" title="Connect input devices" class="svelte-4b3o1e"><!></button></header> <!>',1);function Vf(r,e){tt(e,!0);let t=$(null),n=$(null),i=$(Se([])),a=De(()=>o(i).filter(D=>D.type==="hid"&&D.id!=="keyboard")),s=De(()=>o(i).filter(D=>D.type==="midi")),l=De(()=>o(s).length>0);function c(){e.inputController&&x(i,e.inputController.getInputDevices(),!0),requestAnimationFrame(()=>{var D;(D=o(t))==null||D.showModal()})}function u(){var D;(D=o(t))==null||D.close()}async function f(){var D,R;try{await((D=e.inputController)==null?void 0:D.requestStreamDeck()),x(i,((R=e.inputController)==null?void 0:R.getInputDevices())||[],!0)}catch(j){alert(`Failed to connect Stream Deck: ${j.message}

Please close the Elgato Stream Deck software and try again.`)}}async function d(){var D,R,j;try{await((R=(D=e.inputController)==null?void 0:D.inputDeviceManager)==null?void 0:R.initMIDI()),x(i,((j=e.inputController)==null?void 0:j.getInputDevices())||[],!0)}catch(q){alert(`Failed to connect MIDI: ${q.message}`)}}var m=Bf(),_=Ce(m),h=y(_);{var g=D=>{var R=Lf();R.__click=function(...q){var te;(te=e.onconnect)==null||te.apply(this,q)};var j=y(R);mt(j,{get data(){return Df}}),M(D,R)},v=D=>{var R=Af();R.__click=function(...q){var te;(te=e.ondisconnect)==null||te.apply(this,q)};var j=y(R);mt(j,{get data(){return Ef}}),M(D,R)};pe(h,D=>{e.connected?D(v,!1):D(g)})}var S=C(h,2);S.__click=c;var N=y(S);mt(N,{get data(){return Cf}}),Gr(S,D=>x(n,D),()=>o(n));var I=C(_,2);{var O=D=>{rr(D,{anchored:!0,anchorId:"devices-button",showArrow:!0,lightDismiss:!0,onclose:u,get dialogRef(){return o(t)},set dialogRef(R){x(t,R,!0)},children:(R,j)=>{var q=Ff(),te=Ce(q),ae=y(te);ae.__click=f;var Z=y(ae);mt(Z,{get data(){return If}});var X=C(ae,2);{var K=k=>{var L=Tf();Ee(L,21,()=>o(a),B=>B.id,(B,W)=>{var w=Rf(),P=y(w),A=y(P);re(()=>ve(A,o(W).name)),M(B,w)}),M(k,L)};pe(X,k=>{o(a).length>0&&k(K)})}var Y=C(te,2),J=y(Y);J.__click=d;var Q=y(J);mt(Q,{get data(){return xf}});var T=C(J,2);{var b=k=>{var L=Nf();Ee(L,21,()=>o(s),B=>B.id,(B,W)=>{var w=Of(),P=y(w),A=y(P);re(()=>ve(A,o(W).name)),M(B,w)}),M(k,L)};pe(T,k=>{o(s).length>0&&k(b)})}re(()=>J.disabled=o(l)),M(R,q)},$$slots:{default:!0}})};pe(I,D=>{o(n)&&D(O)})}M(r,m),rt()}wt(["click"]);const jf='<svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 48 48" width="48px" height="48px"><path fill="#3F51B5" d="M17.8 18.1L10.4 25.4 6.2 21.3 4 23.5 10.4 29.9 20 20.3zM17.8 5.1L10.4 12.4 6.2 8.3 4 10.5 10.4 16.9 20 7.3zM17.8 31.1L10.4 38.4 6.2 34.3 4 36.5 10.4 42.9 20 33.3z"/><g><path fill="#90CAF9" d="M24 22H44V26H24zM24 9H44V13H24zM24 35H44V39H24z"/></g></svg>',Gf='<svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 48 48" width="48px" height="48px" baseProfile="basic"><path fill="#64b5f6" d="M24,44C12.972,44,4,35.028,4,24S12.972,4,24,4s20,8.972,20,20S35.028,44,24,44z M24,6	C14.075,6,6,14.075,6,24s8.075,18,18,18s18-8.075,18-18S33.925,6,24,6z"/><path fill="#64b5f6" d="M24,37c-7.168,0-13-5.832-13-13s5.832-13,13-13s13,5.832,13,13S31.168,37,24,37z M24,13	c-6.065,0-11,4.935-11,11s4.935,11,11,11s11-4.935,11-11S30.065,13,24,13z"/><path fill="#64b5f6" d="M24,31c-3.86,0-7-3.14-7-7s3.14-7,7-7s7,3.14,7,7S27.86,31,24,31z M24,19c-2.757,0-5,2.243-5,5	s2.243,5,5,5s5-2.243,5-5S26.757,19,24,19z"/><circle cx="40" cy="14" r="2" fill="#0d47a1"/><circle cx="12" cy="39" r="3" fill="#5e35b1"/><circle cx="33" cy="32" r="3" fill="#0d47a1"/><circle cx="14" cy="8" r="2" fill="#5e35b1"/><circle cx="12" cy="25" r="2" fill="#0d47a1"/><circle cx="24" cy="24" r="3.094" fill="#ffe082"/></svg>',$f=`<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="48" height="48" viewBox="0 0 48 48">
<path fill="none" stroke="#02abc0" stroke-miterlimit="10" stroke-width="4" d="M8 21L8 10 19 10"></path><path fill="none" stroke="#02abc0" stroke-miterlimit="10" stroke-width="4" d="M8,10c5.763,6.146,13,15,20,15 c8.505,0,13-6.102,13-9.748C41,11.932,39.013,9,35.007,9C28.52,9,23.02,16.775,23.346,23.808C23.769,33.967,31.596,41,40,41"></path>
</svg>`,Kf=`<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="48" height="48" viewBox="0 0 48 48">
<path fill="#2196F3" d="M11 5A7 7 0 1 0 11 19A7 7 0 1 0 11 5Z"></path><path fill="#FFA726" d="M23.082 28.861c.713 1.412 2.483 1.967 3.934 1.232 1.454-.734 2.059-2.488 1.346-3.899l-3.186-6.319c-.712-1.41-2.482-1.966-3.934-1.23-1.453.733-2.059 2.486-1.347 3.898L23.082 28.861zM28.39 26.234c.713 1.41 2.483 1.967 3.937 1.232 1.453-.733 2.057-2.488 1.344-3.9l-3.186-6.318c-.713-1.41-2.48-1.967-3.934-1.231-1.453.732-2.059 2.485-1.348 3.898L28.39 26.234zM33.7 23.607c.712 1.413 2.481 1.966 3.935 1.234 1.452-.734 2.058-2.49 1.344-3.9l-3.187-6.32c-.712-1.412-2.479-1.965-3.933-1.232-1.453.734-2.059 2.489-1.348 3.9L33.7 23.607zM40.215 23.421c-.307-.608.047.093.381.755C40.752 24.488 40.496 23.978 40.215 23.421z"></path><path fill="#FFA726" d="M20.815,22.174c-0.486,0.246-1.081,0.053-1.324-0.436l-5.78-11.459c-0.493-0.976-2.209-2.19-3.969-1.301c-1.76,0.89-1.757,3.085-1.313,3.967c0.243,0.482,3.405,6.754,6.226,12.342c2.339,4.635,4.438,8.803,4.438,8.803l-5.523-1.625c-1.83-0.603-3.687,0.198-4.15,2.302c-0.465,1.767,0.762,3.524,2.392,4.056l7.5,2.462c3.865,1.269,7.878,0.809,11.523-1.04l0.545-0.275l0.762-0.305l4.807-2.43l1.27-0.785c3.546-2.574,4.857-7.359,2.819-11.397c0,0-0.216-0.43-0.44-0.876c-0.175-0.344-0.857-1.696-2.6-5.153L20.815,22.174z"></path><g><path fill="#FFCDD2" d="M9.359 12.6c-.511-1.038-.135-2.27.846-2.751.976-.479 2.186-.024 2.692 1.011C13.409 11.898 9.869 13.635 9.359 12.6M11.882 37.605c-1.178-.316-1.874-1.527-1.561-2.707.319-1.178 1.531-1.875 2.707-1.559C14.207 33.657 13.061 37.924 11.882 37.605"></path></g>
</svg>`,Uf=`<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="48" height="48" viewBox="0 0 48 48">
<path fill="#FFC107" d="M33 22L23.6 22 30 5 19 5 13 26 21.6 26 17 45z"></path>
</svg>`,Hf=`<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="48" height="48" viewBox="0 0 48 48">
<path fill="#3F51B5" d="M36 34L33 31.5 39.8 24 33 16.5 36 14 45 24zM13 34L4 24 13 14 16 16.5 9.1 24 16 31.5z"></path><path fill="#2196F3" d="M21 39L17.2 37.7 27 9 30.8 10.3z"></path>
</svg>`;var zf=F('<div class="clear-universe svelte-1f8dwwb"><button class="svelte-1f8dwwb">Clear</button></div>'),qf=F('<div class="tabs-container svelte-1f8dwwb"><nav class="svelte-1f8dwwb"><label class="svelte-1f8dwwb"><input type="radio" name="view" class="svelte-1f8dwwb"/> <!> Devices</label> <label class="svelte-1f8dwwb"><input type="radio" name="view" class="svelte-1f8dwwb"/> <!> Animations</label> <label class="svelte-1f8dwwb"><input type="radio" name="view" class="svelte-1f8dwwb"/> <!> Inputs</label> <label class="svelte-1f8dwwb"><input type="radio" name="view" class="svelte-1f8dwwb"/> <!> Triggers</label> <label class="svelte-1f8dwwb"><input type="radio" name="view" class="svelte-1f8dwwb"/> <!> CSS</label> <label class="svelte-1f8dwwb"><input type="radio" name="view" class="svelte-1f8dwwb"/> <!> Universe</label></nav> <!></div>');function Wf(r,e){tt(e,!0);const t=[];let n=ie(e,"view",15),i=ie(e,"onClearUniverse",3,null);var a=qf(),s=y(a),l=y(s),c=y(l);c.value=c.__value="devices";var u=C(c,2);mt(u,{get data(){return jf}});var f=C(l,2),d=y(f);d.value=d.__value="animations";var m=C(d,2);mt(m,{get data(){return $f}});var _=C(f,2),h=y(_);h.value=h.__value="inputs";var g=C(h,2);mt(g,{get data(){return Kf}});var v=C(_,2),S=y(v);S.value=S.__value="triggers";var N=C(S,2);mt(N,{get data(){return Uf}});var I=C(v,2),O=y(I);O.value=O.__value="css";var D=C(O,2);mt(D,{get data(){return Hf}});var R=C(I,2),j=y(R);j.value=j.__value="universe";var q=C(j,2);mt(q,{get data(){return Gf}});var te=C(s,2);{var ae=Z=>{var X=zf(),K=y(X);K.__click=function(...Y){var J;(J=i())==null||J.apply(this,Y)},M(Z,X)};pe(te,Z=>{n()==="universe"&&i()&&Z(ae)})}Xr(t,[],c,n,n),Xr(t,[],d,n,n),Xr(t,[],h,n,n),Xr(t,[],S,n,n),Xr(t,[],O,n,n),Xr(t,[],j,n,n),M(r,a),rt()}wt(["click"]);var Yf=F('<div class="channel svelte-134r4z3"><label class="svelte-134r4z3"></label> <input type="number" min="0" max="255" class="svelte-134r4z3"/></div>'),Xf=F('<div class="universe-container svelte-134r4z3"><div class="channels-grid svelte-134r4z3"></div></div>');function Jf(r,e){tt(e,!0);let t=$(Se(new Array(512).fill(0))),n;function i(){e.dmxController&&x(t,Array.from(e.dmxController.getUniverse()),!0)}Cn(()=>{n=setInterval(i,100)}),Qi(()=>{n&&clearInterval(n)});function a(c,u){const f=parseInt(u.target.value)||0;e.dmxController&&e.dmxController.setChannel(c,f),o(t)[c]=f}var s=Xf(),l=y(s);Ee(l,21,()=>o(t),je,(c,u,f)=>{var d=Yf(),m=y(d);kt(m,"for",`ch-${f}`),m.textContent=f+1;var _=C(m,2);kt(_,"id",`ch-${f}`),_.__change=h=>a(f,h),re(()=>Jr(_,o(u))),M(c,d)}),M(r,s),rt()}wt(["change"]);const Us={RGB:{0:"Red",1:"Green",2:"Blue"},RGBA:{0:"Red",1:"Green",2:"Blue",3:"Amber"},RGBW:{0:"Red",1:"Green",2:"Blue",3:"White"},DIMMER:{0:"Dimmer"},SMOKE:{0:"Output"},MOVING_HEAD:{0:"Pan",1:"Tilt",2:"Dimmer",3:"Red",4:"Green",5:"Blue",6:"White"}};function ss(r,e){const t=Us[r],n=Us[e];if(!t||!n)return{};const i={};for(const[a,s]of Object.entries(t))for(const[l,c]of Object.entries(n))if(s===c){i[parseInt(a)]=parseInt(l);break}return i}function Zf(r,e){const t=ss(r,e);return Object.keys(t).length>0}function Hs(r,e,t,n){const i=ss(r,e),a=[...n];for(const[s,l]of Object.entries(i))a[l]=t[s];return a}function Qf(r,e){const t=ss(r,e);return Object.values(t)}var ev=F('<div class="xy-pad svelte-wbxrfb" role="slider" aria-label="Pan and Tilt Control" tabindex="0"><div class="grid-line vertical svelte-wbxrfb" style="left: 25%"></div> <div class="grid-line vertical svelte-wbxrfb" style="left: 50%"></div> <div class="grid-line vertical svelte-wbxrfb" style="left: 75%"></div> <div class="grid-line horizontal svelte-wbxrfb" style="top: 25%"></div> <div class="grid-line horizontal svelte-wbxrfb" style="top: 50%"></div> <div class="grid-line horizontal svelte-wbxrfb" style="top: 75%"></div> <div></div></div>');function tv(r,e){tt(e,!0);let t=ie(e,"panValue",15,127),n=ie(e,"tiltValue",15,127),i=ie(e,"onUpdate",3,null),a=$(null),s=$(!1);function l(g,v){if(!o(a))return;const S=o(a).getBoundingClientRect();let N=(g-S.left)/S.width,I=(v-S.top)/S.height;N=Math.max(0,Math.min(1,N)),I=Math.max(0,Math.min(1,I)),t(Math.round(N*255)),n(Math.round((1-I)*255)),i()&&i()(t(),n())}function c(g){x(s,!0),l(g.clientX,g.clientY),g.preventDefault()}function u(g){o(s)&&l(g.clientX,g.clientY)}ir(()=>{const g=()=>{x(s,!1)};return window.addEventListener("mouseup",g),()=>window.removeEventListener("mouseup",g)});let f=De(()=>t()/255*100),d=De(()=>(1-n()/255)*100);var m=ev();m.__mousedown=c,m.__mousemove=u;var _=C(y(m),12);let h;Gr(m,g=>x(a,g),()=>o(a)),re(()=>{h=st(_,1,"crosshair svelte-wbxrfb",null,h,{active:o(s)}),Ht(_,`left: ${o(f)??""}%; top: ${o(d)??""}%`)}),M(r,m),rt()}wt(["mousedown","mousemove"]);var rv=F('<button type="button" role="switch"><span class="toggle-slider svelte-1fjc2jm"></span></button>');function nv(r,e){tt(e,!0);let t=ie(e,"checked",15,!1),n=ie(e,"disabled",3,!1),i=ie(e,"onchange",3,null),a=ie(e,"label",3,null);function s(){n()||(t(!t()),i()&&i()(t()))}var l=rv();let c;l.__click=s,re(()=>{c=st(l,1,"toggle-switch svelte-1fjc2jm",null,c,{on:t()}),l.disabled=n(),kt(l,"aria-checked",t()),kt(l,"aria-label",a())}),M(r,l),rt()}wt(["click"]);var iv=F('<div class="control-xypad svelte-15qavlb"><label class="svelte-15qavlb"> </label> <div><!></div> <div class="xypad-inputs svelte-15qavlb"><input type="text" class="value-input svelte-15qavlb" title="Pan" maxlength="3"/> <input type="text" class="value-input svelte-15qavlb" title="Tilt" maxlength="3"/></div></div>'),av=F('<div class="control svelte-15qavlb"><label class="svelte-15qavlb"> </label> <div class="toggle-wrapper svelte-15qavlb"><!></div> <input type="text" class="value-input svelte-15qavlb" maxlength="3"/></div>'),sv=F('<div class="control svelte-15qavlb"><label class="svelte-15qavlb"> </label> <div class="slider-wrapper svelte-15qavlb"><input type="range" min="0" max="255" class="color-slider svelte-15qavlb"/></div> <input type="text" class="value-input svelte-15qavlb" maxlength="3"/></div>'),ov=F('<div class="device-controls svelte-15qavlb"></div>');function Fl(r,e){tt(e,!0);let t=ie(e,"values",31,()=>Se([])),n=ie(e,"onChange",3,null),i=ie(e,"disabledChannels",19,()=>[]);function a(g,v){t(t()[g]=v,!0),n()&&n()(g,v)}function s(g,v,S,N){t(t()[g]=S,!0),t(t()[v]=N,!0),n()&&(n()(g,S),n()(v,N))}function l(g,v){const N=t()[g]===v.onValue?v.offValue:v.onValue;a(g,N)}function c(g,v,S){const N=parseInt(v);!isNaN(N)&&N>=0&&N<=255?a(g,N):v===""?S.target.value="":S.target.value=t()[g]}function u(g){g.target.value=g.target.value.replace(/[^0-9]/g,"")}function f(g){return i().includes(g)}function d(g){const v=Ze[e.deviceType].controls;let S=0;for(let N=0;N<g;N++)v[N].type==="xypad"?S+=2:S+=1;return S}function m(g){switch(g){case"Red":return"linear-gradient(to right, rgb(0,0,0) 0%, rgb(255,0,0) 100%)";case"Green":return"linear-gradient(to right, rgb(0,0,0) 0%, rgb(0,255,0) 100%)";case"Blue":return"linear-gradient(to right, rgb(0,0,0) 0%, rgb(0,0,255) 100%)";case"Amber":return"linear-gradient(to right, rgb(0,0,0) 0%, rgb(255,191,0) 100%)";case"White":return"linear-gradient(to right, rgb(0,0,0) 0%, rgb(255,255,255) 100%)";case"Dimmer":case"Intensity":return"linear-gradient(to right, rgb(0,0,0) 0%, rgb(255,255,255) 100%)";case"Output":return"linear-gradient(to right, rgb(0,0,0) 0%, rgb(200,200,200) 100%)";default:return"linear-gradient(to right, rgb(0,0,0) 0%, rgb(128,128,128) 100%)"}}function _(g,v){switch(g){case"Red":return`rgb(${v}, 0, 0)`;case"Green":return`rgb(0, ${v}, 0)`;case"Blue":return`rgb(0, 0, ${v})`;case"Amber":return`rgb(${v}, ${Math.round(v*.749)}, 0)`;case"White":return`rgb(${v}, ${v}, ${v})`;case"Dimmer":case"Intensity":return`rgb(${v}, ${v}, ${v})`;case"Output":return`rgb(${Math.round(v*.784)}, ${Math.round(v*.784)}, ${Math.round(v*.784)})`;default:return`rgb(${Math.round(v*.5)}, ${Math.round(v*.5)}, ${Math.round(v*.5)})`}}var h=ov();Ee(h,21,()=>Ze[e.deviceType].controls,je,(g,v,S)=>{var N=ar(),I=Ce(N);{var O=R=>{const j=De(()=>f(o(v).panIndex)),q=De(()=>f(o(v).tiltIndex)),te=De(()=>o(j)&&o(q));var ae=iv(),Z=y(ae),X=y(Z),K=C(Z,2);let Y;var J=y(K);tv(J,{onUpdate:(k,L)=>!o(te)&&s(o(v).panIndex,o(v).tiltIndex,k,L),get panValue(){return t()[o(v).panIndex]},set panValue(k){t(t()[o(v).panIndex]=k,!0)},get tiltValue(){return t()[o(v).tiltIndex]},set tiltValue(k){t(t()[o(v).tiltIndex]=k,!0)}});var Q=C(K,2),T=y(Q);T.__input=u,T.__change=k=>!o(j)&&c(o(v).panIndex,k.target.value,k);var b=C(T,2);b.__input=u,b.__change=k=>!o(q)&&c(o(v).tiltIndex,k.target.value,k),re(()=>{ve(X,o(v).name),Y=st(K,1,"xypad-wrapper svelte-15qavlb",null,Y,{disabled:o(te)}),Jr(T,t()[o(v).panIndex]),T.disabled=o(j),Jr(b,t()[o(v).tiltIndex]),b.disabled=o(q)}),M(R,ae)},D=R=>{var j=ar(),q=Ce(j);{var te=Z=>{const X=De(()=>d(S)),K=De(()=>f(o(X))),Y=De(()=>t()[o(X)]===o(v).onValue);var J=av(),Q=y(J),T=y(Q),b=C(Q,2),k=y(b);nv(k,{get checked(){return o(Y)},get disabled(){return o(K)},onchange:()=>l(o(X),o(v)),get label(){return o(v).name}});var L=C(b,2);L.__input=u,L.__change=B=>!o(K)&&c(o(X),B.target.value,B),re(()=>{ve(T,o(v).name),Jr(L,t()[o(X)]),L.disabled=o(K)}),M(Z,J)},ae=Z=>{const X=De(()=>d(S)),K=De(()=>f(o(X)));var Y=sv(),J=y(Y),Q=y(J),T=C(J,2),b=y(T);b.__input=L=>!o(K)&&a(o(X),parseInt(L.target.value));var k=C(T,2);k.__input=u,k.__change=L=>!o(K)&&c(o(X),L.target.value,L),re((L,B)=>{ve(Q,o(v).name),Jr(b,t()[o(X)]),Ht(b,`--slider-gradient: ${L??""}; --thumb-color: ${B??""}`),b.disabled=o(K),Jr(k,t()[o(X)]),k.disabled=o(K)},[()=>m(o(v).name),()=>_(o(v).name,t()[o(X)])]),M(Z,Y)};pe(q,Z=>{o(v).type==="toggle"?Z(te):Z(ae,!1)},!0)}M(R,j)};pe(I,R=>{o(v).type==="xypad"?R(O):R(D,!1)})}M(g,N)}),M(r,h),rt()}wt(["input","change"]);var lv=F("<button><!></button>");function Pe(r,e){let t=ie(e,"variant",3,"primary"),n=ie(e,"disabled",3,!1),i=ie(e,"onclick",3,null),a=ie(e,"type",3,"button"),s=ie(e,"pulsating",3,!1);var l=lv();l.__click=function(...u){var f;(f=i())==null||f.apply(this,u)};var c=y(l);Ii(c,()=>e.children),re(()=>{st(l,1,`button ${t()??""} ${s()?"pulsating":""}`,"svelte-18f749u"),l.disabled=n(),kt(l,"type",a())}),M(r,l)}wt(["click"]);var cv=F("<button><!></button>");function os(r,e){let t=ie(e,"onclick",3,null),n=ie(e,"disabled",3,!1),i=ie(e,"size",3,"medium");var a=cv();a.__click=function(...l){var c;(c=t())==null||c.apply(this,l)};var s=y(a);mt(s,{get data(){return e.icon}}),re(()=>{st(a,1,`icon-button ${i()??""}`,"svelte-cwtv5f"),a.disabled=n(),kt(a,"aria-label",e.label),kt(a,"title",e.label)}),M(r,a)}wt(["click"]);const _a=`<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="30" height="30" viewBox="0 0 30 30">
    <path d="M 22.828125 3 C 22.316375 3 21.804562 3.1954375 21.414062 3.5859375 L 19 6 L 24 11 L 26.414062 8.5859375 C 27.195062 7.8049375 27.195062 6.5388125 26.414062 5.7578125 L 24.242188 3.5859375 C 23.851688 3.1954375 23.339875 3 22.828125 3 z M 17 8 L 5.2597656 19.740234 C 5.2597656 19.740234 6.1775313 19.658 6.5195312 20 C 6.8615312 20.342 6.58 22.58 7 23 C 7.42 23.42 9.6438906 23.124359 9.9628906 23.443359 C 10.281891 23.762359 10.259766 24.740234 10.259766 24.740234 L 22 13 L 17 8 z M 4 23 L 3.0566406 25.671875 A 1 1 0 0 0 3 26 A 1 1 0 0 0 4 27 A 1 1 0 0 0 4.328125 26.943359 A 1 1 0 0 0 4.3378906 26.939453 L 4.3632812 26.931641 A 1 1 0 0 0 4.3691406 26.927734 L 7 26 L 5.5 24.5 L 4 23 z"></path>
</svg>`,uv=`<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="48" height="48" viewBox="0 0 48 48">
<path fill="#1976D2" d="M38 14h-3c-5.514 0-10 4.486-10 10s4.486 10 10 10h3c5.514 0 10-4.486 10-10S43.514 14 38 14M38 30h-3c-3.309 0-6-2.691-6-6s2.691-6 6-6h3c3.309 0 6 2.691 6 6S41.309 30 38 30M13 14h-3C4.486 14 0 18.486 0 24s4.486 10 10 10h3c5.514 0 10-4.486 10-10S18.514 14 13 14M13 30h-3c-3.309 0-6-2.691-6-6s2.691-6 6-6h3c3.309 0 6 2.691 6 6S16.309 30 13 30"></path><path fill="#42A5F5" d="M33,22H15c-1.104,0-2,0.896-2,2s0.896,2,2,2h18c1.104,0,2-0.896,2-2S34.104,22,33,22"></path>
</svg>`,li=`<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="48" height="48" viewBox="0 0 48 48">
<path fill="#b39ddb" d="M30.6,44H17.4c-2,0-3.7-1.4-4-3.4L9,11h30l-4.5,29.6C34.2,42.6,32.5,44,30.6,44z"></path><path fill="#9575cd" d="M28 6L20 6 14 12 34 12z"></path><path fill="#7e57c2" d="M10,8h28c1.1,0,2,0.9,2,2v2H8v-2C8,8.9,8.9,8,10,8z"></path>
</svg>`;var dv=F("<option> </option>"),fv=F('<div class="empty-state svelte-25wvt7"><p>No devices added yet. Add a device to get started!</p></div>'),vv=F('<div class="device-card svelte-25wvt7"><div class="device-header svelte-25wvt7"><div class="color-preview svelte-25wvt7"></div> <h3 class="svelte-25wvt7"> </h3> <!> <!></div> <!></div>'),hv=F("<!> Delete",1),pv=F("<!> <!>",1),_v=F("<option> </option>"),gv=F(`<select id="link-select" class="svelte-25wvt7"><option>None</option><!></select> <small class="link-help svelte-25wvt7">Link this device to follow another device's values</small>`,1),mv=F('<p class="no-devices svelte-25wvt7">No compatible devices available to link</p>'),yv=F('<form id="device-settings-form" method="dialog"><div class="dialog-input-group svelte-25wvt7"><label for="name-input">Name:</label> <input id="name-input" type="text" placeholder="Device name" class="svelte-25wvt7"/> <small class="css-id-preview svelte-25wvt7"> </small></div> <div class="dialog-input-group svelte-25wvt7"><label for="channel-input">Starting channel (1-512):</label> <input id="channel-input" type="number" min="1" max="512"/> <small class="channel-range svelte-25wvt7"> </small></div> <div class="dialog-input-group svelte-25wvt7"><label for="link-select">Link to device:</label> <!></div></form>'),wv=F('<div class="devices-container svelte-25wvt7"><div class="add-device-section svelte-25wvt7"><select class="svelte-25wvt7"></select> <!></div> <div class="devices-list svelte-25wvt7"><!> <!></div> <!></div>');function bv(r,e){tt(e,!0);let t=ie(e,"devices",31,()=>Se([])),n=$("RGB"),i=$(null),a=$(null),s=$(""),l=$(1),c=$(null);function u(w){x(a,w,!0),x(s,w.name,!0),x(l,w.startChannel+1),x(c,w.linkedTo||null,!0),requestAnimationFrame(()=>{var P;(P=o(i))==null||P.showModal()})}function f(){var w;(w=o(i))==null||w.close(),x(a,null),x(s,""),x(c,null)}function d(){o(a)&&confirm(`Are you sure you want to remove "${o(a).name}"?`)&&(R(o(a).id),f())}function m(){var P;return(o(s).trim()||((P=o(a))==null?void 0:P.name)||"").toLowerCase().replace(/[^a-z0-9]/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,"")}function _(){if(!o(a)||!h(o(a),o(l)-1))return;const w=Math.max(0,Math.min(511,o(l)-1)),P=new Pn(o(a).id,o(a).type,w,o(s).trim()||o(a).name,o(c));if(P.defaultValues=[...o(a).defaultValues],o(c)!==null){const A=t().find(E=>E.id===o(c));if(A){const E=Hs(A.type,P.type,A.defaultValues,P.defaultValues);P.defaultValues=E}}e.dmxController&&P.defaultValues.forEach((A,E)=>{const U=P.startChannel+E;e.dmxController.setChannel(U,A)}),t(t().map(A=>A.id===o(a).id?P:A)),f()}function h(w,P){const A=Ze[w.type].channels,E=P+A;if(E>512||P<0)return!1;for(let U of t()){if(U.id===w.id)continue;const ne=Ze[U.type].channels,le=U.startChannel,_e=le+ne;if(P<_e&&E>le)return!1}return!0}function g(){try{const w=localStorage.getItem("dmx-devices");if(w){const P=JSON.parse(w);return{devices:P.devices.map(E=>{const U=new Pn(E.id,E.type,E.startChannel,E.name,E.linkedTo,E.cssId);return U.defaultValues=E.defaultValues||new Array(Ze[E.type].channels).fill(0),U}),nextId:P.nextId||1}}}catch(w){console.error("Failed to load from localStorage:",w)}return{devices:[],nextId:1}}const v=t().length===0?g():{devices:t(),nextId:null};t().length===0&&t(v.devices);const S=t().length>0?Math.max(...t().map(w=>w.id)):0;let N=$(Se(Math.max(S+1,v.nextId||1)));ir(()=>{try{const w={devices:t().map(P=>({id:P.id,name:P.name,type:P.type,startChannel:P.startChannel,defaultValues:P.defaultValues,linkedTo:P.linkedTo})),nextId:o(N)};localStorage.setItem("dmx-devices",JSON.stringify(w))}catch(w){console.error("Failed to save to localStorage:",w)}});function I(){if(t().length===0)return 0;let w=0;return t().forEach(P=>{const A=P.startChannel+Ze[P.type].channels;A>w&&(w=A)}),w>=512?0:w}function O(w=o(n)){const P=I(),A=new Pn(Pi(N),w,P);t([...t(),A])}function D(){t(t().map(w=>(w.defaultValues=w.defaultValues.map(()=>0),w)))}function R(w){t(t().map(P=>(P.linkedTo===w&&(P.linkedTo=null),P)).filter(P=>P.id!==w))}function j(w,P,A){const E=new Pn(w.id,w.type,w.startChannel,w.name,w.linkedTo);E.defaultValues=[...w.defaultValues],E.defaultValues[P]=A,t(t().map(U=>U.id===w.id?E:U)),q(E),te(E)}function q(w){e.dmxController&&w.defaultValues.forEach((P,A)=>{const E=w.startChannel+A;e.dmxController.setChannel(E,P)})}function te(w){t(t().map(P=>{if(P.linkedTo===w.id){const A=new Pn(P.id,P.type,P.startChannel,P.name,P.linkedTo),E=Hs(w.type,P.type,w.defaultValues,P.defaultValues);return A.defaultValues=E,q(A),A}return P}))}function ae(w){return t().filter(P=>P.id!==w.id&&!P.isLinked()&&Zf(w.type,P.type)&&P.linkedTo!==w.id)}function Z(w){if(!w.linkedTo)return[];const P=t().find(A=>A.id===w.linkedTo);return P?Qf(P.type,w.type):[]}ir(()=>{e.dmxController&&t().forEach(w=>{q(w)})});var X={addDevice:O,clearAllDeviceValues:D},K=wv(),Y=y(K),J=y(Y);Ee(J,21,()=>Object.entries(Ze),je,(w,P)=>{var A=De(()=>Xs(o(P),2));let E=()=>o(A)[0],U=()=>o(A)[1];var ne=dv(),le=y(ne),_e={};re(()=>{ve(le,U().name),_e!==(_e=E())&&(ne.value=(ne.__value=E())??"")}),M(w,ne)});var Q=C(J,2);Pe(Q,{onclick:()=>O(o(n)),variant:"secondary",children:(w,P)=>{var A=Ne("Add Device");M(w,A)},$$slots:{default:!0}});var T=C(Y,2),b=y(T);{var k=w=>{var P=fv();M(w,P)};pe(b,w=>{t().length===0&&w(k)})}var L=C(b,2);Ee(L,17,t,w=>w.id,(w,P,A)=>{var E=vv(),U=y(E),ne=y(U),le=C(ne,2),_e=y(le),Ie=C(le,2);{var Te=Ye=>{mt(Ye,{get data(){return uv}})};pe(Ie,Ye=>{o(P).isLinked()&&Ye(Te)})}var Fe=C(Ie,2);os(Fe,{get icon(){return _a},onclick:()=>u(o(P)),title:"Device settings",size:"small"});var We=C(U,2);{let Ye=De(()=>Z(o(P)));Fl(We,{get deviceType(){return o(P).type},onChange:(V,z)=>j(o(P),V,z),get disabledChannels(){return o(Ye)},get values(){return o(P).defaultValues},set values(V){o(P).defaultValues=V}})}re(Ye=>{Ht(ne,`background-color: ${Ye??""}`),ve(_e,o(P).name)},[()=>Vn(o(P).type,o(P).defaultValues)]),M(w,E)});var B=C(T,2);{var W=w=>{rr(w,{title:"Device",onclose:f,get dialogRef(){return o(i)},set dialogRef(E){x(i,E,!0)},tools:E=>{Pe(E,{onclick:d,variant:"secondary",children:(U,ne)=>{var le=hv(),_e=Ce(le);jr(_e,()=>li),M(U,le)},$$slots:{default:!0}})},buttons:E=>{var U=pv(),ne=Ce(U);Pe(ne,{onclick:f,variant:"secondary",children:(_e,Ie)=>{var Te=Ne("Cancel");M(_e,Te)},$$slots:{default:!0}});var le=C(ne,2);{let _e=De(()=>!h(o(a),o(l)-1));Pe(le,{type:"submit",form:"device-settings-form",variant:"primary",get disabled(){return o(_e)},children:(Ie,Te)=>{var Fe=Ne("Save");M(Ie,Fe)},$$slots:{default:!0}})}M(E,U)},children:(E,U)=>{var ne=yv(),le=y(ne),_e=C(y(le),2),Ie=C(_e,2),Te=y(Ie),Fe=C(le,2),We=C(y(Fe),2);let Ye;var V=C(We,2),z=y(V),oe=C(Fe,2),ee=C(y(oe),2);{var we=ce=>{var ge=gv(),xe=Ce(ge),ke=y(xe);ke.value=(ke.__value=null)??"";var bt=C(ke);Ee(bt,17,()=>ae(o(a)),je,(lt,ct)=>{var ut=_v(),Ot=y(ut),Pt={};re(()=>{ve(Ot,`${o(ct).name??""} (${Ze[o(ct).type].name??""})`),Pt!==(Pt=o(ct).id)&&(ut.value=(ut.__value=o(ct).id)??"")}),M(lt,ut)}),it(xe,()=>o(c),lt=>x(c,lt)),M(ce,ge)},se=ce=>{var ge=mv();M(ce,ge)};pe(ee,ce=>{ae(o(a)).length>0||o(a).isLinked()?ce(we):ce(se,!1)})}re((ce,ge)=>{ve(Te,`#${ce??""}`),Ye=st(We,1,"svelte-25wvt7",null,Ye,ge),ve(z,`Device uses ${Ze[o(a).type].channels??""} channels:
                ${o(l)??""}-${o(l)+Ze[o(a).type].channels-1}`)},[m,()=>({valid:h(o(a),o(l)-1),invalid:!h(o(a),o(l)-1)})]),Fr("submit",ne,ce=>{ce.preventDefault(),_()}),gr(_e,()=>o(s),ce=>x(s,ce)),gr(We,()=>o(l),ce=>x(l,ce)),M(E,ne)},$$slots:{tools:!0,buttons:!0,default:!0}})};pe(B,w=>{o(a)&&w(W)})}return it(J,()=>o(n),w=>x(n,w)),M(r,K),rt(X)}var Sv=F('<div class="gradient-segment svelte-ctef3a"></div>'),Dv=F('<div><div class="keyframe-time svelte-ctef3a"> </div></div>'),Ev=F("<!> Delete",1),Cv=F('<div class="timeline-container svelte-ctef3a"><div class="timeline svelte-ctef3a"><!> <!></div></div> <!>',1);function Iv(r,e){tt(e,!0);let t=ie(e,"animation",7),n=ie(e,"animationVersion",3,0),i=ie(e,"onUpdate",3,null),a=$(Se([0,0,0])),s=$(null),l=$(null),c=$(null),u=$(null),f=$(800),d=$(null),m=$(0),_=$(0),h=$(!1),g=De(()=>(n(),t()?t().keyframes:[])),v=De(()=>{if(n(),!t()||t().keyframes.length<2)return[];const b=[],k=t().keyframes,L=k[0];if(L.time>0){const W=t().getKeyframeColor(L);b.push({left:0,width:L.time*o(f),gradient:W})}for(let W=0;W<k.length-1;W++){const w=k[W],P=k[W+1],A=t().getKeyframeColor(w),E=t().getKeyframeColor(P),U=w.time*o(f),ne=(P.time-w.time)*o(f);b.push({left:U,width:ne,gradient:`linear-gradient(to right, ${A}, ${E})`})}const B=k[k.length-1];if(B.time<1){const W=t().getKeyframeColor(B),w=B.time*o(f),P=(1-B.time)*o(f);b.push({left:w,width:P,gradient:W})}return b});function S(b){return n(),b.time*o(f)}function N(b,k=null){if(!t())return;x(s,b,!0);const L=t().keyframes[b];x(a,[...L.values],!0),x(c,k,!0),requestAnimationFrame(()=>{var B;(B=o(l))==null||B.showModal()})}function I(){var b;(b=o(l))==null||b.close(),x(s,null),x(c,null)}function O(){if(!t()||o(s)===null)return;const b=t().keyframes[o(s)];b.values=[...o(a)],e.animationLibrary.save(),i()&&i()()}function D(){if(!(!t()||o(s)===null)){if(t().keyframes.length<=2){alert("Animation must have at least 2 keyframes");return}confirm(`Delete keyframe at ${(t().keyframes[o(s)].time*100).toFixed(0)}%?`)&&(R(o(s)),I())}}function R(b){if(!t()||t().keyframes.length<=2){alert("Animation must have at least 2 keyframes");return}t().keyframes=t().keyframes.filter((k,L)=>L!==b),e.animationLibrary.save(),i()&&i()(),x(s,null)}function j(b){if(!t()||b.target.classList.contains("timeline-keyframe-marker")||b.target.classList.contains("keyframe-time")||b.target.closest(".timeline-keyframe-marker"))return;const L=b.currentTarget.getBoundingClientRect(),B=b.clientX-L.left,W=Math.max(0,Math.min(1,B/o(f))),w=Math.round(W*20)/20;if(t().keyframes.some(U=>Math.abs(U.time-w)<.001))return;const A=t().getValuesAtTime(w);t().addKeyframe(w,A),e.animationLibrary.save(),i()&&i()();const E=t().keyframes.findIndex(U=>Math.abs(U.time-w)<.001);E!==-1&&requestAnimationFrame(()=>{requestAnimationFrame(()=>{const U=document.getElementById(`keyframe-${t().name}-${E}`);U&&N(E,U)})})}function q(b,k,L){b.preventDefault(),b.stopPropagation(),x(d,{keyframe:k,index:L},!0),x(m,b.clientX,!0),x(_,k.time,!0),x(h,!1),document.addEventListener("mousemove",te),document.addEventListener("mouseup",ae)}function te(b){if(!o(d)||!t())return;const k=b.clientX-o(m),L=k/o(f);let B=o(_)+L;B=Math.max(0,Math.min(1,B)),B=Math.round(B*100)/100;const W=t().keyframes[0],w=t().keyframes[t().keyframes.length-1];o(d).index!==0&&B===0&&W.time===0||o(d).index!==t().keyframes.length-1&&B===1&&w.time===1||(o(d).keyframe.time=B,t().keyframes.sort((P,A)=>P.time-A.time),o(d).index=t().keyframes.indexOf(o(d).keyframe),Math.abs(k)>3&&x(h,!0),i()&&i()())}function ae(){o(d)&&t()&&e.animationLibrary.save(),x(d,null),document.removeEventListener("mousemove",te),document.removeEventListener("mouseup",ae),setTimeout(()=>{x(h,!1)},10)}var Z=Cv(),X=Ce(Z),K=y(X);K.__click=j;var Y=y(K);Ee(Y,17,()=>o(v),je,(b,k)=>{var L=Sv();re(()=>Ht(L,`left: ${o(k).left??""}px; width: ${o(k).width??""}px; background: ${o(k).gradient??""}`)),M(b,L)});var J=C(Y,2);Ee(J,19,()=>o(g),(b,k)=>b.time+"-"+k+"-"+n(),(b,k,L)=>{var B=Dv();let W;B.__mousedown=A=>q(A,o(k),o(L)),B.__click=A=>{A.stopPropagation(),o(h)||N(o(L),A.currentTarget)};var w=y(B),P=y(w);re((A,E,U,ne)=>{var le;kt(B,"id",`keyframe-${t().name??""}-${o(L)??""}`),W=st(B,1,"timeline-keyframe-marker svelte-ctef3a",null,W,{dragging:((le=o(d))==null?void 0:le.keyframe)===o(k)}),Ht(B,`left: ${A??""}px; --keyframe-color: ${E??""}; anchor-name: --keyframe-${t().name??""}-${o(L)??""}`),kt(B,"title",`${U??""}%`),ve(P,`${ne??""}%`)},[()=>S(o(k)),()=>t().getKeyframeColor(o(k)),()=>(o(k).time*100).toFixed(0),()=>(o(k).time*100).toFixed(0)]),M(b,B)}),Gr(K,b=>x(u,b),()=>o(u));var Q=C(X,2);{var T=b=>{{const k=W=>{{let w=De(()=>t().keyframes.length<=2);Pe(W,{onclick:D,variant:"secondary",get disabled(){return o(w)},children:(P,A)=>{var E=Ev(),U=Ce(E);jr(U,()=>li),M(P,E)},$$slots:{default:!0}})}};let L=De(()=>`keyframe-${t().name}-${o(s)}`),B=De(()=>(t().keyframes[o(s)].time*100).toFixed(0));rr(b,{anchored:!0,get anchorId(){return o(L)},showArrow:!0,lightDismiss:!0,onclose:I,get title(){return`Keyframe at ${o(B)??""}%`},get dialogRef(){return o(l)},set dialogRef(W){x(l,W,!0)},tools:k,children:(W,w)=>{Fl(W,{get deviceType(){return t().deviceType},onChange:O,get values(){return o(a)},set values(P){x(a,P,!0)}})},$$slots:{tools:!0,default:!0}})}};pe(Q,b=>{o(c)&&t()&&o(s)!==null&&b(T)})}gu(K,"clientWidth",b=>x(f,b)),M(r,Z),rt()}wt(["click","mousedown"]);var xv=F('<div class="empty-state svelte-nhkann"><p class="svelte-nhkann">No animations yet. Create one to get started!</p></div>'),kv=F('<div class="animation-card svelte-nhkann"><div class="animation-header svelte-nhkann"><div class="animation-info svelte-nhkann"><h3 class="svelte-nhkann"> </h3> <div class="device-type-badge svelte-nhkann"> </div></div> <!></div> <!></div>'),Mv=F("<!> <!>",1),Pv=F("<option> </option>"),Lv=F('<form id="new-animation-form" method="dialog"><div class="dialog-input-group"><label for="animation-name">Animation Name:</label> <input id="animation-name" type="text" placeholder="e.g., rainbow, pulse, sweep"/></div> <div class="dialog-input-group"><label for="device-type">Device Type:</label> <select id="device-type"></select></div></form>'),Av=F("<!> Delete",1),Rv=F("<!> <!>",1),Tv=F('<form id="edit-animation-form" method="dialog"><div class="dialog-input-group"><label for="edit-animation-name">Name:</label> <input id="edit-animation-name" type="text" placeholder="Animation name"/></div></form>'),Ov=F('<div class="animations-view svelte-nhkann"><div class="add-animation-section svelte-nhkann"><!></div> <div class="animations-list svelte-nhkann"><!></div></div> <!> <!>',1);function Nv(r,e){tt(e,!0),ie(e,"devices",19,()=>[]);let t=$(Se([])),n=$(null),i=$(""),a=$("RGB"),s=$(null),l=$(null),c=$(""),u=$(0);function f(){if(x(t,e.animationLibrary.getAll(),!0),o(l)){const K=o(t).find(Y=>Y.name===o(l).name);K?x(l,K,!0):x(l,null)}}Cn(()=>{f()});function d(){var K;x(i,""),x(a,"RGB"),(K=o(n))==null||K.showModal()}function m(){var T;if(!o(i).trim())return;const K=o(a),Y=Ze[K].channels,J=new Array(Y).fill(0),Q=new ea(o(i).trim(),K);Q.addKeyframe(0,[...J]),Q.addKeyframe(1,[...J]),e.animationLibrary.add(Q),f(),(T=o(n))==null||T.close()}function _(K){x(l,K,!0),x(c,K.name,!0),requestAnimationFrame(()=>{var Y;(Y=o(s))==null||Y.showModal()})}function h(){var K;(K=o(s))==null||K.close(),x(l,null),x(c,"")}function g(){!o(l)||!o(c).trim()||(o(l).name,o(l).name=o(c).trim(),e.animationLibrary.save(),f(),h())}function v(){o(l)&&confirm(`Are you sure you want to delete "${o(l).name}"?`)&&(e.animationLibrary.remove(o(l).name),f(),h())}function S(){Pi(u)}var N=Ov(),I=Ce(N),O=y(I),D=y(O);Pe(D,{onclick:d,variant:"secondary",children:(K,Y)=>{var J=Ne("Add Animation");M(K,J)},$$slots:{default:!0}});var R=C(O,2),j=y(R);{var q=K=>{var Y=xv();M(K,Y)},te=K=>{var Y=ar(),J=Ce(Y);Ee(J,17,()=>o(t),Q=>Q.name,(Q,T)=>{var b=kv(),k=y(b),L=y(k),B=y(L),W=y(B),w=C(B,2),P=y(w),A=C(L,2);os(A,{get icon(){return _a},onclick:()=>_(o(T)),title:"Edit animation",size:"small"});var E=C(k,2);Iv(E,{get animation(){return o(T)},get animationLibrary(){return e.animationLibrary},get animationVersion(){return o(u)},onUpdate:S}),re(()=>{ve(W,o(T).name),ve(P,Ze[o(T).deviceType].name)}),M(Q,b)}),M(K,Y)};pe(j,K=>{o(t).length===0?K(q):K(te,!1)})}var ae=C(I,2);rr(ae,{title:"Create New Animation",onclose:()=>{var Y;return(Y=o(n))==null?void 0:Y.close()},get dialogRef(){return o(n)},set dialogRef(Y){x(n,Y,!0)},buttons:Y=>{var J=Mv(),Q=Ce(J);Pe(Q,{type:"button",onclick:()=>{var b;return(b=o(n))==null?void 0:b.close()},variant:"secondary",children:(b,k)=>{var L=Ne("Cancel");M(b,L)},$$slots:{default:!0}});var T=C(Q,2);Pe(T,{type:"submit",form:"new-animation-form",variant:"primary",children:(b,k)=>{var L=Ne("Create");M(b,L)},$$slots:{default:!0}}),M(Y,J)},children:(Y,J)=>{var Q=Lv(),T=y(Q),b=C(y(T),2);Li(b,!0);var k=C(T,2),L=C(y(k),2);Ee(L,21,()=>Object.entries(Ze),je,(B,W)=>{var w=De(()=>Xs(o(W),2));let P=()=>o(w)[0],A=()=>o(w)[1];var E=Pv(),U=y(E),ne={};re(()=>{ve(U,A().name),ne!==(ne=P())&&(E.value=(E.__value=P())??"")}),M(B,E)}),Fr("submit",Q,B=>{B.preventDefault(),m()}),gr(b,()=>o(i),B=>x(i,B)),it(L,()=>o(a),B=>x(a,B)),M(Y,Q)},$$slots:{buttons:!0,default:!0}});var Z=C(ae,2);{var X=K=>{rr(K,{title:"Animation",onclose:h,get dialogRef(){return o(s)},set dialogRef(Q){x(s,Q,!0)},tools:Q=>{Pe(Q,{onclick:v,variant:"secondary",children:(T,b)=>{var k=Av(),L=Ce(k);jr(L,()=>li),M(T,k)},$$slots:{default:!0}})},buttons:Q=>{var T=Rv(),b=Ce(T);Pe(b,{onclick:h,variant:"secondary",children:(L,B)=>{var W=Ne("Cancel");M(L,W)},$$slots:{default:!0}});var k=C(b,2);Pe(k,{type:"submit",form:"edit-animation-form",variant:"primary",children:(L,B)=>{var W=Ne("Save");M(L,W)},$$slots:{default:!0}}),M(Q,T)},children:(Q,T)=>{var b=Tv(),k=y(b),L=C(y(k),2);Li(L,!0),Fr("submit",b,B=>{B.preventDefault(),g()}),gr(L,()=>o(c),B=>x(c,B)),M(Q,b)},$$slots:{tools:!0,buttons:!0,default:!0}})};pe(Z,K=>{o(l)&&K(X)})}M(r,N),rt()}var Fv=F('<div class="empty-state svelte-an69h5"><p class="svelte-an69h5">No inputs detected yet. Start listening to detect inputs!</p></div>'),Bv=F('<div class="input-color-badge svelte-an69h5"></div>'),Vv=F('<div class="input-card svelte-an69h5"><!> <div class="input-header svelte-an69h5"><div class="input-name svelte-an69h5"> </div> <div class="input-device-name svelte-an69h5"> </div></div> <div class="input-actions svelte-an69h5"><button class="edit-button svelte-an69h5" title="Rename input"><!></button></div></div>'),jv=F("<!> Delete",1),Gv=F("<!> <!>",1),$v=F('<form id="edit-input-form" method="dialog"><div class="dialog-input-group svelte-an69h5"><label for="input-name">Name:</label> <input id="input-name" type="text" placeholder="Input name" class="svelte-an69h5"/></div></form>'),Kv=F('<div class="inputs-view svelte-an69h5"><div class="listen-section svelte-an69h5"><!></div> <div class="inputs-grid svelte-an69h5"><!></div></div> <!>',1);function Uv(r,e){tt(e,!0);let t=$(!1),n=$(Se([])),i=$(null),a=$(""),s=$(null),l=[];function c(){x(t,!0);const T=e.inputController.getInputDevices();for(const b of T){const k=L=>{u({deviceId:b.id,controlId:L.controlId,type:L.velocity!==void 0?"trigger":"change",device:b})};b.on("trigger",k),b.on("change",k),l.push({device:b,event:"trigger",handler:k}),l.push({device:b,event:"change",handler:k})}e.inputController.on("deviceadded",f)}function u(T){if(!o(t))return;const{deviceId:b,controlId:k,device:L}=T;if(!o(n).find(W=>W.inputDeviceId===b&&W.inputControlId===k)){const W=m((L==null?void 0:L.name)||b,k),w=(L==null?void 0:L.type)==="hid"&&L.id!=="keyboard",P=new yn({name:W,mode:"input",inputDeviceId:b,inputControlId:k,inputDeviceName:(L==null?void 0:L.name)||b,color:w?void 0:null});if(e.mappingLibrary.add(P),I(),w&&k.startsWith("button-")){const A=parseInt(k.replace("button-",""));if(!isNaN(A)&&A>=0){const E=e.inputController.inputDeviceManager.streamDeckManager,U=b;E.setButtonColor(U,A,P.color).catch(ne=>{console.warn(`Could not set button ${A} color:`,ne)})}}}}function f(T){if(!o(t))return;const b=k=>{u({deviceId:T.id,controlId:k.controlId,type:k.velocity!==void 0?"trigger":"change",device:T})};T.on("trigger",b),T.on("change",b),l.push({device:T,event:"trigger",handler:b}),l.push({device:T,event:"change",handler:b})}function d(){x(t,!1);for(const{device:T,event:b,handler:k}of l)T.off(b,k);l=[],e.inputController.off("deviceadded",f)}function m(T,b){if(b.startsWith("note-")){const k=b.replace("note-","");return`${T} Note ${k}`}else if(b.startsWith("control-")||b.startsWith("cc-")){const k=b.replace("control-","").replace("cc-","");return`${T} Control ${k}`}else if(b.startsWith("button-")){const k=b.replace("button-","");return`${T} Button ${k}`}else if(b.startsWith("key-")){const k=b.replace("key-","");return`Keyboard ${k.replace("Key","").replace("Digit","")||k}`}else return`${T} ${b}`}function _(T){x(i,T,!0),x(a,T.name,!0),requestAnimationFrame(()=>{var b;(b=o(s))==null||b.showModal()})}function h(){if(!o(i)||!o(a).trim())return;const T=e.mappingLibrary.get(o(i).id);T&&(T.name=o(a).trim(),e.mappingLibrary.update(T),I()),v()}function g(){v()}function v(){var T;(T=o(s))==null||T.close(),x(i,null),x(a,"")}async function S(){o(i)&&confirm(`Are you sure you want to delete "${o(i).name}"?`)&&(await N(o(i).id),v())}async function N(T){const b=e.mappingLibrary.get(T);if(!b)return;const k=e.inputController.getInputDevice(b.inputDeviceId);if((k==null?void 0:k.type)==="hid"&&k.id!=="keyboard"&&b.inputControlId.startsWith("button-")){const L=parseInt(b.inputControlId.replace("button-",""));if(!isNaN(L)&&L>=0){const B=e.inputController.inputDeviceManager.streamDeckManager,W=b.inputDeviceId;await B.clearButtonColor(W,L)}}e.mappingLibrary.remove(T),I()}function I(){x(n,e.mappingLibrary.getAll().filter(T=>T.mode==="input").map(T=>({...T})),!0)}async function O(){const T=e.inputController.inputDeviceManager.streamDeckManager;if(T.getConnectedDevices().length!==0)for(const k of o(n)){const L=e.inputController.getInputDevice(k.inputDeviceId);if((L==null?void 0:L.type)==="hid"&&L.id!=="keyboard"&&k.inputControlId.startsWith("button-")){const B=parseInt(k.inputControlId.replace("button-",""));if(!isNaN(B)&&B>=0){const W=k.inputDeviceId;await T.setButtonColor(W,B,k.color)}}}}Cn(()=>{I(),e.inputController.on("deviceadded",T=>{T.type==="hid"&&setTimeout(()=>O(),500)}),setTimeout(()=>O(),1e3)}),Qi(()=>{d()});var D=Kv(),R=Ce(D),j=y(R),q=y(j);{var te=T=>{Pe(T,{onclick:d,variant:"primary",pulsating:!0,children:(b,k)=>{var L=Ne("Stop Listening");M(b,L)},$$slots:{default:!0}})},ae=T=>{Pe(T,{onclick:c,variant:"secondary",children:(b,k)=>{var L=Ne("Start Listening");M(b,L)},$$slots:{default:!0}})};pe(q,T=>{o(t)?T(te):T(ae,!1)})}var Z=C(j,2),X=y(Z);{var K=T=>{var b=Fv();M(T,b)},Y=T=>{var b=ar(),k=Ce(b);Ee(k,17,()=>o(n),L=>L.id,(L,B)=>{var W=Vv(),w=y(W);{var P=Fe=>{var We=Bv();re(()=>Ht(We,`background-color: ${o(B).color??""}`)),M(Fe,We)};pe(w,Fe=>{o(B).color&&Fe(P)})}var A=C(w,2),E=y(A),U=y(E),ne=C(E,2),le=y(ne),_e=C(A,2),Ie=y(_e);Ie.__click=()=>_(o(B));var Te=y(Ie);jr(Te,()=>_a),re(()=>{ve(U,o(B).name),ve(le,o(B).inputDeviceName||o(B).inputDeviceId)}),M(L,W)}),M(T,b)};pe(X,T=>{o(n).length===0?T(K):T(Y,!1)})}var J=C(R,2);{var Q=T=>{rr(T,{title:"Input",onclose:v,get dialogRef(){return o(s)},set dialogRef(L){x(s,L,!0)},tools:L=>{Pe(L,{onclick:S,variant:"secondary",children:(B,W)=>{var w=jv(),P=Ce(w);jr(P,()=>li),M(B,w)},$$slots:{default:!0}})},buttons:L=>{var B=Gv(),W=Ce(B);Pe(W,{onclick:g,variant:"secondary",children:(P,A)=>{var E=Ne("Cancel");M(P,E)},$$slots:{default:!0}});var w=C(W,2);Pe(w,{type:"submit",form:"edit-input-form",variant:"primary",children:(P,A)=>{var E=Ne("Save");M(P,E)},$$slots:{default:!0}}),M(L,B)},children:(L,B)=>{var W=$v(),w=y(W),P=C(y(w),2);P.__keydown=A=>{A.key==="Enter"&&h(),A.key==="Escape"&&g()},Li(P,!0),Fr("submit",W,A=>{A.preventDefault(),h()}),gr(P,()=>o(a),A=>x(a,A)),M(L,W)},$$slots:{tools:!0,buttons:!0,default:!0}})};pe(J,T=>{o(i)&&T(Q)})}M(r,D),rt()}wt(["click","keydown"]);var Hv=F('<p class="svelte-17ww3d9">No inputs available. Go to the Inputs tab to detect and save inputs first.</p>'),zv=F('<p class="svelte-17ww3d9">No animations available. Go to the Animations tab to create animations first.</p>'),qv=F('<p class="svelte-17ww3d9">No devices available. Go to the Devices tab to add devices first.</p>'),Wv=F('<div class="empty-state svelte-17ww3d9"><!> <!> <!></div>'),Yv=F('<div class="empty-state svelte-17ww3d9"><p class="svelte-17ww3d9">No triggers created yet. Click Add Trigger to create one!</p></div>'),Xv=F('<div class="trigger-card svelte-17ww3d9"><div class="trigger-content svelte-17ww3d9"><span class="trigger-text svelte-17ww3d9"> </span> <!></div></div>'),Jv=F("<!> <!>",1),Zv=F("<option> </option>"),Qv=F("<option> </option>"),eh=F("<option> </option>"),th=F("<option> </option>"),rh=F("<option> </option>"),nh=F('<form id="manual-trigger-form" method="dialog"><div class="trigger-columns svelte-17ww3d9"><div class="trigger-column svelte-17ww3d9"><div class="dialog-input-group"><label for="trigger-input">Input:</label> <select id="trigger-input"></select></div> <div class="dialog-input-group"><label for="trigger-type">Type:</label> <select id="trigger-type"></select></div></div> <div class="trigger-column svelte-17ww3d9"><div class="dialog-input-group"><label for="trigger-device">Device:</label> <select id="trigger-device"></select></div> <div class="dialog-input-group"><label for="trigger-animation">Animation:</label> <select id="trigger-animation"></select></div></div> <div class="trigger-column svelte-17ww3d9"><div class="dialog-input-group"><label for="trigger-duration">Duration (ms):</label> <div class="duration-with-loop svelte-17ww3d9"><input id="trigger-duration" type="number" min="100" step="100" class="svelte-17ww3d9"/> <div class="checkbox-field svelte-17ww3d9"><label class="svelte-17ww3d9"><input type="checkbox" class="svelte-17ww3d9"/> Loop</label></div></div></div> <div class="dialog-input-group"><label for="trigger-easing">Easing:</label> <select id="trigger-easing"></select></div></div></div></form>'),ih=F("<!> <!>",1),ah=F("<option> </option>"),sh=F("<option> </option>"),oh=F("<option> </option>"),lh=F('<form id="automatic-trigger-form" method="dialog"><div class="trigger-columns svelte-17ww3d9"><div class="trigger-column svelte-17ww3d9"><div class="dialog-input-group"><label for="auto-trigger-device">Device:</label> <select id="auto-trigger-device"></select></div> <div class="dialog-input-group"><label for="auto-trigger-animation">Animation:</label> <select id="auto-trigger-animation"></select></div></div> <div class="trigger-column svelte-17ww3d9"><div class="dialog-input-group"><label for="auto-trigger-duration">Duration (ms):</label> <div class="duration-with-loop svelte-17ww3d9"><input id="auto-trigger-duration" type="number" min="100" step="100" class="svelte-17ww3d9"/> <div class="checkbox-field svelte-17ww3d9"><label class="svelte-17ww3d9"><input type="checkbox" class="svelte-17ww3d9"/> Loop</label></div></div></div> <div class="dialog-input-group"><label for="auto-trigger-easing">Easing:</label> <select id="auto-trigger-easing"></select></div></div></div></form>'),ch=F("<!> Delete",1),uh=F("<!> <!>",1),dh=F("<option> </option>"),fh=F('<div class="trigger-column svelte-17ww3d9"><div class="dialog-input-group"><label for="edit-trigger-type">Type:</label> <select id="edit-trigger-type"></select></div></div>'),vh=F("<option> </option>"),hh=F("<option> </option>"),ph=F("<option> </option>"),_h=F('<form id="edit-trigger-form" method="dialog"><div class="trigger-columns svelte-17ww3d9"><!> <div class="trigger-column svelte-17ww3d9"><div class="dialog-input-group"><label for="edit-trigger-device">Device:</label> <select id="edit-trigger-device"></select></div> <div class="dialog-input-group"><label for="edit-trigger-animation">Animation:</label> <select id="edit-trigger-animation"></select></div></div> <div class="trigger-column svelte-17ww3d9"><div class="dialog-input-group"><label for="edit-trigger-duration">Duration (ms):</label> <div class="duration-with-loop svelte-17ww3d9"><input id="edit-trigger-duration" type="number" min="100" step="100" class="svelte-17ww3d9"/> <div class="checkbox-field svelte-17ww3d9"><label class="svelte-17ww3d9"><input type="checkbox" class="svelte-17ww3d9"/> Loop</label></div></div></div> <div class="dialog-input-group"><label for="edit-trigger-easing">Easing:</label> <select id="edit-trigger-easing"></select></div></div></div></form>'),gh=F('<div class="triggers-view svelte-17ww3d9"><div class="add-trigger-section svelte-17ww3d9"><!> <!></div> <div class="triggers-list svelte-17ww3d9"><!></div></div> <!> <!> <!>',1);function mh(r,e){tt(e,!0);let t=ie(e,"devices",19,()=>[]),n=$(Se([])),i=$(Se([])),a=$(Se([])),s=$(null),l=$(null),c=$(null),u=$("pressed"),f=$(null),d=$(null),m=$(1e3),_=$(!1),h=$("linear"),g=$(null),v=$(null),S=$(null),N=$("pressed"),I=$(null),O=$(null),D=$(1e3),R=$(!1),j=$("linear");const q=[{value:"pressed",label:"Pressed"},{value:"not-pressed",label:"Not Pressed"}],te=["linear","ease","ease-in","ease-out","ease-in-out","cubic-bezier(0.4, 0.0, 0.2, 1)","cubic-bezier(0.68, -0.55, 0.265, 1.55)"];function ae(){x(n,e.mappingLibrary.getAll().filter(V=>V.mode==="input"),!0),x(i,e.animationLibrary.getAll(),!0),x(a,e.mappingLibrary.getAll().filter(V=>V.mode==="trigger"),!0)}function Z(){ae()}function X(){var V,z,oe,ee;x(c,((V=o(n)[0])==null?void 0:V.id)||null,!0),x(u,"pressed"),x(f,((z=t()[0])==null?void 0:z.id)||null,!0),x(d,((oe=o(i)[0])==null?void 0:oe.name)||null,!0),x(m,1e3),x(_,!1),x(h,"linear"),(ee=o(s))==null||ee.showModal()}function K(){var V,z;x(f,((V=t()[0])==null?void 0:V.id)||null,!0),x(d,((z=o(i)[0])==null?void 0:z.name)||null,!0),x(m,1e3),x(_,!1),x(h,"linear"),requestAnimationFrame(()=>{var oe;(oe=o(l))==null||oe.showModal()})}function Y(){var se;if(!o(c)||!o(f)||!o(d))return;const V=e.mappingLibrary.get(o(c));if(!V)return;const z=V.name.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""),oe=o(u)==="pressed"?"down":"up",ee=`${z}-${oe}`,we=new yn({name:`${V.name}_${o(u)}_${o(d)}`,mode:"trigger",triggerType:o(u),inputDeviceId:V.inputDeviceId,inputControlId:V.inputControlId,animationName:o(d),targetDeviceIds:[o(f)],duration:o(m),easing:o(h),iterations:o(_)?"infinite":1,cssClassName:ee});e.mappingLibrary.add(we),ae(),(se=o(s))==null||se.close()}function J(){var z;if(!o(f)||!o(d))return;const V=new yn({name:`always_${o(d)}`,mode:"trigger",triggerType:"always",inputDeviceId:null,inputControlId:null,animationName:o(d),targetDeviceIds:[o(f)],duration:o(m),easing:o(h),iterations:o(_)?"infinite":1,cssClassName:"always"});e.mappingLibrary.add(V),ae(),(z=o(l))==null||z.close()}function Q(V){x(v,V,!0),x(S,V.inputDeviceId+"_"+V.inputControlId),x(N,V.triggerType,!0),x(I,V.targetDeviceIds[0],!0),x(O,V.animationName,!0),x(D,V.duration,!0),x(R,V.iterations==="infinite"),x(j,V.easing,!0),requestAnimationFrame(()=>{var z;(z=o(g))==null||z.showModal()})}function T(){var V;(V=o(g))==null||V.close(),x(v,null)}function b(){if(o(v)){if(o(v).triggerType==="always")o(v).targetDeviceIds=[o(I)],o(v).animationName=o(O),o(v).duration=o(D),o(v).easing=o(j),o(v).iterations=o(R)?"infinite":1,o(v).name=`always_${o(O)}`;else{const V=o(n).find(we=>we.inputDeviceId===o(v).inputDeviceId&&we.inputControlId===o(v).inputControlId);if(!V)return;const z=V.name.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""),oe=o(N)==="pressed"?"down":"up",ee=`${z}-${oe}`;o(v).triggerType=o(N),o(v).targetDeviceIds=[o(I)],o(v).animationName=o(O),o(v).duration=o(D),o(v).easing=o(j),o(v).iterations=o(R)?"infinite":1,o(v).cssClassName=ee,o(v).name=`${V.name}_${o(N)}_${o(O)}`}e.mappingLibrary.save(),ae(),T()}}function k(){o(v)&&confirm("Are you sure you want to delete this trigger?")&&(e.mappingLibrary.remove(o(v).id),ae(),T())}function L(V,z){const oe=o(n).find(ee=>ee.inputDeviceId===V&&ee.inputControlId===z);return(oe==null?void 0:oe.name)||`${V}_${z}`}function B(V){const z=t().find(oe=>oe.id===V);return(z==null?void 0:z.name)||V}function W(V){const z=B(V.targetDeviceIds[0]);if(V.triggerType==="always")return`Always â ${V.animationName} â ${z}`;const oe=L(V.inputDeviceId,V.inputControlId),ee=V.triggerType==="pressed"?"Pressed":"Not Pressed";return`${oe} â ${ee} â ${V.animationName} â ${z}`}Cn(()=>{ae(),e.mappingLibrary.on("changed",Z)}),Qi(()=>{e.mappingLibrary.off("changed",Z)});var w=gh(),P=Ce(w),A=y(P),E=y(A);{let V=De(()=>o(n).length===0||o(i).length===0||t().length===0);Pe(E,{onclick:X,variant:"secondary",get disabled(){return o(V)},children:(z,oe)=>{var ee=Ne("Add Manual Trigger");M(z,ee)},$$slots:{default:!0}})}var U=C(E,2);{let V=De(()=>o(i).length===0||t().length===0);Pe(U,{onclick:K,variant:"secondary",get disabled(){return o(V)},children:(z,oe)=>{var ee=Ne("Add Automatic Trigger");M(z,ee)},$$slots:{default:!0}})}var ne=C(A,2),le=y(ne);{var _e=V=>{var z=Wv(),oe=y(z);{var ee=xe=>{var ke=Hv();M(xe,ke)};pe(oe,xe=>{o(n).length===0&&xe(ee)})}var we=C(oe,2);{var se=xe=>{var ke=zv();M(xe,ke)};pe(we,xe=>{o(i).length===0&&xe(se)})}var ce=C(we,2);{var ge=xe=>{var ke=qv();M(xe,ke)};pe(ce,xe=>{t().length===0&&xe(ge)})}M(V,z)},Ie=V=>{var z=ar(),oe=Ce(z);{var ee=se=>{var ce=Yv();M(se,ce)},we=se=>{var ce=ar(),ge=Ce(ce);Ee(ge,17,()=>o(a),xe=>xe.id,(xe,ke)=>{var bt=Xv(),lt=y(bt),ct=y(lt),ut=y(ct),Ot=C(ct,2);os(Ot,{get icon(){return _a},onclick:()=>Q(o(ke)),title:"Edit trigger",size:"small"}),re(Pt=>ve(ut,Pt),[()=>W(o(ke))]),M(xe,bt)}),M(se,ce)};pe(oe,se=>{o(a).length===0?se(ee):se(we,!1)},!0)}M(V,z)};pe(le,V=>{o(n).length===0||o(i).length===0||t().length===0?V(_e):V(Ie,!1)})}var Te=C(P,2);rr(Te,{title:"Create Manual Trigger",onclose:()=>{var z;return(z=o(s))==null?void 0:z.close()},get dialogRef(){return o(s)},set dialogRef(z){x(s,z,!0)},buttons:z=>{var oe=Jv(),ee=Ce(oe);Pe(ee,{type:"button",onclick:()=>{var se;return(se=o(s))==null?void 0:se.close()},variant:"secondary",children:(se,ce)=>{var ge=Ne("Cancel");M(se,ge)},$$slots:{default:!0}});var we=C(ee,2);Pe(we,{type:"submit",form:"manual-trigger-form",variant:"primary",children:(se,ce)=>{var ge=Ne("Create");M(se,ge)},$$slots:{default:!0}}),M(z,oe)},children:(z,oe)=>{var ee=nh(),we=y(ee),se=y(we),ce=y(se),ge=C(y(ce),2);Ee(ge,21,()=>o(n),je,(ue,he)=>{var ye=Zv(),Ae=y(ye),Ve={};re(()=>{ve(Ae,o(he).name),Ve!==(Ve=o(he).id)&&(ye.value=(ye.__value=o(he).id)??"")}),M(ue,ye)});var xe=C(ce,2),ke=C(y(xe),2);Ee(ke,21,()=>q,je,(ue,he)=>{var ye=Qv(),Ae=y(ye),Ve={};re(()=>{ve(Ae,o(he).label),Ve!==(Ve=o(he).value)&&(ye.value=(ye.__value=o(he).value)??"")}),M(ue,ye)});var bt=C(se,2),lt=y(bt),ct=C(y(lt),2);Ee(ct,21,t,je,(ue,he)=>{var ye=eh(),Ae=y(ye),Ve={};re(()=>{ve(Ae,o(he).name),Ve!==(Ve=o(he).id)&&(ye.value=(ye.__value=o(he).id)??"")}),M(ue,ye)});var ut=C(lt,2),Ot=C(y(ut),2);Ee(Ot,21,()=>o(i),je,(ue,he)=>{var ye=th(),Ae=y(ye),Ve={};re(()=>{ve(Ae,o(he).name),Ve!==(Ve=o(he).name)&&(ye.value=(ye.__value=o(he).name)??"")}),M(ue,ye)});var Pt=C(bt,2),qr=y(Pt),Wr=C(y(qr),2),Dr=y(Wr),Oe=C(Dr,2),nt=y(Oe),Be=y(nt),Nt=C(qr,2),me=C(y(Nt),2);Ee(me,21,()=>te,je,(ue,he)=>{var ye=rh(),Ae=y(ye),Ve={};re(()=>{ve(Ae,o(he)),Ve!==(Ve=o(he))&&(ye.value=(ye.__value=o(he))??"")}),M(ue,ye)}),Fr("submit",ee,ue=>{ue.preventDefault(),Y()}),it(ge,()=>o(c),ue=>x(c,ue)),it(ke,()=>o(u),ue=>x(u,ue)),it(ct,()=>o(f),ue=>x(f,ue)),it(Ot,()=>o(d),ue=>x(d,ue)),gr(Dr,()=>o(m),ue=>x(m,ue)),Sa(Be,()=>o(_),ue=>x(_,ue)),it(me,()=>o(h),ue=>x(h,ue)),M(z,ee)},$$slots:{buttons:!0,default:!0}});var Fe=C(Te,2);rr(Fe,{title:"Create Automatic Trigger",onclose:()=>{var z;return(z=o(l))==null?void 0:z.close()},get dialogRef(){return o(l)},set dialogRef(z){x(l,z,!0)},buttons:z=>{var oe=ih(),ee=Ce(oe);Pe(ee,{type:"button",onclick:()=>{var se;return(se=o(l))==null?void 0:se.close()},variant:"secondary",children:(se,ce)=>{var ge=Ne("Cancel");M(se,ge)},$$slots:{default:!0}});var we=C(ee,2);Pe(we,{type:"submit",form:"automatic-trigger-form",variant:"primary",children:(se,ce)=>{var ge=Ne("Create");M(se,ge)},$$slots:{default:!0}}),M(z,oe)},children:(z,oe)=>{var ee=lh(),we=y(ee),se=y(we),ce=y(se),ge=C(y(ce),2);Ee(ge,21,t,je,(Oe,nt)=>{var Be=ah(),Nt=y(Be),me={};re(()=>{ve(Nt,o(nt).name),me!==(me=o(nt).id)&&(Be.value=(Be.__value=o(nt).id)??"")}),M(Oe,Be)});var xe=C(ce,2),ke=C(y(xe),2);Ee(ke,21,()=>o(i),je,(Oe,nt)=>{var Be=sh(),Nt=y(Be),me={};re(()=>{ve(Nt,o(nt).name),me!==(me=o(nt).name)&&(Be.value=(Be.__value=o(nt).name)??"")}),M(Oe,Be)});var bt=C(se,2),lt=y(bt),ct=C(y(lt),2),ut=y(ct),Ot=C(ut,2),Pt=y(Ot),qr=y(Pt),Wr=C(lt,2),Dr=C(y(Wr),2);Ee(Dr,21,()=>te,je,(Oe,nt)=>{var Be=oh(),Nt=y(Be),me={};re(()=>{ve(Nt,o(nt)),me!==(me=o(nt))&&(Be.value=(Be.__value=o(nt))??"")}),M(Oe,Be)}),Fr("submit",ee,Oe=>{Oe.preventDefault(),J()}),it(ge,()=>o(f),Oe=>x(f,Oe)),it(ke,()=>o(d),Oe=>x(d,Oe)),gr(ut,()=>o(m),Oe=>x(m,Oe)),Sa(qr,()=>o(_),Oe=>x(_,Oe)),it(Dr,()=>o(h),Oe=>x(h,Oe)),M(z,ee)},$$slots:{buttons:!0,default:!0}});var We=C(Fe,2);{var Ye=V=>{rr(V,{title:"Trigger",onclose:T,get dialogRef(){return o(g)},set dialogRef(ee){x(g,ee,!0)},tools:ee=>{Pe(ee,{onclick:k,variant:"secondary",children:(we,se)=>{var ce=ch(),ge=Ce(ce);jr(ge,()=>li),M(we,ce)},$$slots:{default:!0}})},buttons:ee=>{var we=uh(),se=Ce(we);Pe(se,{onclick:T,variant:"secondary",children:(ge,xe)=>{var ke=Ne("Cancel");M(ge,ke)},$$slots:{default:!0}});var ce=C(se,2);Pe(ce,{type:"submit",form:"edit-trigger-form",variant:"primary",children:(ge,xe)=>{var ke=Ne("Save");M(ge,ke)},$$slots:{default:!0}}),M(ee,we)},children:(ee,we)=>{var se=_h(),ce=y(se),ge=y(ce);{var xe=me=>{var ue=fh(),he=y(ue),ye=C(y(he),2);Ee(ye,21,()=>q,je,(Ae,Ve)=>{var ci=dh(),Bl=y(ci),ls={};re(()=>{ve(Bl,o(Ve).label),ls!==(ls=o(Ve).value)&&(ci.value=(ci.__value=o(Ve).value)??"")}),M(Ae,ci)}),it(ye,()=>o(N),Ae=>x(N,Ae)),M(me,ue)};pe(ge,me=>{o(v).triggerType!=="always"&&me(xe)})}var ke=C(ge,2),bt=y(ke),lt=C(y(bt),2);Ee(lt,21,t,je,(me,ue)=>{var he=vh(),ye=y(he),Ae={};re(()=>{ve(ye,o(ue).name),Ae!==(Ae=o(ue).id)&&(he.value=(he.__value=o(ue).id)??"")}),M(me,he)});var ct=C(bt,2),ut=C(y(ct),2);Ee(ut,21,()=>o(i),je,(me,ue)=>{var he=hh(),ye=y(he),Ae={};re(()=>{ve(ye,o(ue).name),Ae!==(Ae=o(ue).name)&&(he.value=(he.__value=o(ue).name)??"")}),M(me,he)});var Ot=C(ke,2),Pt=y(Ot),qr=C(y(Pt),2),Wr=y(qr),Dr=C(Wr,2),Oe=y(Dr),nt=y(Oe),Be=C(Pt,2),Nt=C(y(Be),2);Ee(Nt,21,()=>te,je,(me,ue)=>{var he=ph(),ye=y(he),Ae={};re(()=>{ve(ye,o(ue)),Ae!==(Ae=o(ue))&&(he.value=(he.__value=o(ue))??"")}),M(me,he)}),Fr("submit",se,me=>{me.preventDefault(),b()}),it(lt,()=>o(I),me=>x(I,me)),it(ut,()=>o(O),me=>x(O,me)),gr(Wr,()=>o(D),me=>x(D,me)),Sa(nt,()=>o(R),me=>x(R,me)),it(Nt,()=>o(j),me=>x(j,me)),M(ee,se)},$$slots:{tools:!0,buttons:!0,default:!0}})};pe(We,V=>{o(v)&&V(Ye)})}M(r,w),rt()}var yh=F('<div class="pan-tilt-indicator svelte-kr8awf"></div>'),wh=F('<div class="device-preview-item svelte-kr8awf"><div class="device-preview svelte-kr8awf"><!></div> <code class="device-id svelte-kr8awf"> </code></div>'),bh=F('<div class="reference-section svelte-kr8awf"><h4 class="svelte-kr8awf">Devices</h4> <div class="device-previews svelte-kr8awf"></div></div>'),Sh=F('<div class="reference-item svelte-kr8awf"><code class="svelte-kr8awf"> </code></div>'),Dh=F('<div class="reference-section svelte-kr8awf"><h4 class="svelte-kr8awf">Animations</h4> <div class="reference-list svelte-kr8awf"></div></div>'),Eh=F('<code class="svelte-kr8awf"> </code>'),Ch=F('<code class="svelte-kr8awf"> </code>'),Ih=F('<div class="reference-item svelte-kr8awf"><!></div>'),xh=F('<div class="reference-item svelte-kr8awf"><code class="svelte-kr8awf"> </code></div>'),kh=F('<div class="reference-section svelte-kr8awf"><h4 class="svelte-kr8awf">Inputs</h4> <div class="reference-list svelte-kr8awf"><!> <!></div></div>'),Mh=F('<div class="css-view svelte-kr8awf"><div class="left-column svelte-kr8awf"><div class="reference-card svelte-kr8awf"><!> <!> <!></div> <div class="animation-targets svelte-kr8awf"></div></div> <div class="right-column svelte-kr8awf"><div class="css-scroll-container svelte-kr8awf"><pre class="css-editor readonly svelte-kr8awf"> </pre> <pre class="css-editor editable svelte-kr8awf" contenteditable="true" spellcheck="false"></pre></div></div></div>');function Ph(r,e){tt(e,!0);let t=ie(e,"devices",19,()=>[]),n=ie(e,"isActive",3,!1),i=$(""),a=$("");function s(){return localStorage.getItem("dmx-custom-css")||`/* Add your custom CSS here to override device defaults and apply animations */
`}function l(){x(i,e.cssGenerator.generate(t()),!0)}let c,u=Se({}),f=Se({}),d=Se({}),m=De(()=>e.animationLibrary?e.animationLibrary.getAll():[]),_=De(()=>e.mappingLibrary?e.mappingLibrary.getAll():[]),h=$(Se([]));ir(()=>{const A=setInterval(()=>{e.customPropertyManager&&x(h,e.customPropertyManager.getAll(),!0)},100);return()=>clearInterval(A)});let g,v,S,N;function I(A,E){switch(A){case"RGB":return[E.Red||0,E.Green||0,E.Blue||0];case"RGBA":return[E.Red||0,E.Green||0,E.Blue||0,E.Amber||0];case"RGBW":return[E.Red||0,E.Green||0,E.Blue||0,E.White||0];case"DIMMER":return[E.Intensity||0];case"SMOKE":return[E.Output||0];case"MOVING_HEAD":return[E.Pan||127,E.Tilt||127,E.Dimmer||0,E.Red||0,E.Green||0,E.Blue||0,E.White||0];case"FLAMETHROWER":return[E.Safety||0,E.Fuel||0];default:return console.warn(`Unknown device type: ${A}`),[]}}function O(){if(!e.cssSampler)return;const A=e.cssSampler.sampleAll(t());t().forEach(E=>{const U=A.get(E.id);if(!U)return;const ne=I(E.type,U);if(U.Red!==void 0&&U.Green!==void 0&&U.Blue!==void 0){const le=U.White!==void 0?U.White:255,_e=`rgba(${U.Red}, ${U.Green}, ${U.Blue}, ${le/255})`;u[E.id]=_e}else if(U.Intensity!==void 0){const le=U.Intensity/255;f[E.id]=le}E.type==="MOVING_HEAD"&&U.Pan!==void 0&&U.Tilt!==void 0&&(d[E.id]={pan:U.Pan,tilt:U.Tilt}),e.dmxController&&n()&&D(E,ne)}),c=requestAnimationFrame(O)}function D(A,E){if(e.dmxController)for(let U=0;U<E.length;U++){const ne=A.startChannel+U;e.dmxController.setChannel(ne,E[U])}}function R(A){const E=A.target.textContent;x(a,E,!0),localStorage.setItem("dmx-custom-css",E),j()}function j(){if(g){const A=o(i)+`

`+o(a);g.textContent=`@scope (.animation-targets) {
${A}
}`}}function q(){l(),j()}function te(){l(),j()}Cn(()=>{const A=document.createElement("style");A.id="css-property-definitions",A.textContent=`
/* CSS Custom Property Definitions */
@property --safety {
  syntax: "none | probably";
  inherits: false;
  initial-value: none;
}

@property --fuel {
  syntax: "<percentage>";
  inherits: false;
  initial-value: 0%;
}

@property --smoke {
  syntax: "<percentage>";
  inherits: false;
  initial-value: 0%;
}

@property --pan {
  syntax: "<percentage>";
  inherits: false;
  initial-value: 0%;
}

@property --tilt {
  syntax: "<percentage>";
  inherits: false;
  initial-value: 0%;
}

@property --amber {
  syntax: "<percentage>";
  inherits: false;
  initial-value: 0%;
}
`,document.head.appendChild(A),g=document.createElement("style"),g.id="css-animation-styles",document.head.appendChild(g),v&&(S=document.createElement("div"),S.className="trigger-classes",v.appendChild(S)),e.cssSampler&&S&&(e.cssSampler.initialize(S),e.cssSampler.updateDevices(t())),e.triggerManager&&S&&e.triggerManager.setContainer(S),e.mappingLibrary.on("changed",q),e.animationLibrary.on("changed",te),x(a,s(),!0),l(),N&&(N.textContent=o(a)),j(),t().forEach(E=>{u[E.id]=Vn(E.type,E.defaultValues),f[E.id]=1,E.type==="MOVING_HEAD"&&(d[E.id]={pan:E.defaultValues[0]||127,tilt:E.defaultValues[1]||127})}),c||O()}),ir(()=>{e.cssSampler&&t()&&(e.cssSampler.updateDevices(t()),l(),j())}),Qi(()=>{c&&(cancelAnimationFrame(c),c=null),g&&g.parentNode&&g.parentNode.removeChild(g);const A=document.getElementById("css-property-definitions");A&&A.parentNode&&A.parentNode.removeChild(A),e.mappingLibrary.off("changed",q),e.animationLibrary.off("changed",te)});var ae=Mh(),Z=y(ae),X=y(Z),K=y(X);{var Y=A=>{var E=bh(),U=C(y(E),2);Ee(U,21,t,ne=>ne.id,(ne,le)=>{var _e=wh(),Ie=y(_e),Te=y(Ie);{var Fe=V=>{const z=De(()=>d[o(le).id]),oe=De(()=>o(z).pan/255*100),ee=De(()=>(1-o(z).tilt/255)*100);var we=yh();re(()=>Ht(we,`left: ${o(oe)??""}%; top: ${o(ee)??""}%`)),M(V,we)};pe(Te,V=>{o(le).type==="MOVING_HEAD"&&d[o(le).id]&&V(Fe)})}var We=C(Ie,2),Ye=y(We);re(V=>{Ht(Ie,`background-color: ${V??""}; opacity: ${(f[o(le).id]||1)??""}`),kt(Ie,"title",o(le).name),ve(Ye,`#${o(le).cssId??""}`)},[()=>u[o(le).id]||Vn(o(le).type,o(le).defaultValues)]),M(ne,_e)}),M(A,E)};pe(K,A=>{t().length>0&&A(Y)})}var J=C(K,2);{var Q=A=>{var E=Dh(),U=C(y(E),2);Ee(U,21,()=>o(m),ne=>ne.name,(ne,le)=>{var _e=Sh(),Ie=y(_e),Te=y(Ie);re(()=>ve(Te,o(le).name)),M(ne,_e)}),M(A,E)};pe(J,A=>{o(m).length>0&&A(Q)})}var T=C(J,2);{var b=A=>{var E=kh(),U=C(y(E),2),ne=y(U);Ee(ne,17,()=>o(_),_e=>_e.id,(_e,Ie)=>{var Te=Ih(),Fe=y(Te);{var We=V=>{var z=Eh(),oe=y(z);re(()=>ve(oe,`.${o(Ie).cssClassName??""}`)),M(V,z)},Ye=V=>{var z=ar(),oe=Ce(z);{var ee=we=>{var se=Ch(),ce=y(se);re(ge=>ve(ce,ge),[()=>o(Ie).getPropertyName()]),M(we,se)};pe(oe,we=>{o(Ie).mode==="direct"&&we(ee)},!0)}M(V,z)};pe(Fe,V=>{o(Ie).mode==="trigger"||o(Ie).mode==="input"?V(We):V(Ye,!1)})}M(_e,Te)});var le=C(ne,2);Ee(le,17,()=>o(h),_e=>_e.name,(_e,Ie)=>{var Te=xh(),Fe=y(Te),We=y(Fe);re(()=>ve(We,`${o(Ie).name??""}: ${o(Ie).value??""}`)),M(_e,Te)}),M(A,E)};pe(T,A=>{(o(_).length>0||o(h).length>0)&&A(b)})}var k=C(X,2);Gr(k,A=>v=A,()=>v);var L=C(Z,2),B=y(L),W=y(B),w=y(W),P=C(W,2);P.__input=R,Gr(P,A=>N=A,()=>N),re(()=>ve(w,o(i))),M(r,ae),rt()}wt(["input"]);var Lh=F("<!> <main><!> <div><!></div> <div><!></div> <div><!></div> <div><!></div> <div><!></div> <div><!></div></main>",1);function Ah(r,e){tt(e,!0);let t=$("devices"),n=$(!1),i=Se(new xu),a=$(null),s=$(Se([])),l=Se(new Mu),c=Se(new Jo),u=Se(new Zo),f=Se(new Qo),d=Se(new Lu),m=Se(new Pu(l,c)),_=Se(new wf(c,f,u));ir(()=>{_.initialize()});async function h(){try{await i.connect(),x(n,!0)}catch(w){alert("Failed to connect: "+w.message)}}function g(){i.disconnect(),x(n,!1)}function v(){var w;i&&i.clearUniverse(),(w=o(a))!=null&&w.clearAllDeviceValues&&o(a).clearAllDeviceValues()}var S=Lh(),N=Ce(S);Vf(N,{onconnect:h,ondisconnect:g,get connected(){return o(n)},get inputController(){return _}});var I=C(N,2),O=y(I);Wf(O,{onClearUniverse:v,get view(){return o(t)},set view(w){x(t,w,!0)}});var D=C(O,2);let R;var j=y(D);Gr(bv(j,{get dmxController(){return i},get devices(){return o(s)},set devices(w){x(s,w,!0)}}),w=>x(a,w,!0),()=>o(a));var q=C(D,2);let te;var ae=y(q);Jf(ae,{get dmxController(){return i}});var Z=C(q,2);let X;var K=y(Z);Nv(K,{get animationLibrary(){return l},get cssGenerator(){return m},get devices(){return o(s)}});var Y=C(Z,2);let J;var Q=y(Y);Uv(Q,{get inputController(){return _},get mappingLibrary(){return c}});var T=C(Y,2);let b;var k=y(T);mh(k,{get mappingLibrary(){return c},get animationLibrary(){return l},get devices(){return o(s)}});var L=C(T,2);let B;var W=y(L);{let w=De(()=>o(t)==="css");Ph(W,{get dmxController(){return i},get devices(){return o(s)},get animationLibrary(){return l},get mappingLibrary(){return c},get cssGenerator(){return m},get cssSampler(){return d},get triggerManager(){return u},get customPropertyManager(){return f},get isActive(){return o(w)}})}re(()=>{R=st(D,1,"view-container svelte-1n46o8q",null,R,{hidden:o(t)!=="devices"}),te=st(q,1,"view-container svelte-1n46o8q",null,te,{hidden:o(t)!=="universe"}),X=st(Z,1,"view-container svelte-1n46o8q",null,X,{hidden:o(t)!=="animations"}),J=st(Y,1,"view-container svelte-1n46o8q",null,J,{hidden:o(t)!=="inputs"}),b=st(T,1,"view-container svelte-1n46o8q",null,b,{hidden:o(t)!=="triggers"}),B=st(L,1,"view-container svelte-1n46o8q",null,B,{hidden:o(t)!=="css"})}),M(r,S),rt()}ru(Ah,{target:document.getElementById("app")});
