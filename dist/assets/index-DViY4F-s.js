var mc=Object.defineProperty;var Aa=r=>{throw TypeError(r)};var yc=(r,e,t)=>e in r?mc(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var $e=(r,e,t)=>yc(r,typeof e!="symbol"?e+"":e,t),Ls=(r,e,t)=>e.has(r)||Aa("Cannot "+t);var p=(r,e,t)=>(Ls(r,e,"read from private field"),t?t.call(r):e.get(r)),K=(r,e,t)=>e.has(r)?Aa("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t),F=(r,e,t,n)=>(Ls(r,e,"write to private field"),n?n.call(r,t):e.set(r,t),t),Fe=(r,e,t)=>(Ls(r,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();const mo=!1;var oa=Array.isArray,wc=Array.prototype.indexOf,la=Array.from,bc=Object.defineProperty,fn=Object.getOwnPropertyDescriptor,yo=Object.getOwnPropertyDescriptors,Sc=Object.prototype,Dc=Array.prototype,ca=Object.getPrototypeOf,Oa=Object.isExtensible;function Cc(r){return r()}function $s(r){for(var e=0;e<r.length;e++)r[e]()}function wo(){var r,e,t=new Promise((n,i)=>{r=n,e=i});return{promise:t,resolve:r,reject:e}}function bo(r,e){if(Array.isArray(r))return r;if(!(Symbol.iterator in r))return Array.from(r);const t=[];for(const n of r)if(t.push(n),t.length===e)break;return t}const vt=2,is=4,ss=8,yr=16,wr=32,sn=64,as=128,at=1024,It=2048,sr=4096,Tt=8192,gr=16384,ua=32768,rn=65536,Ra=1<<17,So=1<<18,Rn=1<<19,Do=1<<20,Ft=256,Ui=512,$i=32768,Hs=1<<21,da=1<<22,Pr=1<<23,_r=Symbol("$state"),Ec=Symbol("legacy props"),Ic=Symbol(""),dn=new class extends Error{constructor(){super(...arguments);$e(this,"name","StaleReactionError");$e(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}};function Co(r){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function xc(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function kc(r){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Mc(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Pc(r){throw new Error("https://svelte.dev/e/effect_orphan")}function Tc(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Lc(r){throw new Error("https://svelte.dev/e/props_invalid_value")}function Ac(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Oc(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Rc(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Nc(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const os=1,ls=2,Eo=4,Fc=8,Bc=16,Vc=1,Gc=2,Io=4,jc=8,Kc=16,Uc=1,$c=2,rt=Symbol(),Hc="http://www.w3.org/1999/xhtml",zc="@attach";function qc(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function Wc(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}let Yc=!1;function xo(r){return r===this.v}function Xc(r,e){return r!=r?e==e:r!==e||r!==null&&typeof r=="object"||typeof r=="function"}function ko(r){return!Xc(r,this.v)}let Nn=!1,Jc=!1;function Zc(){Nn=!0}let Ge=null;function In(r){Ge=r}function yt(r,e=!1,t){Ge={p:Ge,i:!1,c:null,e:null,s:r,x:null,l:Nn&&!e?{s:null,u:null,$:[]}:null}}function wt(r){var e=Ge,t=e.e;if(t!==null){e.e=null;for(var n of t)Wo(n)}return r!==void 0&&(e.x=r),e.i=!0,Ge=e.p,r??{}}function pi(){return!Nn||Ge!==null&&Ge.l===null}let $r=[];function Mo(){var r=$r;$r=[],$s(r)}function mr(r){if($r.length===0&&!Xn){var e=$r;queueMicrotask(()=>{e===$r&&Mo()})}$r.push(r)}function Qc(){for(;$r.length>0;)Mo()}function Po(r){var e=ce;if(e===null)return de.f|=Pr,r;if(e.f&ua)xn(r,e);else{if(!(e.f&as))throw r;e.b.error(r)}}function xn(r,e){for(;e!==null;){if(e.f&as)try{e.b.error(r);return}catch(t){r=t}e=e.parent}throw r}const Ii=new Set;let Te=null,Yn=null,nt=null,er=[],cs=null,zs=!1,Xn=!1;var pn,gn,Hr,zr,ri,_n,mn,ft,qs,Ur,To,Lo;const Ji=class Ji{constructor(){K(this,ft);$e(this,"committed",!1);$e(this,"current",new Map);$e(this,"previous",new Map);K(this,pn,new Set);K(this,gn,new Set);K(this,Hr,0);K(this,zr,0);K(this,ri,null);K(this,_n,[]);K(this,mn,[]);$e(this,"skipped_effects",new Set);$e(this,"is_fork",!1)}process(e){var n;er=[],Yn=null,this.apply();var t={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const i of e)Fe(this,ft,qs).call(this,i,t);this.is_fork||Fe(this,ft,To).call(this),p(this,zr)>0||this.is_fork?(Fe(this,ft,Ur).call(this,t.effects),Fe(this,ft,Ur).call(this,t.render_effects),Fe(this,ft,Ur).call(this,t.block_effects)):(Yn=this,Te=null,Na(t.render_effects),Na(t.effects),Yn=null,(n=p(this,ri))==null||n.resolve()),nt=null}capture(e,t){this.previous.has(e)||this.previous.set(e,t),e.f&Pr||(this.current.set(e,e.v),nt==null||nt.set(e,e.v))}activate(){Te=this,this.apply()}deactivate(){Te=null,nt=null}flush(){if(this.activate(),er.length>0){if(Ao(),Te!==null&&Te!==this)return}else p(this,Hr)===0&&this.process([]);this.deactivate()}discard(){for(const e of p(this,gn))e(this);p(this,gn).clear()}increment(e){F(this,Hr,p(this,Hr)+1),e&&F(this,zr,p(this,zr)+1)}decrement(e){F(this,Hr,p(this,Hr)-1),e&&F(this,zr,p(this,zr)-1),this.revive()}revive(){for(const e of p(this,_n))ot(e,It),nn(e);for(const e of p(this,mn))ot(e,sr),nn(e);F(this,_n,[]),F(this,mn,[]),this.flush()}oncommit(e){p(this,pn).add(e)}ondiscard(e){p(this,gn).add(e)}settled(){return(p(this,ri)??F(this,ri,wo())).promise}static ensure(){if(Te===null){const e=Te=new Ji;Ii.add(Te),Xn||Ji.enqueue(()=>{Te===e&&e.flush()})}return Te}static enqueue(e){mr(e)}apply(){}};pn=new WeakMap,gn=new WeakMap,Hr=new WeakMap,zr=new WeakMap,ri=new WeakMap,_n=new WeakMap,mn=new WeakMap,ft=new WeakSet,qs=function(e,t){var d;e.f^=at;for(var n=e.first;n!==null;){var i=n.f,s=(i&(wr|sn))!==0,a=s&&(i&at)!==0,l=a||(i&Tt)!==0||this.skipped_effects.has(n);if(n.f&as&&((d=n.b)!=null&&d.is_pending())&&(t={parent:t,effect:n,effects:[],render_effects:[],block_effects:[]}),!l&&n.fn!==null){s?n.f^=at:i&is?t.effects.push(n):Bn(n)&&(n.f&yr&&t.block_effects.push(n),Mn(n));var c=n.first;if(c!==null){n=c;continue}}var u=n.parent;for(n=n.next;n===null&&u!==null;)u===t.effect&&(Fe(this,ft,Ur).call(this,t.effects),Fe(this,ft,Ur).call(this,t.render_effects),Fe(this,ft,Ur).call(this,t.block_effects),t=t.parent),n=u.next,u=u.parent}},Ur=function(e){for(const t of e)(t.f&It?p(this,_n):p(this,mn)).push(t),ot(t,at)},To=function(){if(p(this,zr)===0){for(const e of p(this,pn))e();p(this,pn).clear()}p(this,Hr)===0&&Fe(this,ft,Lo).call(this)},Lo=function(){var i;if(Ii.size>1){this.previous.clear();var e=nt,t=!0,n={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(const s of Ii){if(s===this){t=!1;continue}const a=[];for(const[c,u]of this.current){if(s.current.has(c))if(t&&u!==s.current.get(c))s.current.set(c,u);else continue;a.push(c)}if(a.length===0)continue;const l=[...s.current.keys()].filter(c=>!this.current.has(c));if(l.length>0){const c=new Set,u=new Map;for(const d of a)Oo(d,l,c,u);if(er.length>0){Te=s,s.apply();for(const d of er)Fe(i=s,ft,qs).call(i,d,n);er=[],s.deactivate()}}}Te=null,nt=e}this.committed=!0,Ii.delete(this)};let hr=Ji;function eu(r){var e=Xn;Xn=!0;try{for(var t;;){if(Qc(),er.length===0&&(Te==null||Te.flush(),er.length===0))return cs=null,t;Ao()}}finally{Xn=e}}function Ao(){var r=hn;zs=!0;try{var e=0;for(Ga(!0);er.length>0;){var t=hr.ensure();if(e++>1e3){var n,i;tu()}t.process(er),Tr.clear()}}finally{zs=!1,Ga(r),cs=null}}function tu(){try{Tc()}catch(r){xn(r,cs)}}let jt=null;function Na(r){var e=r.length;if(e!==0){for(var t=0;t<e;){var n=r[t++];if(!(n.f&(gr|Tt))&&Bn(n)&&(jt=new Set,Mn(n),n.deps===null&&n.first===null&&n.nodes_start===null&&(n.teardown===null&&n.ac===null?Zo(n):n.fn=null),(jt==null?void 0:jt.size)>0)){Tr.clear();for(const i of jt){if(i.f&(gr|Tt))continue;const s=[i];let a=i.parent;for(;a!==null;)jt.has(a)&&(jt.delete(a),s.push(a)),a=a.parent;for(let l=s.length-1;l>=0;l--){const c=s[l];c.f&(gr|Tt)||Mn(c)}}jt.clear()}}jt=null}}function Oo(r,e,t,n){if(!t.has(r)&&(t.add(r),r.reactions!==null))for(const i of r.reactions){const s=i.f;s&vt?Oo(i,e,t,n):s&(da|yr)&&!(s&It)&&Ro(i,e,n)&&(ot(i,It),nn(i))}}function Ro(r,e,t){const n=t.get(r);if(n!==void 0)return n;if(r.deps!==null)for(const i of r.deps){if(e.includes(i))return!0;if(i.f&vt&&Ro(i,e,t))return t.set(i,!0),!0}return t.set(r,!1),!1}function nn(r){for(var e=cs=r;e.parent!==null;){e=e.parent;var t=e.f;if(zs&&e===ce&&t&yr&&!(t&So))return;if(t&(sn|wr)){if(!(t&at))return;e.f^=at}}er.push(e)}function ru(r){let e=0,t=Lr(0),n;return()=>{gu()&&(o(t),an(()=>(e===0&&(n=or(()=>r(()=>Jn(t)))),e+=1,()=>{mr(()=>{e-=1,e===0&&(n==null||n(),n=void 0,Jn(t))})})))}}var nu=rn|Rn|as;function iu(r,e,t){new su(r,e,t)}var At,Ot,aa,Yt,qr,Xt,Rt,St,Jt,ur,Cr,Wr,Er,Yr,Ir,Zi,et,au,ou,Ws,Gi,ji,Ys;class su{constructor(e,t,n){K(this,et);$e(this,"parent");K(this,At,!1);K(this,Ot);K(this,aa,null);K(this,Yt);K(this,qr);K(this,Xt);K(this,Rt,null);K(this,St,null);K(this,Jt,null);K(this,ur,null);K(this,Cr,null);K(this,Wr,0);K(this,Er,0);K(this,Yr,!1);K(this,Ir,null);K(this,Zi,ru(()=>(F(this,Ir,Lr(p(this,Wr))),()=>{F(this,Ir,null)})));F(this,Ot,e),F(this,Yt,t),F(this,qr,n),this.parent=ce.b,F(this,At,!!p(this,Yt).pending),F(this,Xt,Fn(()=>{ce.b=this;{var i=Fe(this,et,Ws).call(this);try{F(this,Rt,Mt(()=>n(i)))}catch(s){this.error(s)}p(this,Er)>0?Fe(this,et,ji).call(this):F(this,At,!1)}return()=>{var s;(s=p(this,Cr))==null||s.remove()}},nu))}is_pending(){return p(this,At)||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!p(this,Yt).pending}update_pending_count(e){Fe(this,et,Ys).call(this,e),F(this,Wr,p(this,Wr)+e),p(this,Ir)&&kn(p(this,Ir),p(this,Wr))}get_effect_pending(){return p(this,Zi).call(this),o(p(this,Ir))}error(e){var t=p(this,Yt).onerror;let n=p(this,Yt).failed;if(p(this,Yr)||!t&&!n)throw e;p(this,Rt)&&(Qe(p(this,Rt)),F(this,Rt,null)),p(this,St)&&(Qe(p(this,St)),F(this,St,null)),p(this,Jt)&&(Qe(p(this,Jt)),F(this,Jt,null));var i=!1,s=!1;const a=()=>{if(i){Wc();return}i=!0,s&&Nc(),hr.ensure(),F(this,Wr,0),p(this,Jt)!==null&&vn(p(this,Jt),()=>{F(this,Jt,null)}),F(this,At,this.has_pending_snippet()),F(this,Rt,Fe(this,et,Gi).call(this,()=>(F(this,Yr,!1),Mt(()=>p(this,qr).call(this,p(this,Ot)))))),p(this,Er)>0?Fe(this,et,ji).call(this):F(this,At,!1)};var l=de;try{Ct(null),s=!0,t==null||t(e,a),s=!1}catch(c){xn(c,p(this,Xt)&&p(this,Xt).parent)}finally{Ct(l)}n&&mr(()=>{F(this,Jt,Fe(this,et,Gi).call(this,()=>{hr.ensure(),F(this,Yr,!0);try{return Mt(()=>{n(p(this,Ot),()=>e,()=>a)})}catch(c){return xn(c,p(this,Xt).parent),null}finally{F(this,Yr,!1)}}))})}}At=new WeakMap,Ot=new WeakMap,aa=new WeakMap,Yt=new WeakMap,qr=new WeakMap,Xt=new WeakMap,Rt=new WeakMap,St=new WeakMap,Jt=new WeakMap,ur=new WeakMap,Cr=new WeakMap,Wr=new WeakMap,Er=new WeakMap,Yr=new WeakMap,Ir=new WeakMap,Zi=new WeakMap,et=new WeakSet,au=function(){try{F(this,Rt,Mt(()=>p(this,qr).call(this,p(this,Ot))))}catch(e){this.error(e)}F(this,At,!1)},ou=function(){const e=p(this,Yt).pending;e&&(F(this,St,Mt(()=>e(p(this,Ot)))),hr.enqueue(()=>{var t=Fe(this,et,Ws).call(this);F(this,Rt,Fe(this,et,Gi).call(this,()=>(hr.ensure(),Mt(()=>p(this,qr).call(this,t))))),p(this,Er)>0?Fe(this,et,ji).call(this):(vn(p(this,St),()=>{F(this,St,null)}),F(this,At,!1))}))},Ws=function(){var e=p(this,Ot);return p(this,At)&&(F(this,Cr,Ar()),p(this,Ot).before(p(this,Cr)),e=p(this,Cr)),e},Gi=function(e){var t=ce,n=de,i=Ge;Bt(p(this,Xt)),Ct(p(this,Xt)),In(p(this,Xt).ctx);try{return e()}catch(s){return Po(s),null}finally{Bt(t),Ct(n),In(i)}},ji=function(){const e=p(this,Yt).pending;p(this,Rt)!==null&&(F(this,ur,document.createDocumentFragment()),p(this,ur).append(p(this,Cr)),tl(p(this,Rt),p(this,ur))),p(this,St)===null&&F(this,St,Mt(()=>e(p(this,Ot))))},Ys=function(e){var t;if(!this.has_pending_snippet()){this.parent&&Fe(t=this.parent,et,Ys).call(t,e);return}F(this,Er,p(this,Er)+e),p(this,Er)===0&&(F(this,At,!1),p(this,St)&&vn(p(this,St),()=>{F(this,St,null)}),p(this,ur)&&(p(this,Ot).before(p(this,ur)),F(this,ur,null)))};function No(r,e,t,n){const i=pi()?gi:fa;if(t.length===0&&r.length===0){n(e.map(i));return}var s=Te,a=ce,l=lu();function c(){Promise.all(t.map(u=>cu(u))).then(u=>{l();try{n([...e.map(i),...u])}catch(d){a.f&gr||xn(d,a)}s==null||s.deactivate(),Hi()}).catch(u=>{xn(u,a)})}r.length>0?Promise.all(r).then(()=>{l();try{return c()}finally{s==null||s.deactivate(),Hi()}}):c()}function lu(){var r=ce,e=de,t=Ge,n=Te;return function(s=!0){Bt(r),Ct(e),In(t),s&&(n==null||n.activate())}}function Hi(){Bt(null),Ct(null),In(null)}function gi(r){var e=vt|It,t=de!==null&&de.f&vt?de:null;return ce===null||t!==null&&t.f&Ft?e|=Ft:ce.f|=Rn,{ctx:Ge,deps:null,effects:null,equals:xo,f:e,fn:r,reactions:null,rv:0,v:rt,wv:0,parent:t??ce,ac:null}}function cu(r,e){let t=ce;t===null&&xc();var n=t.b,i=void 0,s=Lr(rt),a=!de,l=new Map;return bu(()=>{var _;var c=wo();i=c.promise;try{Promise.resolve(r()).then(c.resolve,c.reject).then(()=>{u===Te&&u.committed&&u.deactivate(),Hi()})}catch(m){c.reject(m),Hi()}var u=Te;if(a){var d=!n.is_pending();n.update_pending_count(1),u.increment(d),(_=l.get(u))==null||_.reject(dn),l.delete(u),l.set(u,c)}const f=(m,v=void 0)=>{if(u.activate(),v)v!==dn&&(s.f|=Pr,kn(s,v));else{s.f&Pr&&(s.f^=Pr),kn(s,m);for(const[h,g]of l){if(l.delete(h),h===u)break;g.reject(dn)}}a&&(n.update_pending_count(-1),u.decrement(d))};c.promise.then(f,m=>f(null,m||"unknown"))}),fs(()=>{for(const c of l.values())c.reject(dn)}),new Promise(c=>{function u(d){function f(){d===i?c(s):u(i)}d.then(f,f)}u(i)})}function We(r){const e=gi(r);return rl(e),e}function fa(r){const e=gi(r);return e.equals=ko,e}function Fo(r){var e=r.effects;if(e!==null){r.effects=null;for(var t=0;t<e.length;t+=1)Qe(e[t])}}function uu(r){for(var e=r.parent;e!==null;){if(!(e.f&vt))return e;e=e.parent}return null}function va(r){var e,t=ce;Bt(uu(r));try{r.f&=~$i,Fo(r),e=al(r)}finally{Bt(t)}return e}function Bo(r){var e=va(r);if(r.equals(e)||(r.v=e,r.wv=il()),!on)if(nt!==null)nt.set(r,r.v);else{var t=(Mr||r.f&Ft)&&r.deps!==null?sr:at;ot(r,t)}}let Xs=new Set;const Tr=new Map;let Vo=!1;function Lr(r,e){var t={f:0,v:r,reactions:null,equals:xo,rv:0,wv:0};return t}function V(r,e){const t=Lr(r);return rl(t),t}function Go(r,e=!1,t=!0){var i;const n=Lr(r);return e||(n.equals=ko),Nn&&t&&Ge!==null&&Ge.l!==null&&((i=Ge.l).s??(i.s=[])).push(n),n}function S(r,e,t=!1){de!==null&&(!$t||de.f&Ra)&&pi()&&de.f&(vt|yr|da|Ra)&&!(mt!=null&&mt.includes(r))&&Rc();let n=t?we(e):e;return kn(r,n)}function kn(r,e){if(!r.equals(e)){var t=r.v;on?Tr.set(r,e):Tr.set(r,t),r.v=e;var n=hr.ensure();n.capture(r,t),r.f&vt&&(r.f&It&&va(r),ot(r,r.f&Ft?sr:at)),r.wv=il(),jo(r,It),pi()&&ce!==null&&ce.f&at&&!(ce.f&(wr|sn))&&(Lt===null?Du([r]):Lt.push(r)),!n.is_fork&&Xs.size>0&&!Vo&&du()}return e}function du(){Vo=!1;const r=Array.from(Xs);for(const e of r)e.f&at&&ot(e,sr),Bn(e)&&Mn(e);Xs.clear()}function Pt(r,e=1){var t=o(r),n=e===1?t++:t--;return S(r,t),n}function Jn(r){S(r,r.v+1)}function jo(r,e){var t=r.reactions;if(t!==null)for(var n=pi(),i=t.length,s=0;s<i;s++){var a=t[s],l=a.f;if(!(!n&&a===ce)){var c=(l&It)===0;c&&ot(a,e),l&vt?l&$i||(a.f|=$i,jo(a,sr)):c&&(l&yr&&jt!==null&&jt.add(a),nn(a))}}}function we(r){if(typeof r!="object"||r===null||_r in r)return r;const e=ca(r);if(e!==Sc&&e!==Dc)return r;var t=new Map,n=oa(r),i=V(0),s=tn,a=l=>{if(tn===s)return l();var c=de,u=tn;Ct(null),Ka(s);var d=l();return Ct(c),Ka(u),d};return n&&t.set("length",V(r.length)),new Proxy(r,{defineProperty(l,c,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&Ac();var d=t.get(c);return d===void 0?d=a(()=>{var f=V(u.value);return t.set(c,f),f}):S(d,u.value,!0),!0},deleteProperty(l,c){var u=t.get(c);if(u===void 0){if(c in l){const d=a(()=>V(rt));t.set(c,d),Jn(i)}}else S(u,rt),Jn(i);return!0},get(l,c,u){var m;if(c===_r)return r;var d=t.get(c),f=c in l;if(d===void 0&&(!f||(m=fn(l,c))!=null&&m.writable)&&(d=a(()=>{var v=we(f?l[c]:rt),h=V(v);return h}),t.set(c,d)),d!==void 0){var _=o(d);return _===rt?void 0:_}return Reflect.get(l,c,u)},getOwnPropertyDescriptor(l,c){var u=Reflect.getOwnPropertyDescriptor(l,c);if(u&&"value"in u){var d=t.get(c);d&&(u.value=o(d))}else if(u===void 0){var f=t.get(c),_=f==null?void 0:f.v;if(f!==void 0&&_!==rt)return{enumerable:!0,configurable:!0,value:_,writable:!0}}return u},has(l,c){var _;if(c===_r)return!0;var u=t.get(c),d=u!==void 0&&u.v!==rt||Reflect.has(l,c);if(u!==void 0||ce!==null&&(!d||(_=fn(l,c))!=null&&_.writable)){u===void 0&&(u=a(()=>{var m=d?we(l[c]):rt,v=V(m);return v}),t.set(c,u));var f=o(u);if(f===rt)return!1}return d},set(l,c,u,d){var E;var f=t.get(c),_=c in l;if(n&&c==="length")for(var m=u;m<f.v;m+=1){var v=t.get(m+"");v!==void 0?S(v,rt):m in l&&(v=a(()=>V(rt)),t.set(m+"",v))}if(f===void 0)(!_||(E=fn(l,c))!=null&&E.writable)&&(f=a(()=>V(void 0)),S(f,we(u)),t.set(c,f));else{_=f.v!==rt;var h=a(()=>we(u));S(f,h)}var g=Reflect.getOwnPropertyDescriptor(l,c);if(g!=null&&g.set&&g.set.call(d,u),!_){if(n&&typeof c=="string"){var D=t.get("length"),R=Number(c);Number.isInteger(R)&&R>=D.v&&S(D,R+1)}Jn(i)}return!0},ownKeys(l){o(i);var c=Reflect.ownKeys(l).filter(f=>{var _=t.get(f);return _===void 0||_.v!==rt});for(var[u,d]of t)d.v!==rt&&!(u in l)&&c.push(u);return c},setPrototypeOf(){Oc()}})}function Fa(r){try{if(r!==null&&typeof r=="object"&&_r in r)return r[_r]}catch{}return r}function Ko(r,e){return Object.is(Fa(r),Fa(e))}var Ba,Uo,$o,Ho;function fu(){if(Ba===void 0){Ba=window,Uo=/Firefox/.test(navigator.userAgent);var r=Element.prototype,e=Node.prototype,t=Text.prototype;$o=fn(e,"firstChild").get,Ho=fn(e,"nextSibling").get,Oa(r)&&(r.__click=void 0,r.__className=void 0,r.__attributes=null,r.__style=void 0,r.__e=void 0),Oa(t)&&(t.__t=void 0)}}function Ar(r=""){return document.createTextNode(r)}function tr(r){return $o.call(r)}function _i(r){return Ho.call(r)}function w(r,e){return tr(r)}function st(r,e=!1){{var t=tr(r);return t instanceof Comment&&t.data===""?_i(t):t}}function b(r,e=1,t=!1){let n=r;for(;e--;)n=_i(n);return n}function vu(r){r.textContent=""}function zo(){return!1}function ha(r,e){if(e){const t=document.body;r.autofocus=!0,mr(()=>{document.activeElement===t&&r.focus()})}}let Va=!1;function hu(){Va||(Va=!0,document.addEventListener("reset",r=>{Promise.resolve().then(()=>{var e;if(!r.defaultPrevented)for(const t of r.target.elements)(e=t.__on_r)==null||e.call(t)})},{capture:!0}))}function us(r){var e=de,t=ce;Ct(null),Bt(null);try{return r()}finally{Ct(e),Bt(t)}}function ds(r,e,t,n=t){r.addEventListener(e,()=>us(t));const i=r.__on_r;i?r.__on_r=()=>{i(),n(!0)}:r.__on_r=()=>n(!0),hu()}function qo(r){ce===null&&de===null&&Pc(),de!==null&&de.f&Ft&&ce===null&&Mc(),on&&kc()}function pu(r,e){var t=e.last;t===null?e.last=e.first=r:(t.next=r,r.prev=t,e.last=r)}function ar(r,e,t,n=!0){var i=ce;i!==null&&i.f&Tt&&(r|=Tt);var s={ctx:Ge,deps:null,nodes_start:null,nodes_end:null,f:r|It,first:null,fn:e,last:null,next:null,parent:i,b:i&&i.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(t)try{Mn(s),s.f|=ua}catch(c){throw Qe(s),c}else e!==null&&nn(s);if(n){var a=s;if(t&&a.deps===null&&a.teardown===null&&a.nodes_start===null&&a.first===a.last&&!(a.f&Rn)&&(a=a.first,r&yr&&r&rn&&a!==null&&(a.f|=rn)),a!==null&&(a.parent=i,i!==null&&pu(a,i),de!==null&&de.f&vt&&!(r&sn))){var l=de;(l.effects??(l.effects=[])).push(a)}}return s}function gu(){return de!==null&&!$t}function fs(r){const e=ar(ss,null,!1);return ot(e,at),e.teardown=r,e}function rr(r){qo();var e=ce.f,t=!de&&(e&wr)!==0&&(e&ua)===0;if(t){var n=Ge;(n.e??(n.e=[])).push(r)}else return Wo(r)}function Wo(r){return ar(is|Do,r,!1)}function _u(r){return qo(),ar(ss|Do,r,!0)}function mu(r){hr.ensure();const e=ar(sn|Rn,r,!0);return(t={})=>new Promise(n=>{t.outro?vn(e,()=>{Qe(e),n(void 0)}):(Qe(e),n(void 0))})}function mi(r){return ar(is,r,!1)}function yu(r,e){var t=Ge,n={effect:null,ran:!1,deps:r};t.l.$.push(n),n.effect=an(()=>{r(),!n.ran&&(n.ran=!0,or(e))})}function wu(){var r=Ge;an(()=>{for(var e of r.l.$){e.deps();var t=e.effect;t.f&at&&ot(t,sr),Bn(t)&&Mn(t),e.ran=!1}})}function bu(r){return ar(da|Rn,r,!0)}function an(r,e=0){return ar(ss|e,r,!0)}function re(r,e=[],t=[],n=[],i=!1){No(n,e,t,s=>{ar(i?is:ss,()=>r(...s.map(o)),!0)})}function Fn(r,e=0){var t=ar(yr|e,r,!0);return t}function Mt(r,e=!0){return ar(wr|Rn,r,!0,e)}function Yo(r){var e=r.teardown;if(e!==null){const t=on,n=de;ja(!0),Ct(null);try{e.call(null)}finally{ja(t),Ct(n)}}}function Xo(r,e=!1){var t=r.first;for(r.first=r.last=null;t!==null;){const i=t.ac;i!==null&&us(()=>{i.abort(dn)});var n=t.next;t.f&sn?t.parent=null:Qe(t,e),t=n}}function Su(r){for(var e=r.first;e!==null;){var t=e.next;e.f&wr||Qe(e),e=t}}function Qe(r,e=!0){var t=!1;(e||r.f&So)&&r.nodes_start!==null&&r.nodes_end!==null&&(Jo(r.nodes_start,r.nodes_end),t=!0),Xo(r,e&&!t),zi(r,0),ot(r,gr);var n=r.transitions;if(n!==null)for(const s of n)s.stop();Yo(r);var i=r.parent;i!==null&&i.first!==null&&Zo(r),r.next=r.prev=r.teardown=r.ctx=r.deps=r.fn=r.nodes_start=r.nodes_end=r.ac=null}function Jo(r,e){for(;r!==null;){var t=r===e?null:_i(r);r.remove(),r=t}}function Zo(r){var e=r.parent,t=r.prev,n=r.next;t!==null&&(t.next=n),n!==null&&(n.prev=t),e!==null&&(e.first===r&&(e.first=n),e.last===r&&(e.last=t))}function vn(r,e,t=!0){var n=[];pa(r,n,!0),Qo(n,()=>{t&&Qe(r),e&&e()})}function Qo(r,e){var t=r.length;if(t>0){var n=()=>--t||e();for(var i of r)i.out(n)}else e()}function pa(r,e,t){if(!(r.f&Tt)){if(r.f^=Tt,r.transitions!==null)for(const a of r.transitions)(a.is_global||t)&&e.push(a);for(var n=r.first;n!==null;){var i=n.next,s=(n.f&rn)!==0||(n.f&wr)!==0&&(r.f&yr)!==0;pa(n,e,s?t:!1),n=i}}}function ga(r){el(r,!0)}function el(r,e){if(r.f&Tt){r.f^=Tt,r.f&at||(ot(r,It),nn(r));for(var t=r.first;t!==null;){var n=t.next,i=(t.f&rn)!==0||(t.f&wr)!==0;el(t,i?e:!1),t=n}if(r.transitions!==null)for(const s of r.transitions)(s.is_global||e)&&s.in()}}function tl(r,e){for(var t=r.nodes_start,n=r.nodes_end;t!==null;){var i=t===n?null:_i(t);e.append(t),t=i}}let hn=!1;function Ga(r){hn=r}let on=!1;function ja(r){on=r}let de=null,$t=!1;function Ct(r){de=r}let ce=null;function Bt(r){ce=r}let mt=null;function rl(r){de!==null&&(mt===null?mt=[r]:mt.push(r))}let gt=null,xt=0,Lt=null;function Du(r){Lt=r}let nl=1,ei=0,tn=ei;function Ka(r){tn=r}let Mr=!1;function il(){return++nl}function Bn(r){var f;var e=r.f;if(e&It)return!0;if(e&sr){var t=r.deps,n=(e&Ft)!==0;if(e&vt&&(r.f&=~$i),t!==null){var i,s,a=(e&Ui)!==0,l=n&&ce!==null&&!Mr,c=t.length;if((a||l)&&(ce===null||!(ce.f&gr))){var u=r,d=u.parent;for(i=0;i<c;i++)s=t[i],(a||!((f=s==null?void 0:s.reactions)!=null&&f.includes(u)))&&(s.reactions??(s.reactions=[])).push(u);a&&(u.f^=Ui),l&&d!==null&&!(d.f&Ft)&&(u.f^=Ft)}for(i=0;i<c;i++)if(s=t[i],Bn(s)&&Bo(s),s.wv>r.wv)return!0}(!n||ce!==null&&!Mr)&&ot(r,at)}return!1}function sl(r,e,t=!0){var n=r.reactions;if(n!==null&&!(mt!=null&&mt.includes(r)))for(var i=0;i<n.length;i++){var s=n[i];s.f&vt?sl(s,e,!1):e===s&&(t?ot(s,It):s.f&at&&ot(s,sr),nn(s))}}function al(r){var h;var e=gt,t=xt,n=Lt,i=de,s=Mr,a=mt,l=Ge,c=$t,u=tn,d=r.f;gt=null,xt=0,Lt=null,Mr=(d&Ft)!==0&&($t||!hn||de===null),de=d&(wr|sn)?null:r,mt=null,In(r.ctx),$t=!1,tn=++ei,r.ac!==null&&(us(()=>{r.ac.abort(dn)}),r.ac=null);try{r.f|=Hs;var f=r.fn,_=f(),m=r.deps;if(gt!==null){var v;if(zi(r,xt),m!==null&&xt>0)for(m.length=xt+gt.length,v=0;v<gt.length;v++)m[xt+v]=gt[v];else r.deps=m=gt;if(!Mr||d&vt&&r.reactions!==null)for(v=xt;v<m.length;v++)((h=m[v]).reactions??(h.reactions=[])).push(r)}else m!==null&&xt<m.length&&(zi(r,xt),m.length=xt);if(pi()&&Lt!==null&&!$t&&m!==null&&!(r.f&(vt|sr|It)))for(v=0;v<Lt.length;v++)sl(Lt[v],r);return i!==null&&i!==r&&(ei++,Lt!==null&&(n===null?n=Lt:n.push(...Lt))),r.f&Pr&&(r.f^=Pr),_}catch(g){return Po(g)}finally{r.f^=Hs,gt=e,xt=t,Lt=n,de=i,Mr=s,mt=a,In(l),$t=c,tn=u}}function Cu(r,e){let t=e.reactions;if(t!==null){var n=wc.call(t,r);if(n!==-1){var i=t.length-1;i===0?t=e.reactions=null:(t[n]=t[i],t.pop())}}t===null&&e.f&vt&&(gt===null||!gt.includes(e))&&(ot(e,sr),e.f&(Ft|Ui)||(e.f^=Ui),Fo(e),zi(e,0))}function zi(r,e){var t=r.deps;if(t!==null)for(var n=e;n<t.length;n++)Cu(r,t[n])}function Mn(r){var e=r.f;if(!(e&gr)){ot(r,at);var t=ce,n=hn;ce=r,hn=!0;try{e&yr?Su(r):Xo(r),Yo(r);var i=al(r);r.teardown=typeof i=="function"?i:null,r.wv=nl;var s;mo&&Jc&&r.f&It&&r.deps}finally{hn=n,ce=t}}}async function Eu(){await Promise.resolve(),eu()}function o(r){var e=r.f,t=(e&vt)!==0;if(de!==null&&!$t){var n=ce!==null&&(ce.f&gr)!==0;if(!n&&!(mt!=null&&mt.includes(r))){var i=de.deps;if(de.f&Hs)r.rv<ei&&(r.rv=ei,gt===null&&i!==null&&i[xt]===r?xt++:gt===null?gt=[r]:(!Mr||!gt.includes(r))&&gt.push(r));else{(de.deps??(de.deps=[])).push(r);var s=r.reactions;s===null?r.reactions=[de]:s.includes(de)||s.push(de)}}}else if(t&&r.deps===null&&r.effects===null){var a=r,l=a.parent;l!==null&&!(l.f&Ft)&&(a.f^=Ft)}if(on){if(Tr.has(r))return Tr.get(r);if(t){a=r;var c=a.v;return(!(a.f&at)&&a.reactions!==null||ol(a))&&(c=va(a)),Tr.set(a,c),c}}else if(t){if(a=r,nt!=null&&nt.has(a))return nt.get(a);Bn(a)&&Bo(a)}if(nt!=null&&nt.has(r))return nt.get(r);if(r.f&Pr)throw r.v;return r.v}function ol(r){if(r.v===rt)return!0;if(r.deps===null)return!1;for(const e of r.deps)if(Tr.has(e)||e.f&vt&&ol(e))return!0;return!1}function or(r){var e=$t;try{return $t=!0,r()}finally{$t=e}}const Iu=-7169;function ot(r,e){r.f=r.f&Iu|e}function ll(r){if(!(typeof r!="object"||!r||r instanceof EventTarget)){if(_r in r)Js(r);else if(!Array.isArray(r))for(let e in r){const t=r[e];typeof t=="object"&&t&&_r in t&&Js(t)}}}function Js(r,e=new Set){if(typeof r=="object"&&r!==null&&!(r instanceof EventTarget)&&!e.has(r)){e.add(r),r instanceof Date&&r.getTime();for(let n in r)try{Js(r[n],e)}catch{}const t=ca(r);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const n=yo(t);for(let i in n){const s=n[i].get;if(s)try{s.call(r)}catch{}}}}}function xu(r){return r.endsWith("capture")&&r!=="gotpointercapture"&&r!=="lostpointercapture"}const ku=["beforeinput","click","change","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"];function Mu(r){return ku.includes(r)}const Pu={formnovalidate:"formNoValidate",ismap:"isMap",nomodule:"noModule",playsinline:"playsInline",readonly:"readOnly",defaultvalue:"defaultValue",defaultchecked:"defaultChecked",srcobject:"srcObject",novalidate:"noValidate",allowfullscreen:"allowFullscreen",disablepictureinpicture:"disablePictureInPicture",disableremoteplayback:"disableRemotePlayback"};function Tu(r){return r=r.toLowerCase(),Pu[r]??r}const Lu=["touchstart","touchmove"];function Au(r){return Lu.includes(r)}const cl=new Set,Zs=new Set;function ul(r,e,t,n={}){function i(s){if(n.capture||qn.call(e,s),!s.cancelBubble)return us(()=>t==null?void 0:t.call(this,s))}return r.startsWith("pointer")||r.startsWith("touch")||r==="wheel"?mr(()=>{e.addEventListener(r,i,n)}):e.addEventListener(r,i,n),i}function _a(r,e,t,n,i){var s={capture:n,passive:i},a=ul(r,e,t,s);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&fs(()=>{e.removeEventListener(r,a,s)})}function bt(r){for(var e=0;e<r.length;e++)cl.add(r[e]);for(var t of Zs)t(r)}let Ua=null;function qn(r){var g;var e=this,t=e.ownerDocument,n=r.type,i=((g=r.composedPath)==null?void 0:g.call(r))||[],s=i[0]||r.target;Ua=r;var a=0,l=Ua===r&&r.__root;if(l){var c=i.indexOf(l);if(c!==-1&&(e===document||e===window)){r.__root=e;return}var u=i.indexOf(e);if(u===-1)return;c<=u&&(a=c)}if(s=i[a]||r.target,s!==e){bc(r,"currentTarget",{configurable:!0,get(){return s||t}});var d=de,f=ce;Ct(null),Bt(null);try{for(var _,m=[];s!==null;){var v=s.assignedSlot||s.parentNode||s.host||null;try{var h=s["__"+n];h!=null&&(!s.disabled||r.target===s)&&h.call(s,r)}catch(D){_?m.push(D):_=D}if(r.cancelBubble||v===e||v===null)break;s=v}if(_){for(let D of m)queueMicrotask(()=>{throw D});throw _}}finally{r.__root=e,delete r.currentTarget,Ct(d),Bt(f)}}}function ma(r){var e=document.createElement("template");return e.innerHTML=r.replaceAll("<!>","<!---->"),e.content}function Pn(r,e){var t=ce;t.nodes_start===null&&(t.nodes_start=r,t.nodes_end=e)}function G(r,e){var t=(e&Uc)!==0,n=(e&$c)!==0,i,s=!r.startsWith("<!>");return()=>{i===void 0&&(i=ma(s?r:"<!>"+r),t||(i=tr(i)));var a=n||Uo?document.importNode(i,!0):i.cloneNode(!0);if(t){var l=tr(a),c=a.lastChild;Pn(l,c)}else Pn(a,a);return a}}function Ou(r,e,t="svg"){var n=!r.startsWith("<!>"),i=`<${t}>${n?r:"<!>"+r}</${t}>`,s;return()=>{if(!s){var a=ma(i),l=tr(a);s=tr(l)}var c=s.cloneNode(!0);return Pn(c,c),c}}function dl(r,e){return Ou(r,e,"svg")}function Dt(r=""){{var e=Ar(r+"");return Pn(e,e),e}}function Tn(){var r=document.createDocumentFragment(),e=document.createComment(""),t=Ar();return r.append(e,t),Pn(e,t),r}function M(r,e){r!==null&&r.before(e)}function te(r,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(r.__t??(r.__t=r.nodeValue))&&(r.__t=t,r.nodeValue=t+"")}function Ru(r,e){return Nu(r,e)}const un=new Map;function Nu(r,{target:e,anchor:t,props:n={},events:i,context:s,intro:a=!0}){fu();var l=new Set,c=f=>{for(var _=0;_<f.length;_++){var m=f[_];if(!l.has(m)){l.add(m);var v=Au(m);e.addEventListener(m,qn,{passive:v});var h=un.get(m);h===void 0?(document.addEventListener(m,qn,{passive:v}),un.set(m,1)):un.set(m,h+1)}}};c(la(cl)),Zs.add(c);var u=void 0,d=mu(()=>{var f=t??e.appendChild(Ar());return iu(f,{pending:()=>{}},_=>{if(s){yt({});var m=Ge;m.c=s}i&&(n.$$events=i),u=r(_,n)||{},s&&wt()}),()=>{var v;for(var _ of l){e.removeEventListener(_,qn);var m=un.get(_);--m===0?(document.removeEventListener(_,qn),un.delete(_)):un.set(_,m)}Zs.delete(c),f!==t&&((v=f.parentNode)==null||v.removeChild(f))}});return Fu.set(u,d),u}let Fu=new WeakMap;var Kt,Zt,kt,ni,ii,Qi;class fl{constructor(e,t=!0){$e(this,"anchor");K(this,Kt,new Map);K(this,Zt,new Map);K(this,kt,new Map);K(this,ni,!0);K(this,ii,()=>{var e=Te;if(p(this,Kt).has(e)){var t=p(this,Kt).get(e),n=p(this,Zt).get(t);if(n)ga(n);else{var i=p(this,kt).get(t);i&&(p(this,Zt).set(t,i.effect),p(this,kt).delete(t),i.fragment.lastChild.remove(),this.anchor.before(i.fragment),n=i.effect)}for(const[s,a]of p(this,Kt)){if(p(this,Kt).delete(s),s===e)break;const l=p(this,kt).get(a);l&&(Qe(l.effect),p(this,kt).delete(a))}for(const[s,a]of p(this,Zt)){if(s===t)continue;const l=()=>{if(Array.from(p(this,Kt).values()).includes(s)){var u=document.createDocumentFragment();tl(a,u),u.append(Ar()),p(this,kt).set(s,{effect:a,fragment:u})}else Qe(a);p(this,Zt).delete(s)};p(this,ni)||!n?vn(a,l,!1):l()}}});K(this,Qi,e=>{p(this,Kt).delete(e);const t=Array.from(p(this,Kt).values());for(const[n,i]of p(this,kt))t.includes(n)||(Qe(i.effect),p(this,kt).delete(n))});this.anchor=e,F(this,ni,t)}ensure(e,t){var n=Te,i=zo();if(t&&!p(this,Zt).has(e)&&!p(this,kt).has(e))if(i){var s=document.createDocumentFragment(),a=Ar();s.append(a),p(this,kt).set(e,{effect:Mt(()=>t(a)),fragment:s})}else p(this,Zt).set(e,Mt(()=>t(this.anchor)));if(p(this,Kt).set(n,e),i){for(const[l,c]of p(this,Zt))l===e?n.skipped_effects.delete(c):n.skipped_effects.add(c);for(const[l,c]of p(this,kt))l===e?n.skipped_effects.delete(c.effect):n.skipped_effects.add(c.effect);n.oncommit(p(this,ii)),n.ondiscard(p(this,Qi))}else p(this,ii).call(this)}}Kt=new WeakMap,Zt=new WeakMap,kt=new WeakMap,ni=new WeakMap,ii=new WeakMap,Qi=new WeakMap;function Le(r,e,t=!1){var n=new fl(r),i=t?rn:0;function s(a,l){n.ensure(a,l)}Fn(()=>{var a=!1;e((l,c=!0)=>{a=!0,s(c,l)}),a||s(!1,null)},i)}function Xe(r,e){return e}function Bu(r,e,t){for(var n=r.items,i=[],s=e.length,a=0;a<s;a++)pa(e[a].e,i,!0);var l=s>0&&i.length===0&&t!==null;if(l){var c=t.parentNode;vu(c),c.append(t),n.clear(),Wt(r,e[0].prev,e[s-1].next)}Qo(i,()=>{for(var u=0;u<s;u++){var d=e[u];l||(n.delete(d.k),Wt(r,d.prev,d.next)),Qe(d.e,!l)}})}function Be(r,e,t,n,i,s=null){var a=r,l={flags:e,items:new Map,first:null},c=(e&Eo)!==0;if(c){var u=r;a=u.appendChild(Ar())}var d=null,f=!1,_=new Map,m=fa(()=>{var D=t();return oa(D)?D:D==null?[]:la(D)}),v,h;function g(){Vu(h,v,l,_,a,i,e,n,t),s!==null&&(v.length===0?d?ga(d):d=Mt(()=>s(a)):d!==null&&vn(d,()=>{d=null}))}Fn(()=>{h??(h=ce),v=o(m);var D=v.length;if(!(f&&D===0)){f=D===0;var R,E,T,P;if(zo()){var L=new Set,j=Te;for(E=0;E<D;E+=1){T=v[E],P=n(T,E);var q=l.items.get(P)??_.get(P);q?e&(os|ls)&&vl(q,T,E,e):(R=hl(null,l,null,null,T,P,E,i,e,t,!0),_.set(P,R)),L.add(P)}for(const[Ee,be]of l.items)L.has(Ee)||j.skipped_effects.add(be.e);j.oncommit(g)}else g();o(m)}})}function Vu(r,e,t,n,i,s,a,l,c){var x,k,Y,z;var u=(a&Fc)!==0,d=(a&(os|ls))!==0,f=e.length,_=t.items,m=t.first,v=m,h,g=null,D,R=[],E=[],T,P,L,j;if(u)for(j=0;j<f;j+=1)T=e[j],P=l(T,j),L=_.get(P),L!==void 0&&((x=L.a)==null||x.measure(),(D??(D=new Set)).add(L));for(j=0;j<f;j+=1){if(T=e[j],P=l(T,j),L=_.get(P),L===void 0){var q=n.get(P);if(q!==void 0){n.delete(P),_.set(P,q);var Ee=g?g.next:v;Wt(t,g,q),Wt(t,q,Ee),As(q,Ee,i),g=q}else{var be=v?v.e.nodes_start:i;g=hl(be,t,g,g===null?t.first:g.next,T,P,j,s,a,c)}_.set(P,g),R=[],E=[],v=g.next;continue}if(d&&vl(L,T,j,a),L.e.f&Tt&&(ga(L.e),u&&((k=L.a)==null||k.unfix(),(D??(D=new Set)).delete(L))),L!==v){if(h!==void 0&&h.has(L)){if(R.length<E.length){var me=E[0],ie;g=me.prev;var Se=R[0],he=R[R.length-1];for(ie=0;ie<R.length;ie+=1)As(R[ie],me,i);for(ie=0;ie<E.length;ie+=1)h.delete(E[ie]);Wt(t,Se.prev,he.next),Wt(t,g,Se),Wt(t,he,me),v=me,g=he,j-=1,R=[],E=[]}else h.delete(L),As(L,v,i),Wt(t,L.prev,L.next),Wt(t,L,g===null?t.first:g.next),Wt(t,g,L),g=L;continue}for(R=[],E=[];v!==null&&v.k!==P;)v.e.f&Tt||(h??(h=new Set)).add(v),E.push(v),v=v.next;if(v===null)continue;L=v}R.push(L),g=L,v=L.next}if(v!==null||h!==void 0){for(var ue=h===void 0?[]:la(h);v!==null;)v.e.f&Tt||ue.push(v),v=v.next;var De=ue.length;if(De>0){var Re=a&Eo&&f===0?i:null;if(u){for(j=0;j<De;j+=1)(Y=ue[j].a)==null||Y.measure();for(j=0;j<De;j+=1)(z=ue[j].a)==null||z.fix()}Bu(t,ue,Re)}}u&&mr(()=>{var A;if(D!==void 0)for(L of D)(A=L.a)==null||A.apply()}),r.first=t.first&&t.first.e,r.last=g&&g.e;for(var ke of n.values())Qe(ke.e);n.clear()}function vl(r,e,t,n){n&os&&kn(r.v,e),n&ls?kn(r.i,t):r.i=t}function hl(r,e,t,n,i,s,a,l,c,u,d){var f=(c&os)!==0,_=(c&Bc)===0,m=f?_?Go(i,!1,!1):Lr(i):i,v=c&ls?Lr(a):a,h={i:v,v:m,k:s,a:null,e:null,prev:t,next:n};try{if(r===null){var g=document.createDocumentFragment();g.append(r=Ar())}return h.e=Mt(()=>l(r,m,v,u),Yc),h.e.prev=t&&t.e,h.e.next=n&&n.e,t===null?d||(e.first=h):(t.next=h,t.e.next=h.e),n!==null&&(n.prev=h,n.e.prev=h.e),h}finally{}}function As(r,e,t){for(var n=r.next?r.next.e.nodes_start:t,i=e?e.e.nodes_start:t,s=r.e.nodes_start;s!==null&&s!==n;){var a=_i(s);i.before(s),s=a}}function Wt(r,e,t){e===null?r.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function pl(r,e,t=!1,n=!1,i=!1){var s=r,a="";re(()=>{var l=ce;if(a!==(a=e()??"")&&(l.nodes_start!==null&&(Jo(l.nodes_start,l.nodes_end),l.nodes_start=l.nodes_end=null),a!=="")){var c=a+"";t?c=`<svg>${c}</svg>`:n&&(c=`<math>${c}</math>`);var u=ma(c);if((t||n)&&(u=tr(u)),Pn(tr(u),u.lastChild),t||n)for(;tr(u);)s.before(tr(u));else s.before(u)}})}function gl(r,e,...t){var n=new fl(r);Fn(()=>{const i=e()??null;n.ensure(i,i&&(s=>i(s,...t)))},rn)}function Gu(r,e){var t=void 0,n;Fn(()=>{t!==(t=e())&&(n&&(Qe(n),n=null),t&&(n=Mt(()=>{mi(()=>t(r))})))})}function _l(r){var e,t,n="";if(typeof r=="string"||typeof r=="number")n+=r;else if(typeof r=="object")if(Array.isArray(r)){var i=r.length;for(e=0;e<i;e++)r[e]&&(t=_l(r[e]))&&(n&&(n+=" "),n+=t)}else for(t in r)r[t]&&(n&&(n+=" "),n+=t);return n}function ju(){for(var r,e,t=0,n="",i=arguments.length;t<i;t++)(r=arguments[t])&&(e=_l(r))&&(n&&(n+=" "),n+=e);return n}function Ku(r){return typeof r=="object"?ju(r):r??""}const $a=[...` 	
\r\fÂ \v\uFEFF`];function Uu(r,e,t){var n=r==null?"":""+r;if(e&&(n=n?n+" "+e:e),t){for(var i in t)if(t[i])n=n?n+" "+i:i;else if(n.length)for(var s=i.length,a=0;(a=n.indexOf(i,a))>=0;){var l=a+s;(a===0||$a.includes(n[a-1]))&&(l===n.length||$a.includes(n[l]))?n=(a===0?"":n.substring(0,a))+n.substring(l+1):a=l}}return n===""?null:n}function Ha(r,e=!1){var t=e?" !important;":";",n="";for(var i in r){var s=r[i];s!=null&&s!==""&&(n+=" "+i+": "+s+t)}return n}function Os(r){return r[0]!=="-"||r[1]!=="-"?r.toLowerCase():r}function $u(r,e){if(e){var t="",n,i;if(Array.isArray(e)?(n=e[0],i=e[1]):n=e,r){r=String(r).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var s=!1,a=0,l=!1,c=[];n&&c.push(...Object.keys(n).map(Os)),i&&c.push(...Object.keys(i).map(Os));var u=0,d=-1;const h=r.length;for(var f=0;f<h;f++){var _=r[f];if(l?_==="/"&&r[f-1]==="*"&&(l=!1):s?s===_&&(s=!1):_==="/"&&r[f+1]==="*"?l=!0:_==='"'||_==="'"?s=_:_==="("?a++:_===")"&&a--,!l&&s===!1&&a===0){if(_===":"&&d===-1)d=f;else if(_===";"||f===h-1){if(d!==-1){var m=Os(r.substring(u,d).trim());if(!c.includes(m)){_!==";"&&f++;var v=r.substring(u,f).trim();t+=" "+v+";"}}u=f+1,d=-1}}}}return n&&(t+=Ha(n)),i&&(t+=Ha(i,!0)),t=t.trim(),t===""?null:t}return r==null?null:String(r)}function it(r,e,t,n,i,s){var a=r.__className;if(a!==t||a===void 0){var l=Uu(t,n,s);l==null?r.removeAttribute("class"):e?r.className=l:r.setAttribute("class",l),r.__className=t}else if(s&&i!==s)for(var c in s){var u=!!s[c];(i==null||u!==!!i[c])&&r.classList.toggle(c,u)}return s}function Rs(r,e={},t,n){for(var i in t){var s=t[i];e[i]!==s&&(t[i]==null?r.style.removeProperty(i):r.style.setProperty(i,s,n))}}function Ze(r,e,t,n){var i=r.__style;if(i!==e){var s=$u(e,n);s==null?r.removeAttribute("style"):r.style.cssText=s,r.__style=e}else n&&(Array.isArray(n)?(Rs(r,t==null?void 0:t[0],n[0]),Rs(r,t==null?void 0:t[1],n[1],"important")):Rs(r,t,n));return n}function qi(r,e,t=!1){if(r.multiple){if(e==null)return;if(!oa(e))return qc();for(var n of r.options)n.selected=e.includes(Zn(n));return}for(n of r.options){var i=Zn(n);if(Ko(i,e)){n.selected=!0;return}}(!t||e!==void 0)&&(r.selectedIndex=-1)}function ml(r){var e=new MutationObserver(()=>{qi(r,r.__value)});e.observe(r,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),fs(()=>{e.disconnect()})}function vr(r,e,t=e){var n=new WeakSet,i=!0;ds(r,"change",s=>{var a=s?"[selected]":":checked",l;if(r.multiple)l=[].map.call(r.querySelectorAll(a),Zn);else{var c=r.querySelector(a)??r.querySelector("option:not([disabled])");l=c&&Zn(c)}t(l),Te!==null&&n.add(Te)}),mi(()=>{var s=e();if(r===document.activeElement){var a=Yn??Te;if(n.has(a))return}if(qi(r,s,i),i&&s===void 0){var l=r.querySelector(":checked");l!==null&&(s=Zn(l),t(s))}r.__value=s,i=!1}),ml(r)}function Zn(r){return"__value"in r?r.__value:r.value}const Kn=Symbol("class"),Un=Symbol("style"),yl=Symbol("is custom element"),wl=Symbol("is html");function Wn(r,e){var t=ya(r);t.value===(t.value=e??void 0)||r.value===e&&(e!==0||r.nodeName!=="PROGRESS")||(r.value=e??"")}function Hu(r,e){e?r.hasAttribute("selected")||r.setAttribute("selected",""):r.removeAttribute("selected")}function Ht(r,e,t,n){var i=ya(r);i[e]!==(i[e]=t)&&(e==="loading"&&(r[Ic]=t),t==null?r.removeAttribute(e):typeof t!="string"&&bl(r).includes(e)?r[e]=t:r.setAttribute(e,t))}function zu(r,e,t,n,i=!1,s=!1){var a=ya(r),l=a[yl],c=!a[wl],u=e||{},d=r.tagName==="OPTION";for(var f in e)f in t||(t[f]=null);t.class?t.class=Ku(t.class):t[Kn]&&(t.class=null),t[Un]&&(t.style??(t.style=null));var _=bl(r);for(const T in t){let P=t[T];if(d&&T==="value"&&P==null){r.value=r.__value="",u[T]=P;continue}if(T==="class"){var m=r.namespaceURI==="http://www.w3.org/1999/xhtml";it(r,m,P,n,e==null?void 0:e[Kn],t[Kn]),u[T]=P,u[Kn]=t[Kn];continue}if(T==="style"){Ze(r,P,e==null?void 0:e[Un],t[Un]),u[T]=P,u[Un]=t[Un];continue}var v=u[T];if(!(P===v&&!(P===void 0&&r.hasAttribute(T)))){u[T]=P;var h=T[0]+T[1];if(h!=="$$")if(h==="on"){const L={},j="$$"+T;let q=T.slice(2);var g=Mu(q);if(xu(q)&&(q=q.slice(0,-7),L.capture=!0),!g&&v){if(P!=null)continue;r.removeEventListener(q,u[j],L),u[j]=null}if(P!=null)if(g)r[`__${q}`]=P,bt([q]);else{let Ee=function(be){u[T].call(this,be)};var E=Ee;u[j]=ul(q,r,Ee,L)}else g&&(r[`__${q}`]=void 0)}else if(T==="style")Ht(r,T,P);else if(T==="autofocus")ha(r,!!P);else if(!l&&(T==="__value"||T==="value"&&P!=null))r.value=r.__value=P;else if(T==="selected"&&d)Hu(r,P);else{var D=T;c||(D=Tu(D));var R=D==="defaultValue"||D==="defaultChecked";if(P==null&&!l&&!R)if(a[T]=null,D==="value"||D==="checked"){let L=r;const j=e===void 0;if(D==="value"){let q=L.defaultValue;L.removeAttribute(D),L.defaultValue=q,L.value=L.__value=j?q:null}else{let q=L.defaultChecked;L.removeAttribute(D),L.defaultChecked=q,L.checked=j?q:!1}}else r.removeAttribute(T);else R||_.includes(D)&&(l||typeof P!="string")?(r[D]=P,D in a&&(a[D]=rt)):typeof P!="function"&&Ht(r,D,P)}}}return u}function qu(r,e,t=[],n=[],i=[],s,a=!1,l=!1){No(i,t,n,c=>{var u=void 0,d={},f=r.nodeName==="SELECT",_=!1;if(Fn(()=>{var v=e(...c.map(o)),h=zu(r,u,v,s,a,l);_&&f&&"value"in v&&qi(r,v.value);for(let D of Object.getOwnPropertySymbols(d))v[D]||Qe(d[D]);for(let D of Object.getOwnPropertySymbols(v)){var g=v[D];D.description===zc&&(!u||g!==u[D])&&(d[D]&&Qe(d[D]),d[D]=Mt(()=>Gu(r,()=>g))),h[D]=g}u=h}),f){var m=r;mi(()=>{qi(m,u.value,!0),ml(m)})}_=!0})}function ya(r){return r.__attributes??(r.__attributes={[yl]:r.nodeName.includes("-"),[wl]:r.namespaceURI===Hc})}var za=new Map;function bl(r){var e=r.getAttribute("is")||r.nodeName,t=za.get(e);if(t)return t;za.set(e,t=[]);for(var n,i=r,s=Element.prototype;s!==i;){n=yo(i);for(var a in n)n[a].set&&t.push(a);i=ca(i)}return t}function Ln(r,e,t=e){var n=new WeakSet;ds(r,"input",async i=>{var s=i?r.defaultValue:r.value;if(s=Fs(r)?Bs(s):s,t(s),Te!==null&&n.add(Te),await Eu(),s!==(s=e())){var a=r.selectionStart,l=r.selectionEnd,c=r.value.length;if(r.value=s??"",l!==null){var u=r.value.length;a===l&&l===c&&u>c?(r.selectionStart=u,r.selectionEnd=u):(r.selectionStart=a,r.selectionEnd=Math.min(l,u))}}}),or(e)==null&&r.value&&(t(Fs(r)?Bs(r.value):r.value),Te!==null&&n.add(Te)),an(()=>{var i=e();if(r===document.activeElement){var s=Yn??Te;if(n.has(s))return}Fs(r)&&i===Bs(r.value)||r.type==="date"&&!i&&!r.value||i!==r.value&&(r.value=i??"")})}const Ns=new Set;function Kr(r,e,t,n,i=n){var s=t.getAttribute("type")==="checkbox",a=r;if(e!==null)for(var l of e)a=a[l]??(a[l]=[]);a.push(t),ds(t,"change",()=>{var c=t.__value;s&&(c=Wu(a,c,t.checked)),i(c)},()=>i(s?[]:null)),an(()=>{var c=n();s?(c=c||[],t.checked=c.includes(t.__value)):t.checked=Ko(t.__value,c)}),fs(()=>{var c=a.indexOf(t);c!==-1&&a.splice(c,1)}),Ns.has(a)||(Ns.add(a),mr(()=>{a.sort((c,u)=>c.compareDocumentPosition(u)===4?-1:1),Ns.delete(a)})),mr(()=>{})}function Sl(r,e,t=e){ds(r,"change",n=>{var i=n?r.defaultChecked:r.checked;t(i)}),or(e)==null&&t(r.checked),an(()=>{var n=e();r.checked=!!n})}function Wu(r,e,t){for(var n=new Set,i=0;i<r.length;i+=1)r[i].checked&&n.add(r[i].__value);return t||n.delete(e),Array.from(n)}function Fs(r){var e=r.type;return e==="number"||e==="range"}function Bs(r){return r===""?null:+r}var xr,yn,si,es,Dl;const ts=class ts{constructor(e){K(this,es);K(this,xr,new WeakMap);K(this,yn);K(this,si);F(this,si,e)}observe(e,t){var n=p(this,xr).get(e)||new Set;return n.add(t),p(this,xr).set(e,n),Fe(this,es,Dl).call(this).observe(e,p(this,si)),()=>{var i=p(this,xr).get(e);i.delete(t),i.size===0&&(p(this,xr).delete(e),p(this,yn).unobserve(e))}}};xr=new WeakMap,yn=new WeakMap,si=new WeakMap,es=new WeakSet,Dl=function(){return p(this,yn)??F(this,yn,new ResizeObserver(e=>{for(var t of e){ts.entries.set(t.target,t);for(var n of p(this,xr).get(t.target)||[])n(t)}}))},$e(ts,"entries",new WeakMap);let Qs=ts;var Yu=new Qs({box:"border-box"});function Xu(r,e,t){var n=Yu.observe(r,()=>t(r[e]));mi(()=>(or(()=>t(r[e])),n))}function qa(r,e){return r===e||(r==null?void 0:r[_r])===e}function nr(r={},e,t,n){return mi(()=>{var i,s;return an(()=>{i=s,s=[],or(()=>{r!==t(...s)&&(e(r,...s),i&&qa(t(...i),r)&&e(null,...i))})}),()=>{mr(()=>{s&&qa(t(...s),r)&&e(null,...s)})}}),r}function Ju(r=!1){const e=Ge,t=e.l.u;if(!t)return;let n=()=>ll(e.s);if(r){let i=0,s={};const a=gi(()=>{let l=!1;const c=e.s;for(const u in c)c[u]!==s[u]&&(s[u]=c[u],l=!0);return l&&i++,i});n=()=>o(a)}t.b.length&&_u(()=>{Wa(e,n),$s(t.b)}),rr(()=>{const i=or(()=>t.m.map(Cc));return()=>{for(const s of i)typeof s=="function"&&s()}}),t.a.length&&rr(()=>{Wa(e,n),$s(t.a)})}function Wa(r,e){if(r.l.s)for(const t of r.l.s)o(t);e()}let xi=!1;function Zu(r){var e=xi;try{return xi=!1,[r(),xi]}finally{xi=e}}const Qu={get(r,e){if(!r.exclude.includes(e))return o(r.version),e in r.special?r.special[e]():r.props[e]},set(r,e,t){if(!(e in r.special)){var n=ce;try{Bt(r.parent_effect),r.special[e]=fe({get[e](){return r.props[e]}},e,Io)}finally{Bt(n)}}return r.special[e](t),Pt(r.version),!0},getOwnPropertyDescriptor(r,e){if(!r.exclude.includes(e)&&e in r.props)return{enumerable:!0,configurable:!0,value:r.props[e]}},deleteProperty(r,e){return r.exclude.includes(e)||(r.exclude.push(e),Pt(r.version)),!0},has(r,e){return r.exclude.includes(e)?!1:e in r.props},ownKeys(r){return Reflect.ownKeys(r.props).filter(e=>!r.exclude.includes(e))}};function Ya(r,e){return new Proxy({props:r,exclude:e,special:{},version:Lr(0),parent_effect:ce},Qu)}function fe(r,e,t,n){var E;var i=!Nn||(t&Gc)!==0,s=(t&jc)!==0,a=(t&Kc)!==0,l=n,c=!0,u=()=>(c&&(c=!1,l=a?or(n):n),l),d;if(s){var f=_r in r||Ec in r;d=((E=fn(r,e))==null?void 0:E.set)??(f&&e in r?T=>r[e]=T:void 0)}var _,m=!1;s?[_,m]=Zu(()=>r[e]):_=r[e],_===void 0&&n!==void 0&&(_=u(),d&&(i&&Lc(),d(_)));var v;if(i?v=()=>{var T=r[e];return T===void 0?u():(c=!0,T)}:v=()=>{var T=r[e];return T!==void 0&&(l=void 0),T===void 0?l:T},i&&!(t&Io))return v;if(d){var h=r.$$legacy;return function(T,P){return arguments.length>0?((!i||!P||h||m)&&d(P?v():T),T):v()}}var g=!1,D=(t&Vc?gi:fa)(()=>(g=!1,v()));s&&o(D);var R=ce;return function(T,P){if(arguments.length>0){const L=P?o(D):i&&s?we(T):T;return S(D,L),g=!0,l!==void 0&&(l=L),T}return on&&g||R.f&gr?D.v:o(D)}}function Vn(r){Ge===null&&Co(),Nn&&Ge.l!==null?ed(Ge).m.push(r):rr(()=>{const e=or(r);if(typeof e=="function")return e})}function vs(r){Ge===null&&Co(),Vn(()=>()=>or(r))}function ed(r){var e=r.l;return e.u??(e.u={a:[],b:[],m:[]})}const td="5";var _o;typeof window<"u"&&((_o=window.__svelte??(window.__svelte={})).v??(_o.v=new Set)).add(td);const rd=0,nd=126,id=231,sd=6;class ad{constructor(){this.universe=new Uint8Array(512).fill(0),this.device=null,this.interval=null,this.updateRate=1e3/60,this.connected=!1}async connect(){if(!("usb"in navigator))throw new Error("WebUSB is not supported in this browser");try{return this.device=await navigator.usb.requestDevice({filters:[{vendorId:1027}]}),await this.device.open(),await this.device.claimInterface(0),await this.device.controlTransferOut({requestType:"class",recipient:"interface",request:34,value:1,index:0}),this.connected=!0,this.interval=setInterval(()=>{this.sendUniverse()},this.updateRate),!0}catch(e){throw console.error("Failed to connect:",e),e}}disconnect(){this.interval&&(clearInterval(this.interval),this.interval=null),this.device&&(this.device.close(),this.device=null),this.connected=!1}setChannel(e,t){e>=0&&e<512&&(this.universe[e]=Math.max(0,Math.min(255,t)))}getChannel(e){return this.universe[e]||0}setChannels(e,t){t.forEach((n,i)=>{this.setChannel(e+i,n)})}getUniverse(){return this.universe}clearUniverse(){this.universe.fill(0)}sendUniverse(){if(!this.device||!this.connected)return;const e=Uint8Array.from([rd,...this.universe]),t=Uint8Array.from([nd,sd,e.length&255,e.length>>8&255,...e,id]);this.device.transferOut(2,t).catch(n=>{console.error("Failed to send DMX data:",n)})}}const Ve={RGB:{name:"RGB Light",channels:3,controls:[{name:"Red",type:"slider",color:"#b83838"},{name:"Green",type:"slider",color:"#4a964a"},{name:"Blue",type:"slider",color:"#365fb4"}]},RGBA:{name:"RGBA Light",channels:4,controls:[{name:"Red",type:"slider",color:"#b83838"},{name:"Green",type:"slider",color:"#4a964a"},{name:"Blue",type:"slider",color:"#365fb4"},{name:"Amber",type:"slider",color:"#a68522"}]},RGBW:{name:"RGBW Light",channels:4,controls:[{name:"Red",type:"slider",color:"#b83838"},{name:"Green",type:"slider",color:"#4a964a"},{name:"Blue",type:"slider",color:"#365fb4"},{name:"White",type:"slider",color:"#808080"}]},DIMMER:{name:"Dimmer",channels:1,controls:[{name:"Intensity",type:"slider",color:"#888888"}]},SMOKE:{name:"Smoke Machine",channels:1,controls:[{name:"Output",type:"slider",color:"#666666"}]},MOVING_HEAD:{name:"Moving Head (Basic)",channels:7,controls:[{name:"Pan/Tilt",type:"xypad",panIndex:0,tiltIndex:1},{name:"Dimmer",type:"slider",color:"#888888"},{name:"Red",type:"slider",color:"#b83838"},{name:"Green",type:"slider",color:"#4a964a"},{name:"Blue",type:"slider",color:"#365fb4"},{name:"White",type:"slider",color:"#808080"}]}};class $n{constructor(e,t,n,i="",s=null,a=null){this.id=e,this.type=t,this.startChannel=n,this.name=i||`${Ve[t].name} ${e}`,this.defaultValues=new Array(Ve[t].channels).fill(0),this.linkedTo=s,this.cssId=a||this.generateCssId(this.name)}generateCssId(e){return e.toLowerCase().replace(/[^a-z0-9]/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,"")}updateCssId(){this.cssId=this.generateCssId(this.name)}setValue(e,t){this.defaultValues[e]=Math.max(0,Math.min(255,t))}getValue(e){return this.defaultValues[e]}getChannelValues(){return this.defaultValues}isLinked(){return this.linkedTo!==null}}function pr(r,e){if(!e||e.length===0)return"#000000";switch(r){case"RGB":{const[t,n,i]=e;return`rgb(${t}, ${n}, ${i})`}case"RGBA":{const[t,n,i,s]=e,a=255,l=191,c=0,u=Math.min(255,t+a*s/255),d=Math.min(255,n+l*s/255),f=Math.min(255,i+c*s/255);return`rgb(${Math.round(u)}, ${Math.round(d)}, ${Math.round(f)})`}case"RGBW":{const[t,n,i,s]=e,a=Math.min(255,t+s),l=Math.min(255,n+s),c=Math.min(255,i+s);return`rgb(${Math.round(a)}, ${Math.round(l)}, ${Math.round(c)})`}case"MOVING_HEAD":{const t=e[2]||0,n=e[3]||0,i=e[4]||0,s=e[5]||0,a=e[6]||0;let l=Math.min(255,n+a),c=Math.min(255,i+a),u=Math.min(255,s+a);return l=Math.round(l*t/255),c=Math.round(c*t/255),u=Math.round(u*t/255),`rgb(${l}, ${c}, ${u})`}case"DIMMER":{const t=e[0]||0;return`rgb(${t}, ${t}, ${t})`}case"SMOKE":{const t=e[0]||0,n=Math.round(t*.7);return`rgb(${Math.round(t*.5)}, ${Math.round(t*.5)}, ${n})`}default:return"#000000"}}class od{constructor(e=0,t="RGB",n=[0,0,0]){this.time=e,this.deviceType=t,this.values=[...n]}getProperties(){const e=pr(this.deviceType,this.values);if(this.deviceType==="MOVING_HEAD"){const t=this.values[0]||0,n=this.values[1]||0,i=t/255*100-50,s=n/255*100-50;return{color:e,transform:`translate(${i}%, ${s}%)`}}return{color:e}}toCSS(){const e=this.getProperties(),t=Object.entries(e).map(([i,s])=>`${i}: ${s}`).join("; ");return`${Math.round(this.time*100)}% { ${t}; }`}}class hs{constructor(e="animation",t="RGB",n=[]){this.name=e,this.deviceType=t,this.keyframes=n}addKeyframe(e,t){const n=new od(e,this.deviceType,t);return this.keyframes=[...this.keyframes,n].sort((i,s)=>i.time-s.time),n}removeKeyframe(e){const t=this.keyframes.indexOf(e);t!==-1&&this.keyframes.splice(t,1)}toCSS(){if(this.keyframes.length===0)return"";const e=this.keyframes.map(t=>t.toCSS()).join(`
  `);return`@keyframes ${this.name} {
  ${e}
}`}getKeyframeColor(e){return pr(this.deviceType,e.values)}getGradientSegments(e=1e3){if(this.keyframes.length===0)return[{left:0,width:e,gradient:"#000000"}];const t=[],n=[...this.keyframes].sort((s,a)=>s.time-a.time);if(n[0].time>0){const s=this.getKeyframeColor(n[0]);t.push({left:0,width:n[0].time*e,gradient:`linear-gradient(to right, #000000, ${s})`})}for(let s=0;s<n.length-1;s++){const a=n[s],l=n[s+1],c=this.getKeyframeColor(a),u=this.getKeyframeColor(l);t.push({left:a.time*e,width:(l.time-a.time)*e,gradient:`linear-gradient(to right, ${c}, ${u})`})}const i=n[n.length-1];if(i.time<1){const s=this.getKeyframeColor(i);t.push({left:i.time*e,width:(1-i.time)*e,gradient:`linear-gradient(to right, ${s}, #000000)`})}return t}toJSON(){return{name:this.name,deviceType:this.deviceType,keyframes:this.keyframes.map(e=>({time:e.time,deviceType:e.deviceType,values:e.values}))}}static fromJSON(e){const t=e.deviceType||"RGB",n=new hs(e.name,t);for(const i of e.keyframes)if(i.values)n.addKeyframe(i.time,i.values);else if(i.properties){const s=new Array(n.deviceType==="RGB"?3:4).fill(0);n.addKeyframe(i.time,s)}return n}}class ld{constructor(){this.animations=new Map,this.listeners=new Map,this.load()}on(e,t){this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e).add(t)}off(e,t){this.listeners.has(e)&&this.listeners.get(e).delete(t)}_emit(e,t){if(!this.listeners.has(e))return;const n=this.listeners.get(e);for(const i of n)i(t)}add(e){this.animations.set(e.name,e),this.save(),this._emit("changed",{type:"add",animation:e})}remove(e){const t=this.animations.get(e);this.animations.delete(e),this.save(),this._emit("changed",{type:"remove",animation:t,name:e})}get(e){return this.animations.get(e)}getAll(){return Array.from(this.animations.values())}has(e){return this.animations.has(e)}rename(e,t){const n=this.animations.get(e);return n?(n.name=t,this.animations.delete(e),this.animations.set(t,n),this.save(),!0):!1}toCSS(){return this.getAll().map(e=>e.toCSS()).filter(e=>e).join(`

`)}save(){const e=this.getAll().map(t=>t.toJSON());localStorage.setItem("dmx-animations",JSON.stringify(e))}load(){const e=localStorage.getItem("dmx-animations");if(e)try{const t=JSON.parse(e);for(const n of t){const i=hs.fromJSON(n);this.animations.set(i.name,i)}}catch(t){console.error("Failed to load animations:",t)}}clear(){this.animations.clear(),this.save()}}class yi{constructor(e={}){this.id=e.id||`mapping-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,this.name=e.name||"Untitled Mapping",this.mode=e.mode||"trigger",this.inputDeviceId=e.inputDeviceId||null,this.inputControlId=e.inputControlId||null,this.color=e.color||this._generateRandomColor(),this.triggerType=e.triggerType||"pressed",this.animationName=e.animationName||null,this.duration=e.duration||1e3,this.easing=e.easing||"linear",this.iterations=e.iterations||1,this.targetDeviceIds=e.targetDeviceIds||[],this.propertyName=e.propertyName||"--value",this.propertyType=e.propertyType||"percentage",this.range=e.range||[0,100],this.cssClassName=e.cssClassName||this._generateClassName()}_generateRandomColor(){const e=Math.floor(Math.random()*360),t=70+Math.floor(Math.random()*30),n=50+Math.floor(Math.random()*20);return`hsl(${e}, ${t}%, ${n}%)`}_generateClassName(){if(!this.inputDeviceId||!this.inputControlId)return`mapping-${this.id}`;const e=this.inputControlId.replace(/[^a-zA-Z0-9]/g,"_").toLowerCase(),t=this.triggerType==="pressed"?"down":this.triggerType==="not-pressed"?"up":"always";return`${e}_${t}`}updateClassName(){this.cssClassName=this._generateClassName()}toCSS(e=[]){return this.mode==="trigger"?this._generateTriggerCSS(e):""}_generateTriggerCSS(e=[]){if(!this.animationName)return"";const t=this.targetDeviceIds.map(s=>{const a=e.find(l=>l.id===s);return a?`#${a.cssId}`:null}).filter(s=>s!==null).join(", ");if(!t)return"";const n=this.iterations==="infinite"?"infinite":this.iterations,i=(this.duration/1e3).toFixed(3);return`.${this.cssClassName} ${t} {
  animation: ${this.animationName} ${i}s ${this.easing} ${n};
}`}getPropertyName(){return this.propertyName.startsWith("--")?this.propertyName:`--${this.propertyName}`}mapValue(e){const[t,n]=this.range,i=t+(n-t)*e;switch(this.propertyType){case"percentage":return`${i.toFixed(1)}%`;case"degrees":return`${i.toFixed(1)}deg`;case"number":return i.toFixed(2);default:return i.toString()}}toJSON(){return{id:this.id,name:this.name,mode:this.mode,inputDeviceId:this.inputDeviceId,inputControlId:this.inputControlId,color:this.color,triggerType:this.triggerType,animationName:this.animationName,duration:this.duration,easing:this.easing,iterations:this.iterations,targetDeviceIds:this.targetDeviceIds,propertyName:this.propertyName,propertyType:this.propertyType,range:this.range,cssClassName:this.cssClassName}}static fromJSON(e){return new yi(e)}}class Cl{constructor(){this.mappings=new Map,this.listeners=new Map,this.load()}on(e,t){this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e).add(t)}off(e,t){this.listeners.has(e)&&this.listeners.get(e).delete(t)}_emit(e,t){if(!this.listeners.has(e))return;const n=this.listeners.get(e);for(const i of n)i(t)}add(e){return this.mappings.set(e.id,e),this.save(),this._emit("changed",{type:"add",mapping:e}),e}remove(e){const t=this.mappings.get(e);this.mappings.delete(e),this.save(),this._emit("changed",{type:"remove",mapping:t,id:e})}get(e){return this.mappings.get(e)}getAll(){return Array.from(this.mappings.values())}getByInput(e,t){return this.getAll().filter(n=>n.inputDeviceId===e&&n.inputControlId===t)}getTriggerMappings(){return this.getAll().filter(e=>e.mode==="trigger")}getDirectMappings(){return this.getAll().filter(e=>e.mode==="direct")}toCSS(e=[]){return this.getTriggerMappings().map(t=>t.toCSS(e)).filter(t=>t).join(`

`)}save(){const e=this.getAll().map(t=>t.toJSON());localStorage.setItem("dmx-mappings",JSON.stringify(e))}load(){const e=localStorage.getItem("dmx-mappings");if(e)try{const t=JSON.parse(e);for(const n of t){const i=yi.fromJSON(n);this.mappings.set(i.id,i)}}catch(t){console.error("Failed to load mappings:",t)}}clear(){this.mappings.clear(),this.save()}}class El{constructor(){this.activeClasses=new Set,this.notPressedClasses=new Set,this.alwaysClasses=new Set,this.container=null}setContainer(e){this.container=e;for(const t of this.notPressedClasses)e.classList.add(t);for(const t of this.alwaysClasses)e.classList.add(t)}register(e){e.mode==="trigger"&&(e.triggerType==="not-pressed"?(this.notPressedClasses.add(e.cssClassName),this.container&&this.container.classList.add(e.cssClassName)):e.triggerType==="always"&&(this.alwaysClasses.add(e.cssClassName),this.container&&this.container.classList.add(e.cssClassName)))}unregister(e){e.mode==="trigger"&&(this.notPressedClasses.delete(e.cssClassName),this.alwaysClasses.delete(e.cssClassName),this.container&&this.container.classList.remove(e.cssClassName))}trigger(e){if(!this.container||e.mode!=="trigger")return;const t=e.cssClassName;e.triggerType==="pressed"?(this.container.classList.add(t),this.activeClasses.add(t)):e.triggerType==="not-pressed"&&this.container.classList.remove(t)}release(e){if(!this.container||e.mode!=="trigger")return;const t=e.cssClassName;e.triggerType==="pressed"?(this.container.classList.remove(t),this.activeClasses.delete(t)):e.triggerType==="not-pressed"&&this.container.classList.add(t)}addRawClass(e){this.container&&this.container.classList.add(e)}removeRawClass(e){this.container&&this.container.classList.remove(e)}clearAll(){if(this.container){for(const e of this.activeClasses)this.container.classList.remove(e);this.activeClasses.clear()}}}class cd{constructor(e,t){this.animationLibrary=e,this.mappingLibrary=t}generate(e=[]){const t=[];if(t.push("/* DMX Controller - Generated CSS */"),t.push("/* This stylesheet is auto-generated from your animations and input mappings */"),t.push(`/* You can edit this CSS and the changes will be reflected in the interface */
`),e.length>0){t.push("/* === Default Device Values === */"),t.push("/* These selectors set the default state for each device */");for(const a of e){const l=this._generateDeviceDefaults(a);l&&t.push(l)}t.push("")}const n=this.animationLibrary.toCSS();n&&(t.push("/* === Animations === */"),t.push(n),t.push(""));const i=this.mappingLibrary.toCSS(e);i&&(t.push("/* === Triggers === */"),t.push(i),t.push(""));const s=this.mappingLibrary.getDirectMappings();if(s.length>0){t.push("/* === Custom Properties (Direct Control) === */"),t.push("/* These properties are updated live via JavaScript */"),t.push(":root {");for(const a of s){const l=a.getPropertyName(),c=a.mapValue(0);t.push(`  ${l}: ${c}; /* ${a.name} */`)}t.push(`}
`)}return t.push("/* === Custom Styles === */"),t.push("/* Add your custom CSS below to override device defaults and apply animations */"),t.push(""),t.join(`
`)}_generateDeviceDefaults(e){if(!Ve[e.type]||e.isLinked&&e.isLinked())return null;const n=[],i=e.defaultValues||[];switch(e.type){case"RGB":const[s,a,l]=i;n.push(`  color: rgb(${s||0}, ${a||0}, ${l||0});`);break;case"RGBA":const[c,u,d,f]=i;n.push(`  color: rgb(${c||0}, ${u||0}, ${d||0});`),n.push(`  /* Amber channel: ${f||0} */`);break;case"RGBW":const[_,m,v,h]=i;n.push(`  color: rgb(${_||0}, ${m||0}, ${v||0});`),n.push(`  /* White channel: ${h||0} */`);break;case"DIMMER":const g=i[0]||0;n.push(`  opacity: ${(g/255).toFixed(2)};`);break;case"SMOKE":const D=i[0]||0;n.push(`  --smoke-output: ${D};`);break;case"MOVING_HEAD":const[R,E,T,P,L,j,q]=i,Ee=R!==void 0?Math.round(R/255*100-50):0,be=E!==void 0?Math.round(E/255*100-50):0;n.push(`  translate: ${Ee}% ${be}%;`),n.push(`  opacity: ${T!==void 0?(T/255).toFixed(2):"1"};`),n.push(`  color: rgb(${P||0}, ${L||0}, ${j||0});`),q!==void 0&&n.push(`  /* White channel: ${q} */`);break;default:return null}return n.length===0?null:`#${e.cssId} {
${n.join(`
`)}
}`}}class ud{constructor(){this.deviceElements=new Map,this.container=null,this.previousValues=new Map}initialize(e){this.container=e}updateDevices(e){if(this.container){for(const[t,n]of this.deviceElements)e.find(i=>i.id===t)||(n.remove(),this.deviceElements.delete(t));for(const t of e){let n=this.deviceElements.get(t.id);const i=t.cssId;n?n.id!==i&&(n.id=i):(n=document.createElement("div"),n.id=i,n.className="dmx-device",n.dataset.deviceType=t.type,this.container.appendChild(n),this.deviceElements.set(t.id,n)),n.dataset.deviceName=t.name,n.dataset.deviceType=t.type}}}sampleDevice(e){var a;const t=this.deviceElements.get(e.id);if(!t)return console.warn(`[CSSSampler] No element found for device ${e.id}`),null;t.offsetHeight;const n=window.getComputedStyle(t),i={};switch(this.previousValues.has(e.id)||console.log(`[CSSSampler] Sampling device ${e.id} (${e.name}):`,{elementId:t.id,className:t.className,parentClass:(a=t.parentElement)==null?void 0:a.className,computedColor:n.color,computedOpacity:n.opacity}),this._sampleCount||(this._sampleCount=0),this._sampleCount++,this._sampleCount%60===0&&console.log(`[CSSSampler DEBUG] Device ${e.id} computed color:`,n.color,"opacity:",n.opacity),e.type){case Ve.RGB:Object.assign(i,this._sampleRGB(n));break;case Ve.RGBA:Object.assign(i,this._sampleRGBA(n));break;case Ve.RGBW:Object.assign(i,this._sampleRGBW(n));break;case Ve.DIMMER:Object.assign(i,this._sampleDimmer(n));break;case Ve.SMOKE:Object.assign(i,this._sampleSmoke(n));break;case Ve.MOVING_HEAD:Object.assign(i,this._sampleMovingHead(n));break}const s=this.previousValues.get(e.id);if(s){let l=!1;const c={};for(const[u,d]of Object.entries(i))s[u]!==d&&(l=!0,c[u]={from:s[u],to:d});l&&console.log(`[CSSSampler] Device ${e.id} (${e.name}) values changed:`,{color:n.color,opacity:n.opacity,changes:c})}else console.log(`[CSSSampler] Initial sample for device ${e.id} (${e.name}):`,{color:n.color,opacity:n.opacity,channels:i});return this.previousValues.set(e.id,{...i}),i}sampleAll(e){const t=new Map;for(const n of e){const i=this.sampleDevice(n);i&&t.set(n.id,i)}return t}_sampleRGB(e){const t=this._parseComputedColor(e.color);return{Red:t.r,Green:t.g,Blue:t.b}}_sampleRGBA(e){const t=this._parseComputedColor(e.color);return{Red:t.r,Green:t.g,Blue:t.b,Amber:t.a*255}}_sampleRGBW(e){const t=this._parseComputedColor(e.color),n=Math.min(t.r,t.g,t.b);return{Red:t.r,Green:t.g,Blue:t.b,White:n}}_sampleDimmer(e){const t=parseFloat(e.opacity)||1;return{Intensity:Math.round(t*255)}}_sampleSmoke(e){const t=e.getPropertyValue("--smoke-output")||"0",n=parseFloat(t);return{Output:Math.round(Math.max(0,Math.min(255,n)))}}_sampleMovingHead(e){const t=this._parseComputedColor(e.color),n=parseFloat(e.opacity)||1,i=this._parseTranslate(e.translate);return{Pan:i.x,Tilt:i.y,Dimmer:Math.round(n*255),Red:t.r,Green:t.g,Blue:t.b,White:Math.min(t.r,t.g,t.b)}}_parseComputedColor(e){const t=e.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([\d.]+))?\)/);return t?{r:parseInt(t[1]),g:parseInt(t[2]),b:parseInt(t[3]),a:t[4]?parseFloat(t[4]):1}:{r:0,g:0,b:0,a:1}}_parseTranslate(e){if(!e||e==="none")return{x:127,y:127};const t=e.match(/translate\(([^,)]+)(?:,?\s+([^)]+))?\)/);if(t){const n=this._parsePercentage(t[1]),i=t[2]?this._parsePercentage(t[2]):n;return{x:Math.round(n*255/100),y:Math.round(i*255/100)}}return{x:127,y:127}}_parsePercentage(e){const t=parseFloat(e);return e.includes("%")?Math.max(0,Math.min(100,t)):Math.max(0,Math.min(100,t/255*100))}getElement(e){return this.deviceElements.get(e)}clear(){for(const e of this.deviceElements.values())e.remove();this.deviceElements.clear()}}class Il{constructor(){this.properties=new Map,this.styleElement=null}initialize(){this.styleElement=document.createElement("style"),this.styleElement.id="dmx-custom-properties",document.head.appendChild(this.styleElement),this._updateStyle()}setProperty(e,t){e.startsWith("--")||(e=`--${e}`),this.properties.set(e,t),this._updateStyle()}getProperty(e){return e.startsWith("--")||(e=`--${e}`),this.properties.get(e)}_updateStyle(){if(!this.styleElement)return;const e=Array.from(this.properties.entries()).map(([t,n])=>`  ${t}: ${n};`).join(`
`);this.styleElement.textContent=`:root {
${e}
}`}clear(){this.properties.clear(),this._updateStyle()}destroy(){this.styleElement&&(this.styleElement.remove(),this.styleElement=null),this.properties.clear()}}function dd(r){if(r.__esModule)return r;var e=r.default;if(typeof e=="function"){var t=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(n){var i=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:function(){return r[n]}})}),t}var ea={},Vs={},ta=function(r,e){return ta=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},ta(r,e)};function xl(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");ta(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Wi=function(){return Wi=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Wi.apply(this,arguments)};function kl(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t}function Ml(r,e,t,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,n);else for(var l=r.length-1;l>=0;l--)(a=r[l])&&(s=(i<3?a(s):i>3?a(e,t,s):a(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}function Pl(r,e){return function(t,n){e(t,n,r)}}function Tl(r,e,t,n,i,s){function a(D){if(D!==void 0&&typeof D!="function")throw new TypeError("Function expected");return D}for(var l=n.kind,c=l==="getter"?"get":l==="setter"?"set":"value",u=!e&&r?n.static?r:r.prototype:null,d=e||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),f,_=!1,m=t.length-1;m>=0;m--){var v={};for(var h in n)v[h]=h==="access"?{}:n[h];for(var h in n.access)v.access[h]=n.access[h];v.addInitializer=function(D){if(_)throw new TypeError("Cannot add initializers after decoration has completed");s.push(a(D||null))};var g=(0,t[m])(l==="accessor"?{get:d.get,set:d.set}:d[c],v);if(l==="accessor"){if(g===void 0)continue;if(g===null||typeof g!="object")throw new TypeError("Object expected");(f=a(g.get))&&(d.get=f),(f=a(g.set))&&(d.set=f),(f=a(g.init))&&i.unshift(f)}else(f=a(g))&&(l==="field"?i.unshift(f):d[c]=f)}u&&Object.defineProperty(u,n.name,d),_=!0}function Ll(r,e,t){for(var n=arguments.length>2,i=0;i<e.length;i++)t=n?e[i].call(r,t):e[i].call(r);return n?t:void 0}function Al(r){return typeof r=="symbol"?r:"".concat(r)}function Ol(r,e,t){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(r,"name",{configurable:!0,value:t?"".concat(t," ",e):e})}function Rl(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)}function Nl(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function l(d){try{u(n.next(d))}catch(f){a(f)}}function c(d){try{u(n.throw(d))}catch(f){a(f)}}function u(d){d.done?s(d.value):i(d.value).then(l,c)}u((n=n.apply(r,e||[])).next())})}function Fl(r,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=l(0),a.throw=l(1),a.return=l(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function l(u){return function(d){return c([u,d])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(t=0)),t;)try{if(n=1,i&&(s=u[0]&2?i.return:u[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,u[1])).done)return s;switch(i=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){t.label=u[1];break}if(u[0]===6&&t.label<s[1]){t.label=s[1],s=u;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(u);break}s[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(r,t)}catch(d){u=[6,d],i=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}var ps=Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]};function Bl(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&ps(e,r,t)}function Yi(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function wa(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),i,s=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(l){a={error:l}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(a)throw a.error}}return s}function Vl(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(wa(arguments[e]));return r}function Gl(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var n=Array(r),i=0,e=0;e<t;e++)for(var s=arguments[e],a=0,l=s.length;a<l;a++,i++)n[i]=s[a];return n}function jl(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return r.concat(s||Array.prototype.slice.call(e))}function An(r){return this instanceof An?(this.v=r,this):new An(r)}function Kl(r,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(r,e||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",a),i[Symbol.asyncIterator]=function(){return this},i;function a(m){return function(v){return Promise.resolve(v).then(m,f)}}function l(m,v){n[m]&&(i[m]=function(h){return new Promise(function(g,D){s.push([m,h,g,D])>1||c(m,h)})},v&&(i[m]=v(i[m])))}function c(m,v){try{u(n[m](v))}catch(h){_(s[0][3],h)}}function u(m){m.value instanceof An?Promise.resolve(m.value.v).then(d,f):_(s[0][2],m)}function d(m){c("next",m)}function f(m){c("throw",m)}function _(m,v){m(v),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Ul(r){var e,t;return e={},n("next"),n("throw",function(i){throw i}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(i,s){e[i]=r[i]?function(a){return(t=!t)?{value:An(r[i](a)),done:!1}:s?s(a):a}:s}}function $l(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof Yi=="function"?Yi(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(s){t[s]=r[s]&&function(a){return new Promise(function(l,c){a=r[s](a),i(l,c,a.done,a.value)})}}function i(s,a,l,c){Promise.resolve(c).then(function(u){s({value:u,done:l})},a)}}function Hl(r,e){return Object.defineProperty?Object.defineProperty(r,"raw",{value:e}):r.raw=e,r}var fd=Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e},ra=function(r){return ra=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},ra(r)};function zl(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t=ra(r),n=0;n<t.length;n++)t[n]!=="default"&&ps(e,r,t[n]);return fd(e,r),e}function ql(r){return r&&r.__esModule?r:{default:r}}function Wl(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)}function Yl(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t}function Xl(r,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof r=="function"?e===r:r.has(e)}function Jl(r,e,t){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var n,i;if(t){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=e[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=e[Symbol.dispose],t&&(i=n)}if(typeof n!="function")throw new TypeError("Object not disposable.");i&&(n=function(){try{i.call(this)}catch(s){return Promise.reject(s)}}),r.stack.push({value:e,dispose:n,async:t})}else t&&r.stack.push({async:!0});return e}var vd=typeof SuppressedError=="function"?SuppressedError:function(r,e,t){var n=new Error(t);return n.name="SuppressedError",n.error=r,n.suppressed=e,n};function Zl(r){function e(s){r.error=r.hasError?new vd(s,r.error,"An error was suppressed during disposal."):s,r.hasError=!0}var t,n=0;function i(){for(;t=r.stack.pop();)try{if(!t.async&&n===1)return n=0,r.stack.push(t),Promise.resolve().then(i);if(t.dispose){var s=t.dispose.call(t.value);if(t.async)return n|=2,Promise.resolve(s).then(i,function(a){return e(a),i()})}else n|=1}catch(a){e(a)}if(n===1)return r.hasError?Promise.reject(r.error):Promise.resolve();if(r.hasError)throw r.error}return i()}function Ql(r,e){return typeof r=="string"&&/^\.\.?\//.test(r)?r.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(t,n,i,s,a){return n?e?".jsx":".js":i&&(!s||!a)?t:i+s+"."+a.toLowerCase()+"js"}):r}const hd={__extends:xl,__assign:Wi,__rest:kl,__decorate:Ml,__param:Pl,__esDecorate:Tl,__runInitializers:Ll,__propKey:Al,__setFunctionName:Ol,__metadata:Rl,__awaiter:Nl,__generator:Fl,__createBinding:ps,__exportStar:Bl,__values:Yi,__read:wa,__spread:Vl,__spreadArrays:Gl,__spreadArray:jl,__await:An,__asyncGenerator:Kl,__asyncDelegator:Ul,__asyncValues:$l,__makeTemplateObject:Hl,__importStar:zl,__importDefault:ql,__classPrivateFieldGet:Wl,__classPrivateFieldSet:Yl,__classPrivateFieldIn:Xl,__addDisposableResource:Jl,__disposeResources:Zl,__rewriteRelativeImportExtension:Ql},pd=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:Jl,get __assign(){return Wi},__asyncDelegator:Ul,__asyncGenerator:Kl,__asyncValues:$l,__await:An,__awaiter:Nl,__classPrivateFieldGet:Wl,__classPrivateFieldIn:Xl,__classPrivateFieldSet:Yl,__createBinding:ps,__decorate:Ml,__disposeResources:Zl,__esDecorate:Tl,__exportStar:Bl,__extends:xl,__generator:Fl,__importDefault:ql,__importStar:zl,__makeTemplateObject:Hl,__metadata:Rl,__param:Pl,__propKey:Al,__read:wa,__rest:kl,__rewriteRelativeImportExtension:Ql,__runInitializers:Ll,__setFunctionName:Ol,__spread:Vl,__spreadArray:jl,__spreadArrays:Gl,__values:Yi,default:hd},Symbol.toStringTag,{value:"Module"})),gd=dd(pd);var lt={};Object.defineProperty(lt,"__esModule",{value:!0});lt.MODEL_NAMES=lt.DeviceModelId=void 0;var ut;(function(r){r.ORIGINAL="original",r.ORIGINALV2="originalv2",r.ORIGINALMK2="original-mk2",r.ORIGINALMK2SCISSOR="original-mk2-scissor",r.MINI="mini",r.XL="xl",r.PEDAL="pedal",r.PLUS="plus",r.NEO="neo",r.STUDIO="studio",r.MODULE6="6-module",r.MODULE15="15-module",r.MODULE32="32-module",r.NETWORK_DOCK="network-dock"})(ut||(lt.DeviceModelId=ut={}));lt.MODEL_NAMES={[ut.ORIGINAL]:"Stream Deck",[ut.MINI]:"Stream Deck Mini",[ut.XL]:"Stream Deck XL",[ut.ORIGINALV2]:"Stream Deck",[ut.ORIGINALMK2]:"Stream Deck MK.2",[ut.ORIGINALMK2SCISSOR]:"Stream Deck MK.2 (Scissor)",[ut.PLUS]:"Stream Deck +",[ut.PEDAL]:"Stream Deck Pedal",[ut.NEO]:"Stream Deck Neo",[ut.STUDIO]:"Stream Deck Studio",[ut.MODULE6]:"Stream Deck 6 Module",[ut.MODULE15]:"Stream Deck 15 Module",[ut.MODULE32]:"Stream Deck 32 Module",[ut.NETWORK_DOCK]:"Stream Deck Network Dock"};var ki={},Mi={},Hn={},ec={exports:{}};(function(r){var e=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function i(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function s(c,u,d,f,_){if(typeof d!="function")throw new TypeError("The listener must be a function");var m=new i(d,f||c,_),v=t?t+u:u;return c._events[v]?c._events[v].fn?c._events[v]=[c._events[v],m]:c._events[v].push(m):(c._events[v]=m,c._eventsCount++),c}function a(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],d,f;if(this._eventsCount===0)return u;for(f in d=this._events)e.call(d,f)&&u.push(t?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},l.prototype.listeners=function(u){var d=t?t+u:u,f=this._events[d];if(!f)return[];if(f.fn)return[f.fn];for(var _=0,m=f.length,v=new Array(m);_<m;_++)v[_]=f[_].fn;return v},l.prototype.listenerCount=function(u){var d=t?t+u:u,f=this._events[d];return f?f.fn?1:f.length:0},l.prototype.emit=function(u,d,f,_,m,v){var h=t?t+u:u;if(!this._events[h])return!1;var g=this._events[h],D=arguments.length,R,E;if(g.fn){switch(g.once&&this.removeListener(u,g.fn,void 0,!0),D){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,d),!0;case 3:return g.fn.call(g.context,d,f),!0;case 4:return g.fn.call(g.context,d,f,_),!0;case 5:return g.fn.call(g.context,d,f,_,m),!0;case 6:return g.fn.call(g.context,d,f,_,m,v),!0}for(E=1,R=new Array(D-1);E<D;E++)R[E-1]=arguments[E];g.fn.apply(g.context,R)}else{var T=g.length,P;for(E=0;E<T;E++)switch(g[E].once&&this.removeListener(u,g[E].fn,void 0,!0),D){case 1:g[E].fn.call(g[E].context);break;case 2:g[E].fn.call(g[E].context,d);break;case 3:g[E].fn.call(g[E].context,d,f);break;case 4:g[E].fn.call(g[E].context,d,f,_);break;default:if(!R)for(P=1,R=new Array(D-1);P<D;P++)R[P-1]=arguments[P];g[E].fn.apply(g[E].context,R)}}return!0},l.prototype.on=function(u,d,f){return s(this,u,d,f,!1)},l.prototype.once=function(u,d,f){return s(this,u,d,f,!0)},l.prototype.removeListener=function(u,d,f,_){var m=t?t+u:u;if(!this._events[m])return this;if(!d)return a(this,m),this;var v=this._events[m];if(v.fn)v.fn===d&&(!_||v.once)&&(!f||v.context===f)&&a(this,m);else{for(var h=0,g=[],D=v.length;h<D;h++)(v[h].fn!==d||_&&!v[h].once||f&&v[h].context!==f)&&g.push(v[h]);g.length?this._events[m]=g.length===1?g[0]:g:a(this,m)}return this},l.prototype.removeAllListeners=function(u){var d;return u?(d=t?t+u:u,this._events[d]&&a(this,d)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=t,l.EventEmitter=l,r.exports=l})(ec);var tc=ec.exports,Gn={};Object.defineProperty(Gn,"__esModule",{value:!0});Gn.wrapBufferToPreparedBuffer=_d;Gn.unwrapPreparedBufferToBuffer=md;function _d(r,e,t,n){let i=t;return n&&(typeof Buffer<"u"?i=t.map(s=>Buffer.from(s).toString("base64")):i=t.map(s=>btoa(String.fromCharCode(...s)))),{if_you_change_this_you_will_break_everything:"This is a encoded form of the buffer, exactly as the Stream Deck expects it. Do not touch this object, or you can crash your stream deck",modelId:r,type:e,do_not_touch:i}}function md(r,e){const t=e;if(t.modelId!==r)throw new Error("Prepared buffer is for a different model!");return t.do_not_touch.map(n=>{if(typeof n=="string")return typeof Buffer<"u"?Buffer.from(n,"base64"):new Uint8Array(atob(n).split("").map(i=>i.charCodeAt(0)));if(n instanceof Uint8Array)return n;throw new Error("Prepared buffer is not a string or Uint8Array!")})}var Xa;function Rr(){var i,s,a,l,c;if(Xa)return Hn;Xa=1,Object.defineProperty(Hn,"__esModule",{value:!0}),Hn.StreamDeckBase=void 0;const r=tc,e=Xi(),t=Gn;class n extends r.EventEmitter{constructor(f,_,m){var v;super();$e(this,"device");$e(this,"deviceProperties");K(this,i);K(this,s);K(this,a);K(this,l);K(this,c);this.device=f,this.deviceProperties=m.deviceProperties,F(this,i,m.properties),F(this,s,m.buttonsLcd),F(this,a,m.lcdSegmentDisplay),F(this,l,m.inputService),F(this,c,m.encoderLed),(v=m.events)==null||v.listen((h,...g)=>this.emit(h,...g)),this.device.on("input",h=>p(this,l).handleInput(h)),this.device.on("error",h=>{this.emit("error",h)})}get CONTROLS(){return this.deviceProperties.CONTROLS}get MODEL(){return this.deviceProperties.MODEL}get PRODUCT_NAME(){return this.deviceProperties.PRODUCT_NAME}get HAS_NFC_READER(){return this.deviceProperties.HAS_NFC_READER}checkValidKeyIndex(f,_){const m=this.deviceProperties.CONTROLS.find(v=>v.type==="button"&&v.index===f);if(!m)throw new TypeError("Expected a valid keyIndex");if(_&&m.feedbackType!==_)throw new TypeError("Expected a keyIndex with expected feedbackType")}calculateFillPanelDimensions(f){return p(this,s).calculateFillPanelDimensions(f)}async close(){return this.device.close()}async getHidDeviceInfo(){return this.device.getDeviceInfo()}async setBrightness(f){return p(this,i).setBrightness(f)}async resetToLogo(){return p(this,i).resetToLogo()}async getFirmwareVersion(){return p(this,i).getFirmwareVersion()}async getAllFirmwareVersions(){return p(this,i).getAllFirmwareVersions()}async getSerialNumber(){return p(this,i).getSerialNumber()}async sendPreparedBuffer(f){const _=(0,t.unwrapPreparedBufferToBuffer)(this.deviceProperties.MODEL,f);await this.device.sendReports(_)}async fillKeyColor(f,_,m,v){this.checkValidKeyIndex(f,null),await p(this,s).fillKeyColor(f,_,m,v)}async fillKeyBuffer(f,_,m){this.checkValidKeyIndex(f,"lcd"),await p(this,s).fillKeyBuffer(f,_,m)}async prepareFillKeyBuffer(f,_,m,v){return p(this,s).prepareFillKeyBuffer(f,_,m,v)}async fillPanelBuffer(f,_){await p(this,s).fillPanelBuffer(f,_)}async prepareFillPanelBuffer(f,_,m){return p(this,s).prepareFillPanelBuffer(f,_,m)}async clearKey(f){this.checkValidKeyIndex(f,null),await p(this,s).clearKey(f)}async clearPanel(){const f=[];f.push(p(this,s).clearPanel()),p(this,a)&&f.push(p(this,a).clearAllLcdSegments()),await Promise.all(f)}async fillLcd(...f){if(!p(this,a))throw new Error("Not supported for this model");return p(this,a).fillLcd(...f)}async fillLcdRegion(...f){if(!p(this,a))throw new Error("Not supported for this model");return p(this,a).fillLcdRegion(...f)}async prepareFillLcdRegion(...f){if(!p(this,a))throw new Error("Not supported for this model");return p(this,a).prepareFillLcdRegion(...f)}async clearLcdSegment(...f){if(!p(this,a))throw new Error("Not supported for this model");return p(this,a).clearLcdSegment(...f)}async setEncoderColor(...f){if(!p(this,c))throw new Error("Not supported for this model");return p(this,c).setEncoderColor(...f)}async setEncoderRingSingleColor(...f){if(!p(this,c))throw new Error("Not supported for this model");return p(this,c).setEncoderRingSingleColor(...f)}async setEncoderRingColors(...f){if(!p(this,c))throw new Error("Not supported for this model");return p(this,c).setEncoderRingColors(...f)}async getChildDeviceInfo(){const f=await this.device.getChildDeviceInfo();if(!f||f.vendorId!==e.VENDOR_ID)return null;const _=e.DEVICE_MODELS.find(m=>m.productIds.includes(f.productId));return _?{...f,model:_.id}:null}}return i=new WeakMap,s=new WeakMap,a=new WeakMap,l=new WeakMap,c=new WeakMap,Hn.StreamDeckBase=n,Hn}var gs={};Object.defineProperty(gs,"__esModule",{value:!0});gs.Gen1PropertiesService=void 0;var Qt;class yd{constructor(e){K(this,Qt);F(this,Qt,e)}async setBrightness(e){if(e<0||e>100)throw new RangeError("Expected brightness percentage to be between 0 and 100");const t=new Uint8Array([5,85,170,209,1,e,0,0,0,0,0,0,0,0,0,0,0]);await p(this,Qt).sendFeatureReport(t)}async resetToLogo(){const e=new Uint8Array([11,99,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);await p(this,Qt).sendFeatureReport(e)}async getFirmwareVersion(){let e;try{e=await p(this,Qt).getFeatureReport(4,32)}catch{e=await p(this,Qt).getFeatureReport(4,17)}const t=e.indexOf(0,5);return new TextDecoder("ascii").decode(e.subarray(5,t===-1?void 0:t))}async getAllFirmwareVersions(){return{}}async getSerialNumber(){let e;try{e=await p(this,Qt).getFeatureReport(3,32)}catch{e=await p(this,Qt).getFeatureReport(3,17)}return new TextDecoder("ascii").decode(e.subarray(5,17))}}Qt=new WeakMap;gs.Gen1PropertiesService=yd;var wi={};Object.defineProperty(wi,"__esModule",{value:!0});wi.DefaultButtonsLcdService=void 0;const Ja=Gn;var ai,oi,dr,dt;class wd{constructor(e,t,n,i){K(this,ai);K(this,oi);K(this,dr);K(this,dt);F(this,ai,e),F(this,oi,t),F(this,dr,n),F(this,dt,i)}getLcdButtonControls(){return p(this,dt).CONTROLS.filter(e=>e.type==="button"&&e.feedbackType==="lcd")}calculateLcdGridSpan(e){if(e.length===0)return null;const t=e.map(i=>i.row),n=e.map(i=>i.column);return{minRow:Math.min(...t),maxRow:Math.max(...t),minCol:Math.min(...n),maxCol:Math.max(...n)}}calculateDimensionsFromGridSpan(e,t,n){if(n)throw new Error("Not implemented");{const i=e.maxRow-e.minRow+1;return{width:(e.maxCol-e.minCol+1)*t.width,height:i*t.height}}}calculateFillPanelDimensions(e){const t=this.getLcdButtonControls(),n=this.calculateLcdGridSpan(t);return!n||t.length===0?null:this.calculateDimensionsFromGridSpan(n,t[0].pixelSize,e==null?void 0:e.withPadding)}async clearPanel(){const e=[];if(p(this,dt).FULLSCREEN_PANELS>0)for(let t=0;t<p(this,dt).FULLSCREEN_PANELS;t++)e.push(p(this,dr).sendFeatureReport(new Uint8Array([3,5,t,0,0,0])));else for(const t of p(this,dt).CONTROLS)if(t.type==="button")switch(t.feedbackType){case"rgb":e.push(this.sendKeyRgb(t.hidIndex,0,0,0));break;case"lcd":if(p(this,dt).SUPPORTS_RGB_KEY_FILL)e.push(this.sendKeyRgb(t.hidIndex,0,0,0));else{const n=new Uint8Array(t.pixelSize.width*t.pixelSize.height*3);e.push(this.fillImageRangeControl(t,n,{format:"rgb",offset:0,stride:t.pixelSize.width*3}))}break}await Promise.all(e)}async clearKey(e){const t=p(this,dt).CONTROLS.find(n=>n.type==="button"&&n.index===e);if(!t||t.feedbackType==="none")throw new TypeError("Expected a valid keyIndex");if(p(this,dt).SUPPORTS_RGB_KEY_FILL||t.feedbackType==="rgb")await this.sendKeyRgb(e,0,0,0);else{const n=new Uint8Array(t.pixelSize.width*t.pixelSize.height*3);await this.fillImageRangeControl(t,n,{format:"rgb",offset:0,stride:t.pixelSize.width*3})}}async fillKeyColor(e,t,n,i){this.checkRGBValue(t),this.checkRGBValue(n),this.checkRGBValue(i);const s=p(this,dt).CONTROLS.find(a=>a.type==="button"&&a.index===e);if(!s||s.feedbackType==="none")throw new TypeError("Expected a valid keyIndex");if(p(this,dt).SUPPORTS_RGB_KEY_FILL||s.feedbackType==="rgb")await this.sendKeyRgb(e,t,n,i);else{const a=s.pixelSize.width*s.pixelSize.height,l=new Uint8Array(a*4),c=new DataView(l.buffer,l.byteOffset,l.byteLength);c.setUint8(0,t),c.setUint8(1,n),c.setUint8(2,i),c.setUint8(3,255);const u=c.getUint32(0);for(let d=1;d<a;d++)c.setUint32(d*4,u);await this.fillImageRangeControl(s,l,{format:"rgba",offset:0,stride:s.pixelSize.width*4})}}async fillKeyBuffer(e,t,n){const i=await this.prepareFillKeyBufferInner(e,t,n);await p(this,dr).sendReports(i)}async prepareFillKeyBufferInner(e,t,n){const i=(n==null?void 0:n.format)??"rgb";this.checkSourceFormat(i);const s=p(this,dt).CONTROLS.find(l=>l.type==="button"&&l.index===e);if(!s||s.feedbackType==="none")throw new TypeError("Expected a valid keyIndex");if(s.feedbackType!=="lcd")throw new TypeError(`keyIndex ${s.index} does not support lcd feedback`);const a=s.pixelSize.width*s.pixelSize.height*i.length;if(t.length!==a)throw new RangeError(`Expected image buffer of length ${a}, got length ${t.length}`);return this.prepareFillImageRangeControl(s,t,{format:i,offset:0,stride:s.pixelSize.width*i.length})}async prepareFillKeyBuffer(e,t,n,i){const s=await this.prepareFillKeyBufferInner(e,t,n);return(0,Ja.wrapBufferToPreparedBuffer)(p(this,dt).MODEL,"fill-key",s,i??!1)}async fillPanelBuffer(e,t){const n=await this.prepareFillPanelBufferInner(e,t);await p(this,dr).sendReports(n)}async prepareFillPanelBufferInner(e,t){const n=(t==null?void 0:t.format)??"rgb";this.checkSourceFormat(n);const i=this.getLcdButtonControls(),s=this.calculateLcdGridSpan(i);if(!s||i.length===0)throw new Error("Panel does not support being filled");const a=this.calculateDimensionsFromGridSpan(s,i[0].pixelSize,t==null?void 0:t.withPadding),l=n.length*a.width*a.height;if(e.length!==l)throw new RangeError(`Expected image buffer of length ${l}, got length ${e.length}`);const c=a.width*n.length,u=[];for(const f of i){const _=f.row-s.minRow,m=f.column-s.minCol,v=f.pixelSize.width*n.length,h=c*_*f.pixelSize.height,g=m*v;u.push(this.prepareFillImageRangeControl(f,e,{format:n,offset:h+g,stride:c}))}return(await Promise.all(u)).flat()}async prepareFillPanelBuffer(e,t,n){const i=await this.prepareFillPanelBufferInner(e,t);return(0,Ja.wrapBufferToPreparedBuffer)(p(this,dt).MODEL,"fill-panel",i,n??!1)}async sendKeyRgb(e,t,n,i){await p(this,dr).sendFeatureReport(new Uint8Array([3,6,e,t,n,i]))}async fillImageRangeControl(e,t,n){const i=await this.prepareFillImageRangeControl(e,t,n);await p(this,dr).sendReports(i)}async prepareFillImageRangeControl(e,t,n){if(e.feedbackType!=="lcd")throw new TypeError(`keyIndex ${e.index} does not support lcd feedback`);const i=await p(this,oi).convertPixelBuffer(t,n,e.pixelSize);return p(this,ai).generateFillImageWrites({keyIndex:e.hidIndex},i)}checkRGBValue(e){if(e<0||e>255)throw new TypeError("Expected a valid color RGB value 0 - 255")}checkSourceFormat(e){switch(e){case"rgb":case"rgba":case"bgr":case"bgra":break;default:{const t=e;throw new TypeError(`Expected a known color format not "${t}"`)}}}}ai=new WeakMap,oi=new WeakMap,dr=new WeakMap,dt=new WeakMap;wi.DefaultButtonsLcdService=wd;var _s={},Dr={},Za;function Nr(){if(Za)return Dr;Za=1,Object.defineProperty(Dr,"__esModule",{value:!0}),Dr.BMP_HEADER_LENGTH=void 0,Dr.transformImageBuffer=r,Dr.writeBMPHeader=e,Dr.uint8ArrayToDataView=t;function r(n,i,s,a,l,c){const u=t(n),d=new Uint8Array(a+l*c*s.colorMode.length),f=t(d),_=i.format.substring(0,3)!==s.colorMode.substring(0,3);for(let m=0;m<c;m++){const v=a+l*s.colorMode.length*m;for(let h=0;h<l;h++){let g=s.xFlip?l-h-1:h,D=s.yFlip?c-m-1:m;if(s.rotate){const j=g;g=D,D=j}const R=D*i.stride+i.offset+g*i.format.length,E=u.getUint8(R),T=u.getUint8(R+1),P=u.getUint8(R+2),L=v+h*s.colorMode.length;_?(f.setUint8(L,P),f.setUint8(L+1,T),f.setUint8(L+2,E)):(f.setUint8(L,E),f.setUint8(L+1,T),f.setUint8(L+2,P)),s.colorMode.length===4&&f.setUint8(L+3,255)}}return d}Dr.BMP_HEADER_LENGTH=54;function e(n,i,s,a,l){const c=t(n);c.setUint8(0,66),c.setUint8(1,77),c.setUint32(2,a+54,!0),c.setInt16(6,0,!0),c.setInt16(8,0,!0),c.setUint32(10,54,!0),c.setUint32(14,40,!0),c.setInt32(18,i,!0),c.setInt32(22,s,!0),c.setInt16(26,1,!0),c.setInt16(28,24,!0),c.setInt32(30,0,!0),c.setInt32(34,a,!0),c.setInt32(38,l,!0),c.setInt32(42,l,!0),c.setInt32(46,0,!0),c.setInt32(50,0,!0)}function t(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}return Dr}Object.defineProperty(_s,"__esModule",{value:!0});_s.BitmapButtonLcdImagePacker=void 0;const Pi=Nr();var li,ci;class bd{constructor(e,t){K(this,li);K(this,ci);F(this,li,e),F(this,ci,t)}async convertPixelBuffer(e,t,n){const i=(0,Pi.transformImageBuffer)(e,t,p(this,li),Pi.BMP_HEADER_LENGTH,n.width,n.height);return(0,Pi.writeBMPHeader)(i,n.width,n.height,i.length-Pi.BMP_HEADER_LENGTH,p(this,ci)),i}}li=new WeakMap,ci=new WeakMap;_s.BitmapButtonLcdImagePacker=bd;var ln={};Object.defineProperty(ln,"__esModule",{value:!0});ln.CallbackHook=void 0;var wn;class Sd{constructor(){K(this,wn,null)}emit(e,...t){if(!p(this,wn))throw new Error("No listener setup");p(this,wn).call(this,e,...t)}listen(e){F(this,wn,e)}}wn=new WeakMap;ln.CallbackHook=Sd;var jn={};Object.defineProperty(jn,"__esModule",{value:!0});jn.ButtonOnlyInputService=void 0;var bn,Sn;class Dd{constructor(e,t){$e(this,"deviceProperties");K(this,bn);K(this,Sn);this.deviceProperties=e,F(this,Sn,t);const n=this.deviceProperties.CONTROLS.filter(i=>i.type==="button").map(i=>i.index);F(this,bn,new Array(Math.max(-1,...n)+1).fill(!1))}handleInput(e){const t=this.deviceProperties.KEY_DATA_OFFSET||0;for(const n of this.deviceProperties.CONTROLS){if(n.type!=="button")continue;const i=!!e[t+n.hidIndex];i!==p(this,bn)[n.index]&&(p(this,bn)[n.index]=i,i?p(this,Sn).emit("down",n):p(this,Sn).emit("up",n))}}}bn=new WeakMap,Sn=new WeakMap;jn.ButtonOnlyInputService=Dd;var Qa;function rc(){if(Qa)return Mi;Qa=1,Object.defineProperty(Mi,"__esModule",{value:!0}),Mi.StreamDeckGen1Factory=l;const r=Rr(),e=gs,t=wi,n=_s,i=ln,s=jn;function a(c){return{...c,KEY_DATA_OFFSET:0,HAS_NFC_READER:!1,SUPPORTS_CHILD_DEVICES:!1}}function l(c,u,d,f,_,m){const v=a(d),h=new i.CallbackHook;return new r.StreamDeckBase(c,u,{deviceProperties:v,events:h,properties:new e.Gen1PropertiesService(c),buttonsLcd:new t.DefaultButtonsLcdService(f,new n.BitmapButtonLcdImagePacker(_,m),c,v),lcdSegmentDisplay:null,inputService:new s.ButtonOnlyInputService(v,h),encoderLed:null})}return Mi}var ir={},Et={};Object.defineProperty(Et,"__esModule",{value:!0});Et.StreamdeckNeoLcdImageHeaderGenerator=Et.StreamdeckPlusLcdImageHeaderGenerator=Et.StreamdeckGen2ImageHeaderGenerator=Et.StreamdeckGen1ImageHeaderGenerator=void 0;const ms=Nr();class Cd{getFillImageCommandHeaderLength(){return 16}writeFillImageCommandHeader(e,t,n,i,s){const a=(0,ms.uint8ArrayToDataView)(e);a.setUint8(0,2),a.setUint8(1,1),a.setUint16(2,n,!0),a.setUint8(4,i?1:0),a.setUint8(5,t.keyIndex+1)}}Et.StreamdeckGen1ImageHeaderGenerator=Cd;class Ed{getFillImageCommandHeaderLength(){return 8}writeFillImageCommandHeader(e,t,n,i,s){const a=(0,ms.uint8ArrayToDataView)(e);a.setUint8(0,2),a.setUint8(1,7),a.setUint8(2,t.keyIndex),a.setUint8(3,i?1:0),a.setUint16(4,s,!0),a.setUint16(6,n++,!0)}}Et.StreamdeckGen2ImageHeaderGenerator=Ed;class Id{getFillImageCommandHeaderLength(){return 16}writeFillImageCommandHeader(e,t,n,i,s){const a=(0,ms.uint8ArrayToDataView)(e);a.setUint8(0,2),a.setUint8(1,12),a.setUint16(2,t.x,!0),a.setUint16(4,t.y,!0),a.setUint16(6,t.width,!0),a.setUint16(8,t.height,!0),a.setUint8(10,i?1:0),a.setUint16(11,n,!0),a.setUint16(13,s,!0)}}Et.StreamdeckPlusLcdImageHeaderGenerator=Id;class xd{getFillImageCommandHeaderLength(){return 8}writeFillImageCommandHeader(e,t,n,i,s){const a=(0,ms.uint8ArrayToDataView)(e);a.setUint8(0,2),a.setUint8(1,11),a.setUint8(2,0),a.setUint8(3,i?1:0),a.setUint16(4,s,!0),a.setUint16(6,n,!0)}}Et.StreamdeckNeoLcdImageHeaderGenerator=xd;Object.defineProperty(ir,"__esModule",{value:!0});ir.StreamdeckDefaultImageWriter=ir.StreamdeckOriginalImageWriter=void 0;const kd=Et;class Md{constructor(){$e(this,"headerGenerator",new kd.StreamdeckGen1ImageHeaderGenerator)}generateFillImageWrites(e,t){const i=this.headerGenerator.getFillImageCommandHeaderLength(),s=t.length/2,a=new Uint8Array(8191);this.headerGenerator.writeFillImageCommandHeader(a,e,1,!1,s),a.set(t.subarray(0,s),i);const l=new Uint8Array(8191);return this.headerGenerator.writeFillImageCommandHeader(l,e,2,!0,s),l.set(t.subarray(s),i),[a,l]}}ir.StreamdeckOriginalImageWriter=Md;class Pd{constructor(e){$e(this,"headerGenerator");this.headerGenerator=e}generateFillImageWrites(e,t){const i=this.headerGenerator.getFillImageCommandHeaderLength(),s=1024-i,a=[];let l=t.length;for(let c=0;l>0;c++){const u=new Uint8Array(1024),d=Math.min(l,s);this.headerGenerator.writeFillImageCommandHeader(u,e,c,l<=s,d);const f=t.length-l;l-=d,u.set(t.subarray(f,f+d),i),a.push(u)}return a}}ir.StreamdeckDefaultImageWriter=Pd;var Vt={};Object.defineProperty(Vt,"__esModule",{value:!0});Vt.generateButtonsGrid=Td;Vt.freezeDefinitions=Ad;function Td(r,e,t,n=!1,i=0){const s=[];for(let a=0;a<e;a++)for(let l=0;l<r;l++){const c=a*r+l,u=n?Ld(r,c):c;s.push({type:"button",row:a,column:l+i,index:c,hidIndex:u,feedbackType:"lcd",pixelSize:t})}return s}function Ld(r,e){const t=(r-1)/2,n=(e%r-t)*-t;return e+n}function Ad(r){return Object.freeze(r.map(e=>Object.freeze(e)))}var eo;function Od(){if(eo)return ki;eo=1,Object.defineProperty(ki,"__esModule",{value:!0}),ki.StreamDeckOriginalFactory=s;const r=rc(),e=lt,t=ir,n=Vt,i={MODEL:e.DeviceModelId.ORIGINAL,PRODUCT_NAME:e.MODEL_NAMES[e.DeviceModelId.ORIGINAL],SUPPORTS_RGB_KEY_FILL:!1,CONTROLS:(0,n.freezeDefinitions)((0,n.generateButtonsGrid)(5,3,{width:72,height:72},!0)),KEY_SPACING_HORIZONTAL:25,KEY_SPACING_VERTICAL:25,FULLSCREEN_PANELS:0};function s(a,l){return(0,r.StreamDeckGen1Factory)(a,l,i,new t.StreamdeckOriginalImageWriter,{colorMode:"bgr",xFlip:!0},3780)}return ki}var Ti={},to;function Rd(){if(to)return Ti;to=1,Object.defineProperty(Ti,"__esModule",{value:!0}),Ti.StreamDeck6KeyFactory=a;const r=rc(),e=lt,t=Vt,n=ir,i=Et,s={SUPPORTS_RGB_KEY_FILL:!1,CONTROLS:(0,t.freezeDefinitions)((0,t.generateButtonsGrid)(3,2,{width:80,height:80})),KEY_SPACING_HORIZONTAL:28,KEY_SPACING_VERTICAL:28,FULLSCREEN_PANELS:0};function a(l,c,u,d){const f={...s,MODEL:l,PRODUCT_NAME:e.MODEL_NAMES[l]};return(0,r.StreamDeckGen1Factory)(c,u,f,new n.StreamdeckDefaultImageWriter(new i.StreamdeckGen1ImageHeaderGenerator),{colorMode:"bgr",rotate:!0,yFlip:!0},2835)}return Ti}var Li={},cn={},bi={};Object.defineProperty(bi,"__esModule",{value:!0});bi.Gen2PropertiesService=void 0;class Nd{constructor(e){$e(this,"device");this.device=e}async setBrightness(e){if(e<0||e>100)throw new RangeError("Expected brightness percentage to be between 0 and 100");const t=new Uint8Array([3,8,e,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);await this.device.sendFeatureReport(t)}async resetToLogo(){const e=new Uint8Array([3,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);await this.device.sendFeatureReport(e)}async getFirmwareVersion(){const e=await this.device.getFeatureReport(5,32),t=e[1]+2;return new TextDecoder("ascii").decode(e.subarray(6,t))}async getAllFirmwareVersions(){return{AP2:await this.getFirmwareVersion()}}async getSerialNumber(){const e=await this.device.getFeatureReport(6,32),t=e[1]+2;return new TextDecoder("ascii").decode(e.subarray(2,t))}}bi.Gen2PropertiesService=Nd;var ys={};Object.defineProperty(ys,"__esModule",{value:!0});ys.JpegButtonLcdImagePacker=void 0;const Fd=Nr();var ui,Dn;class Bd{constructor(e,t){K(this,ui);K(this,Dn);F(this,ui,e),F(this,Dn,t)}async convertPixelBuffer(e,t,n){const i=(0,Fd.transformImageBuffer)(e,t,{colorMode:"rgba",xFlip:p(this,Dn),yFlip:p(this,Dn)},0,n.width,n.height);return p(this,ui).call(this,i,n.width,n.height)}}ui=new WeakMap,Dn=new WeakMap;ys.JpegButtonLcdImagePacker=Bd;var ws={};Object.defineProperty(ws,"__esModule",{value:!0});ws.Gen2InputService=void 0;const Vd=jn,Gd=Nr();var Ut,Xr,Cn,di,Or,nc,ic,sc;class jd extends Vd.ButtonOnlyInputService{constructor(t,n){super(t,n);K(this,Or);K(this,Ut);K(this,Xr);K(this,Cn);K(this,di);F(this,Ut,n),F(this,Xr,t.CONTROLS.filter(s=>s.type==="encoder"));const i=Math.max(-1,...p(this,Xr).map(s=>s.index));F(this,Cn,new Array(i+1).fill(!1)),F(this,di,t.CONTROLS.filter(s=>s.type==="lcd-segment"))}handleInput(t){switch(t[0]){case 0:super.handleInput(t);break;case 2:Fe(this,Or,nc).call(this,t);break;case 3:Fe(this,Or,ic).call(this,t);break;case 4:Fe(this,Or,sc).call(this,t);break}}}Ut=new WeakMap,Xr=new WeakMap,Cn=new WeakMap,di=new WeakMap,Or=new WeakSet,nc=function(t){const n=p(this,di).find(a=>a.id===0);if(!n)return;const i=(0,Gd.uint8ArrayToDataView)(t),s={x:i.getUint16(5,!0),y:i.getUint16(7,!0)};switch(t[3]){case 1:p(this,Ut).emit("lcdShortPress",n,s);break;case 2:p(this,Ut).emit("lcdLongPress",n,s);break;case 3:{const a={x:i.getUint16(9,!0),y:i.getUint16(11,!0)};p(this,Ut).emit("lcdSwipe",n,s,a);break}}},ic=function(t){switch(t[3]){case 0:for(const n of p(this,Xr)){const i=!!t[4+n.hidIndex];i!==p(this,Cn)[n.index]&&(p(this,Cn)[n.index]=i,i?p(this,Ut).emit("down",n):p(this,Ut).emit("up",n))}break;case 1:for(const n of p(this,Xr)){const s=new Int8Array(t.buffer,t.byteOffset,t.byteLength)[4+n.hidIndex];s!==0&&p(this,Ut).emit("rotate",n,s)}break}},sc=function(t){if(!this.deviceProperties.HAS_NFC_READER)return;const n=t[1]+t[2]*256,i=new TextDecoder("ascii").decode(t.subarray(3,3+n));p(this,Ut).emit("nfcRead",i)};ws.Gen2InputService=jd;var bs={};Object.defineProperty(bs,"__esModule",{value:!0});bs.EncoderLedService=void 0;var Jr,kr;class Kd{constructor(e,t){K(this,Jr);K(this,kr);F(this,Jr,e),F(this,kr,t.filter(n=>n.type==="encoder"))}async clearAll(){const e=[];for(const t of p(this,kr))t.hasLed&&e.push(this.setEncoderColor(t.index,0,0,0)),t.ledRingSteps>0&&e.push(this.setEncoderRingSingleColor(t.index,0,0,0));await Promise.all(e)}async setEncoderColor(e,t,n,i){const s=p(this,kr).find(l=>l.index===e);if(!s)throw new Error(`Invalid encoder index ${e}`);if(!s.hasLed)throw new Error("Encoder does not have an LED");const a=new Uint8Array(1024);a[0]=2,a[1]=16,a[2]=e,a[3]=t,a[4]=n,a[5]=i,await p(this,Jr).sendReports([a])}async setEncoderRingSingleColor(e,t,n,i){const s=p(this,kr).find(l=>l.index===e);if(!s)throw new Error(`Invalid encoder index ${e}`);if(s.ledRingSteps<=0)throw new Error("Encoder does not have an LED ring");const a=new Uint8Array(1024);a[0]=2,a[1]=15,a[2]=e;for(let l=0;l<s.ledRingSteps;l++){const c=3+l*3;a[c]=t,a[c+1]=n,a[c+2]=i}await p(this,Jr).sendReports([a])}async setEncoderRingColors(e,t){const n=p(this,kr).find(a=>a.index===e);if(!n)throw new Error(`Invalid encoder index ${e}`);if(n.ledRingSteps<=0)throw new Error("Encoder does not have an LED ring");if(t.length!==n.ledRingSteps*3)throw new Error("Invalid colors length");let i=t instanceof Uint8Array?t:new Uint8Array(t);if(n.lcdRingOffset){const a=i;i=new Uint8Array(a.length),i.set(a.slice(n.lcdRingOffset*3),0),i.set(a.slice(0,n.lcdRingOffset*3),n.lcdRingOffset*3)}const s=new Uint8Array(1024);s[0]=2,s[1]=15,s[2]=e,s.set(i,3),await p(this,Jr).sendReports([s])}}Jr=new WeakMap,kr=new WeakMap;bs.EncoderLedService=Kd;Object.defineProperty(cn,"__esModule",{value:!0});cn.createBaseGen2Properties=Zd;const Ud=ir,$d=Et,Hd=wi,zd=ln,qd=bi,Wd=ys,Yd=ws,Xd=bs;function Jd(r){return{...r,KEY_DATA_OFFSET:3}}function Zd(r,e,t,n,i){const s=Jd(t),a=new zd.CallbackHook;return{deviceProperties:s,events:a,properties:n??new qd.Gen2PropertiesService(r),buttonsLcd:new Hd.DefaultButtonsLcdService(new Ud.StreamdeckDefaultImageWriter(new $d.StreamdeckGen2ImageHeaderGenerator),new Wd.JpegButtonLcdImagePacker(e.encodeJPEG,!i),r,s),lcdSegmentDisplay:null,inputService:new Yd.Gen2InputService(s,a),encoderLed:new Xd.EncoderLedService(r,t.CONTROLS)}}var ro;function Qd(){if(ro)return Li;ro=1,Object.defineProperty(Li,"__esModule",{value:!0}),Li.StreamDeck32KeyFactory=s;const r=Rr(),e=cn,t=lt,n=Vt,i={SUPPORTS_RGB_KEY_FILL:!1,CONTROLS:(0,n.freezeDefinitions)((0,n.generateButtonsGrid)(8,4,{width:96,height:96})),KEY_SPACING_HORIZONTAL:32,KEY_SPACING_VERTICAL:39,FULLSCREEN_PANELS:0,HAS_NFC_READER:!1,SUPPORTS_CHILD_DEVICES:!1};function s(a,l,c,u){const d={...i,MODEL:a,PRODUCT_NAME:t.MODEL_NAMES[a]},f=(0,e.createBaseGen2Properties)(l,c,d,null);return new r.StreamDeckBase(l,c,f)}return Li}var Ai={},no;function ef(){if(no)return Ai;no=1,Object.defineProperty(Ai,"__esModule",{value:!0}),Ai.StreamDeck15KeyFactory=s;const r=Rr(),e=cn,t=lt,n=Vt,i={SUPPORTS_RGB_KEY_FILL:!1,CONTROLS:(0,n.freezeDefinitions)((0,n.generateButtonsGrid)(5,3,{width:72,height:72})),KEY_SPACING_HORIZONTAL:25,KEY_SPACING_VERTICAL:25,FULLSCREEN_PANELS:0,HAS_NFC_READER:!1,SUPPORTS_CHILD_DEVICES:!1};function s(a,l,c,u){const d={...i,MODEL:a,PRODUCT_NAME:t.MODEL_NAMES[a]},f=(0,e.createBaseGen2Properties)(l,c,d,null);return new r.StreamDeckBase(l,c,f)}return Ai}var Oi={},Ss={};Object.defineProperty(Ss,"__esModule",{value:!0});Ss.StreamDeckPlusLcdService=void 0;const tf=Et,rf=ir,nf=Nr(),sf=Gn,af=lt;var fi,Zr,fr,rs;class of{constructor(e,t,n){K(this,fi);K(this,Zr);K(this,fr);K(this,rs,new rf.StreamdeckDefaultImageWriter(new tf.StreamdeckPlusLcdImageHeaderGenerator));F(this,fi,e),F(this,Zr,t),F(this,fr,n)}async fillLcd(e,t,n){const i=p(this,fr).find(a=>a.id===e);if(!i)throw new Error(`Invalid lcd segment index ${e}`);const s=await this.prepareFillControlRegion(i,0,0,t,{format:n.format,width:i.pixelSize.width,height:i.pixelSize.height});await p(this,Zr).sendReports(s)}async fillLcdRegion(e,t,n,i,s){const a=p(this,fr).find(c=>c.id===e);if(!a)throw new Error(`Invalid lcd segment index ${e}`);const l=await this.prepareFillControlRegion(a,t,n,i,s);await p(this,Zr).sendReports(l)}async prepareFillLcdRegion(e,t,n,i,s,a){const l=p(this,fr).find(u=>u.id===e);if(!l)throw new Error(`Invalid lcd segment index ${e}`);const c=await this.prepareFillControlRegion(l,t,n,i,s);return(0,sf.wrapBufferToPreparedBuffer)(af.DeviceModelId.PLUS,"fill-lcd-region",c,a??!1)}async clearLcdSegment(e){const t=p(this,fr).find(s=>s.id===e);if(!t)throw new Error(`Invalid lcd segment index ${e}`);const n=new Uint8Array(t.pixelSize.width*t.pixelSize.height*4),i=await this.prepareFillControlRegion(t,0,0,n,{format:"rgba",width:t.pixelSize.width,height:t.pixelSize.height});await p(this,Zr).sendReports(i)}async clearAllLcdSegments(){const e=[];for(const t of p(this,fr))e.push(this.clearLcdSegment(t.id));await Promise.all(e)}async prepareFillControlRegion(e,t,n,i,s){const a=e.pixelSize;if(t<0||t+s.width>a.width)throw new TypeError("Image will not fit within the lcd segment");if(n<0||n+s.height>a.height)throw new TypeError("Image will not fit within the lcd segment");const l=s.width*s.height*s.format.length;if(i.length!==l)throw new RangeError(`Expected image buffer of length ${l}, got length ${i.length}`);const c=await this.convertFillLcdBuffer(i,s);return p(this,rs).generateFillImageWrites({...s,x:t,y:n},c)}async convertFillLcdBuffer(e,t){const n={format:t.format,offset:0,stride:t.width*t.format.length},i=(0,nf.transformImageBuffer)(e,n,{colorMode:"rgba"},0,t.width,t.height);return p(this,fi).call(this,i,t.width,t.height)}}fi=new WeakMap,Zr=new WeakMap,fr=new WeakMap,rs=new WeakMap;Ss.StreamDeckPlusLcdService=of;var io;function lf(){if(io)return Oi;io=1,Object.defineProperty(Oi,"__esModule",{value:!0}),Oi.StreamDeckPlusFactory=c;const r=Rr(),e=cn,t=lt,n=Vt,i=Ss,s=(0,n.generateButtonsGrid)(4,2,{width:120,height:120});s.push({type:"lcd-segment",row:2,column:0,columnSpan:4,rowSpan:1,id:0,pixelSize:Object.freeze({width:800,height:100}),drawRegions:!0},{type:"encoder",row:3,column:0,index:0,hidIndex:0,hasLed:!1,ledRingSteps:0},{type:"encoder",row:3,column:1,index:1,hidIndex:1,hasLed:!1,ledRingSteps:0},{type:"encoder",row:3,column:2,index:2,hidIndex:2,hasLed:!1,ledRingSteps:0},{type:"encoder",row:3,column:3,index:3,hidIndex:3,hasLed:!1,ledRingSteps:0});const a={MODEL:t.DeviceModelId.PLUS,PRODUCT_NAME:t.MODEL_NAMES[t.DeviceModelId.PLUS],SUPPORTS_RGB_KEY_FILL:!0,CONTROLS:(0,n.freezeDefinitions)(s),KEY_SPACING_HORIZONTAL:99,KEY_SPACING_VERTICAL:40,FULLSCREEN_PANELS:0,HAS_NFC_READER:!1,SUPPORTS_CHILD_DEVICES:!1},l=a.CONTROLS.filter(u=>u.type==="lcd-segment");function c(u,d){const f=(0,e.createBaseGen2Properties)(u,d,a,null,!0);return f.lcdSegmentDisplay=new i.StreamDeckPlusLcdService(d.encodeJPEG,u,l),new r.StreamDeckBase(u,d,f)}return Oi}var Ri={},Ds={};Object.defineProperty(Ds,"__esModule",{value:!0});Ds.PedalPropertiesService=void 0;var En;class cf{constructor(e){K(this,En);F(this,En,e)}async setBrightness(e){}async resetToLogo(){}async getFirmwareVersion(){const e=await p(this,En).getFeatureReport(5,32),t=e.indexOf(0,6);return new TextDecoder("ascii").decode(e.subarray(6,t===-1?void 0:t))}async getAllFirmwareVersions(){return{AP2:await this.getFirmwareVersion()}}async getSerialNumber(){const e=await p(this,En).getFeatureReport(6,32);return new TextDecoder("ascii").decode(e.subarray(2,14))}}En=new WeakMap;Ds.PedalPropertiesService=cf;var Si={};Object.defineProperty(Si,"__esModule",{value:!0});Si.FakeLcdService=void 0;class uf{calculateFillPanelDimensions(e){return null}async clearKey(e){}async clearPanel(){}async fillKeyColor(e,t,n,i){}async fillKeyBuffer(e,t,n){}async prepareFillKeyBuffer(e,t,n,i){throw new Error("Not supported")}async fillPanelBuffer(e,t){}async prepareFillPanelBuffer(e,t,n){throw new Error("Not supported")}}Si.FakeLcdService=uf;var so;function df(){if(so)return Ri;so=1,Object.defineProperty(Ri,"__esModule",{value:!0}),Ri.StreamDeckPedalFactory=u;const r=Rr(),e=lt,t=Vt,n=Ds,i=Si,s=ln,a=jn,l=[{type:"button",row:0,column:0,index:0,hidIndex:0,feedbackType:"none"},{type:"button",row:0,column:1,index:1,hidIndex:1,feedbackType:"none"},{type:"button",row:0,column:2,index:2,hidIndex:2,feedbackType:"none"}],c={MODEL:e.DeviceModelId.PEDAL,PRODUCT_NAME:e.MODEL_NAMES[e.DeviceModelId.PEDAL],KEY_DATA_OFFSET:3,SUPPORTS_RGB_KEY_FILL:!1,CONTROLS:(0,t.freezeDefinitions)(l),KEY_SPACING_HORIZONTAL:0,KEY_SPACING_VERTICAL:0,FULLSCREEN_PANELS:0,HAS_NFC_READER:!1,SUPPORTS_CHILD_DEVICES:!1};function u(d,f){const _=new s.CallbackHook;return new r.StreamDeckBase(d,f,{deviceProperties:c,events:_,properties:new n.PedalPropertiesService(d),buttonsLcd:new i.FakeLcdService,lcdSegmentDisplay:null,inputService:new a.ButtonOnlyInputService(c,_),encoderLed:null})}return Ri}var Ni={},Cs={};Object.defineProperty(Cs,"__esModule",{value:!0});Cs.StreamDeckNeoLcdService=void 0;const ff=Et,vf=ir,hf=Nr();var vi,hi,Qr,ns;class pf{constructor(e,t,n){K(this,vi);K(this,hi);K(this,Qr);K(this,ns,new vf.StreamdeckDefaultImageWriter(new ff.StreamdeckNeoLcdImageHeaderGenerator));F(this,vi,e),F(this,hi,t),F(this,Qr,n)}async fillLcdRegion(e,t,n,i,s){throw new Error("Not supported for this model")}async prepareFillLcdRegion(e,t,n,i,s,a){throw new Error("Not supported for this model")}async fillLcd(e,t,n){const i=p(this,Qr).find(c=>c.id===e);if(!i)throw new Error(`Invalid lcd segment index ${e}`);const s=i.pixelSize.width*i.pixelSize.height*n.format.length;if(t.length!==s)throw new RangeError(`Expected image buffer of length ${s}, got length ${t.length}`);const a=await this.convertFillLcdBuffer(t,i.pixelSize,n),l=p(this,ns).generateFillImageWrites(null,a);await p(this,hi).sendReports(l)}async clearLcdSegment(e){const t=p(this,Qr).find(i=>i.id===e);if(!t)throw new Error(`Invalid lcd segment index ${e}`);const n=new Uint8Array(t.pixelSize.width*t.pixelSize.height*4);await this.fillLcd(e,n,{format:"rgba"})}async clearAllLcdSegments(){const e=[];for(const t of p(this,Qr))e.push(this.clearLcdSegment(t.id));await Promise.all(e)}async convertFillLcdBuffer(e,t,n){const i={format:n.format,offset:0,stride:t.width*n.format.length},s=(0,hf.transformImageBuffer)(e,i,{colorMode:"rgba",xFlip:!0,yFlip:!0},0,t.width,t.height);return p(this,vi).call(this,s,t.width,t.height)}}vi=new WeakMap,hi=new WeakMap,Qr=new WeakMap,ns=new WeakMap;Cs.StreamDeckNeoLcdService=pf;var ao;function gf(){if(ao)return Ni;ao=1,Object.defineProperty(Ni,"__esModule",{value:!0}),Ni.StreamDeckNeoFactory=c;const r=Rr(),e=lt,t=cn,n=Vt,i=Cs,s=(0,n.generateButtonsGrid)(4,2,{width:96,height:96});s.push({type:"button",row:2,column:0,index:8,hidIndex:8,feedbackType:"rgb"},{type:"lcd-segment",row:2,column:1,columnSpan:2,rowSpan:1,id:0,pixelSize:{width:248,height:58},drawRegions:!1},{type:"button",row:2,column:3,index:9,hidIndex:9,feedbackType:"rgb"});const a={MODEL:e.DeviceModelId.NEO,PRODUCT_NAME:e.MODEL_NAMES[e.DeviceModelId.NEO],CONTROLS:(0,n.freezeDefinitions)(s),KEY_SPACING_HORIZONTAL:30,KEY_SPACING_VERTICAL:30,FULLSCREEN_PANELS:0,HAS_NFC_READER:!1,SUPPORTS_CHILD_DEVICES:!1,SUPPORTS_RGB_KEY_FILL:!0},l=a.CONTROLS.filter(u=>u.type==="lcd-segment");function c(u,d){const f=(0,t.createBaseGen2Properties)(u,d,a,null);return f.lcdSegmentDisplay=new i.StreamDeckNeoLcdService(d.encodeJPEG,u,l),new r.StreamDeckBase(u,d,f)}return Ni}var Gs={},Es={},Fi={},oo;function ba(){if(oo)return Fi;oo=1,Object.defineProperty(Fi,"__esModule",{value:!0}),Fi.parseAllFirmwareVersionsHelper=e;const r=Nr();async function e(t){const n=new TextDecoder("ascii"),i={};if(t.ap2){const s=(0,r.uint8ArrayToDataView)(t.ap2);i.AP2=n.decode(t.ap2.subarray(6,14)),i.AP2_CHECKSUM=s.getUint32(2,!1).toString(16)}if(t.encoderLd&&(t.encoderLd[0]===24||t.encoderLd[1]===24)){const s=(0,r.uint8ArrayToDataView)(t.encoderLd);i.ENCODER_LD=n.decode(t.encoderLd.subarray(2,10)),i.ENCODER_LD_CHECKSUM=s.getUint32(10,!1).toString(16)}if(t.encoderAp2&&(t.encoderAp2[0]===24||t.encoderAp2[1]===24)){const s=(0,r.uint8ArrayToDataView)(t.encoderAp2);i.ENCODER_AP2=n.decode(t.encoderAp2.subarray(2,10)),i.ENCODER_AP2_CHECKSUM=s.getUint32(10,!1).toString(16)}return i}return Fi}Object.defineProperty(Es,"__esModule",{value:!0});Es.StudioPropertiesService=void 0;const _f=ba(),mf=bi;class yf extends mf.Gen2PropertiesService{async getAllFirmwareVersions(){const[e,t,n]=await Promise.all([this.device.getFeatureReport(5,32),this.device.getFeatureReport(17,32),this.device.getFeatureReport(19,32)]);return(0,_f.parseAllFirmwareVersionsHelper)({ap2:e,encoderAp2:t,encoderLd:n})}}Es.StudioPropertiesService=yf;var lo;function wf(){return lo||(lo=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.studioProperties=void 0,r.StreamDeckStudioFactory=l;const e=Rr(),t=cn,n=lt,i=Vt,s=Es,a=[{type:"encoder",row:0,column:0,index:0,hidIndex:0,hasLed:!0,ledRingSteps:24},...(0,i.generateButtonsGrid)(16,2,{width:144,height:112},!1,1),{type:"encoder",row:0,column:17,index:1,hidIndex:1,hasLed:!0,ledRingSteps:24,lcdRingOffset:12}];r.studioProperties={MODEL:n.DeviceModelId.STUDIO,PRODUCT_NAME:n.MODEL_NAMES[n.DeviceModelId.STUDIO],SUPPORTS_RGB_KEY_FILL:!0,CONTROLS:(0,i.freezeDefinitions)(a),KEY_SPACING_HORIZONTAL:0,KEY_SPACING_VERTICAL:0,FULLSCREEN_PANELS:2,HAS_NFC_READER:!0,SUPPORTS_CHILD_DEVICES:!0};function l(c,u,d){const f=(0,t.createBaseGen2Properties)(c,u,r.studioProperties,d??new s.StudioPropertiesService(c),!0);return new e.StreamDeckBase(c,u,f)}}(Gs)),Gs}var Bi={},Is={};Object.defineProperty(Is,"__esModule",{value:!0});Is.FakeInputService=void 0;class bf{handleInput(e){}}Is.FakeInputService=bf;var xs={};Object.defineProperty(xs,"__esModule",{value:!0});xs.NetworkDockPropertiesService=void 0;const Sf=ba();var en;class Df{constructor(e){K(this,en);F(this,en,e)}async setBrightness(e){}async resetToLogo(){}async getFirmwareVersion(){const e=await p(this,en).getFeatureReport(131,-1);return new TextDecoder("ascii").decode(e.subarray(8,16))}async getAllFirmwareVersions(){const[e]=await Promise.all([p(this,en).getFeatureReport(131,-1)]);return(0,Sf.parseAllFirmwareVersionsHelper)({ap2:e.slice(2),encoderAp2:null,encoderLd:null})}async getSerialNumber(){const e=await p(this,en).getFeatureReport(132,-1),t=e[3];return new TextDecoder("ascii").decode(e.subarray(4,4+t))}}en=new WeakMap;xs.NetworkDockPropertiesService=Df;var co;function Cf(){if(co)return Bi;co=1,Object.defineProperty(Bi,"__esModule",{value:!0}),Bi.NetworkDockFactory=c;const r=Rr(),e=lt,t=Vt,n=ln,i=Si,s=Is,a=xs,l={MODEL:e.DeviceModelId.NETWORK_DOCK,PRODUCT_NAME:e.MODEL_NAMES[e.DeviceModelId.NETWORK_DOCK],KEY_DATA_OFFSET:0,SUPPORTS_RGB_KEY_FILL:!1,CONTROLS:(0,t.freezeDefinitions)([]),KEY_SPACING_HORIZONTAL:0,KEY_SPACING_VERTICAL:0,FULLSCREEN_PANELS:0,HAS_NFC_READER:!1,SUPPORTS_CHILD_DEVICES:!0};function c(u,d,f){const _=new n.CallbackHook;return new r.StreamDeckBase(u,d,{deviceProperties:l,events:_,properties:new a.NetworkDockPropertiesService(u),buttonsLcd:new i.FakeLcdService,lcdSegmentDisplay:null,inputService:new s.FakeInputService,encoderLed:null})}return Bi}var js={},uo;function Ef(){return uo||(uo=1,Object.defineProperty(js,"__esModule",{value:!0})),js}var Ks={},fo;function If(){return fo||(fo=1,Object.defineProperty(Ks,"__esModule",{value:!0})),Ks}var zn={},vo;function xf(){if(vo)return zn;vo=1,Object.defineProperty(zn,"__esModule",{value:!0}),zn.StreamDeckProxy=void 0;class r{constructor(t){$e(this,"device");this.device=t}get CONTROLS(){return this.device.CONTROLS}get MODEL(){return this.device.MODEL}get PRODUCT_NAME(){return this.device.PRODUCT_NAME}get HAS_NFC_READER(){return this.device.HAS_NFC_READER}calculateFillPanelDimensions(...t){return this.device.calculateFillPanelDimensions(...t)}async close(){return this.device.close()}async getHidDeviceInfo(...t){return this.device.getHidDeviceInfo(...t)}async sendPreparedBuffer(...t){return this.device.sendPreparedBuffer(...t)}async fillKeyColor(...t){return this.device.fillKeyColor(...t)}async fillKeyBuffer(...t){return this.device.fillKeyBuffer(...t)}async prepareFillKeyBuffer(...t){return this.device.prepareFillKeyBuffer(...t)}async fillPanelBuffer(...t){return this.device.fillPanelBuffer(...t)}async prepareFillPanelBuffer(...t){return this.device.prepareFillPanelBuffer(...t)}async clearKey(...t){return this.device.clearKey(...t)}async clearPanel(...t){return this.device.clearPanel(...t)}async setBrightness(...t){return this.device.setBrightness(...t)}async resetToLogo(...t){return this.device.resetToLogo(...t)}async getFirmwareVersion(){return this.device.getFirmwareVersion()}async getAllFirmwareVersions(){return this.device.getAllFirmwareVersions()}async getSerialNumber(){return this.device.getSerialNumber()}async fillLcd(...t){return this.device.fillLcd(...t)}async setEncoderColor(...t){return this.device.setEncoderColor(...t)}async setEncoderRingSingleColor(...t){return this.device.setEncoderRingSingleColor(...t)}async setEncoderRingColors(...t){return this.device.setEncoderRingColors(...t)}async fillLcdRegion(...t){return this.device.fillLcdRegion(...t)}async prepareFillLcdRegion(...t){return this.device.prepareFillLcdRegion(...t)}async clearLcdSegment(...t){return this.device.clearLcdSegment(...t)}async getChildDeviceInfo(...t){return this.device.getChildDeviceInfo(...t)}eventNames(){return this.device.eventNames()}listeners(t){return this.device.listeners(t)}listenerCount(t){return this.device.listenerCount(t)}emit(t,...n){return this.device.emit(t,...n)}on(t,n,i){return this.device.on(t,n,i),this}addListener(t,n,i){return this.device.addListener(t,n,i),this}once(t,n,i){return this.device.once(t,n,i),this}removeListener(t,n,i,s){return this.device.removeListener(t,n,i,s),this}off(t,n,i,s){return this.device.off(t,n,i,s),this}removeAllListeners(t){return this.device.removeAllListeners(t),this}}return zn.StreamDeckProxy=r,zn}var ho;function Xi(){return ho||(ho=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.DEVICE_MODELS=r.DEVICE_MODELS2=r.DeviceModelType=r.VENDOR_ID=r.parseAllFirmwareVersionsHelper=r.uint8ArrayToDataView=r.StreamDeckProxy=void 0;const e=gd,t=lt,n=Od(),i=Rd(),s=Qd(),a=ef(),l=lf(),c=df(),u=gf(),d=wf(),f=Cf();e.__exportStar(Ef(),r),e.__exportStar(lt,r),e.__exportStar(If(),r);var _=xf();Object.defineProperty(r,"StreamDeckProxy",{enumerable:!0,get:function(){return _.StreamDeckProxy}});var m=Nr();Object.defineProperty(r,"uint8ArrayToDataView",{enumerable:!0,get:function(){return m.uint8ArrayToDataView}});var v=ba();Object.defineProperty(r,"parseAllFirmwareVersionsHelper",{enumerable:!0,get:function(){return v.parseAllFirmwareVersionsHelper}}),r.VENDOR_ID=4057;var h;(function(g){g.STREAMDECK="streamdeck",g.PEDAL="pedal",g.NETWORK_DOCK="network-dock"})(h||(r.DeviceModelType=h={})),r.DEVICE_MODELS2={[t.DeviceModelId.ORIGINAL]:{type:h.STREAMDECK,productIds:[96],factory:n.StreamDeckOriginalFactory,hasNativeTcp:!1},[t.DeviceModelId.MINI]:{type:h.STREAMDECK,productIds:[99,144],factory:(...g)=>(0,i.StreamDeck6KeyFactory)(t.DeviceModelId.MINI,...g),hasNativeTcp:!1},[t.DeviceModelId.XL]:{type:h.STREAMDECK,productIds:[108,143],factory:(...g)=>(0,s.StreamDeck32KeyFactory)(t.DeviceModelId.XL,...g),hasNativeTcp:!1},[t.DeviceModelId.ORIGINALV2]:{type:h.STREAMDECK,productIds:[109],factory:(...g)=>(0,a.StreamDeck15KeyFactory)(t.DeviceModelId.ORIGINALV2,...g),hasNativeTcp:!1},[t.DeviceModelId.ORIGINALMK2]:{type:h.STREAMDECK,productIds:[128],factory:(...g)=>(0,a.StreamDeck15KeyFactory)(t.DeviceModelId.ORIGINALMK2,...g),hasNativeTcp:!1},[t.DeviceModelId.ORIGINALMK2SCISSOR]:{type:h.STREAMDECK,productIds:[165],factory:(...g)=>(0,a.StreamDeck15KeyFactory)(t.DeviceModelId.ORIGINALMK2SCISSOR,...g),hasNativeTcp:!1},[t.DeviceModelId.PLUS]:{type:h.STREAMDECK,productIds:[132],factory:l.StreamDeckPlusFactory,hasNativeTcp:!1},[t.DeviceModelId.PEDAL]:{type:h.PEDAL,productIds:[134],factory:c.StreamDeckPedalFactory,hasNativeTcp:!1},[t.DeviceModelId.NEO]:{type:h.STREAMDECK,productIds:[154],factory:u.StreamDeckNeoFactory,hasNativeTcp:!1},[t.DeviceModelId.STUDIO]:{type:h.STREAMDECK,productIds:[170],factory:d.StreamDeckStudioFactory,hasNativeTcp:!0},[t.DeviceModelId.MODULE6]:{type:h.STREAMDECK,productIds:[184],factory:(...g)=>(0,i.StreamDeck6KeyFactory)(t.DeviceModelId.MODULE6,...g),hasNativeTcp:!1},[t.DeviceModelId.MODULE15]:{type:h.STREAMDECK,productIds:[185],factory:(...g)=>(0,a.StreamDeck15KeyFactory)(t.DeviceModelId.MODULE15,...g),hasNativeTcp:!1},[t.DeviceModelId.MODULE32]:{type:h.STREAMDECK,productIds:[186],factory:(...g)=>(0,s.StreamDeck32KeyFactory)(t.DeviceModelId.MODULE32,...g),hasNativeTcp:!1},[t.DeviceModelId.NETWORK_DOCK]:{type:h.NETWORK_DOCK,productIds:[65535],factory:f.NetworkDockFactory,hasNativeTcp:!0}},r.DEVICE_MODELS=Object.entries(r.DEVICE_MODELS2).map(([g,D])=>{const R=g;return{id:R,productName:t.MODEL_NAMES[R],...D}})}(Vs)),Vs}var ks={},Sa={},ac={exports:{}};(function(r){var e=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function i(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function s(c,u,d,f,_){if(typeof d!="function")throw new TypeError("The listener must be a function");var m=new i(d,f||c,_),v=t?t+u:u;return c._events[v]?c._events[v].fn?c._events[v]=[c._events[v],m]:c._events[v].push(m):(c._events[v]=m,c._eventsCount++),c}function a(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],d,f;if(this._eventsCount===0)return u;for(f in d=this._events)e.call(d,f)&&u.push(t?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},l.prototype.listeners=function(u){var d=t?t+u:u,f=this._events[d];if(!f)return[];if(f.fn)return[f.fn];for(var _=0,m=f.length,v=new Array(m);_<m;_++)v[_]=f[_].fn;return v},l.prototype.listenerCount=function(u){var d=t?t+u:u,f=this._events[d];return f?f.fn?1:f.length:0},l.prototype.emit=function(u,d,f,_,m,v){var h=t?t+u:u;if(!this._events[h])return!1;var g=this._events[h],D=arguments.length,R,E;if(g.fn){switch(g.once&&this.removeListener(u,g.fn,void 0,!0),D){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,d),!0;case 3:return g.fn.call(g.context,d,f),!0;case 4:return g.fn.call(g.context,d,f,_),!0;case 5:return g.fn.call(g.context,d,f,_,m),!0;case 6:return g.fn.call(g.context,d,f,_,m,v),!0}for(E=1,R=new Array(D-1);E<D;E++)R[E-1]=arguments[E];g.fn.apply(g.context,R)}else{var T=g.length,P;for(E=0;E<T;E++)switch(g[E].once&&this.removeListener(u,g[E].fn,void 0,!0),D){case 1:g[E].fn.call(g[E].context);break;case 2:g[E].fn.call(g[E].context,d);break;case 3:g[E].fn.call(g[E].context,d,f);break;case 4:g[E].fn.call(g[E].context,d,f,_);break;default:if(!R)for(P=1,R=new Array(D-1);P<D;P++)R[P-1]=arguments[P];g[E].fn.apply(g[E].context,R)}}return!0},l.prototype.on=function(u,d,f){return s(this,u,d,f,!1)},l.prototype.once=function(u,d,f){return s(this,u,d,f,!0)},l.prototype.removeListener=function(u,d,f,_){var m=t?t+u:u;if(!this._events[m])return this;if(!d)return a(this,m),this;var v=this._events[m];if(v.fn)v.fn===d&&(!_||v.once)&&(!f||v.context===f)&&a(this,m);else{for(var h=0,g=[],D=v.length;h<D;h++)(v[h].fn!==d||_&&!v[h].once||f&&v[h].context!==f)&&g.push(v[h]);g.length?this._events[m]=g.length===1?g[0]:g:a(this,m)}return this},l.prototype.removeAllListeners=function(u){var d;return u?(d=t?t+u:u,this._events[d]&&a(this,d)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=t,l.EventEmitter=l,r.exports=l})(ac);var kf=ac.exports,Ms={exports:{}},Mf=(r,e)=>(e=e||(()=>{}),r.then(t=>new Promise(n=>{n(e())}).then(()=>t),t=>new Promise(n=>{n(e())}).then(()=>{throw t})));const Pf=Mf;class oc extends Error{constructor(e){super(e),this.name="TimeoutError"}}const lc=(r,e,t)=>new Promise((n,i)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){n(r);return}const s=setTimeout(()=>{if(typeof t=="function"){try{n(t())}catch(c){i(c)}return}const a=typeof t=="string"?t:`Promise timed out after ${e} milliseconds`,l=t instanceof Error?t:new oc(a);typeof r.cancel=="function"&&r.cancel(),i(l)},e);Pf(r.then(n,i),()=>{clearTimeout(s)})});Ms.exports=lc;Ms.exports.default=lc;Ms.exports.TimeoutError=oc;var Tf=Ms.exports,Da={},Ca={};Object.defineProperty(Ca,"__esModule",{value:!0});function Lf(r,e,t){let n=0,i=r.length;for(;i>0;){const s=i/2|0;let a=n+s;t(r[a],e)<=0?(n=++a,i-=s+1):i=s}return n}Ca.default=Lf;Object.defineProperty(Da,"__esModule",{value:!0});const Af=Ca;class Of{constructor(){this._queue=[]}enqueue(e,t){t=Object.assign({priority:0},t);const n={priority:t.priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority){this._queue.push(n);return}const i=Af.default(this._queue,n,(s,a)=>a.priority-s.priority);this._queue.splice(i,0,n)}dequeue(){const e=this._queue.shift();return e==null?void 0:e.run}filter(e){return this._queue.filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return this._queue.length}}Da.default=Of;Object.defineProperty(Sa,"__esModule",{value:!0});const Rf=kf,cc=Tf,Nf=Da,Vi=()=>{},Ff=new cc.TimeoutError;class Bf extends Rf{constructor(e){var t,n,i,s;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=Vi,this._resolveIdle=Vi,e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:Nf.default},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(n=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(s=(i=e.interval)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||e.interval===0,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=e.throwOnTimeout===!0,this._isPaused=e.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=Vi,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=Vi,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const e=Date.now();if(this._intervalId===void 0){const t=this._intervalEnd-e;if(t<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},t)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const t=this._queue.dequeue();return t?(this.emit("active"),t(),e&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,t={}){return new Promise((n,i)=>{const s=async()=>{this._pendingCount++,this._intervalCount++;try{const a=this._timeout===void 0&&t.timeout===void 0?e():cc.default(Promise.resolve(e()),t.timeout===void 0?this._timeout:t.timeout,()=>{(t.throwOnTimeout===void 0?this._throwOnTimeout:t.throwOnTimeout)&&i(Ff)});n(await a)}catch(a){i(a)}this._next()};this._queue.enqueue(s,t),this._tryToStartAnother(),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async n=>this.add(n,t)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(e=>{const t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(e=>{const t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}}Sa.default=Bf;Object.defineProperty(ks,"__esModule",{value:!0});ks.WebHIDDevice=void 0;const Vf=tc,Gf=Sa;class jf extends Vf.EventEmitter{constructor(t){super();$e(this,"device");$e(this,"reportQueue",new Gf.default({concurrency:1}));this.device=t,this.device.addEventListener("inputreport",n=>{if(n.reportId===1){const i=new Uint8Array(n.data.buffer,n.data.byteOffset,n.data.byteLength);this.emit("input",i)}})}async close(){return this.device.close()}async forget(){return this.device.forget()}async sendFeatureReport(t){return this.device.sendFeatureReport(t[0],t.subarray(1))}async getFeatureReport(t,n){const i=await this.device.receiveFeatureReport(t);return new Uint8Array(i.buffer,i.byteOffset,i.byteLength)}async sendReports(t){return this.reportQueue.add(async()=>{for(const n of t)await this.device.sendReport(n[0],n.subarray(1))})}async getDeviceInfo(){return{path:void 0,productId:this.device.productId,vendorId:this.device.vendorId}}async getChildDeviceInfo(){return null}}ks.WebHIDDevice=jf;var Ea={};Object.defineProperty(Ea,"__esModule",{value:!0});Ea.encodeJPEG=Kf;async function Kf(r,e,t){const n=await new Promise((i,s)=>{const a=document.createElement("canvas");a.width=e,a.height=t;const l=a.getContext("2d");if(l){const c=l.createImageData(e,t);c.data.set(r),l.putImageData(c,0,0),a.toBlob(u=>{u?i(u):s(new Error("No image generated"))},"image/jpeg",.9)}else s(new Error("Failed to get canvas context"))});return new Uint8Array(await n.arrayBuffer())}var ti={};Object.defineProperty(ti,"__esModule",{value:!0});ti.StreamDeckWeb=void 0;const Uf=Xi();class $f extends Uf.StreamDeckProxy{constructor(t,n){super(t);$e(this,"hid");this.hid=n}async forget(){await this.hid.forget()}async fillKeyCanvas(t,n){const i=n.getContext("2d");if(!i)throw new Error("Failed to get canvas context");const s=this.CONTROLS.find(l=>l.type==="button"&&l.index===t);if(!s||s.feedbackType==="none")throw new TypeError("Expected a valid keyIndex");if(s.feedbackType!=="lcd")throw new TypeError(`keyIndex ${s.index} does not support lcd feedback`);const a=i.getImageData(0,0,s.pixelSize.width,s.pixelSize.height);return this.device.fillKeyBuffer(t,a.data,{format:"rgba"})}async fillPanelCanvas(t){const n=t.getContext("2d");if(!n)throw new Error("Failed to get canvas context");const i=this.device.calculateFillPanelDimensions();if(!i)throw new Error("Panel does not support filling");const s=n.getImageData(0,0,i.width,i.height);return this.device.fillPanelBuffer(s.data,{format:"rgba"})}}ti.StreamDeckWeb=$f;(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.StreamDeckWeb=r.StreamDeckProxy=r.DeviceModelId=r.VENDOR_ID=void 0,r.requestStreamDecks=l,r.getStreamDecks=c,r.openDevice=u;const e=Xi(),t=ks,n=Ea,i=ti;var s=Xi();Object.defineProperty(r,"VENDOR_ID",{enumerable:!0,get:function(){return s.VENDOR_ID}}),Object.defineProperty(r,"DeviceModelId",{enumerable:!0,get:function(){return s.DeviceModelId}}),Object.defineProperty(r,"StreamDeckProxy",{enumerable:!0,get:function(){return s.StreamDeckProxy}});var a=ti;Object.defineProperty(r,"StreamDeckWeb",{enumerable:!0,get:function(){return a.StreamDeckWeb}});async function l(d){const f=await navigator.hid.requestDevice({filters:[{vendorId:e.VENDOR_ID}]});return Promise.all(f.map(async _=>u(_,d)))}async function c(d){const _=(await navigator.hid.getDevices()).filter(v=>v.vendorId===e.VENDOR_ID);return(await Promise.all(_.map(async v=>u(v,d).catch(h=>null)))).filter(v=>!!v)}async function u(d,f){const _=e.DEVICE_MODELS.find(m=>d.vendorId===e.VENDOR_ID&&m.productIds.includes(d.productId));if(!_)throw new Error("Stream Deck is of unexpected type.");await d.open();try{const m={encodeJPEG:n.encodeJPEG,...f},v=new t.WebHIDDevice(d),h=_.factory(v,m||{});return new i.StreamDeckWeb(h,v)}catch(m){throw await d.close().catch(()=>null),m}}})(ea);const Hf={VENDOR_ID:4057};function zf(r){return r.vendorId===Hf.VENDOR_ID}class qf{constructor(){this.connectedDevices=new Map,this.listeners=new Map,this.buttonStates=new Map}on(e,t){this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e).add(t)}off(e,t){this.listeners.has(e)&&this.listeners.get(e).delete(t)}_emit(e,t){if(!this.listeners.has(e))return;const n=this.listeners.get(e);for(const i of n)i(t)}async requestDevice(){if(!navigator.hid)throw new Error("WebHID not supported in this browser");try{const e=await ea.requestStreamDecks();for(const t of e)await this._setupStreamDeck(t);return e[0]||null}catch(e){throw e.name==="NotAllowedError"?new Error("Failed to open Stream Deck. Please close the Elgato Stream Deck software and try again."):e}}async autoReconnect(){if(!navigator.hid)return console.warn("WebHID not supported"),[];try{const e=await ea.getStreamDecks(),t=[];for(const n of e)try{await this._setupStreamDeck(n),t.push(n)}catch(i){console.warn("Failed to reconnect to Stream Deck:",i)}return t}catch(e){return console.error("Failed to auto-reconnect Stream Deck devices:",e),[]}}async _setupStreamDeck(e){try{const t=e.serialNumber||e.SERIAL_NUMBER||`${e.PRODUCT_NAME||"StreamDeck"}-${e.MODEL||e.PRODUCT_ID||"unknown"}`.replace(/\s+/g,"-").toLowerCase();return console.log("Stream Deck serial number:",t,"Product:",e.PRODUCT_NAME,"Model:",e.MODEL),this.buttonStates.set(t,new Map),e.on("down",n=>{let i;if(typeof n=="number"?i=n:typeof n=="object"&&n!==null?i=n.index:typeof n=="string"&&(i=parseInt(n)),typeof i!="number"||isNaN(i)){console.warn("Could not extract button index from Stream Deck event:",n);return}const s=this.buttonStates.get(t);s&&typeof i=="number"&&s.set(i,!0),this._emit("buttondown",{device:e,serialNumber:t,button:i,model:e.PRODUCT_NAME||"Stream Deck"})}),e.on("up",n=>{let i;if(typeof n=="number"?i=n:typeof n=="object"&&n!==null?i=n.index:typeof n=="string"&&(i=parseInt(n)),typeof i!="number"||isNaN(i))return;const s=this.buttonStates.get(t);s&&typeof i=="number"&&s.set(i,!1),this._emit("buttonup",{device:e,serialNumber:t,button:i,model:e.PRODUCT_NAME||"Stream Deck"})}),await e.setBrightness(100),await e.clearPanel(),this.connectedDevices.set(t,e),this._emit("connected",{device:e,serialNumber:t,model:e.PRODUCT_NAME||"Stream Deck",buttonCount:e.NUM_KEYS}),e}catch(t){throw console.error("Failed to setup Stream Deck:",t),t}}async disconnectDevice(e){const t=this.connectedDevices.get(e);t&&(await t.close(),this.connectedDevices.delete(e),this.buttonStates.delete(e),this._emit("disconnected",{serialNumber:e}))}async setButtonColor(e,t,n){const i=this.connectedDevices.get(e);if(!i)return!1;const s=i.NUM_KEYS||15;if(t<0||t>=s)return!1;try{const a=this._parseColor(n);return a?(await i.fillKeyColor(t,a.r,a.g,a.b),!0):!1}catch(a){return console.error(`Failed to set button ${t} color on ${e}:`,a),!1}}async clearButtonColor(e,t){return await this.setButtonColor(e,t,"#000000")}_parseColor(e){const t=document.createElement("div");t.style.color=e,document.body.appendChild(t);const n=window.getComputedStyle(t).color;document.body.removeChild(t);const i=n.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/);return i?{r:parseInt(i[1]),g:parseInt(i[2]),b:parseInt(i[3])}:null}getConnectedDevices(){return Array.from(this.connectedDevices.values())}async disconnectAll(){const e=Array.from(this.connectedDevices.keys());for(const t of e)await this.disconnectDevice(t)}}class Di{constructor(e,t,n){this.id=e,this.name=t,this.type=n,this.controls=new Map,this.listeners=new Map}getValue(e){const t=this.controls.get(e);return t?t.value:0}_setValue(e,t,n=0,i=1){this.controls.has(e)||this.controls.set(e,{type:"value",value:0,min:n,max:i});const s=this.controls.get(e);s.value=t,s.min=n,s.max=i,this._emit("change",{controlId:e,value:t,control:s})}_trigger(e,t=1){this._emit("trigger",{controlId:e,velocity:t})}on(e,t){this.listeners.has(e)||this.listeners.set(e,[]),this.listeners.get(e).push(t)}off(e,t){if(!this.listeners.has(e))return;const n=this.listeners.get(e),i=n.indexOf(t);i!==-1&&n.splice(i,1)}_emit(e,t){if(!this.listeners.has(e))return;const n=this.listeners.get(e);for(const i of n)i(t)}disconnect(){}getControlIds(){return Array.from(this.controls.keys())}}class Wf extends Di{constructor(e){super(e.id,e.name||"MIDI Device","midi"),this.midiInput=e,this.midiInput.onmidimessage=this._handleMIDIMessage.bind(this)}_handleMIDIMessage(e){const[t,n,i]=e.data;switch(t&240){case 144:if(i>0){const u=`note-${n}`;this._trigger(u,i/127)}else{const u=`note-${n}`;this._emit("release",{controlId:u})}break;case 128:const a=`note-${n}`;this._emit("release",{controlId:a});break;case 176:const l=`cc-${n}`;this._setValue(l,i/127,0,1);break;case 224:const c=(i<<7|n)-8192;this._setValue("pitchbend",c/8192,-1,1);break}}disconnect(){this.midiInput&&(this.midiInput.onmidimessage=null)}}class Yf extends Di{constructor(e,t={}){super(e.productId.toString(),t.name||"HID Device","hid"),this.hidDevice=e,this.config=t,this.buttonStates=new Map,this.hidDevice.oninputreport=this._handleInputReport.bind(this)}_handleInputReport(e){const{data:t,reportId:n}=e,i=new Uint8Array(t.buffer);for(let s=0;s<i.length;s++){const a=i[s];for(let l=0;l<8;l++){const c=s*8+l,u=a>>l&1,d=`button-${c}`,f=this.buttonStates.get(d)||!1;u&&!f?(this.buttonStates.set(d,!0),this._trigger(d,127)):!u&&f&&(this.buttonStates.set(d,!1),this._emit("release",{controlId:d}))}}}async sendOutput(e,t){this.hidDevice&&this.hidDevice.opened&&await this.hidDevice.sendReport(e,t)}disconnect(){this.hidDevice&&(this.hidDevice.oninputreport=null,this.hidDevice.close()),this.buttonStates.clear()}}class Xf extends Di{constructor(){super("keyboard","Keyboard","keyboard"),this.pressedKeys=new Set,this._boundKeyDown=this._handleKeyDown.bind(this),this._boundKeyUp=this._handleKeyUp.bind(this),window.addEventListener("keydown",this._boundKeyDown),window.addEventListener("keyup",this._boundKeyUp)}_handleKeyDown(e){if(e.target.matches("input, textarea"))return;const t=`key-${e.code}`;this.pressedKeys.has(e.code)||(this.pressedKeys.add(e.code),this._trigger(t),this._setValue(t,1,0,1))}_handleKeyUp(e){const t=`key-${e.code}`;this.pressedKeys.has(e.code)&&(this.pressedKeys.delete(e.code),this._emit("release",{controlId:t}),this._setValue(t,0,0,1))}disconnect(){window.removeEventListener("keydown",this._boundKeyDown),window.removeEventListener("keyup",this._boundKeyUp),this.pressedKeys.clear()}}class Jf extends Di{constructor(e="Virtual"){super(`virtual-${Date.now()}`,e,"virtual")}trigger(e,t=1){this._trigger(e,t)}setValue(e,t){this._setValue(e,t,0,1)}addButton(e,t){this.controls.set(e,{type:"button",value:0,label:t})}addKnob(e,t,n=0){this.controls.set(e,{type:"knob",value:n,label:t,min:0,max:1})}}class Zf{constructor(){$e(this,"listeners",new Map);this.devices=new Map,this.midiAccess=null,this.keyboardDevice=null,this.streamDeckManager=new qf,this._setupStreamDeckListeners()}_setupStreamDeckListeners(){this.streamDeckManager.on("connected",({device:e,model:t,serialNumber:n})=>{console.log(`Stream Deck connected: ${t}`);const i=n,s=new Di(i,t||"Stream Deck","hid");s.streamDeck=e,this.devices.set(i,s),this._emit("deviceadded",s)}),this.streamDeckManager.on("buttondown",({device:e,button:t,model:n,serialNumber:i})=>{const s=i,a=this.devices.get(s);if(a){const l=`button-${t}`;a._trigger(l,127)}}),this.streamDeckManager.on("buttonup",({serialNumber:e,button:t})=>{const n=e,i=this.devices.get(n);if(i){const s=`button-${t}`;i._emit("release",{controlId:s})}}),this.streamDeckManager.on("disconnected",({serialNumber:e})=>{console.log("Stream Deck disconnected"),this.removeDevice(e)})}async initMIDI(){if(!navigator.requestMIDIAccess)return console.warn("WebMIDI not supported"),!1;try{this.midiAccess=await navigator.requestMIDIAccess(),this.midiAccess.onstatechange=this._handleMIDIStateChange.bind(this);for(const e of this.midiAccess.inputs.values())this._addMIDIDevice(e);return!0}catch(e){return console.error("Failed to initialize MIDI:",e),!1}}_handleMIDIStateChange(e){const t=e.port;t.type==="input"&&(t.state==="connected"?this._addMIDIDevice(t):t.state==="disconnected"&&this.removeDevice(t.id))}_addMIDIDevice(e){const t=new Wf(e);this.devices.set(t.id,t),this._emit("deviceadded",t)}async requestStreamDeck(){try{return await this.streamDeckManager.requestDevice()}catch(e){throw console.error("Failed to request Stream Deck:",e),e}}async autoReconnectStreamDecks(){try{const e=await this.streamDeckManager.autoReconnect();return console.log(`Auto-reconnected ${e.length} Stream Deck(s)`),e}catch(e){return console.error("Failed to auto-reconnect Stream Decks:",e),[]}}async requestHIDDevice(e=[]){if(!navigator.hid)return console.warn("WebHID not supported"),null;try{const t=await navigator.hid.requestDevice({filters:e});for(const n of t){if(zf(n))return await this.streamDeckManager.connectDevice(n);if(!n.opened)try{await n.open()}catch(s){throw console.error("Failed to open HID device:",s),new Error(`Cannot open device. Make sure it's not being used by another application. Error: ${s.message}`)}const i=new Yf(n);return this.devices.set(i.id,i),this._emit("deviceadded",i),i}}catch(t){throw console.error("Failed to request HID device:",t),t}return null}enableKeyboard(){return this.keyboardDevice||(this.keyboardDevice=new Xf,this.devices.set(this.keyboardDevice.id,this.keyboardDevice),this._emit("deviceadded",this.keyboardDevice)),this.keyboardDevice}createVirtual(e){const t=new Jf(e);return this.devices.set(t.id,t),this._emit("deviceadded",t),t}removeDevice(e){const t=this.devices.get(e);t&&(t.disconnect(),this.devices.delete(e),this._emit("deviceremoved",t))}getDevice(e){return this.devices.get(e)}getAllDevices(){return Array.from(this.devices.values())}getInputDevices(){return this.getAllDevices()}getInputDevice(e){return this.getDevice(e)}on(e,t){this.listeners.has(e)||this.listeners.set(e,[]),this.listeners.get(e).push(t)}off(e,t){if(!this.listeners.has(e))return;const n=this.listeners.get(e),i=n.indexOf(t);i!==-1&&n.splice(i,1)}_emit(e,t){if(!this.listeners.has(e))return;const n=this.listeners.get(e);for(const i of n)i(t)}disconnectAll(){for(const e of this.devices.values())e.disconnect();this.devices.clear()}}class Qf{constructor(e,t,n){this.inputDeviceManager=new Zf,this.mappingLibrary=e||new Cl,this.customPropertyManager=t||new Il,this.triggerManager=n||new El,this.listeners=new Map,this._setupInputListeners()}async initialize(){this.customPropertyManager.initialize(),this.inputDeviceManager.on("deviceadded",e=>{this._setupDeviceListeners(e),this._emit("deviceadded",e)}),this.inputDeviceManager.on("deviceremoved",e=>{this._emit("deviceremoved",e)}),await this.inputDeviceManager.initMIDI(),await this.inputDeviceManager.autoReconnectStreamDecks(),this.inputDeviceManager.enableKeyboard()}_setupInputListeners(){}_setupDeviceListeners(e){e.on("trigger",({controlId:t,velocity:n})=>{this._handleTrigger(e.id,t,n)}),e.on("release",({controlId:t})=>{this._handleRelease(e.id,t)}),e.on("change",({controlId:t,value:n})=>{this._handleValueChange(e.id,t,n)})}_generateClassName(e,t){return`${e.replace(/[^a-zA-Z0-9]/g,"_").toLowerCase()}_${t}`}_handleTrigger(e,t,n){const i=this.mappingLibrary.getByInput(e,t);if(i.length>0){const s=this._generateClassName(t,"down");this.triggerManager.addRawClass(s);const a=this._generateClassName(t,"up");this.triggerManager.removeRawClass(a);for(const l of i)l.mode==="trigger"&&(this.triggerManager.trigger(l),this._emit("trigger",{mapping:l,velocity:n}))}}_handleRelease(e,t){const n=this.mappingLibrary.getByInput(e,t);if(n.length>0){const i=this._generateClassName(t,"down");this.triggerManager.removeRawClass(i);const s=this._generateClassName(t,"up");this.triggerManager.addRawClass(s);for(const a of n)a.mode==="trigger"&&a.triggerType!=="always"&&(this.triggerManager.release(a),this._emit("release",{mapping:a}))}}_handleValueChange(e,t,n){const i=this.mappingLibrary.getByInput(e,t);for(const s of i)if(s.mode==="direct"){const a=s.getPropertyName(),l=s.mapValue(n);this.customPropertyManager.setProperty(a,l),this._emit("valuechange",{mapping:s,value:n,propertyValue:l})}}async requestStreamDeck(){return await this.inputDeviceManager.requestStreamDeck()}async requestHIDDevice(e=[]){return await this.inputDeviceManager.requestHIDDevice(e)}getInputDevices(){return this.inputDeviceManager.getAllDevices()}getInputDevice(e){return this.inputDeviceManager.getDevice(e)}createVirtualDevice(e){return this.inputDeviceManager.createVirtual(e)}setTriggerContainer(e){this.triggerManager.setContainer(e)}on(e,t){this.listeners.has(e)||this.listeners.set(e,[]),this.listeners.get(e).push(t)}off(e,t){if(!this.listeners.has(e))return;const n=this.listeners.get(e),i=n.indexOf(t);i!==-1&&n.splice(i,1)}_emit(e,t){if(!this.listeners.has(e))return;const n=this.listeners.get(e);for(const i of n)i(t)}destroy(){this.inputDeviceManager.disconnectAll(),this.customPropertyManager.destroy(),this.triggerManager.clearAll(),this.listeners.clear()}}Zc();var ev=dl("<title> </title>"),tv=dl("<svg><!><!></svg>");function _t(r,e){const t=Ya(e,["children","$$slots","$$events","$$legacy"]),n=Ya(t,["data","viewBox","size","width","height","color","stroke","fill","title"]);yt(e,!1);const i=Go();let s=fe(e,"data",8,""),a=fe(e,"viewBox",24,()=>v(s())),l=fe(e,"size",8,"20px"),c=fe(e,"width",24,l),u=fe(e,"height",24,l),d=fe(e,"color",8,"currentColor"),f=fe(e,"stroke",24,d),_=fe(e,"fill",24,d),m=fe(e,"title",8,"");function v(E){const P=/viewBox="([\d\- \.]+)"/.exec(E);return P?P[1]:"0 0 20 20"}yu(()=>ll(s()),()=>{S(i,s().replace(/<svg[ \n]([^>]*)>/,"").replace("</svg>",""))}),wu(),Ju();var h=tv();qu(h,()=>({xmlns:"http://www.w3.org/2000/svg",width:c(),height:u(),viewBox:a(),stroke:f(),fill:_(),...n}));var g=w(h);{var D=E=>{var T=ev(),P=w(T);re(()=>te(P,m())),M(E,T)};Le(g,E=>{m()&&E(D)})}var R=b(g);pl(R,()=>o(i),!0),M(r,h),wt()}const rv=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30">
    <path fill="#2196f3" d="M 17 2 A 1 1 0 0 0 16.123047 2.5214844 L 8.1738281 15.433594 L 8.1738281 15.435547 A 1 1 0 0 0 8 16 A 1 1 0 0 0 9 17 L 14.5 17 L 13.019531 26.800781 A 1 1 0 0 0 13 27 A 1 1 0 0 0 14 28 A 1 1 0 0 0 14.882812 27.466797 L 14.884766 27.466797 L 22.806641 14.589844 L 22.796875 14.572266 C 22.915239 14.407976 23 14.217804 23 14 C 23 13.448 22.552 13 22 13 L 16.5 13 L 17.955078 3.2949219 A 1 1 0 0 0 18 3 A 1 1 0 0 0 17 2 z"></path>
</svg>
`,uc=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48">
    <path fill="#9C27B0" d="M21 4H26.001V43H21z" transform="rotate(45.001 23.5 23.5)"></path>
    <path fill="#9C27B0" d="M21 4H26.001V43H21z" transform="rotate(134.999 23.5 23.5)"></path>
</svg>
`;var nv=G('<button id="start" class="svelte-4b3o1e"><!> Connect DMX controller</button>'),iv=G('<button id="stop" class="svelte-4b3o1e"><!> Disconnect</button>'),sv=G('<header class="svelte-4b3o1e"><!></header>');function av(r,e){var t=sv(),n=w(t);{var i=a=>{var l=nv();l.__click=function(...u){var d;(d=e.onconnect)==null||d.apply(this,u)};var c=w(l);_t(c,{get data(){return rv}}),M(a,l)},s=a=>{var l=iv();l.__click=function(...u){var d;(d=e.ondisconnect)==null||d.apply(this,u)};var c=w(l);_t(c,{get data(){return uc}}),M(a,l)};Le(n,a=>{e.connected?a(s,!1):a(i)})}M(r,t)}bt(["click"]);const ov='<svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 48 48" width="48px" height="48px"><path fill="#3F51B5" d="M17.8 18.1L10.4 25.4 6.2 21.3 4 23.5 10.4 29.9 20 20.3zM17.8 5.1L10.4 12.4 6.2 8.3 4 10.5 10.4 16.9 20 7.3zM17.8 31.1L10.4 38.4 6.2 34.3 4 36.5 10.4 42.9 20 33.3z"/><g><path fill="#90CAF9" d="M24 22H44V26H24zM24 9H44V13H24zM24 35H44V39H24z"/></g></svg>',lv='<svg xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 48 48" width="48px" height="48px" baseProfile="basic"><path fill="#64b5f6" d="M24,44C12.972,44,4,35.028,4,24S12.972,4,24,4s20,8.972,20,20S35.028,44,24,44z M24,6	C14.075,6,6,14.075,6,24s8.075,18,18,18s18-8.075,18-18S33.925,6,24,6z"/><path fill="#64b5f6" d="M24,37c-7.168,0-13-5.832-13-13s5.832-13,13-13s13,5.832,13,13S31.168,37,24,37z M24,13	c-6.065,0-11,4.935-11,11s4.935,11,11,11s11-4.935,11-11S30.065,13,24,13z"/><path fill="#64b5f6" d="M24,31c-3.86,0-7-3.14-7-7s3.14-7,7-7s7,3.14,7,7S27.86,31,24,31z M24,19c-2.757,0-5,2.243-5,5	s2.243,5,5,5s5-2.243,5-5S26.757,19,24,19z"/><circle cx="40" cy="14" r="2" fill="#0d47a1"/><circle cx="12" cy="39" r="3" fill="#5e35b1"/><circle cx="33" cy="32" r="3" fill="#0d47a1"/><circle cx="14" cy="8" r="2" fill="#5e35b1"/><circle cx="12" cy="25" r="2" fill="#0d47a1"/><circle cx="24" cy="24" r="3.094" fill="#ffe082"/></svg>',cv=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48">
  <path fill="#90a4ae" d="M6 6H42V8H6zM6 40H42V42H6z"></path>
  <path fill="#00bcd4" d="M11 24h6v14h-6V24zM21 17h6v14h-6V17zM31 10h6v14h-6V10z"></path>
</svg>
`,uv=`<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="48" height="48" viewBox="0 0 48 48">
<path fill="none" stroke="#02abc0" stroke-miterlimit="10" stroke-width="4" d="M8 21L8 10 19 10"></path><path fill="none" stroke="#02abc0" stroke-miterlimit="10" stroke-width="4" d="M8,10c5.763,6.146,13,15,20,15 c8.505,0,13-6.102,13-9.748C41,11.932,39.013,9,35.007,9C28.52,9,23.02,16.775,23.346,23.808C23.769,33.967,31.596,41,40,41"></path>
</svg>`,dv=`<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="48" height="48" viewBox="0 0 48 48">
<path fill="#2196F3" d="M11 5A7 7 0 1 0 11 19A7 7 0 1 0 11 5Z"></path><path fill="#FFA726" d="M23.082 28.861c.713 1.412 2.483 1.967 3.934 1.232 1.454-.734 2.059-2.488 1.346-3.899l-3.186-6.319c-.712-1.41-2.482-1.966-3.934-1.23-1.453.733-2.059 2.486-1.347 3.898L23.082 28.861zM28.39 26.234c.713 1.41 2.483 1.967 3.937 1.232 1.453-.733 2.057-2.488 1.344-3.9l-3.186-6.318c-.713-1.41-2.48-1.967-3.934-1.231-1.453.732-2.059 2.485-1.348 3.898L28.39 26.234zM33.7 23.607c.712 1.413 2.481 1.966 3.935 1.234 1.452-.734 2.058-2.49 1.344-3.9l-3.187-6.32c-.712-1.412-2.479-1.965-3.933-1.232-1.453.734-2.059 2.489-1.348 3.9L33.7 23.607zM40.215 23.421c-.307-.608.047.093.381.755C40.752 24.488 40.496 23.978 40.215 23.421z"></path><path fill="#FFA726" d="M20.815,22.174c-0.486,0.246-1.081,0.053-1.324-0.436l-5.78-11.459c-0.493-0.976-2.209-2.19-3.969-1.301c-1.76,0.89-1.757,3.085-1.313,3.967c0.243,0.482,3.405,6.754,6.226,12.342c2.339,4.635,4.438,8.803,4.438,8.803l-5.523-1.625c-1.83-0.603-3.687,0.198-4.15,2.302c-0.465,1.767,0.762,3.524,2.392,4.056l7.5,2.462c3.865,1.269,7.878,0.809,11.523-1.04l0.545-0.275l0.762-0.305l4.807-2.43l1.27-0.785c3.546-2.574,4.857-7.359,2.819-11.397c0,0-0.216-0.43-0.44-0.876c-0.175-0.344-0.857-1.696-2.6-5.153L20.815,22.174z"></path><g><path fill="#FFCDD2" d="M9.359 12.6c-.511-1.038-.135-2.27.846-2.751.976-.479 2.186-.024 2.692 1.011C13.409 11.898 9.869 13.635 9.359 12.6M11.882 37.605c-1.178-.316-1.874-1.527-1.561-2.707.319-1.178 1.531-1.875 2.707-1.559C14.207 33.657 13.061 37.924 11.882 37.605"></path></g>
</svg>`,fv=`<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="48" height="48" viewBox="0 0 48 48">
<path fill="#FFC107" d="M33 22L23.6 22 30 5 19 5 13 26 21.6 26 17 45z"></path>
</svg>`,vv=`<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="48" height="48" viewBox="0 0 48 48">
<path fill="#3F51B5" d="M36 34L33 31.5 39.8 24 33 16.5 36 14 45 24zM13 34L4 24 13 14 16 16.5 9.1 24 16 31.5z"></path><path fill="#2196F3" d="M21 39L17.2 37.7 27 9 30.8 10.3z"></path>
</svg>`;var hv=G('<option class="svelte-1f8dwwb"> </option>'),pv=G('<div class="add-device svelte-1f8dwwb"><select class="svelte-1f8dwwb"></select> <button class="svelte-1f8dwwb">Add Device</button></div>'),gv=G('<div class="clear-universe svelte-1f8dwwb"><button class="svelte-1f8dwwb">Clear</button></div>'),_v=G('<div class="tabs-container svelte-1f8dwwb"><nav class="svelte-1f8dwwb"><label class="svelte-1f8dwwb"><input type="radio" name="view" class="svelte-1f8dwwb"/> <!> Devices</label> <label class="svelte-1f8dwwb"><input type="radio" name="view" class="svelte-1f8dwwb"/> <!> Timeline</label> <label class="svelte-1f8dwwb"><input type="radio" name="view" class="svelte-1f8dwwb"/> <!> Animations</label> <label class="svelte-1f8dwwb"><input type="radio" name="view" class="svelte-1f8dwwb"/> <!> Inputs</label> <label class="svelte-1f8dwwb"><input type="radio" name="view" class="svelte-1f8dwwb"/> <!> Triggers</label> <label class="svelte-1f8dwwb"><input type="radio" name="view" class="svelte-1f8dwwb"/> <!> CSS</label> <label class="svelte-1f8dwwb"><input type="radio" name="view" class="svelte-1f8dwwb"/> <!> Universe</label></nav> <!> <!></div>');function mv(r,e){yt(e,!0);const t=[];let n=fe(e,"view",15),i=fe(e,"showAddDevice",3,!1),s=fe(e,"deviceTypes",3,null),a=fe(e,"selectedType",15),l=fe(e,"onAddDevice",3,null),c=fe(e,"onClearUniverse",3,null);var u=_v(),d=w(u),f=w(d),_=w(f);_.value=_.__value="devices";var m=b(_,2);_t(m,{get data(){return ov}});var v=b(f,2),h=w(v);h.value=h.__value="timeline";var g=b(h,2);_t(g,{get data(){return cv}});var D=b(v,2),R=w(D);R.value=R.__value="animations";var E=b(R,2);_t(E,{get data(){return uv}});var T=b(D,2),P=w(T);P.value=P.__value="inputs";var L=b(P,2);_t(L,{get data(){return dv}});var j=b(T,2),q=w(j);q.value=q.__value="triggers";var Ee=b(q,2);_t(Ee,{get data(){return fv}});var be=b(j,2),me=w(be);me.value=me.__value="css";var ie=b(me,2);_t(ie,{get data(){return vv}});var Se=b(be,2),he=w(Se);he.value=he.__value="universe";var ue=b(he,2);_t(ue,{get data(){return lv}});var De=b(d,2);{var Re=k=>{var Y=pv(),z=w(Y);Be(z,21,()=>Object.entries(s()),Xe,(y,C)=>{var O=We(()=>bo(o(C),2));let U=()=>o(O)[0],$=()=>o(O)[1];var se=hv(),He=w(se),B={};re(()=>{te(He,$().name),B!==(B=U())&&(se.value=(se.__value=U())??"")}),M(y,se)});var A=b(z,2);A.__click=function(...y){var C;(C=l())==null||C.apply(this,y)},vr(z,a),M(k,Y)};Le(De,k=>{i()&&n()==="devices"&&k(Re)})}var ke=b(De,2);{var x=k=>{var Y=gv(),z=w(Y);z.__click=function(...A){var y;(y=c())==null||y.apply(this,A)},M(k,Y)};Le(ke,k=>{n()==="universe"&&c()&&k(x)})}Kr(t,[],_,n,n),Kr(t,[],h,n,n),Kr(t,[],R,n,n),Kr(t,[],P,n,n),Kr(t,[],q,n,n),Kr(t,[],me,n,n),Kr(t,[],he,n,n),M(r,u),wt()}bt(["click"]);var yv=G('<div class="channel svelte-134r4z3"><label class="svelte-134r4z3"></label> <input type="number" min="0" max="255" class="svelte-134r4z3"/></div>'),wv=G('<div class="universe-container svelte-134r4z3"><div class="channels-grid svelte-134r4z3"></div></div>');function bv(r,e){yt(e,!0);let t=V(we(new Array(512).fill(0))),n;function i(){e.dmxController&&S(t,Array.from(e.dmxController.getUniverse()),!0)}Vn(()=>{n=setInterval(i,100)}),vs(()=>{n&&clearInterval(n)});function s(c,u){const d=parseInt(u.target.value)||0;e.dmxController&&e.dmxController.setChannel(c,d),o(t)[c]=d}var a=wv(),l=w(a);Be(l,21,()=>o(t),Xe,(c,u,d)=>{var f=yv(),_=w(f);Ht(_,"for",`ch-${d}`),_.textContent=d+1;var m=b(_,2);Ht(m,"id",`ch-${d}`),m.__change=v=>s(d,v),re(()=>Wn(m,o(u))),M(c,f)}),M(r,a),wt()}bt(["change"]);const po={RGB:{0:"Red",1:"Green",2:"Blue"},RGBA:{0:"Red",1:"Green",2:"Blue",3:"Amber"},RGBW:{0:"Red",1:"Green",2:"Blue",3:"White"},DIMMER:{0:"Dimmer"},SMOKE:{0:"Output"},MOVING_HEAD:{0:"Pan",1:"Tilt",2:"Dimmer",3:"Red",4:"Green",5:"Blue",6:"White"}};function Ia(r,e){const t=po[r],n=po[e];if(!t||!n)return{};const i={};for(const[s,a]of Object.entries(t))for(const[l,c]of Object.entries(n))if(a===c){i[parseInt(s)]=parseInt(l);break}return i}function Sv(r,e){const t=Ia(r,e);return Object.keys(t).length>0}function go(r,e,t,n){const i=Ia(r,e),s=[...n];for(const[a,l]of Object.entries(i))s[l]=t[a];return s}function na(r,e){const t=Ia(r,e);return Object.values(t)}var Dv=G('<div class="xy-pad svelte-wbxrfb" role="slider" aria-label="Pan and Tilt Control" tabindex="0"><div class="grid-line vertical svelte-wbxrfb" style="left: 25%"></div> <div class="grid-line vertical svelte-wbxrfb" style="left: 50%"></div> <div class="grid-line vertical svelte-wbxrfb" style="left: 75%"></div> <div class="grid-line horizontal svelte-wbxrfb" style="top: 25%"></div> <div class="grid-line horizontal svelte-wbxrfb" style="top: 50%"></div> <div class="grid-line horizontal svelte-wbxrfb" style="top: 75%"></div> <div></div></div>');function Cv(r,e){yt(e,!0);let t=fe(e,"panValue",15,127),n=fe(e,"tiltValue",15,127),i=fe(e,"onUpdate",3,null),s=V(null),a=V(!1);function l(h,g){if(!o(s))return;const D=o(s).getBoundingClientRect();let R=(h-D.left)/D.width,E=(g-D.top)/D.height;R=Math.max(0,Math.min(1,R)),E=Math.max(0,Math.min(1,E)),t(Math.round(R*255)),n(Math.round((1-E)*255)),i()&&i()(t(),n())}function c(h){S(a,!0),l(h.clientX,h.clientY),h.preventDefault()}function u(h){o(a)&&l(h.clientX,h.clientY)}rr(()=>{const h=()=>{S(a,!1)};return window.addEventListener("mouseup",h),()=>window.removeEventListener("mouseup",h)});let d=We(()=>t()/255*100),f=We(()=>(1-n()/255)*100);var _=Dv();_.__mousedown=c,_.__mousemove=u;var m=b(w(_),12);let v;nr(_,h=>S(s,h),()=>o(s)),re(()=>{v=it(m,1,"crosshair svelte-wbxrfb",null,v,{active:o(a)}),Ze(m,`left: ${o(d)??""}%; top: ${o(f)??""}%`)}),M(r,_),wt()}bt(["mousedown","mousemove"]);var Ev=G('<div class="control-xypad svelte-15qavlb"><label class="svelte-15qavlb"> </label> <div><!></div> <div class="xypad-inputs svelte-15qavlb"><input type="text" class="value-input svelte-15qavlb" title="Pan" maxlength="3"/> <input type="text" class="value-input svelte-15qavlb" title="Tilt" maxlength="3"/></div></div>'),Iv=G('<div class="control svelte-15qavlb"><label class="svelte-15qavlb"> </label> <div class="slider-wrapper svelte-15qavlb"><input type="range" min="0" max="255" class="color-slider svelte-15qavlb"/></div> <input type="text" class="value-input svelte-15qavlb" maxlength="3"/></div>'),xv=G('<div class="device-controls svelte-15qavlb"></div>');function xa(r,e){yt(e,!0);let t=fe(e,"values",31,()=>we([])),n=fe(e,"onChange",3,null),i=fe(e,"disabledChannels",19,()=>[]);function s(v,h){t(t()[v]=h,!0),n()&&n()(v,h)}function a(v,h,g,D){t(t()[v]=g,!0),t(t()[h]=D,!0),n()&&(n()(v,g),n()(h,D))}function l(v,h,g){const D=parseInt(h);!isNaN(D)&&D>=0&&D<=255?s(v,D):h===""?g.target.value="":g.target.value=t()[v]}function c(v){v.target.value=v.target.value.replace(/[^0-9]/g,"")}function u(v){return i().includes(v)}function d(v){const h=Ve[e.deviceType].controls;let g=0;for(let D=0;D<v;D++)h[D].type==="xypad"?g+=2:g+=1;return g}function f(v){switch(v){case"Red":return"linear-gradient(to right, rgb(0,0,0) 0%, rgb(255,0,0) 100%)";case"Green":return"linear-gradient(to right, rgb(0,0,0) 0%, rgb(0,255,0) 100%)";case"Blue":return"linear-gradient(to right, rgb(0,0,0) 0%, rgb(0,0,255) 100%)";case"Amber":return"linear-gradient(to right, rgb(0,0,0) 0%, rgb(255,191,0) 100%)";case"White":return"linear-gradient(to right, rgb(0,0,0) 0%, rgb(255,255,255) 100%)";case"Dimmer":case"Intensity":return"linear-gradient(to right, rgb(0,0,0) 0%, rgb(255,255,255) 100%)";case"Output":return"linear-gradient(to right, rgb(0,0,0) 0%, rgb(200,200,200) 100%)";default:return"linear-gradient(to right, rgb(0,0,0) 0%, rgb(128,128,128) 100%)"}}function _(v,h){switch(v){case"Red":return`rgb(${h}, 0, 0)`;case"Green":return`rgb(0, ${h}, 0)`;case"Blue":return`rgb(0, 0, ${h})`;case"Amber":return`rgb(${h}, ${Math.round(h*.749)}, 0)`;case"White":return`rgb(${h}, ${h}, ${h})`;case"Dimmer":case"Intensity":return`rgb(${h}, ${h}, ${h})`;case"Output":return`rgb(${Math.round(h*.784)}, ${Math.round(h*.784)}, ${Math.round(h*.784)})`;default:return`rgb(${Math.round(h*.5)}, ${Math.round(h*.5)}, ${Math.round(h*.5)})`}}var m=xv();Be(m,21,()=>Ve[e.deviceType].controls,Xe,(v,h,g)=>{var D=Tn(),R=st(D);{var E=P=>{const L=We(()=>u(o(h).panIndex)),j=We(()=>u(o(h).tiltIndex)),q=We(()=>o(L)&&o(j));var Ee=Ev(),be=w(Ee),me=w(be),ie=b(be,2);let Se;var he=w(ie);Cv(he,{onUpdate:(ke,x)=>!o(q)&&a(o(h).panIndex,o(h).tiltIndex,ke,x),get panValue(){return t()[o(h).panIndex]},set panValue(ke){t(t()[o(h).panIndex]=ke,!0)},get tiltValue(){return t()[o(h).tiltIndex]},set tiltValue(ke){t(t()[o(h).tiltIndex]=ke,!0)}});var ue=b(ie,2),De=w(ue);De.__input=c,De.__change=ke=>!o(L)&&l(o(h).panIndex,ke.target.value,ke);var Re=b(De,2);Re.__input=c,Re.__change=ke=>!o(j)&&l(o(h).tiltIndex,ke.target.value,ke),re(()=>{te(me,o(h).name),Se=it(ie,1,"xypad-wrapper svelte-15qavlb",null,Se,{disabled:o(q)}),Wn(De,t()[o(h).panIndex]),De.disabled=o(L),Wn(Re,t()[o(h).tiltIndex]),Re.disabled=o(j)}),M(P,Ee)},T=P=>{const L=We(()=>d(g)),j=We(()=>u(o(L)));var q=Iv(),Ee=w(q),be=w(Ee),me=b(Ee,2),ie=w(me);ie.__input=he=>!o(j)&&s(o(L),parseInt(he.target.value));var Se=b(me,2);Se.__input=c,Se.__change=he=>!o(j)&&l(o(L),he.target.value,he),re((he,ue)=>{te(be,o(h).name),Wn(ie,t()[o(L)]),Ze(ie,`--slider-gradient: ${he??""}; --thumb-color: ${ue??""}`),ie.disabled=o(j),Wn(Se,t()[o(L)]),Se.disabled=o(j)},[()=>f(o(h).name),()=>_(o(h).name,t()[o(L)])]),M(P,q)};Le(R,P=>{o(h).type==="xypad"?P(E):P(T,!1)})}M(v,D)}),M(r,m),wt()}bt(["input","change"]);const kv=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
  <path d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"/>
</svg>
`,Mv=`<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="48" height="48" viewBox="0 0 48 48">
<path fill="#1976D2" d="M38 14h-3c-5.514 0-10 4.486-10 10s4.486 10 10 10h3c5.514 0 10-4.486 10-10S43.514 14 38 14M38 30h-3c-3.309 0-6-2.691-6-6s2.691-6 6-6h3c3.309 0 6 2.691 6 6S41.309 30 38 30M13 14h-3C4.486 14 0 18.486 0 24s4.486 10 10 10h3c5.514 0 10-4.486 10-10S18.514 14 13 14M13 30h-3c-3.309 0-6-2.691-6-6s2.691-6 6-6h3c3.309 0 6 2.691 6 6S16.309 30 13 30"></path><path fill="#42A5F5" d="M33,22H15c-1.104,0-2,0.896-2,2s0.896,2,2,2h18c1.104,0,2-0.896,2-2S34.104,22,33,22"></path>
</svg>`;var Pv=G('<div class="empty-state svelte-25wvt7"><p>No devices added yet. Add a device to get started!</p></div>'),Tv=G('<div class="device-card svelte-25wvt7"><div class="device-header svelte-25wvt7"><div class="color-preview svelte-25wvt7"></div> <h3 class="svelte-25wvt7"> </h3> <!> <button class="settings-btn svelte-25wvt7" title="Device settings"><!></button> <button class="remove-btn svelte-25wvt7"><!></button></div> <!></div>'),Lv=G("<option> </option>"),Av=G(`<select id="link-select" class="svelte-25wvt7"><option>None</option><!></select> <small class="link-help svelte-25wvt7">Link this device to follow another device's values</small>`,1),Ov=G('<p class="no-devices svelte-25wvt7">No compatible devices available to link</p>'),Rv=G('<form method="dialog" class="svelte-25wvt7"><h3 class="svelte-25wvt7">Device Settings</h3> <div class="dialog-input-group svelte-25wvt7"><label for="name-input" class="svelte-25wvt7">Name:</label> <input id="name-input" type="text" placeholder="Device name" class="svelte-25wvt7"/> <small class="css-id-preview svelte-25wvt7"> </small></div> <div class="dialog-input-group svelte-25wvt7"><label for="channel-input" class="svelte-25wvt7">Starting channel (1-512):</label> <input id="channel-input" type="number" min="1" max="512"/> <small class="channel-range svelte-25wvt7"> </small></div> <div class="dialog-input-group svelte-25wvt7"><label for="link-select" class="svelte-25wvt7">Link to device:</label> <!></div> <div class="dialog-buttons svelte-25wvt7"><button type="button" class="svelte-25wvt7">Cancel</button> <button type="submit" class="svelte-25wvt7">Save</button></div></form>'),Nv=G('<div class="devices-container svelte-25wvt7"><div class="devices-list svelte-25wvt7"><!> <!></div> <dialog class="settings-dialog svelte-25wvt7"><!></dialog></div>');function Fv(r,e){yt(e,!0);let t=fe(e,"devices",31,()=>we([])),n=V(null),i=V(null),s=V(""),a=V(1),l=V(null);function c(x){var k;S(i,x,!0),S(s,x.name,!0),S(a,x.startChannel+1),S(l,x.linkedTo||null,!0),(k=o(n))==null||k.showModal()}function u(){var x;(x=o(n))==null||x.close(),S(i,null),S(s,""),S(l,null)}function d(){var k;return(o(s).trim()||((k=o(i))==null?void 0:k.name)||"").toLowerCase().replace(/[^a-z0-9]/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,"")}function f(){if(!o(i)||!_(o(i),o(a)-1))return;const x=Math.max(0,Math.min(511,o(a)-1)),k=new $n(o(i).id,o(i).type,x,o(s).trim()||o(i).name,o(l));if(k.defaultValues=[...o(i).defaultValues],o(l)!==null){const Y=t().find(z=>z.id===o(l));if(Y){const z=go(Y.type,k.type,Y.defaultValues,k.defaultValues);k.defaultValues=z}}e.dmxController&&k.defaultValues.forEach((Y,z)=>{const A=k.startChannel+z;e.dmxController.setChannel(A,Y)}),t(t().map(Y=>Y.id===o(i).id?k:Y)),u()}function _(x,k){const Y=Ve[x.type].channels,z=k+Y;if(z>512||k<0)return!1;for(let A of t()){if(A.id===x.id)continue;const y=Ve[A.type].channels,C=A.startChannel,O=C+y;if(k<O&&z>C)return!1}return!0}function m(){try{const x=localStorage.getItem("dmx-devices");if(x){const k=JSON.parse(x);return{devices:k.devices.map(z=>{const A=new $n(z.id,z.type,z.startChannel,z.name,z.linkedTo,z.cssId);return A.defaultValues=z.defaultValues||new Array(Ve[z.type].channels).fill(0),A}),nextId:k.nextId||1}}}catch(x){console.error("Failed to load from localStorage:",x)}return{devices:[],nextId:1}}const v=t().length===0?m():{devices:t(),nextId:null};t().length===0&&t(v.devices);const h=t().length>0?Math.max(...t().map(x=>x.id)):0;let g=V(we(Math.max(h+1,v.nextId||1)));rr(()=>{try{const x={devices:t().map(k=>({id:k.id,name:k.name,type:k.type,startChannel:k.startChannel,defaultValues:k.defaultValues,linkedTo:k.linkedTo})),nextId:o(g)};localStorage.setItem("dmx-devices",JSON.stringify(x))}catch(x){console.error("Failed to save to localStorage:",x)}});function D(){if(t().length===0)return 0;let x=0;return t().forEach(k=>{const Y=k.startChannel+Ve[k.type].channels;Y>x&&(x=Y)}),x>=512?0:x}function R(x=e.selectedType){const k=D(),Y=new $n(Pt(g),x,k);t([...t(),Y])}function E(){t(t().map(x=>(x.defaultValues=x.defaultValues.map(()=>0),x)))}function T(x){t(t().map(k=>(k.linkedTo===x&&(k.linkedTo=null),k)).filter(k=>k.id!==x))}function P(x,k,Y){const z=new $n(x.id,x.type,x.startChannel,x.name,x.linkedTo);z.defaultValues=[...x.defaultValues],z.defaultValues[k]=Y,t(t().map(A=>A.id===x.id?z:A)),L(z),j(z)}function L(x){e.dmxController&&x.defaultValues.forEach((k,Y)=>{const z=x.startChannel+Y;e.dmxController.setChannel(z,k)})}function j(x){t(t().map(k=>{if(k.linkedTo===x.id){const Y=new $n(k.id,k.type,k.startChannel,k.name,k.linkedTo),z=go(x.type,k.type,x.defaultValues,k.defaultValues);return Y.defaultValues=z,L(Y),Y}return k}))}function q(x){return t().filter(k=>k.id!==x.id&&!k.isLinked()&&Sv(x.type,k.type)&&k.linkedTo!==x.id)}function Ee(x){if(!x.linkedTo)return[];const k=t().find(Y=>Y.id===x.linkedTo);return k?na(k.type,x.type):[]}rr(()=>{e.dmxController&&t().forEach(x=>{L(x)})});var be={addDevice:R,clearAllDeviceValues:E},me=Nv(),ie=w(me),Se=w(ie);{var he=x=>{var k=Pv();M(x,k)};Le(Se,x=>{t().length===0&&x(he)})}var ue=b(Se,2);Be(ue,17,t,x=>x.id,(x,k,Y)=>{var z=Tv(),A=w(z),y=w(A),C=b(y,2),O=w(C),U=b(C,2);{var $=ye=>{_t(ye,{get data(){return Mv}})};Le(U,ye=>{o(k).isLinked()&&ye($)})}var se=b(U,2);se.__click=()=>c(o(k));var He=w(se);_t(He,{get data(){return kv}});var B=b(se,2);B.__click=()=>T(o(k).id);var Z=w(B);_t(Z,{get data(){return uc}});var ve=b(A,2);{let ye=We(()=>Ee(o(k)));xa(ve,{get deviceType(){return o(k).type},onChange:(ae,Ke)=>P(o(k),ae,Ke),get disabledChannels(){return o(ye)},get values(){return o(k).defaultValues},set values(ae){o(k).defaultValues=ae}})}re(ye=>{Ze(y,`background-color: ${ye??""}`),te(O,o(k).name)},[()=>pr(o(k).type,o(k).defaultValues)]),M(x,z)});var De=b(ie,2),Re=w(De);{var ke=x=>{var k=Rv(),Y=b(w(k),2),z=b(w(Y),2),A=b(z,2),y=w(A),C=b(Y,2),O=b(w(C),2);let U;var $=b(O,2),se=w($),He=b(C,2),B=b(w(He),2);{var Z=Ie=>{var je=Av(),ze=st(je),N=w(ze);N.value=(N.__value=null)??"";var Q=b(N);Be(Q,17,()=>q(o(i)),Xe,(ne,oe)=>{var le=Lv(),Ae=w(le),Oe={};re(()=>{te(Ae,`${o(oe).name??""} (${Ve[o(oe).type].name??""})`),Oe!==(Oe=o(oe).id)&&(le.value=(le.__value=o(oe).id)??"")}),M(ne,le)}),vr(ze,()=>o(l),ne=>S(l,ne)),M(Ie,je)},ve=Ie=>{var je=Ov();M(Ie,je)};Le(B,Ie=>{q(o(i)).length>0||o(i).isLinked()?Ie(Z):Ie(ve,!1)})}var ye=b(He,2),ae=w(ye);ae.__click=u;var Ke=b(ae,2);re((Ie,je,ze)=>{te(y,`CSS ID: #${Ie??""}`),U=it(O,1,"svelte-25wvt7",null,U,je),te(se,`Device uses ${Ve[o(i).type].channels??""} channels
                        (Ch ${o(a)??""}-${o(a)+Ve[o(i).type].channels-1})`),Ke.disabled=ze},[d,()=>({valid:_(o(i),o(a)-1),invalid:!_(o(i),o(a)-1)}),()=>!_(o(i),o(a)-1)]),_a("submit",k,Ie=>{Ie.preventDefault(),f()}),Ln(z,()=>o(s),Ie=>S(s,Ie)),Ln(O,()=>o(a),Ie=>S(a,Ie)),M(x,k)};Le(Re,x=>{o(i)&&x(ke)})}return nr(De,x=>S(n,x),()=>o(n)),M(r,me),wt(be)}bt(["click"]);const Bv=`<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="48" height="48" viewBox="0 0 48 48">
<path fill="#2196F3" d="M14 34L14 14 34 24z"></path>
</svg>`,Vv=`<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="48" height="48" viewBox="0 0 48 48">
<path fill="#2196F3" d="M15 14H21V34H15zM27 14H33V34H27z"></path>
</svg>`,Gv=`<svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="48" height="48" viewBox="0 0 48 48">
<path fill="#FF3D00" d="M14 14H34V34H14z"></path>
</svg>`,ia={linear:r=>r,easeInQuad:r=>r*r,easeOutQuad:r=>r*(2-r),easeInOutQuad:r=>r<.5?2*r*r:-1+(4-2*r)*r,easeInCubic:r=>r*r*r,easeOutCubic:r=>--r*r*r+1,easeInOutCubic:r=>r<.5?4*r*r*r:(r-1)*(2*r-2)*(2*r-2)+1,easeInSine:r=>1-Math.cos(r*Math.PI/2),easeOutSine:r=>Math.sin(r*Math.PI/2),easeInOutSine:r=>-(Math.cos(Math.PI*r)-1)/2};function Us(r,e,t,n="linear"){const s=(ia[n]||ia.linear)(t);return Math.round(r+(e-r)*s)}function jv(){return Object.keys(ia)}class Ki{constructor(e,t,n,i="linear"){this.time=e,this.deviceId=t,this.values=[...n],this.easing=i}}class Qn{constructor(e=1e4,t=!0){this.duration=e,this.loop=t,this.keypoints=[],this.playing=!1,this.currentTime=0,this.lastUpdateTime=null}addKeypoint(e){this.keypoints.push(e),this.sortKeypoints()}removeKeypoint(e){const t=this.keypoints.indexOf(e);t>-1&&this.keypoints.splice(t,1)}updateKeypoint(e,t){const n=this.keypoints.indexOf(e);n>-1&&(this.keypoints[n]=t,this.sortKeypoints())}sortKeypoints(){this.keypoints.sort((e,t)=>e.time-t.time)}getDeviceKeypoints(e){return this.keypoints.filter(t=>t.deviceId===e)}getSurroundingKeypoints(e,t){const n=this.getDeviceKeypoints(e);if(n.length===0)return{before:null,after:null};let i=null,s=null;for(let a=0;a<n.length;a++)if(n[a].time<=t&&(i=n[a]),n[a].time>=t&&!s){s=n[a];break}return{before:i,after:s}}getDeviceValuesAtTime(e,t,n){const i=this.getDeviceKeypoints(e);if(i.length===0)return n;const s=i.find(f=>f.time===0),a=s?s.values:n,l=i[0],c=i[i.length-1];if(t<l.time){const f=l.time-0,_=t/f;return a.map((v,h)=>{const g=l.values[h];return Us(v,g,_,l.easing)})}if(t>c.time){const f=this.duration-c.time,_=(t-c.time)/f;return c.values.map((v,h)=>{const g=a[h];return Us(v,g,_,"linear")})}const{before:u,after:d}=this.getSurroundingKeypoints(e,t);if(u&&d&&u===d)return u.values;if(u&&d&&u!==d){const f=d.time-u.time,_=(t-u.time)/f;return u.values.map((v,h)=>{const g=d.values[h];return Us(v,g,_,d.easing)})}return u?u.values:a}getAllDeviceValuesAtTime(e){const t=new Map;return e.forEach(n=>{const i=this.getDeviceValuesAtTime(n.id,this.currentTime,n.defaultValues);t.set(n.id,i)}),t}play(){this.playing=!0,this.lastUpdateTime=Date.now()}pause(){this.playing=!1,this.lastUpdateTime=null}stop(){this.playing=!1,this.currentTime=0,this.lastUpdateTime=null}update(){if(!this.playing)return!1;const e=Date.now(),t=e-this.lastUpdateTime;return this.lastUpdateTime=e,this.currentTime+=t,this.currentTime>=this.duration&&(this.loop?this.currentTime=this.currentTime%this.duration:(this.currentTime=this.duration,this.pause())),!0}seek(e){this.currentTime=Math.max(0,Math.min(e,this.duration)),this.playing&&(this.lastUpdateTime=Date.now())}toJSON(){return{duration:this.duration,loop:this.loop,keypoints:this.keypoints.map(e=>({time:e.time,deviceId:e.deviceId,values:e.values,easing:e.easing}))}}static fromJSON(e){const t=new Qn(e.duration,e.loop);return t.keypoints=e.keypoints.map(n=>new Ki(n.time,n.deviceId,n.values,n.easing)),t}}var Kv=G('<div class="empty-state svelte-1swyu47"><p class="svelte-1swyu47">No devices</p> <p class="svelte-1swyu47">Add devices in the Devices tab</p></div>'),Uv=G('<div class="device-name-row svelte-1swyu47"><div class="color-preview svelte-1swyu47"></div> <span> </span></div>'),$v=G('<div class="time-marker svelte-1swyu47"><span class="svelte-1swyu47"></span></div>'),Hv=G('<div class="empty-tracks svelte-1swyu47"></div>'),zv=G('<div class="gradient-segment svelte-1swyu47"></div>'),qv=G("<div></div>"),Wv=G('<div class="device-track svelte-1swyu47"><!> <!></div>'),Yv=G("<option> </option>"),Xv=G('<dialog class="keypoint-dialog svelte-1swyu47"><div class="dialog-header svelte-1swyu47"><div class="dialog-title svelte-1swyu47"><div class="color-preview-large svelte-1swyu47"></div> <span> </span></div> <button class="close-btn svelte-1swyu47">Ã</button></div> <div class="dialog-time svelte-1swyu47"> </div> <div class="dialog-content svelte-1swyu47"><div class="dialog-field svelte-1swyu47"><label class="svelte-1swyu47">Easing:</label> <select class="svelte-1swyu47"></select></div> <!> <button class="delete-btn svelte-1swyu47">Delete Keypoint</button></div></dialog>'),Jv=G('<div class="timeline-view svelte-1swyu47"><div class="controls-bar svelte-1swyu47"><div class="playback-controls svelte-1swyu47"><button class="svelte-1swyu47"><!></button> <button title="Stop" class="svelte-1swyu47"><!></button></div> <div class="time-display svelte-1swyu47"> </div> <button class="settings-button svelte-1swyu47">Settings</button> <button class="clear-button svelte-1swyu47">Clear</button></div> <div class="timeline-editor svelte-1swyu47"><div class="device-names svelte-1swyu47"><div class="device-names-header svelte-1swyu47">Devices</div> <!></div> <div class="timeline-tracks-container svelte-1swyu47"><div class="timeline-tracks svelte-1swyu47"><div class="time-ruler svelte-1swyu47"></div> <div class="playhead svelte-1swyu47"></div> <div class="timeline-end svelte-1swyu47"></div> <!></div></div></div></div> <!> <dialog class="settings-dialog svelte-1swyu47"><form method="dialog" class="svelte-1swyu47"><h3 class="svelte-1swyu47">Timeline Settings</h3> <div class="dialog-field svelte-1swyu47"><label class="svelte-1swyu47">Duration (seconds):</label> <input type="number" min="1" step="1" class="svelte-1swyu47"/></div> <div class="dialog-field svelte-1swyu47"><label class="svelte-1swyu47"><input type="checkbox" class="svelte-1swyu47"/> Loop playback</label></div> <div class="dialog-actions svelte-1swyu47"><button type="button" class="svelte-1swyu47">Cancel</button> <button type="button" class="svelte-1swyu47">Save</button></div></form></dialog>',1);function Zv(r,e){yt(e,!0);let t=fe(e,"dmxController",3,null),n=fe(e,"devices",19,()=>[]);const i=We(()=>n().filter(I=>{if(!I.linkedTo)return!0;const H=n().find(xe=>xe.id===I.linkedTo);if(!H)return!0;const _e=na(H.type,I.type),Ne=Ve[I.type].channels;return _e.length<Ne}));function s(I){if(!I.linkedTo)return[];const H=n().find(_e=>_e.id===I.linkedTo);return H?na(H.type,I.type):[]}function a(I){o(_);const H=o(d).getDeviceValuesAtTime(I.id,o(_),I.defaultValues);return pr(I.type,H)}function l(I,H){return pr(H.type,I.values)}function c(I){if(!I||!I.defaultValues||!I.type)return[];const H=B(I),_e=[],Ne=H.find(ht=>ht.time===0),xe=Ne?Ne.values:I.defaultValues;if(!xe||xe.length===0)return[];const qe=pr(I.type,xe);if(H.length===0)_e.push({left:0,width:o(ue),gradient:qe});else{const ht=H[0],qt=H[H.length-1];if(ht.time>0){const Ye=l(ht,I);_e.push({left:0,width:ht.time/o(h)*o(ue),gradient:`linear-gradient(to right, ${qe}, ${Ye})`})}for(let Ye=0;Ye<H.length-1;Ye++){const Ue=H[Ye],pt=H[Ye+1],Gr=l(Ue,I),Gt=l(pt,I);_e.push({left:Ue.time/o(h)*o(ue),width:(pt.time-Ue.time)/o(h)*o(ue),gradient:`linear-gradient(to right, ${Gr}, ${Gt})`})}if(qt.time<o(h)){const Ye=l(qt,I);_e.push({left:qt.time/o(h)*o(ue),width:(o(h)-qt.time)/o(h)*o(ue),gradient:`linear-gradient(to right, ${Ye}, ${qe})`})}}return _e}function u(){try{const I=localStorage.getItem("dmx-timeline");if(I){const H=JSON.parse(I);return Qn.fromJSON(H)}}catch(I){console.error("Failed to load timeline from localStorage:",I)}return new Qn(3e4,!0)}let d=V(we(u())),f=V(null),_=V(we(o(d).currentTime)),m=V(0),v=V(we(o(d).playing)),h=V(we(o(d).duration)),g=V(null),D=V(null),R=V(we([])),E=V("linear"),T=jv(),P=V(null),L=V(null),j=V(null),q=V(0),Ee=V(0),be=V(!1),me=V(null),ie=V(o(d).duration/1e3),Se=V(we(o(d).loop));const he=100,ue=We(()=>o(h)/1e3*he);rr(()=>{o(m),o(h);try{const I=o(d).toJSON();localStorage.setItem("dmx-timeline",JSON.stringify(I))}catch(I){console.error("Failed to save timeline to localStorage:",I)}});function De(I){const H=Math.floor(I/1e3),_e=Math.floor(H/60),Ne=H%60,xe=Math.floor(I%1e3/10);return`${String(_e).padStart(2,"0")}:${String(Ne).padStart(2,"0")}.${String(xe).padStart(2,"0")}`}function Re(){if(o(f))return;function I(){o(d).update()&&(S(_,o(d).currentTime,!0),x()),S(f,requestAnimationFrame(I),!0)}I()}function ke(){o(f)&&(cancelAnimationFrame(o(f)),S(f,null))}function x(){if(!t())return;const I=o(d).getAllDeviceValuesAtTime(n());n().forEach(H=>{const _e=I.get(H.id);_e&&_e.forEach((Ne,xe)=>{const qe=H.startChannel+xe;t().setChannel(qe,Ne)})})}function k(){o(d).playing?o(d).pause():(o(d).play(),Re()),S(v,o(d).playing,!0)}function Y(){o(d).stop(),S(_,o(d).currentTime,!0),S(v,o(d).playing,!0),ke(),x()}function z(I){S(be,!0),C(I),document.addEventListener("mousemove",A),document.addEventListener("mouseup",y)}function A(I){o(be)&&C(I)}function y(){S(be,!1),document.removeEventListener("mousemove",A),document.removeEventListener("mouseup",y)}function C(I){const H=document.querySelector(".time-ruler");if(!H)return;const _e=H.getBoundingClientRect(),Ne=I.clientX-_e.left,xe=Math.max(0,Math.min(o(h),Ne/o(ue)*o(h)));o(d).seek(xe),S(_,o(d).currentTime,!0),x()}function O(I,H){if(I.target.classList.contains("keypoint"))return;const _e=I.currentTarget.getBoundingClientRect(),xe=(I.clientX-_e.left)/o(ue)*o(h),qe=new Ki(Math.round(xe),H.id,[...H.defaultValues],"linear");o(d).addKeypoint(qe),Pt(m),U(H,qe)}function U(I,H){S(g,H,!0),S(D,I,!0),S(R,[...H.values],!0),S(E,H.easing,!0),S(L,`keypoint-${I.id}-${H.time}`),requestAnimationFrame(()=>{var _e;(_e=o(P))==null||_e.show()})}function $(){var I;(I=o(P))==null||I.close(),S(g,null),S(D,null),S(L,null)}function se(){if(!o(g)||!o(D))return;const I=new Ki(o(g).time,o(D).id,o(R),o(E));o(d).updateKeypoint(o(g),I),Pt(m),S(g,I,!0),x()}function He(){o(g)&&confirm("Delete this keypoint?")&&(o(d).removeKeypoint(o(g)),Pt(m),$(),x())}function B(I){return o(m),o(d).getDeviceKeypoints(I.id)}function Z(I){return I.time/o(h)*o(ue)}function ve(){return o(_)/o(h)*o(ue)}function ye(I,H,_e){I.stopPropagation(),I.preventDefault(),S(j,H,!0),S(q,I.clientX,!0),S(Ee,H.time,!0),document.addEventListener("mousemove",ae),document.addEventListener("mouseup",Ke)}function ae(I){if(!o(j))return;const _e=(I.clientX-o(q))/o(ue)*o(h);let Ne=Math.round(o(Ee)+_e);if(Ne=Math.max(0,Math.min(o(h),Ne)),!o(i).find(ht=>ht.id===o(j).deviceId))return;const qe=new Ki(Ne,o(j).deviceId,o(j).values,o(j).easing);o(d).updateKeypoint(o(j),qe),S(j,qe,!0),o(g)===o(j)&&S(g,qe,!0),Pt(m)}function Ke(I){document.removeEventListener("mousemove",ae),document.removeEventListener("mouseup",Ke),S(j,null)}function Ie(){var I;S(ie,o(d).duration/1e3),S(Se,o(d).loop,!0),(I=o(me))==null||I.showModal()}function je(){var I;o(d).duration=Math.max(1,o(ie))*1e3,o(d).loop=o(Se),S(h,o(d).duration,!0),o(d).currentTime>o(d).duration&&(o(d).currentTime=o(d).duration,S(_,o(d).currentTime,!0)),Pt(m),(I=o(me))==null||I.close()}function ze(){confirm("Clear all keypoints? This cannot be undone.")&&(S(d,new Qn(3e4,!0),!0),S(_,0),S(h,o(d).duration,!0),S(v,o(d).playing,!0),Pt(m),$())}rr(()=>()=>{ke()});var N=Jv(),Q=st(N),ne=w(Q),oe=w(ne),le=w(oe);le.__click=k;var Ae=w(le);{let I=We(()=>o(v)?Vv:Bv);_t(Ae,{get data(){return o(I)}})}var Oe=b(le,2);Oe.__click=Y;var ee=w(Oe);_t(ee,{get data(){return Gv}});var W=b(oe,2),Me=w(W),Ce=b(W,2);Ce.__click=Ie;var Je=b(Ce,2);Je.__click=ze;var X=b(ne,2),pe=w(X),J=b(w(pe),2);{var ge=I=>{var H=Kv();M(I,H)},Pe=I=>{var H=Tn(),_e=st(H);Be(_e,17,()=>o(i),Xe,(Ne,xe)=>{var qe=Uv(),ht=w(qe),qt=b(ht,2),Ye=w(qt);re(Ue=>{Ze(ht,`background-color: ${Ue??""}`),te(Ye,o(xe).name)},[()=>a(o(xe))]),M(Ne,qe)}),M(I,H)};Le(J,I=>{o(i).length===0?I(ge):I(Pe,!1)})}var tt=b(pe,2),zt=w(tt),lr=w(zt);lr.__mousedown=z,Be(lr,21,()=>Array(Math.ceil(o(h)/1e3)),Xe,(I,H,_e)=>{var Ne=$v();Ze(Ne,`left: ${_e*he}px`);var xe=w(Ne);xe.textContent=`${_e}s`,M(I,Ne)});var br=b(lr,2),ct=b(br,2),Fr=b(ct,2);{var Sr=I=>{var H=Hv();M(I,H)},Br=I=>{var H=Tn(),_e=st(H);Be(_e,17,()=>o(i),Xe,(Ne,xe)=>{var qe=Wv();qe.__click=Ye=>O(Ye,o(xe));var ht=w(qe);Be(ht,17,()=>c(o(xe)),Xe,(Ye,Ue)=>{var pt=zv();re(()=>Ze(pt,`left: ${o(Ue).left??""}px; width: ${o(Ue).width??""}px; background: ${o(Ue).gradient??""}`)),M(Ye,pt)});var qt=b(ht,2);Be(qt,17,()=>B(o(xe)),Xe,(Ye,Ue)=>{var pt=qv();let Gr;pt.__mousedown=Gt=>ye(Gt,o(Ue),o(xe)),pt.__click=Gt=>{Gt.stopPropagation(),o(j)||U(o(xe),o(Ue))},re((Gt,Ci,Ts)=>{Ht(pt,"id",`keypoint-${o(xe).id??""}-${o(Ue).time??""}`),Gr=it(pt,1,"keypoint svelte-1swyu47",null,Gr,{selected:o(g)===o(Ue),dragging:o(j)===o(Ue)}),Ze(pt,`left: ${Gt??""}px; --keypoint-color: ${Ci??""}; anchor-name: --keypoint-${o(xe).id??""}-${o(Ue).time??""}`),Ht(pt,"title",`${Ts??""} - ${o(Ue).easing??""}`)},[()=>Z(o(Ue)),()=>l(o(Ue),o(xe)),()=>De(o(Ue).time)]),M(Ye,pt)}),M(Ne,qe)}),M(I,H)};Le(Fr,I=>{o(i).length===0?I(Sr):I(Br,!1)})}var Vr=b(Q,2);{var Ps=I=>{var H=Xv(),_e=w(H),Ne=w(_e),xe=w(Ne),qe=b(xe,2),ht=w(qe),qt=b(Ne,2);qt.__click=$;var Ye=b(_e,2),Ue=w(Ye),pt=b(Ye,2),Gr=w(pt),Gt=b(w(Gr),2);Gt.__change=se,Be(Gt,21,()=>T,Xe,(cr,jr)=>{var Ei=Yv(),_c=w(Ei),La={};re(()=>{te(_c,o(jr)),La!==(La=o(jr))&&(Ei.value=(Ei.__value=o(jr))??"")}),M(cr,Ei)});var Ci=b(Gr,2);{let cr=We(()=>s(o(D)));xa(Ci,{get deviceType(){return o(D).type},onChange:se,get disabledChannels(){return o(cr)},get values(){return o(R)},set values(jr){S(R,jr,!0)}})}var Ts=b(Ci,2);Ts.__click=He,nr(H,cr=>S(P,cr),()=>o(P)),re((cr,jr)=>{Ze(H,`position-anchor: --${o(L)??""}`),Ze(xe,`background-color: ${cr??""}`),te(ht,o(D).name),te(Ue,jr)},[()=>pr(o(D).type,o(R)),()=>De(o(g).time)]),vr(Gt,()=>o(E),cr=>S(E,cr)),M(I,H)};Le(Vr,I=>{o(g)&&o(D)&&o(L)&&I(Ps)})}var ka=b(Vr,2),dc=w(ka),Ma=b(w(dc),2),fc=b(w(Ma),2),Pa=b(Ma,2),vc=w(Pa),hc=w(vc),pc=b(Pa,2),Ta=w(pc);Ta.__click=()=>{var I;return(I=o(me))==null?void 0:I.close()};var gc=b(Ta,2);gc.__click=je,nr(ka,I=>S(me,I),()=>o(me)),re((I,H,_e)=>{Ht(le,"title",o(v)?"Pause":"Play"),te(Me,`${I??""} / ${H??""}`),Ze(zt,`width: ${o(ue)??""}px`),Ze(br,`left: ${_e??""}px`),Ze(ct,`left: ${o(ue)??""}px`)},[()=>De(o(_)),()=>De(o(h)),ve]),Ln(fc,()=>o(ie),I=>S(ie,I)),Sl(hc,()=>o(Se),I=>S(Se,I)),M(r,N),wt()}bt(["click","mousedown","change"]);var Qv=G("<button><!></button>");function Nt(r,e){let t=fe(e,"variant",3,"primary"),n=fe(e,"disabled",3,!1),i=fe(e,"onclick",3,null),s=fe(e,"type",3,"button");var a=Qv();a.__click=function(...c){var u;(u=i())==null||u.apply(this,c)};var l=w(a);gl(l,()=>e.children),re(()=>{it(a,1,`button ${t()??""}`,"svelte-18f749u"),a.disabled=n(),Ht(a,"type",s())}),M(r,a)}bt(["click"]);var eh=G('<dialog class="dialog svelte-pz05fu"><div class="dialog-header svelte-pz05fu"><h2 class="svelte-pz05fu"> </h2> <button class="close-btn svelte-pz05fu">Ã</button></div> <div class="dialog-body svelte-pz05fu"><!></div></dialog>');function sa(r,e){yt(e,!0);let t=fe(e,"onclose",3,null),n=fe(e,"dialogRef",15,null);function i(){var _;(_=n())==null||_.close(),t()&&t()()}var s=eh(),a=w(s),l=w(a),c=w(l),u=b(l,2);u.__click=i;var d=b(a,2),f=w(d);gl(f,()=>e.children),nr(s,_=>n(_),()=>n()),re(()=>te(c,e.title)),M(r,s),wt()}bt(["click"]);var th=G("<button><!></button>");function On(r,e){let t=fe(e,"onclick",3,null),n=fe(e,"disabled",3,!1),i=fe(e,"size",3,"medium");var s=th();s.__click=function(...l){var c;(c=t())==null||c.apply(this,l)};var a=w(s);_t(a,{get data(){return e.icon}}),re(()=>{it(s,1,`icon-button ${i()??""}`,"svelte-cwtv5f"),s.disabled=n(),Ht(s,"aria-label",e.label),Ht(s,"title",e.label)}),M(r,s)}bt(["click"]);var rh=G("<style>{@html previewCSS}</style>"),nh=G('<div class="animation-preview svelte-1age76"><div class="preview-container svelte-1age76"><div class="preview-box svelte-1age76"></div></div> <div class="preview-controls svelte-1age76"><button class="preview-button svelte-1age76"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" class="svelte-1age76"><path d="M8 5v14l11-7z"></path></svg> Play</button> <button class="preview-button svelte-1age76"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" class="svelte-1age76"><path d="M6 6h12v12H6z"></path></svg> Stop</button></div></div> <!>',1);function ih(r,e){yt(e,!0),fe(e,"animationVersion",3,0);let t=V(null),n=V(!1);function i(){!e.animation||!o(t)||(o(t).style.animation="none",S(n,!1),setTimeout(()=>{o(t).style.animation=`preview-${e.animation.name} 3s linear infinite`,S(n,!0)},10))}function s(){o(t)&&(o(t).style.animation="none",S(n,!1))}var a=nh(),l=st(a),c=w(l),u=w(c);nr(u,h=>S(t,h),()=>o(t));var d=b(c,2),f=w(d);f.__click=i;var _=b(f,2);_.__click=s;var m=b(l,2);{var v=h=>{var g=rh();M(h,g)};Le(m,h=>{e.animation&&h(v)})}re(()=>{f.disabled=!e.animation,_.disabled=!e.animation||!o(n)}),M(r,a),wt()}bt(["click"]);var sh=G('<p class="empty-state svelte-nhkann">No animations yet. Create one to get started!</p>'),ah=G('<div><span class="animation-name svelte-nhkann"> </span> <span class="keyframe-count svelte-nhkann"> </span> <!></div>'),oh=G('<div class="gradient-segment svelte-nhkann"></div>'),lh=G('<div><div class="keyframe-time svelte-nhkann"> </div></div>'),ch=G('<div class="keyframe-editor svelte-nhkann"><h4 class="svelte-nhkann"> </h4> <!> <div class="property-actions svelte-nhkann"><!></div></div>'),uh=G('<p class="empty-state svelte-nhkann">Select a keyframe to edit its values</p>'),dh=G('<div class="panel-header svelte-nhkann"><h3 class="svelte-nhkann"> </h3> <div class="device-type-badge svelte-nhkann"> </div></div> <div class="timeline-container svelte-nhkann"><div class="timeline-instructions svelte-nhkann">Click on the timeline to add a keyframe</div> <div class="timeline svelte-nhkann"><!> <!></div></div> <!>',1),fh=G('<div class="empty-state-large svelte-nhkann"><p>Select an animation to edit, or create a new one</p></div>'),vh=G('<div class="preview-section svelte-nhkann"><h4 class="svelte-nhkann">Animation Preview</h4> <!></div> <div class="css-section svelte-nhkann"><h4 class="svelte-nhkann">Generated CSS</h4> <pre class="css-output svelte-nhkann"> </pre></div>',1),hh=G('<p class="empty-state svelte-nhkann">No animation selected</p>'),ph=G("<option> </option>"),gh=G('<form method="dialog"><h3>Create New Animation</h3> <div class="dialog-field svelte-nhkann"><label for="animation-name" class="svelte-nhkann">Animation Name:</label> <input id="animation-name" type="text" placeholder="e.g., rainbow, pulse, sweep" class="svelte-nhkann"/></div> <div class="dialog-field svelte-nhkann"><label for="device-type" class="svelte-nhkann">Device Type:</label> <select id="device-type" class="svelte-nhkann"></select></div> <div class="dialog-buttons svelte-nhkann"><!> <!></div></form>'),_h=G('<h3>Delete Animation</h3> <p> </p> <p class="warning svelte-nhkann">This cannot be undone.</p> <div class="dialog-buttons svelte-nhkann"><!> <!></div>',1),mh=G('<div class="animations-view svelte-nhkann"><div class="left-panel svelte-nhkann"><div class="panel-header svelte-nhkann"><h3 class="svelte-nhkann">Animations</h3> <!></div> <div class="animations-list svelte-nhkann"><!></div></div> <div class="center-panel svelte-nhkann"><!></div> <div class="right-panel svelte-nhkann"><div class="panel-header svelte-nhkann"><h3 class="svelte-nhkann">Preview & CSS</h3></div> <!></div></div> <!> <!>',1);function yh(r,e){yt(e,!0),fe(e,"devices",19,()=>[]);const t='<svg viewBox="0 0 24 24" fill="currentColor"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>',n='<svg viewBox="0 0 24 24" fill="currentColor"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>';let i=V(null),s=V(null),a=V(we([])),l=V(null),c=V(""),u=V("RGB"),d=V(null),f=V(null),_=V(we([0,0,0])),m=V(null),v=V(800),h=V(null),g=V(0),D=V(0),R=V(!1),E=V(0);function T(){if(S(a,e.animationLibrary.getAll(),!0),o(i)){const N=o(a).find(Q=>Q.name===o(i).name);N?S(i,N,!0):(S(i,null),S(s,null))}}Vn(()=>{T()});function P(N){S(i,N,!0),S(s,null)}function L(){var N;S(c,""),S(u,"RGB"),(N=o(l))==null||N.showModal()}function j(){var le;if(!o(c).trim())return;const N=o(u),Q=Ve[N].channels,ne=new Array(Q).fill(0),oe=new hs(o(c).trim(),N);oe.addKeyframe(0,[...ne]),oe.addKeyframe(1,[...ne]),e.animationLibrary.add(oe),T(),P(oe),(le=o(l))==null||le.close()}function q(N){var Q;S(f,N,!0),(Q=o(d))==null||Q.showModal()}function Ee(){var N;o(f)&&(e.animationLibrary.remove(o(f).name),T(),(N=o(d))==null||N.close(),S(f,null))}function be(N){if(!o(i))return;const Q=Ve[o(i).deviceType].channels,ne=new Array(Q).fill(0);o(i).addKeyframe(N,ne),S(i,o(i),!0),Pt(E),e.animationLibrary.save();const oe=o(i).keyframes.findIndex(le=>Math.abs(le.time-N)<.001);oe!==-1&&ie(oe)}function me(N){if(!o(i)||o(i).keyframes.length<=2){alert("Animation must have at least 2 keyframes");return}o(i).keyframes=o(i).keyframes.filter((Q,ne)=>ne!==N),S(i,o(i),!0),Pt(E),e.animationLibrary.save(),S(s,null)}function ie(N){if(!o(i))return;S(s,N,!0);const Q=o(i).keyframes[N];S(_,[...Q.values],!0)}function Se(){if(!o(i)||o(s)===null)return;const N=o(i).keyframes[o(s)];N.values=[...o(_)],S(i,o(i),!0),Pt(E),e.animationLibrary.save()}function he(N){if(!o(i)||N.target.classList.contains("timeline-keyframe-marker"))return;const Q=N.currentTarget.getBoundingClientRect(),ne=N.clientX-Q.left,oe=Math.max(0,Math.min(1,ne/o(v)));be(oe)}function ue(N,Q,ne){N.stopPropagation(),N.preventDefault(),S(h,{keyframe:Q,index:ne},!0),S(g,N.clientX,!0),S(D,Q.time,!0),S(R,!1),document.addEventListener("mousemove",De),document.addEventListener("mouseup",Re)}function De(N){if(!o(h)||!o(i))return;const Q=N.clientX-o(g);Math.abs(Q)>3&&S(R,!0);const ne=Q/o(v);let oe=o(D)+ne;oe=Math.max(0,Math.min(1,oe));const le=o(h).keyframe;le.time=oe,o(i).keyframes=[...o(i).keyframes].sort((Oe,ee)=>Oe.time-ee.time),S(i,o(i),!0);const Ae=o(i).keyframes.indexOf(le);S(s,Ae,!0),o(h).index=Ae,Pt(E)}function Re(){o(h)&&(document.removeEventListener("mousemove",De),document.removeEventListener("mouseup",Re),e.animationLibrary.save(),S(h,null))}function ke(N){return o(E),N.time*o(v)}let x=We(()=>(o(E),o(i)?o(i).getGradientSegments(o(v)):[])),k=We(()=>(o(E),o(i)?o(i).keyframes:[]));var Y=mh(),z=st(Y),A=w(z),y=w(A),C=b(w(y),2);On(C,{icon:t,onclick:L,title:"Create new animation"});var O=b(y,2),U=w(O);{var $=N=>{var Q=sh();M(N,Q)},se=N=>{var Q=Tn(),ne=st(Q);Be(ne,17,()=>o(a),Xe,(oe,le)=>{var Ae=ah();let Oe;Ae.__click=()=>P(o(le));var ee=w(Ae),W=w(ee),Me=b(ee,2),Ce=w(Me),Je=b(Me,2);On(Je,{icon:n,onclick:X=>{X.stopPropagation(),q(o(le))},size:"small",title:"Delete animation"}),re(()=>{var X;Oe=it(Ae,1,"animation-item svelte-nhkann",null,Oe,{selected:((X=o(i))==null?void 0:X.name)===o(le).name}),te(W,o(le).name),te(Ce,`${o(le).keyframes.length??""} keyframes`)}),M(oe,Ae)}),M(N,Q)};Le(U,N=>{o(a).length===0?N($):N(se,!1)})}var He=b(A,2),B=w(He);{var Z=N=>{var Q=dh(),ne=st(Q),oe=w(ne),le=w(oe),Ae=b(oe,2),Oe=w(Ae),ee=b(ne,2),W=b(w(ee),2);W.__click=he;var Me=w(W);Be(Me,17,()=>o(x),Xe,(J,ge)=>{var Pe=oh();re(()=>Ze(Pe,`left: ${o(ge).left??""}px; width: ${o(ge).width??""}px; background: ${o(ge).gradient??""}`)),M(J,Pe)});var Ce=b(Me,2);Be(Ce,19,()=>o(k),(J,ge)=>J.time+"-"+ge,(J,ge,Pe)=>{var tt=lh();let zt;tt.__mousedown=ct=>ue(ct,o(ge),o(Pe)),tt.__click=ct=>{ct.stopPropagation(),o(R)||ie(o(Pe))};var lr=w(tt),br=w(lr);re((ct,Fr,Sr,Br)=>{var Vr;zt=it(tt,1,"timeline-keyframe-marker svelte-nhkann",null,zt,{selected:o(s)===o(Pe),dragging:((Vr=o(h))==null?void 0:Vr.keyframe)===o(ge)}),Ze(tt,`left: ${ct??""}px; --keyframe-color: ${Fr??""}`),Ht(tt,"title",`${Sr??""}%`),te(br,`${Br??""}%`)},[()=>ke(o(ge)),()=>o(i).getKeyframeColor(o(ge)),()=>(o(ge).time*100).toFixed(0),()=>(o(ge).time*100).toFixed(0)]),M(J,tt)}),nr(W,J=>S(m,J),()=>o(m));var Je=b(ee,2);{var X=J=>{var ge=ch(),Pe=w(ge),tt=w(Pe),zt=b(Pe,2);xa(zt,{get deviceType(){return o(i).deviceType},onChange:Se,get values(){return o(_)},set values(ct){S(_,ct,!0)}});var lr=b(zt,2),br=w(lr);{let ct=We(()=>o(i).keyframes.length<=2);Nt(br,{onclick:()=>me(o(s)),get disabled(){return o(ct)},children:(Fr,Sr)=>{var Br=Dt("Delete Keyframe");M(Fr,Br)},$$slots:{default:!0}})}re(ct=>te(tt,`Keyframe at ${ct??""}%`),[()=>(o(i).keyframes[o(s)].time*100).toFixed(0)]),M(J,ge)},pe=J=>{var ge=uh();M(J,ge)};Le(Je,J=>{o(s)!==null?J(X):J(pe,!1)})}re(()=>{te(le,o(i).name),te(Oe,Ve[o(i).deviceType].name)}),Xu(W,"clientWidth",J=>S(v,J)),M(N,Q)},ve=N=>{var Q=fh();M(N,Q)};Le(B,N=>{o(i)?N(Z):N(ve,!1)})}var ye=b(He,2),ae=b(w(ye),2);{var Ke=N=>{var Q=vh(),ne=st(Q),oe=b(w(ne),2);ih(oe,{get animation(){return o(i)},get animationVersion(){return o(E)}});var le=b(ne,2),Ae=b(w(le),2),Oe=w(Ae);re(ee=>te(Oe,ee),[()=>o(i).toCSS()]),M(N,Q)},Ie=N=>{var Q=hh();M(N,Q)};Le(ae,N=>{o(i)?N(Ke):N(Ie,!1)})}var je=b(z,2);sa(je,{get dialogRef(){return o(l)},set dialogRef(N){S(l,N,!0)},children:(N,Q)=>{var ne=gh(),oe=b(w(ne),2),le=b(w(oe),2);ha(le,!0);var Ae=b(oe,2),Oe=b(w(Ae),2);Be(Oe,21,()=>Object.entries(Ve),Xe,(Ce,Je)=>{var X=We(()=>bo(o(Je),2));let pe=()=>o(X)[0],J=()=>o(X)[1];var ge=ph(),Pe=w(ge),tt={};re(()=>{te(Pe,J().name),tt!==(tt=pe())&&(ge.value=(ge.__value=pe())??"")}),M(Ce,ge)});var ee=b(Ae,2),W=w(ee);Nt(W,{type:"button",onclick:()=>{var Ce;return(Ce=o(l))==null?void 0:Ce.close()},children:(Ce,Je)=>{var X=Dt("Cancel");M(Ce,X)},$$slots:{default:!0}});var Me=b(W,2);Nt(Me,{type:"submit",primary:!0,children:(Ce,Je)=>{var X=Dt("Create");M(Ce,X)},$$slots:{default:!0}}),_a("submit",ne,Ce=>{Ce.preventDefault(),j()}),Ln(le,()=>o(c),Ce=>S(c,Ce)),vr(Oe,()=>o(u),Ce=>S(u,Ce)),M(N,ne)},$$slots:{default:!0}});var ze=b(je,2);sa(ze,{get dialogRef(){return o(d)},set dialogRef(N){S(d,N,!0)},children:(N,Q)=>{var ne=_h(),oe=b(st(ne),2),le=w(oe),Ae=b(oe,4),Oe=w(Ae);Nt(Oe,{onclick:()=>{var W;return(W=o(d))==null?void 0:W.close()},children:(W,Me)=>{var Ce=Dt("Cancel");M(W,Ce)},$$slots:{default:!0}});var ee=b(Oe,2);Nt(ee,{onclick:Ee,primary:!0,children:(W,Me)=>{var Ce=Dt("Delete");M(W,Ce)},$$slots:{default:!0}}),re(()=>{var W;return te(le,`Are you sure you want to delete "${((W=o(f))==null?void 0:W.name)??""}"?`)}),M(N,ne)},$$slots:{default:!0}}),M(r,Y),wt()}bt(["click","mousedown"]);var wh=G('<div class="listening-indicator svelte-an69h5"><div class="pulse-dot svelte-an69h5"></div> Listening for inputs...</div>'),bh=G('<p class="empty-state svelte-an69h5">No inputs detected yet. Start listening to detect inputs!</p>'),Sh=G('<div class="input-color-badge svelte-an69h5"></div>'),Dh=G('<input type="text" class="input-name-edit svelte-an69h5"/>'),Ch=G('<div class="input-name svelte-an69h5"> </div>'),Eh=G("<!> <!>",1),Ih=G("<!> <!>",1),xh=G('<div class="input-item svelte-an69h5"><!> <div class="input-icon svelte-an69h5"><!></div> <div class="input-info svelte-an69h5"><!> <div class="input-details svelte-an69h5"><!> </div></div> <div class="input-actions svelte-an69h5"><!></div></div>'),kh=G('<div class="inputs-view svelte-an69h5"><div class="left-panel svelte-an69h5"><div class="panel-header svelte-an69h5"><h3 class="svelte-an69h5">Listen for Inputs</h3></div> <div class="listen-section svelte-an69h5"><p class="instructions svelte-an69h5">Press any MIDI button, keyboard key, Stream Deck button, or move any MIDI control to detect and save it automatically.</p> <div class="button-group svelte-an69h5"><!> <!></div> <!></div></div> <div class="right-panel svelte-an69h5"><div class="panel-header svelte-an69h5"><h3 class="svelte-an69h5">Saved Inputs</h3></div> <div class="inputs-list svelte-an69h5"><!></div></div></div>');function Mh(r,e){yt(e,!0);const t='<svg viewBox="0 0 24 24" fill="currentColor"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>',n='<svg viewBox="0 0 24 24" fill="currentColor"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>',i='<svg viewBox="0 0 24 24" fill="currentColor"><path d="M20 5H4c-1.1 0-1.99.9-1.99 2L2 17c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm-9 3h2v2h-2V8zm0 3h2v2h-2v-2zM8 8h2v2H8V8zm0 3h2v2H8v-2zm-1 2H5v-2h2v2zm0-3H5V8h2v2zm9 7H8v-2h8v2zm0-4h-2v-2h2v2zm0-3h-2V8h2v2zm3 3h-2v-2h2v2zm0-3h-2V8h2v2z"/></svg>',s='<svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"/></svg>',a='<svg viewBox="0 0 24 24" fill="currentColor"><path d="M4 6h16v2H4zm0 5h16v2H4zm0 5h16v2H4z"/></svg>';let l=V(!1),c=V(we([])),u=V(null),d=V(""),f=[];async function _(){try{await e.inputController.requestStreamDeck()}catch(y){alert(`Failed to connect Stream Deck: ${y.message}

Please close the Elgato Stream Deck software and try again.`)}}function m(){S(l,!0);const y=e.inputController.getInputDevices();for(const C of y){const O=U=>{v({deviceId:C.id,controlId:U.controlId,type:U.velocity!==void 0?"trigger":"change",device:C})};C.on("trigger",O),C.on("change",O),f.push({device:C,event:"trigger",handler:O}),f.push({device:C,event:"change",handler:O})}e.inputController.on("deviceadded",h)}function v(y){if(!o(l))return;const{deviceId:C,controlId:O,device:U}=y;if(!o(c).find(se=>se.inputDeviceId===C&&se.inputControlId===O)){const se=D((U==null?void 0:U.name)||C,O),He=(U==null?void 0:U.type)==="hid"&&U.id!=="keyboard",B=new yi({name:se,mode:"input",inputDeviceId:C,inputControlId:O,color:He?void 0:null});if(e.mappingLibrary.add(B),L(),He&&O.startsWith("button-")){const Z=parseInt(O.replace("button-",""));if(!isNaN(Z)&&Z>=0){const ve=e.inputController.inputDeviceManager.streamDeckManager,ye=C;ve.setButtonColor(ye,Z,B.color).catch(ae=>{console.warn(`Could not set button ${Z} color:`,ae)})}}}}function h(y){if(!o(l))return;const C=O=>{v({deviceId:y.id,controlId:O.controlId,type:O.velocity!==void 0?"trigger":"change",device:y})};y.on("trigger",C),y.on("change",C),f.push({device:y,event:"trigger",handler:C}),f.push({device:y,event:"change",handler:C})}function g(){S(l,!1);for(const{device:y,event:C,handler:O}of f)y.off(C,O);f=[],e.inputController.off("deviceadded",h)}function D(y,C){const O=y.replace(/\s+/g,"_").toLowerCase(),U=C.replace(/[^a-zA-Z0-9]/g,"_").toLowerCase();return`${O}_${U}`}function R(y){S(u,y,!0),S(d,y.name,!0)}function E(){!o(u)||!o(d).trim()||(o(u).name=o(d).trim(),e.mappingLibrary.save(),L(),S(u,null),S(d,""))}function T(){S(u,null),S(d,"")}async function P(y){const C=e.mappingLibrary.get(y);if(!C)return;const O=e.inputController.getInputDevice(C.inputDeviceId);if((O==null?void 0:O.type)==="hid"&&O.id!=="keyboard"&&C.inputControlId.startsWith("button-")){const U=parseInt(C.inputControlId.replace("button-",""));if(!isNaN(U)&&U>=0){const $=e.inputController.inputDeviceManager.streamDeckManager,se=C.inputDeviceId;await $.clearButtonColor(se,U)}}e.mappingLibrary.remove(y),L()}function L(){S(c,e.mappingLibrary.getAll().filter(y=>y.mode==="input"),!0)}function j(y){const C=e.inputController.getInputDevice(y);switch(C==null?void 0:C.type){case"keyboard":return i;case"midi":return s;case"hid":return a;default:return s}}async function q(){const y=e.inputController.inputDeviceManager.streamDeckManager;if(y.getConnectedDevices().length!==0)for(const O of o(c)){const U=e.inputController.getInputDevice(O.inputDeviceId);if((U==null?void 0:U.type)==="hid"&&U.id!=="keyboard"&&O.inputControlId.startsWith("button-")){const $=parseInt(O.inputControlId.replace("button-",""));if(!isNaN($)&&$>=0){const se=O.inputDeviceId;await y.setButtonColor(se,$,O.color)}}}}Vn(()=>{L(),e.inputController.on("deviceadded",y=>{y.type==="hid"&&setTimeout(()=>q(),500)}),setTimeout(()=>q(),1e3)}),vs(()=>{g()});var Ee=kh(),be=w(Ee),me=b(w(be),2),ie=b(w(me),2),Se=w(ie);{var he=y=>{Nt(y,{onclick:g,primary:!0,children:(C,O)=>{var U=Dt("Stop Listening");M(C,U)},$$slots:{default:!0}})},ue=y=>{Nt(y,{onclick:m,primary:!0,children:(C,O)=>{var U=Dt("Start Listening");M(C,U)},$$slots:{default:!0}})};Le(Se,y=>{o(l)?y(he):y(ue,!1)})}var De=b(Se,2);Nt(De,{onclick:_,children:(y,C)=>{var O=Dt("Connect Stream Deck");M(y,O)},$$slots:{default:!0}});var Re=b(ie,2);{var ke=y=>{var C=wh();M(y,C)};Le(Re,y=>{o(l)&&y(ke)})}var x=b(be,2),k=b(w(x),2),Y=w(k);{var z=y=>{var C=bh();M(y,C)},A=y=>{var C=Tn(),O=st(C);Be(O,17,()=>o(c),U=>U.id,(U,$)=>{var se=xh(),He=w(se);{var B=ee=>{var W=Sh();re(()=>Ze(W,`background-color: ${o($).color??""}`)),M(ee,W)};Le(He,ee=>{o($).color&&ee(B)})}var Z=b(He,2),ve=w(Z);pl(ve,()=>j(o($).inputDeviceId));var ye=b(Z,2),ae=w(ye);{var Ke=ee=>{var W=Dh();W.__keydown=Me=>{Me.key==="Enter"&&E(),Me.key==="Escape"&&T()},ha(W,!0),Ln(W,()=>o(d),Me=>S(d,Me)),M(ee,W)},Ie=ee=>{var W=Ch(),Me=w(W);re(()=>te(Me,o($).name)),M(ee,W)};Le(ae,ee=>{var W;((W=o(u))==null?void 0:W.id)===o($).id?ee(Ke):ee(Ie,!1)})}var je=b(ae,2),ze=w(je);{var N=ee=>{var W=Dt();re(Me=>te(W,Me),[()=>e.inputController.getInputDevice(o($).inputDeviceId).name]),M(ee,W)},Q=ee=>{var W=Dt();re(()=>te(W,o($).inputDeviceId)),M(ee,W)};Le(ze,ee=>{e.inputController.getInputDevice(o($).inputDeviceId)?ee(N):ee(Q,!1)})}var ne=b(ze),oe=b(ye,2),le=w(oe);{var Ae=ee=>{var W=Eh(),Me=st(W);Nt(Me,{onclick:E,size:"small",children:(Je,X)=>{var pe=Dt("Save");M(Je,pe)},$$slots:{default:!0}});var Ce=b(Me,2);Nt(Ce,{onclick:T,size:"small",children:(Je,X)=>{var pe=Dt("Cancel");M(Je,pe)},$$slots:{default:!0}}),M(ee,W)},Oe=ee=>{var W=Ih(),Me=st(W);On(Me,{icon:n,onclick:()=>R(o($)),title:"Rename input"});var Ce=b(Me,2);On(Ce,{icon:t,onclick:()=>P(o($).id),title:"Delete input"}),M(ee,W)};Le(le,ee=>{var W;((W=o(u))==null?void 0:W.id)===o($).id?ee(Ae):ee(Oe,!1)})}re(()=>te(ne,` â ${o($).inputControlId??""}`)),M(U,se)}),M(y,C)};Le(Y,y=>{o(c).length===0?y(z):y(A,!1)})}M(r,Ee),wt()}bt(["keydown"]);var Ph=G('<p class="warning svelte-17ww3d9">No inputs available. Go to the Inputs tab to detect and save inputs first.</p>'),Th=G('<p class="warning svelte-17ww3d9">No animations available. Go to the Animations tab to create animations first.</p>'),Lh=G('<p class="warning svelte-17ww3d9">No devices available. Go to the Devices tab to add devices first.</p>'),Ah=G('<div class="type-info svelte-17ww3d9"><strong class="svelte-17ww3d9"> </strong> <span class="svelte-17ww3d9"> </span></div>'),Oh=G('<div class="trigger-types svelte-17ww3d9"><h4 class="svelte-17ww3d9">Trigger Types</h4> <!></div>'),Rh=G('<p class="empty-state svelte-17ww3d9">No triggers created yet. Click the + button to create one!</p>'),Nh=G('<div class="trigger-item svelte-17ww3d9"><div class="trigger-header svelte-17ww3d9"><div class="trigger-name svelte-17ww3d9"> </div> <!></div> <div class="trigger-details svelte-17ww3d9"><div class="detail-row svelte-17ww3d9"><span class="label svelte-17ww3d9">Input:</span> <span class="value svelte-17ww3d9"> </span></div> <div class="detail-row svelte-17ww3d9"><span class="label svelte-17ww3d9">Type:</span> <span> </span></div> <div class="detail-row svelte-17ww3d9"><span class="label svelte-17ww3d9">Device:</span> <span class="value svelte-17ww3d9"> </span></div> <div class="detail-row svelte-17ww3d9"><span class="label svelte-17ww3d9">Animation:</span> <span class="value svelte-17ww3d9"> </span></div> <div class="detail-row svelte-17ww3d9"><span class="label svelte-17ww3d9">Duration:</span> <span class="value svelte-17ww3d9"> </span></div> <div class="detail-row svelte-17ww3d9"><span class="label svelte-17ww3d9">Loop:</span> <span class="value svelte-17ww3d9"> </span></div> <div class="detail-row svelte-17ww3d9"><span class="label svelte-17ww3d9">CSS Class:</span> <span class="value css-class svelte-17ww3d9"> </span></div></div></div>'),Fh=G("<option> </option>"),Bh=G("<option> </option>"),Vh=G("<option> </option>"),Gh=G("<option> </option>"),jh=G("<option> </option>"),Kh=G('<form method="dialog"><h3>Create New Trigger</h3> <div class="dialog-field svelte-17ww3d9"><label for="trigger-input" class="svelte-17ww3d9">Input:</label> <select id="trigger-input" class="svelte-17ww3d9"></select></div> <div class="dialog-field svelte-17ww3d9"><label for="trigger-type" class="svelte-17ww3d9">Trigger Type:</label> <select id="trigger-type" class="svelte-17ww3d9"></select></div> <div class="dialog-field svelte-17ww3d9"><label for="trigger-device" class="svelte-17ww3d9">Device:</label> <select id="trigger-device" class="svelte-17ww3d9"></select></div> <div class="dialog-field svelte-17ww3d9"><label for="trigger-animation" class="svelte-17ww3d9">Animation:</label> <select id="trigger-animation" class="svelte-17ww3d9"></select></div> <div class="dialog-field svelte-17ww3d9"><label for="trigger-duration" class="svelte-17ww3d9">Duration (ms):</label> <input id="trigger-duration" type="number" min="100" step="100" class="svelte-17ww3d9"/></div> <div class="dialog-field svelte-17ww3d9"><label for="trigger-easing" class="svelte-17ww3d9">Easing:</label> <select id="trigger-easing" class="svelte-17ww3d9"></select></div> <div class="dialog-field checkbox-field svelte-17ww3d9"><label class="svelte-17ww3d9"><input type="checkbox" class="svelte-17ww3d9"/> Loop animation infinitely</label></div> <div class="dialog-buttons svelte-17ww3d9"><!> <!></div></form>'),Uh=G('<div class="triggers-view svelte-17ww3d9"><div class="left-panel svelte-17ww3d9"><div class="panel-header svelte-17ww3d9"><h3 class="svelte-17ww3d9">Create Trigger</h3> <!></div> <div class="info-section svelte-17ww3d9"><!> <!> <!> <!></div></div> <div class="right-panel svelte-17ww3d9"><div class="panel-header svelte-17ww3d9"><h3 class="svelte-17ww3d9">Triggers</h3></div> <div class="triggers-list svelte-17ww3d9"><!></div></div></div> <!>',1);function $h(r,e){yt(e,!0);let t=fe(e,"devices",19,()=>[]);const n='<svg viewBox="0 0 24 24" fill="currentColor"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>',i='<svg viewBox="0 0 24 24" fill="currentColor"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>';let s=V(we([])),a=V(we([])),l=V(we([])),c=V(null),u=V(null),d=V("pressed"),f=V(null),_=V(null),m=V(1e3),v=V(!1),h=V("linear");const g=[{value:"pressed",label:"Pressed",description:"Trigger when key/button is pressed down"},{value:"not-pressed",label:"Not Pressed",description:"Active when key/button is NOT pressed"},{value:"always",label:"Always",description:"Infinite loop animation"}],D=["linear","ease","ease-in","ease-out","ease-in-out","cubic-bezier(0.4, 0.0, 0.2, 1)","cubic-bezier(0.68, -0.55, 0.265, 1.55)"];function R(){S(s,e.mappingLibrary.getAll().filter(B=>B.mode==="input"),!0),S(a,e.animationLibrary.getAll(),!0),S(l,e.mappingLibrary.getAll().filter(B=>B.mode==="trigger"),!0)}function E(){R()}function T(){var B,Z,ve,ye;S(u,((B=o(s)[0])==null?void 0:B.id)||null,!0),S(d,"pressed"),S(f,((Z=t()[0])==null?void 0:Z.id)||null,!0),S(_,((ve=o(a)[0])==null?void 0:ve.name)||null,!0),S(m,1e3),S(v,!1),S(h,"linear"),(ye=o(c))==null||ye.showModal()}function P(){var ve;if(!o(u)||!o(f)||!o(_))return;const B=e.mappingLibrary.get(o(u));if(!B)return;const Z=new yi({name:`${B.name}_${o(d)}_${o(_)}`,mode:"trigger",triggerType:o(d),inputDeviceId:B.inputDeviceId,inputControlId:B.inputControlId,animationName:o(_),targetDeviceIds:[o(f)],duration:o(m),easing:o(h),iterations:o(v)?"infinite":1});e.mappingLibrary.add(Z),R(),(ve=o(c))==null||ve.close()}function L(B){e.mappingLibrary.remove(B),R()}function j(B,Z){const ve=o(s).find(ye=>ye.inputDeviceId===B&&ye.inputControlId===Z);return(ve==null?void 0:ve.name)||`${B}_${Z}`}function q(B){const Z=t().find(ve=>ve.id===B);return(Z==null?void 0:Z.name)||B}function Ee(B){const Z=g.find(ve=>ve.value===B);return(Z==null?void 0:Z.label)||B}function be(B){const Z=B.inputControlId.replace(/[^a-zA-Z0-9]/g,"_").toLowerCase(),ve=B.triggerType==="pressed"?"down":B.triggerType==="not-pressed"?"up":"always";return`${Z}_${ve}`}Vn(()=>{R(),e.mappingLibrary.on("changed",E)}),vs(()=>{e.mappingLibrary.off("changed",E)});var me=Uh(),ie=st(me),Se=w(ie),he=w(Se),ue=b(w(he),2);{let B=We(()=>o(s).length===0||o(a).length===0||t().length===0);On(ue,{icon:n,onclick:T,title:"Create new trigger",get disabled(){return o(B)}})}var De=b(he,2),Re=w(De);{var ke=B=>{var Z=Ph();M(B,Z)};Le(Re,B=>{o(s).length===0&&B(ke)})}var x=b(Re,2);{var k=B=>{var Z=Th();M(B,Z)};Le(x,B=>{o(a).length===0&&B(k)})}var Y=b(x,2);{var z=B=>{var Z=Lh();M(B,Z)};Le(Y,B=>{t().length===0&&B(z)})}var A=b(Y,2);{var y=B=>{var Z=Oh(),ve=b(w(Z),2);Be(ve,17,()=>g,Xe,(ye,ae)=>{var Ke=Ah(),Ie=w(Ke),je=w(Ie),ze=b(Ie,2),N=w(ze);re(()=>{te(je,`${o(ae).label??""}:`),te(N,o(ae).description)}),M(ye,Ke)}),M(B,Z)};Le(A,B=>{o(s).length>0&&o(a).length>0&&t().length>0&&B(y)})}var C=b(Se,2),O=b(w(C),2),U=w(O);{var $=B=>{var Z=Rh();M(B,Z)},se=B=>{var Z=Tn(),ve=st(Z);Be(ve,17,()=>o(l),ye=>ye.id,(ye,ae)=>{var Ke=Nh(),Ie=w(Ke),je=w(Ie),ze=w(je),N=b(je,2);On(N,{icon:i,onclick:()=>L(o(ae).id),title:"Delete trigger"});var Q=b(Ie,2),ne=w(Q),oe=b(w(ne),2),le=w(oe),Ae=b(ne,2),Oe=b(w(Ae),2),ee=w(Oe),W=b(Ae,2),Me=b(w(W),2),Ce=w(Me),Je=b(W,2),X=b(w(Je),2),pe=w(X),J=b(Je,2),ge=b(w(J),2),Pe=w(ge),tt=b(J,2),zt=b(w(tt),2),lr=w(zt),br=b(tt,2),ct=b(w(br),2),Fr=w(ct);re((Sr,Br,Vr,Ps)=>{te(ze,o(ae).name),te(le,Sr),it(Oe,1,`value type-${o(ae).triggerType??""}`,"svelte-17ww3d9"),te(ee,Br),te(Ce,Vr),te(pe,o(ae).animationName),te(Pe,`${o(ae).duration??""}ms`),te(lr,o(ae).iterations==="infinite"?"Yes":"No"),te(Fr,`.${Ps??""}`)},[()=>j(o(ae).inputDeviceId,o(ae).inputControlId),()=>Ee(o(ae).triggerType),()=>o(ae).targetDeviceIds.map(Sr=>q(Sr)).join(", "),()=>be(o(ae))]),M(ye,Ke)}),M(B,Z)};Le(U,B=>{o(l).length===0?B($):B(se,!1)})}var He=b(ie,2);sa(He,{get dialogRef(){return o(c)},set dialogRef(B){S(c,B,!0)},children:(B,Z)=>{var ve=Kh(),ye=b(w(ve),2),ae=b(w(ye),2);Be(ae,21,()=>o(s),Xe,(X,pe)=>{var J=Fh(),ge=w(J),Pe={};re(()=>{te(ge,o(pe).name),Pe!==(Pe=o(pe).id)&&(J.value=(J.__value=o(pe).id)??"")}),M(X,J)});var Ke=b(ye,2),Ie=b(w(Ke),2);Be(Ie,21,()=>g,Xe,(X,pe)=>{var J=Bh(),ge=w(J),Pe={};re(()=>{te(ge,`${o(pe).label??""} - ${o(pe).description??""}`),Pe!==(Pe=o(pe).value)&&(J.value=(J.__value=o(pe).value)??"")}),M(X,J)});var je=b(Ke,2),ze=b(w(je),2);Be(ze,21,t,Xe,(X,pe)=>{var J=Vh(),ge=w(J),Pe={};re(()=>{te(ge,o(pe).name),Pe!==(Pe=o(pe).id)&&(J.value=(J.__value=o(pe).id)??"")}),M(X,J)});var N=b(je,2),Q=b(w(N),2);Be(Q,21,()=>o(a),Xe,(X,pe)=>{var J=Gh(),ge=w(J),Pe={};re(()=>{te(ge,o(pe).name),Pe!==(Pe=o(pe).name)&&(J.value=(J.__value=o(pe).name)??"")}),M(X,J)});var ne=b(N,2),oe=b(w(ne),2),le=b(ne,2),Ae=b(w(le),2);Be(Ae,21,()=>D,Xe,(X,pe)=>{var J=jh(),ge=w(J),Pe={};re(()=>{te(ge,o(pe)),Pe!==(Pe=o(pe))&&(J.value=(J.__value=o(pe))??"")}),M(X,J)});var Oe=b(le,2),ee=w(Oe),W=w(ee),Me=b(Oe,2),Ce=w(Me);Nt(Ce,{type:"button",onclick:()=>{var X;return(X=o(c))==null?void 0:X.close()},children:(X,pe)=>{var J=Dt("Cancel");M(X,J)},$$slots:{default:!0}});var Je=b(Ce,2);Nt(Je,{type:"submit",primary:!0,children:(X,pe)=>{var J=Dt("Create Trigger");M(X,J)},$$slots:{default:!0}}),_a("submit",ve,X=>{X.preventDefault(),P()}),vr(ae,()=>o(u),X=>S(u,X)),vr(Ie,()=>o(d),X=>S(d,X)),vr(ze,()=>o(f),X=>S(f,X)),vr(Q,()=>o(_),X=>S(_,X)),Ln(oe,()=>o(m),X=>S(m,X)),vr(Ae,()=>o(h),X=>S(h,X)),Sl(W,()=>o(v),X=>S(v,X)),M(B,ve)},$$slots:{default:!0}}),M(r,me),wt()}var Hh=G('<div class="pan-tilt-indicator svelte-kr8awf"></div>'),zh=G('<div class="device-item svelte-kr8awf"><div class="device-preview-container svelte-kr8awf"><div class="device-preview svelte-kr8awf"><!></div></div> <div class="device-info svelte-kr8awf"><div class="device-id svelte-kr8awf"> </div> <div class="device-name svelte-kr8awf"> </div></div></div>'),qh=G('<div class="css-view svelte-kr8awf"><div class="left-column svelte-kr8awf"><div class="device-list svelte-kr8awf"></div> <div class="animation-targets svelte-kr8awf"></div></div> <div class="right-column svelte-kr8awf"><div class="css-toolbar svelte-kr8awf"><button class="restore-button svelte-kr8awf">Restore Default CSS</button></div> <pre class="css-editor svelte-kr8awf" contenteditable="true" spellcheck="false"></pre></div></div>');function Wh(r,e){yt(e,!0);let t=fe(e,"devices",19,()=>[]);function n(){const A=localStorage.getItem("dmx-css");if(A)return A;const y=e.cssGenerator.generate(t());return y&&y.trim().length>200?y:`/* CSS Animation Mode

Target devices using ID selectors based on device names.
Example: "Moving Head 1" becomes #moving_head_1

Supported properties:
- color: Maps to RGB(W) channels
- opacity: Maps to dimmer channel
- translate: x â pan, y â tilt (for moving heads)
- --smoke-output: For smoke machines (0-255)

Example animations:
*/

@keyframes rainbow {
    0%   { color: rgb(255, 0, 0); }
    16%  { color: rgb(255, 127, 0); }
    33%  { color: rgb(255, 255, 0); }
    50%  { color: rgb(0, 255, 0); }
    66%  { color: rgb(0, 0, 255); }
    83%  { color: rgb(75, 0, 130); }
    100% { color: rgb(148, 0, 211); }
}

@keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.2; }
}

@keyframes pan-tilt {
    0%   { translate: 0% 0%; }
    25%  { translate: 100% 0%; }
    50%  { translate: 100% 100%; }
    75%  { translate: 0% 100%; }
    100% { translate: 0% 0%; }
}

/* Apply rainbow animation to all devices */
* {
    animation: rainbow 5s linear infinite;
}
`}let i=V(we(n())),s,a=!1,l=we({}),c=we({}),u=we({}),d=V(localStorage.getItem("dmx-css")!==null),f,_,m,v,h=0;function g(A,y){switch(A){case"RGB":return[y.Red||0,y.Green||0,y.Blue||0];case"RGBA":return[y.Red||0,y.Green||0,y.Blue||0,y.Amber||0];case"RGBW":return[y.Red||0,y.Green||0,y.Blue||0,y.White||0];case"DIMMER":return[y.Intensity||0];case"SMOKE":return[y.Output||0];case"MOVING_HEAD":return[y.Pan||127,y.Tilt||127,y.Dimmer||0,y.Red||0,y.Green||0,y.Blue||0,y.White||0];default:return console.warn(`Unknown device type: ${A}`),[]}}function D(){if(!e.cssSampler)return;h++,h%60===0&&console.log(`[CSSView] Animation loop running, frame ${h}`);const A=e.cssSampler.sampleAll(t());t().forEach(y=>{const C=A.get(y.id);if(!C)return;const O=g(y.type,C);if(C.Red!==void 0&&C.Green!==void 0&&C.Blue!==void 0){const U=C.White!==void 0?C.White:255,$=`rgba(${C.Red}, ${C.Green}, ${C.Blue}, ${U/255})`;l[y.id]!==$&&console.log(`[CSSView] Preview color updated for ${y.name}:`,{old:l[y.id],new:$}),l[y.id]=$}else if(C.Intensity!==void 0){const U=C.Intensity/255;c[y.id]=U}y.type==="MOVING_HEAD"&&C.Pan!==void 0&&C.Tilt!==void 0&&(u[y.id]={pan:C.Pan,tilt:C.Tilt}),e.dmxController&&a&&R(y,O)}),s=requestAnimationFrame(D)}function R(A,y){if(e.dmxController)for(let C=0;C<y.length;C++){const O=A.startChannel+C;e.dmxController.setChannel(O,y[C])}}function E(A){const y=A.target.textContent;f&&(f.textContent=`@scope (.animation-targets) {
${y}
}`),S(i,y,!0),localStorage.setItem("dmx-css",y),S(d,!0)}function T(A){f&&(f.textContent=`@scope (.animation-targets) {
${A}
}`)}function P(){if(!confirm("This will discard your custom CSS and generate a clean stylesheet from your devices, animations, and triggers. Continue?"))return;localStorage.removeItem("dmx-css"),S(d,!1);const A=e.cssGenerator.generate(t());S(i,A,!0),v&&(v.textContent=A),T(A)}function L(A){const{type:y,mapping:C}=A;if(C.mode==="trigger")if(y==="add"){const O=C.toCSS(t());O&&q(O)}else y==="remove"&&Ee(C.cssClassName)}function j(A){const{type:y,animation:C}=A;if(y==="add"){const O=C.toCSS();O&&be(O)}else y==="remove"&&me(C.name)}function q(A){let y=o(i);const C=/\/\*\s*===\s*Triggers\s*===\s*\*\//,O=y.match(C);if(O){const U=O.index+O[0].length;y=y.slice(0,U)+`
`+A+`
`+y.slice(U)}else y+=`

/* === Triggers === */
`+A+`
`;S(i,y,!0),v&&(v.textContent=y),T(y),localStorage.setItem("dmx-css",y)}function Ee(A){const y=new RegExp(`\\.${A}\\s+[^{]+\\{[^}]*\\}\\n?`,"g");let C=o(i).replace(y,"");S(i,C,!0),v&&(v.textContent=C),T(C),localStorage.setItem("dmx-css",C)}function be(A){let y=o(i);const C=/\/\*\s*===\s*Animations\s*===\s*\*\//,O=y.match(C);if(O){const U=O.index+O[0].length;y=y.slice(0,U)+`
`+A+`
`+y.slice(U)}else{const U=/\/\*\s*===\s*Triggers\s*===\s*\*\//,$=y.match(U);if($){const se=$.index;y=y.slice(0,se)+`/* === Animations === */
`+A+`

`+y.slice(se)}else y+=`

/* === Animations === */
`+A+`
`}S(i,y,!0),v&&(v.textContent=y),T(y),localStorage.setItem("dmx-css",y)}function me(A){const y=new RegExp(`@keyframes\\s+${A}\\s*\\{[^}]*(?:\\{[^}]*\\}[^}]*)*\\}\\n?`,"g");let C=o(i).replace(y,"");S(i,C,!0),v&&(v.textContent=C),T(C),localStorage.setItem("dmx-css",C)}function ie(A){let y=o(i);const C=/\/\*\s*===\s*Default Device Values\s*===\s*\*\//,O=y.match(C);if(O){const $=y.slice(O.index+O[0].length).match(/\/\*\s*===\s*Animations\s*===\s*\*\//);if($){const se=O.index+O[0].length+$.index;y=y.slice(0,se)+`
`+A+`
`+y.slice(se)}else{const se=O.index+O[0].length;y=y.slice(0,se)+`
`+A+`
`+y.slice(se)}}else{const U=y.indexOf("*/")+2;U>1?y=y.slice(0,U)+`

/* === Default Device Values === */
/* These selectors set the default state for each device */
`+A+`
`+y.slice(U):y=`/* === Default Device Values === */
`+A+`

`+y}S(i,y,!0),v&&(v.textContent=y),T(y),localStorage.setItem("dmx-css",y)}function Se(){a=!1,s&&(cancelAnimationFrame(s),s=null)}Vn(()=>{f=document.createElement("style"),f.id="css-animation-styles",document.head.appendChild(f),_&&(m=document.createElement("div"),m.className="trigger-classes",_.appendChild(m)),e.cssSampler&&m&&(e.cssSampler.initialize(m),e.cssSampler.updateDevices(t())),e.triggerManager&&m&&e.triggerManager.setContainer(m),e.mappingLibrary.on("changed",L),e.animationLibrary.on("changed",j),v&&(v.textContent=o(i)),T(o(i)),t().forEach(A=>{l[A.id]=pr(A.type,A.defaultValues),c[A.id]=1,A.type==="MOVING_HEAD"&&(u[A.id]={pan:A.defaultValues[0]||127,tilt:A.defaultValues[1]||127})}),s||(a=!0,D())});let he=new Set;rr(()=>{if(e.cssSampler&&t()){e.cssSampler.updateDevices(t());const A=new Set(t().map(C=>C.id)),y=t().filter(C=>!he.has(C.id));if(y.length>0&&he.size>0)for(const C of y){const O=e.cssGenerator._generateDeviceDefaults(C);O&&ie(O)}he=A}}),vs(()=>{Se(),f&&f.parentNode&&f.parentNode.removeChild(f),e.mappingLibrary.off("changed",L),e.animationLibrary.off("changed",j)});var ue=qh(),De=w(ue),Re=w(De);Be(Re,21,t,A=>A.id,(A,y)=>{var C=zh(),O=w(C),U=w(O),$=w(U);{var se=ae=>{const Ke=We(()=>u[o(y).id]),Ie=We(()=>o(Ke).pan/255*100),je=We(()=>(1-o(Ke).tilt/255)*100);var ze=Hh();re(()=>Ze(ze,`left: ${o(Ie)??""}%; top: ${o(je)??""}%`)),M(ae,ze)};Le($,ae=>{o(y).type==="MOVING_HEAD"&&u[o(y).id]&&ae(se)})}var He=b(O,2),B=w(He),Z=w(B),ve=b(B,2),ye=w(ve);re(ae=>{Ze(U,`background-color: ${ae??""}; opacity: ${(c[o(y).id]||1)??""}`),te(Z,`#${o(y).cssId??""}`),te(ye,o(y).name)},[()=>l[o(y).id]||pr(o(y).type,o(y).defaultValues)]),M(A,C)});var ke=b(Re,2);nr(ke,A=>_=A,()=>_);var x=b(De,2),k=w(x),Y=w(k);Y.__click=P;var z=b(k,2);z.__input=E,nr(z,A=>v=A,()=>v),M(r,ue),wt()}bt(["click","input"]);var Yh=G("<!> <main><!> <div><!></div> <div><!></div> <div><!></div> <div><!></div> <div><!></div> <div><!></div> <div><!></div></main>",1);function Xh(r,e){yt(e,!0);let t=V("devices"),n=V(!1),i=we(new ad),s=V("RGB"),a=V(null),l=V(we([])),c=we(new ld),u=we(new Cl),d=we(new El),f=we(new Il),_=we(new ud),m=we(new cd(c,u)),v=we(new Qf(u,f,d));rr(()=>{v.initialize()});async function h(){try{await i.connect(),S(n,!0)}catch($){alert("Failed to connect: "+$.message)}}function g(){i.disconnect(),S(n,!1)}function D(){var $;($=o(a))!=null&&$.addDevice&&o(a).addDevice(o(s))}function R(){var $;i&&i.clearUniverse(),($=o(a))!=null&&$.clearAllDeviceValues&&o(a).clearAllDeviceValues()}var E=Yh(),T=st(E);av(T,{onconnect:h,ondisconnect:g,get connected(){return o(n)}});var P=b(T,2),L=w(P);mv(L,{showAddDevice:!0,get deviceTypes(){return Ve},onAddDevice:D,onClearUniverse:R,get view(){return o(t)},set view($){S(t,$,!0)},get selectedType(){return o(s)},set selectedType($){S(s,$,!0)}});var j=b(L,2);let q;var Ee=w(j);nr(Fv(Ee,{get dmxController(){return i},get animationLibrary(){return c},get mappingLibrary(){return u},get inputController(){return v},get cssGenerator(){return m},get selectedType(){return o(s)},set selectedType($){S(s,$,!0)},get devices(){return o(l)},set devices($){S(l,$,!0)}}),$=>S(a,$,!0),()=>o(a));var be=b(j,2);let me;var ie=w(be);bv(ie,{get dmxController(){return i}});var Se=b(be,2);let he;var ue=w(Se);Zv(ue,{get dmxController(){return i},get devices(){return o(l)}});var De=b(Se,2);let Re;var ke=w(De);yh(ke,{get animationLibrary(){return c},get cssGenerator(){return m},get devices(){return o(l)}});var x=b(De,2);let k;var Y=w(x);Mh(Y,{get inputController(){return v},get mappingLibrary(){return u}});var z=b(x,2);let A;var y=w(z);$h(y,{get mappingLibrary(){return u},get animationLibrary(){return c},get devices(){return o(l)}});var C=b(z,2);let O;var U=w(C);Wh(U,{get dmxController(){return i},get devices(){return o(l)},get animationLibrary(){return c},get mappingLibrary(){return u},get cssGenerator(){return m},get cssSampler(){return _},get triggerManager(){return d}}),re(()=>{q=it(j,1,"view-container svelte-1n46o8q",null,q,{hidden:o(t)!=="devices"}),me=it(be,1,"view-container svelte-1n46o8q",null,me,{hidden:o(t)!=="universe"}),he=it(Se,1,"view-container svelte-1n46o8q",null,he,{hidden:o(t)!=="timeline"}),Re=it(De,1,"view-container svelte-1n46o8q",null,Re,{hidden:o(t)!=="animations"}),k=it(x,1,"view-container svelte-1n46o8q",null,k,{hidden:o(t)!=="inputs"}),A=it(z,1,"view-container svelte-1n46o8q",null,A,{hidden:o(t)!=="triggers"}),O=it(C,1,"view-container svelte-1n46o8q",null,O,{hidden:o(t)!=="css"})}),M(r,E),wt()}Ru(Xh,{target:document.getElementById("app")});
